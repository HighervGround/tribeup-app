{"version":3,"file":"useUserProfile-CtUpRbce.js","sources":["../../src/hooks/useUserProfile.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { toast } from 'sonner';\n\n// Query keys\nexport const userKeys = {\n  all: ['users'] as const,\n  profile: (id: string) => [...userKeys.all, 'profile', id] as const,\n  stats: (id: string) => [...userKeys.all, 'stats', id] as const,\n  recentGames: (id: string) => [...userKeys.all, 'recentGames', id] as const,\n  achievements: (id: string) => [...userKeys.all, 'achievements', id] as const,\n};\n\n/**\n * Hook for fetching user profile data\n */\nexport function useUserProfile(userId: string) {\n  return useQuery({\n    queryKey: userKeys.profile(userId),\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      return await SupabaseService.getUserProfile(userId);\n    },\n    enabled: !!userId,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n  });\n}\n\n/**\n * Hook for fetching user stats\n */\nexport function useUserStats(userId: string) {\n  return useQuery({\n    queryKey: userKeys.stats(userId),\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      try {\n        const rawStats = await SupabaseService.getUserStats(userId);\n        // Map database fields to expected format\n        return {\n          totalGamesPlayed: rawStats.games_played || 0,\n          totalGamesHosted: rawStats.games_hosted || 0,\n          averageRating: rawStats.average_rating || 0,\n          totalPlayTime: rawStats.total_play_time_minutes || 0,\n          favoritesSports: rawStats.favorite_sport ? [rawStats.favorite_sport] : [],\n          completionRate: rawStats.completion_rate || 0,\n          totalDistance: rawStats.total_distance || 0,\n        };\n      } catch (error) {\n        // Return default stats if none exist\n        return {\n          totalGamesPlayed: 0,\n          totalGamesHosted: 0,\n          averageRating: 0,\n          totalPlayTime: 0,\n          favoritesSports: [],\n          completionRate: 0,\n          totalDistance: 0,\n        };\n      }\n    },\n    enabled: !!userId,\n    staleTime: 2 * 60 * 1000, // 2 minutes\n    gcTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n/**\n * Hook for fetching user's recent games\n */\nexport function useUserRecentGames(userId: string, limit = 5) {\n  return useQuery({\n    queryKey: [...userKeys.recentGames(userId), limit],\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      try {\n        return await SupabaseService.getUserRecentGames(userId, limit);\n      } catch (error) {\n        return [];\n      }\n    },\n    enabled: !!userId,\n    staleTime: 1 * 60 * 1000, // 1 minute\n    gcTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n/**\n * Hook for fetching user achievements\n */\nexport function useUserAchievements(userId: string) {\n  return useQuery({\n    queryKey: userKeys.achievements(userId),\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      try {\n        return await SupabaseService.getUserAchievements(userId);\n      } catch (error) {\n        return [];\n      }\n    },\n    enabled: !!userId,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n  });\n}\n\n/**\n * Hook for updating user profile\n */\nexport function useUpdateUserProfile() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ userId, profileData }: { userId: string; profileData: any }) => {\n      return await SupabaseService.updateUserProfile(userId, profileData);\n    },\n    onSuccess: (_, { userId }) => {\n      // Invalidate user profile queries\n      queryClient.invalidateQueries({ queryKey: userKeys.profile(userId) });\n      queryClient.invalidateQueries({ queryKey: userKeys.stats(userId) });\n      \n      toast.success('Profile updated successfully!', {\n        description: 'Your changes have been saved',\n      });\n    },\n    onError: (error) => {\n      console.error('Update profile error:', error);\n      toast.error('Failed to update profile', {\n        description: 'Please try again later',\n      });\n    },\n  });\n}\n"],"names":["userKeys","all","profile","id","stats","recentGames","achievements","useUserProfile","userId","useQuery","queryKey","queryFn","async","Error","SupabaseService","getUserProfile","enabled","staleTime","gcTime","useUserStats","rawStats","getUserStats","totalGamesPlayed","games_played","totalGamesHosted","games_hosted","averageRating","average_rating","totalPlayTime","total_play_time_minutes","favoritesSports","favorite_sport","completionRate","completion_rate","totalDistance","total_distance","error","useUserRecentGames","limit","getUserRecentGames","useUserAchievements","getUserAchievements","useUpdateUserProfile","queryClient","useQueryClient","useMutation","mutationFn","profileData","updateUserProfile","onSuccess","_","invalidateQueries","toast","success","description","onError"],"mappings":"qIAKO,MAAMA,EAAW,CACtBC,IAAK,CAAC,SACNC,QAAUC,GAAe,IAAIH,EAASC,IAAK,UAAWE,GACtDC,MAAQD,GAAe,IAAIH,EAASC,IAAK,QAASE,GAClDE,YAAcF,GAAe,IAAIH,EAASC,IAAK,cAAeE,GAC9DG,aAAeH,GAAe,IAAIH,EAASC,IAAK,eAAgBE,IAM3D,SAASI,EAAeC,GAC7B,OAAOC,EAAS,CACdC,SAAUV,EAASE,QAAQM,GAC3BG,QAASC,UACP,IAAKJ,EAAQ,MAAM,IAAIK,MAAM,uBAC7B,aAAaC,EAAgBC,eAAeP,IAE9CQ,UAAWR,EACXS,UAAW,IACXC,OAAQ,KAEZ,CAKO,SAASC,EAAaX,GAC3B,OAAOC,EAAS,CACdC,SAAUV,EAASI,MAAMI,GACzBG,QAASC,UACP,IAAKJ,EAAQ,MAAM,IAAIK,MAAM,uBAC7B,IACE,MAAMO,QAAiBN,EAAgBO,aAAab,GAEpD,MAAO,CACLc,iBAAkBF,EAASG,cAAgB,EAC3CC,iBAAkBJ,EAASK,cAAgB,EAC3CC,cAAeN,EAASO,gBAAkB,EAC1CC,cAAeR,EAASS,yBAA2B,EACnDC,gBAAiBV,EAASW,eAAiB,CAACX,EAASW,gBAAkB,GACvEC,eAAgBZ,EAASa,iBAAmB,EAC5CC,cAAed,EAASe,gBAAkB,EAE9C,OAASC,GAEP,MAAO,CACLd,iBAAkB,EAClBE,iBAAkB,EAClBE,cAAe,EACfE,cAAe,EACfE,gBAAiB,GACjBE,eAAgB,EAChBE,cAAe,EAEnB,GAEFlB,UAAWR,EACXS,UAAW,KACXC,OAAQ,KAEZ,CAKO,SAASmB,EAAmB7B,EAAgB8B,EAAQ,GACzD,OAAO7B,EAAS,CACdC,SAAU,IAAIV,EAASK,YAAYG,GAAS8B,GAC5C3B,QAASC,UACP,IAAKJ,EAAQ,MAAM,IAAIK,MAAM,uBAC7B,IACE,aAAaC,EAAgByB,mBAAmB/B,EAAQ8B,EAC1D,OAASF,GACP,MAAO,EACT,GAEFpB,UAAWR,EACXS,UAAW,IACXC,OAAQ,KAEZ,CAKO,SAASsB,EAAoBhC,GAClC,OAAOC,EAAS,CACdC,SAAUV,EAASM,aAAaE,GAChCG,QAASC,UACP,IAAKJ,EAAQ,MAAM,IAAIK,MAAM,uBAC7B,IACE,aAAaC,EAAgB2B,oBAAoBjC,EACnD,OAAS4B,GACP,MAAO,EACT,GAEFpB,UAAWR,EACXS,UAAW,IACXC,OAAQ,KAEZ,CAKO,SAASwB,IACd,MAAMC,EAAcC,IAEpB,OAAOC,EAAY,CACjBC,WAAYlC,OAASJ,SAAQuC,uBACdjC,EAAgBkC,kBAAkBxC,EAAQuC,GAEzDE,UAAW,CAACC,GAAK1C,aAEfmC,EAAYQ,kBAAkB,CAAEzC,SAAUV,EAASE,QAAQM,KAC3DmC,EAAYQ,kBAAkB,CAAEzC,SAAUV,EAASI,MAAMI,KAEzD4C,EAAMC,QAAQ,gCAAiC,CAC7CC,YAAa,kCAGjBC,QAAUnB,IAERgB,EAAMhB,MAAM,2BAA4B,CACtCkB,YAAa,6BAIrB"}