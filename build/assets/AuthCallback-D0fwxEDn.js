import{j as a}from"./ui-Ca5AhCQM.js";import{r as m}from"./vendor-IUqyc6Bg.js";import{u as d,t as r,L as g,s as l}from"./index-ugQABfbR.js";function A(){const e=d();return m.useEffect(()=>{const c=async()=>{try{console.log("[AuthCallback] Processing OAuth callback...");const{data:o,error:n}=await l.auth.getSession();if(n){console.error("[AuthCallback] Session error:",n),r.error("Authentication failed"),e("/auth",{replace:!0});return}if(o.session){console.log("[AuthCallback] Session found, user authenticated");const t=localStorage.getItem("pendingGameJoin");t?(console.log("[AuthCallback] Redirecting to pending game:",t),localStorage.removeItem("pendingGameJoin"),e(`/game/${t}`,{replace:!0})):(console.log("[AuthCallback] Redirecting to home"),e("/",{replace:!0}))}else{console.log("[AuthCallback] No session found, checking URL for auth data...");const t=new URLSearchParams(window.location.search),i=new URLSearchParams(window.location.hash.substring(1));t.get("code")||i.get("access_token")?(console.log("[AuthCallback] OAuth data found in URL, waiting for session..."),setTimeout(async()=>{const{data:u,error:h}=await l.auth.getSession();u.session?(console.log("[AuthCallback] Session found on retry"),e("/",{replace:!0})):(console.error("[AuthCallback] Still no session after retry:",h),e("/auth",{replace:!0}))},2e3)):(console.log("[AuthCallback] No OAuth data in URL"),e("/auth",{replace:!0}))}}catch(o){console.error("[AuthCallback] Unexpected error:",o),r.error("Authentication failed"),e("/auth",{replace:!0})}},s=setTimeout(()=>{console.error("[AuthCallback] Timeout - redirecting to auth"),r.error("Authentication timed out"),e("/auth",{replace:!0})},1e4);return c().finally(()=>{clearTimeout(s)}),()=>clearTimeout(s)},[e]),a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(g,{className:"w-8 h-8 animate-spin mx-auto"}),a.jsx("h2",{className:"text-xl font-semibold",children:"Completing sign in..."}),a.jsx("p",{className:"text-muted-foreground",children:"Please wait while we set up your account"})]})})}export{A as AuthCallback};
//# sourceMappingURL=AuthCallback-D0fwxEDn.js.map
