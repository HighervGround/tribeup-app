{"version":3,"file":"useDeepLinks-Du3ymgsh.js","sources":["../../src/hooks/useDeepLinks.ts"],"sourcesContent":["import { useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation, useParams } from 'react-router-dom';\nimport { toast } from 'sonner';\n\ninterface DeepLink {\n  path: string;\n  params?: Record<string, string>;\n  query?: Record<string, string>;\n  state?: any;\n}\n\ninterface ShareableLink {\n  title: string;\n  description: string;\n  url: string;\n  image?: string;\n}\n\nexport function useDeepLinks() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const params = useParams();\n\n  // Generate app URLs for sharing\n  const generateGameUrl = useCallback((gameId: string, options?: { \n    utm_source?: string; \n    utm_medium?: string; \n    utm_campaign?: string;\n  }) => {\n    const baseUrl = window.location.origin;\n    const url = new URL(`${baseUrl}/game/${gameId}`);\n    \n    if (options) {\n      Object.entries(options).forEach(([key, value]) => {\n        if (value) url.searchParams.set(key, value);\n      });\n    }\n    \n    return url.toString();\n  }, []);\n\n  const generateChatUrl = useCallback((type: 'game' | 'direct', id: string, options?: {\n    message?: string;\n    utm_source?: string;\n  }) => {\n    const baseUrl = window.location.origin;\n    const url = new URL(`${baseUrl}/chat/${type}/${id}`);\n    \n    if (options) {\n      Object.entries(options).forEach(([key, value]) => {\n        if (value) url.searchParams.set(key, value);\n      });\n    }\n    \n    return url.toString();\n  }, []);\n\n  const generateUserUrl = useCallback((userId: string) => {\n    const baseUrl = window.location.origin;\n    return `${baseUrl}/user/${userId}`;\n  }, []);\n\n  // Share game with native sharing or clipboard\n  const shareGame = useCallback(async (gameData: {\n    id: string;\n    title: string;\n    sport: string;\n    location: string;\n    date: string;\n    time: string;\n  }) => {\n    const gameUrl = generateGameUrl(gameData.id, {\n      utm_source: 'app_share',\n      utm_medium: 'native_share',\n      utm_campaign: 'game_invitation'\n    });\n\n    const shareData: ShareableLink = {\n      title: `Join me for ${gameData.title}!`,\n      description: `${gameData.sport} game at ${gameData.location} on ${gameData.date} at ${gameData.time}. Tap to join!`,\n      url: gameUrl\n    };\n\n    try {\n      if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {\n        await navigator.share(shareData);\n        toast.success('Game shared successfully!');\n        return true;\n      } else {\n        // Fallback to clipboard\n        await navigator.clipboard.writeText(gameUrl);\n        toast.success('Game link copied to clipboard!', {\n          description: 'Share with your friends',\n          action: {\n            label: 'Share again',\n            onClick: () => shareGame(gameData)\n          }\n        });\n        return true;\n      }\n    } catch (error) {\n      console.error('Error sharing game:', error);\n      toast.error('Failed to share game');\n      return false;\n    }\n  }, [generateGameUrl]);\n\n  // Share user profile\n  const shareProfile = useCallback(async (userData: {\n    id: string;\n    name: string;\n    rating?: number;\n  }) => {\n    const profileUrl = generateUserUrl(userData.id);\n    const shareData: ShareableLink = {\n      title: `Check out ${userData.name}'s TribeUp profile`,\n      description: `${userData.name}${userData.rating ? ` (${userData.rating}â­)` : ''} is on TribeUp! Connect and play sports together.`,\n      url: profileUrl\n    };\n\n    try {\n      if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {\n        await navigator.share(shareData);\n        toast.success('Profile shared successfully!');\n        return true;\n      } else {\n        await navigator.clipboard.writeText(profileUrl);\n        toast.success('Profile link copied to clipboard!');\n        return true;\n      }\n    } catch (error) {\n      console.error('Error sharing profile:', error);\n      toast.error('Failed to share profile');\n      return false;\n    }\n  }, [generateUserUrl]);\n\n  // Navigate with deep link support\n  const navigateToGame = useCallback((gameId: string, state?: any) => {\n    navigate(`/game/${gameId}`, { state });\n  }, [navigate]);\n\n  const navigateToChat = useCallback((type: 'game' | 'direct', id: string, state?: any) => {\n    navigate(`/chat/${type}/${id}`, { state });\n  }, [navigate]);\n\n  const navigateToUser = useCallback((userId: string, state?: any) => {\n    navigate(`/user/${userId}`, { state });\n  }, [navigate]);\n\n  // Handle incoming deep links (when app is opened via URL)\n  const handleIncomingDeepLink = useCallback(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const utmSource = searchParams.get('utm_source');\n    const utmMedium = searchParams.get('utm_medium');\n    const utmCampaign = searchParams.get('utm_campaign');\n\n    // Track analytics for deep link usage\n    if (utmSource || utmMedium || utmCampaign) {\n      console.log('Deep link opened with UTM parameters:', {\n        source: utmSource,\n        medium: utmMedium,\n        campaign: utmCampaign,\n        path: location.pathname\n      });\n\n      // In a real app, you'd send this to your analytics service\n      // analytics.track('deep_link_opened', { utmSource, utmMedium, utmCampaign, path: location.pathname });\n    }\n\n    // Handle specific deep link actions\n    if (location.pathname.startsWith('/game/')) {\n      const gameId = params.gameId;\n      if (gameId && utmCampaign === 'game_invitation') {\n        toast.success('Welcome to the game!', {\n          description: 'You were invited to join this game'\n        });\n      }\n    }\n\n    if (location.pathname.startsWith('/chat/')) {\n      const message = searchParams.get('message');\n      if (message) {\n        // Pre-fill message input if provided\n        setTimeout(() => {\n          const messageInput = document.querySelector('input[placeholder*=\"message\" i]') as HTMLInputElement;\n          if (messageInput) {\n            messageInput.value = decodeURIComponent(message);\n            messageInput.focus();\n          }\n        }, 500);\n      }\n    }\n  }, [location, params]);\n\n  // Generate meta tags for social sharing (for SSR or when sharing externally)\n  const generateMetaTags = useCallback((data: ShareableLink) => {\n    return {\n      'og:title': data.title,\n      'og:description': data.description,\n      'og:url': data.url,\n      'og:image': data.image || `${window.location.origin}/og-image.png`,\n      'og:type': 'website',\n      'twitter:card': 'summary_large_image',\n      'twitter:title': data.title,\n      'twitter:description': data.description,\n      'twitter:image': data.image || `${window.location.origin}/og-image.png`\n    };\n  }, []);\n\n  // Copy current URL to clipboard\n  const copyCurrentUrl = useCallback(async () => {\n    try {\n      await navigator.clipboard.writeText(window.location.href);\n      toast.success('Link copied to clipboard!');\n      return true;\n    } catch (error) {\n      console.error('Error copying URL:', error);\n      toast.error('Failed to copy link');\n      return false;\n    }\n  }, []);\n\n  // Get current route context for analytics\n  const getCurrentContext = useCallback(() => {\n    const path = location.pathname;\n    \n    if (path === '/') return 'home';\n    if (path === '/search') return 'search';\n    if (path === '/create') return 'create';\n    if (path === '/profile') return 'profile';\n    if (path.startsWith('/game/')) return 'game';\n    if (path.startsWith('/chat/')) return 'chat';\n    if (path.startsWith('/user/')) return 'user_profile';\n    if (path.startsWith('/settings')) return 'settings';\n    \n    return 'unknown';\n  }, [location.pathname]);\n\n  // Handle deep link on app load/route change\n  useEffect(() => {\n    handleIncomingDeepLink();\n  }, [handleIncomingDeepLink]);\n\n  // Return all utilities\n  return {\n    // URL generators\n    generateGameUrl,\n    generateChatUrl,\n    generateUserUrl,\n    \n    // Sharing functions\n    shareGame,\n    shareProfile,\n    copyCurrentUrl,\n    \n    // Navigation functions\n    navigateToGame,\n    navigateToChat,\n    navigateToUser,\n    \n    // Utilities\n    generateMetaTags,\n    getCurrentContext,\n    \n    // Current route info\n    currentPath: location.pathname,\n    currentSearch: location.search,\n    currentParams: params,\n    currentState: location.state\n  };\n}\n\n// Hook for handling URL state and query parameters\nexport function useUrlState<T = any>(key: string, defaultValue?: T) {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const getValue = useCallback(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const value = searchParams.get(key);\n    \n    if (value === null) return defaultValue;\n    \n    try {\n      return JSON.parse(value);\n    } catch {\n      return value;\n    }\n  }, [location.search, key, defaultValue]);\n\n  const setValue = useCallback((value: T) => {\n    const searchParams = new URLSearchParams(location.search);\n    \n    if (value === undefined || value === null) {\n      searchParams.delete(key);\n    } else {\n      const stringValue = typeof value === 'string' ? value : JSON.stringify(value);\n      searchParams.set(key, stringValue);\n    }\n    \n    const newSearch = searchParams.toString();\n    const newUrl = newSearch ? `${location.pathname}?${newSearch}` : location.pathname;\n    \n    navigate(newUrl, { replace: true, state: location.state });\n  }, [location, navigate, key]);\n\n  return [getValue(), setValue] as const;\n}"],"names":["useDeepLinks","navigate","useNavigate","location","useLocation","params","useParams","generateGameUrl","useCallback","gameId","options","baseUrl","url","key","value","generateChatUrl","type","id","generateUserUrl","userId","shareGame","gameData","gameUrl","shareData","toast","error","shareProfile","userData","profileUrl","navigateToGame","state","navigateToChat","navigateToUser","handleIncomingDeepLink","searchParams","utmSource","utmMedium","utmCampaign","message","messageInput","generateMetaTags","data","copyCurrentUrl","getCurrentContext","path","useEffect"],"mappings":"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"}