{"version":3,"file":"HomeScreen-NCpEk1IP.js","sources":["../../src/hooks/useUserPresence.ts","../../src/components/HomeScreen.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { supabase } from '../lib/supabase';\n\ninterface UserPresence {\n  userId: string;\n  lastSeen: Date;\n  isOnline: boolean;\n}\n\nexport function useUserPresence() {\n  const [onlineUsers, setOnlineUsers] = useState<UserPresence[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    let intervalId: NodeJS.Timeout;\n    let presenceChannel: any;\n\n    const updatePresence = async () => {\n      try {\n        // Get current user\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) return;\n\n        // Update user's last seen timestamp\n        await supabase\n          .from('user_presence')\n          .upsert({\n            user_id: user.id,\n            last_seen: new Date().toISOString(),\n            is_online: true\n          });\n\n        // Get all users who were active in the last 5 minutes\n        const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000).toISOString();\n        \n        const { data: presenceData, error } = await supabase\n          .from('user_presence')\n          .select('user_id, last_seen, is_online')\n          .gte('last_seen', fiveMinutesAgo)\n          .eq('is_online', true);\n\n        if (error) {\n          console.error('Error fetching user presence:', error);\n          return;\n        }\n\n        // Transform data and update state\n        const users = (presenceData || []).map(p => ({\n          userId: p.user_id,\n          lastSeen: new Date(p.last_seen),\n          isOnline: p.is_online\n        }));\n\n        setOnlineUsers(users);\n        setIsLoading(false);\n      } catch (error) {\n        console.error('Error updating presence:', error);\n        setIsLoading(false);\n      }\n    };\n\n    // Set up real-time presence tracking\n    const setupPresence = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) {\n        setIsLoading(false);\n        return;\n      }\n\n      // Create presence channel\n      presenceChannel = supabase.channel('user-presence', {\n        config: {\n          presence: {\n            key: user.id,\n          },\n        },\n      });\n\n      // Track presence changes\n      presenceChannel\n        .on('presence', { event: 'sync' }, () => {\n          const state = presenceChannel.presenceState();\n          const users = Object.values(state).flat().map((presence: any) => ({\n            userId: presence.user_id,\n            lastSeen: new Date(),\n            isOnline: true\n          }));\n          setOnlineUsers(users);\n          setIsLoading(false);\n        })\n        .on('presence', { event: 'join' }, ({ key, newPresences }) => {\n          console.log('User joined:', key, newPresences);\n        })\n        .on('presence', { event: 'leave' }, ({ key, leftPresences }) => {\n          console.log('User left:', key, leftPresences);\n        })\n        .subscribe(async (status) => {\n          if (status === 'SUBSCRIBED') {\n            await presenceChannel.track({\n              user_id: user.id,\n              online_at: new Date().toISOString(),\n            });\n          }\n        });\n\n      // Update presence every 30 seconds\n      intervalId = setInterval(updatePresence, 30000);\n      \n      // Initial update\n      updatePresence();\n    };\n\n    setupPresence();\n\n    // Cleanup\n    return () => {\n      if (intervalId) {\n        clearInterval(intervalId);\n      }\n      if (presenceChannel) {\n        presenceChannel.unsubscribe();\n      }\n    };\n  }, []);\n\n  return {\n    onlineUsers,\n    onlineCount: onlineUsers.length,\n    isLoading\n  };\n}\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Button } from './ui/button';\nimport { Plus, RefreshCw, MapPin, Clock, Users } from 'lucide-react';\nimport { formatEventHeader, formatCalendarInfo, formatTimeString } from '../lib/dateUtils';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { useAppStore } from '../store/appStore';\nimport { useUserPresence } from '../hooks/useUserPresence';\n\n\n\n// Simple GameCard component\nfunction SimpleGameCard({ game, onSelect }: { game: any; onSelect: () => void }) {\n  const { joinGame, leaveGame } = useAppStore();\n\n  const handleJoinClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (game.isJoined) {\n      leaveGame(game.id);\n    } else {\n      joinGame(game.id);\n    }\n  };\n\n  const handleCardClick = () => {\n    onSelect();\n  };\n\n  // Get category badge\n  const getCategoryBadge = () => {\n    if (game.category === 'today') {\n      return <span className=\"inline-block bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300 text-xs px-2 py-1 rounded-full font-medium\">Today</span>;\n    } else if (game.category === 'tomorrow') {\n      return <span className=\"inline-block bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 text-xs px-2 py-1 rounded-full font-medium\">Tomorrow</span>;\n    }\n    return null;\n  };\n\n  return (\n    <div \n      className=\"bg-card rounded-lg p-4 border border-border cursor-pointer hover:shadow-md transition-shadow\"\n      onClick={handleCardClick}\n    >\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex-1 pr-4\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <h3 className=\"font-semibold text-lg\">{game.title}</h3>\n            {getCategoryBadge()}\n          </div>\n          <p className=\"text-sm text-muted-foreground\">{game.sport}</p>\n        </div>\n        <div className=\"text-right flex-shrink-0\">\n          <div className=\"text-sm font-medium\">{game.cost}</div>\n          <div className=\"text-xs text-muted-foreground\">\n            {game.currentPlayers}/{game.maxPlayers} players\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"space-y-2 text-sm\">\n        <div className=\"flex items-center gap-2\">\n          <MapPin className=\"w-4 h-4 text-muted-foreground\" />\n          <span>{game.location}</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Users className=\"w-4 h-4 text-muted-foreground\" />\n          <span>{game.currentPlayers}/{game.maxPlayers} players</span>\n        </div>\n        {game.distance && (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-muted-foreground\">üìè</span>\n            <span>{game.distance}</span>\n          </div>\n        )}\n        <div className=\"flex items-center gap-2\">\n          <Clock className=\"w-4 h-4 text-muted-foreground\" />\n          <span>{game.date} at {formatTimeString(game.time)}</span>\n        </div>\n      </div>\n      \n      <p className=\"text-sm text-muted-foreground mt-3\">{game.description}</p>\n      \n      <div className=\"flex items-center justify-between mt-3\">\n        {game.isJoined ? (\n          <span className=\"inline-block bg-success/20 text-success dark:bg-success/30 dark:text-success text-xs px-2 py-1 rounded\">\n            Joined ‚úì\n          </span>\n        ) : (\n          <div></div>\n        )}\n        \n        <button\n          onClick={handleJoinClick}\n          className={`px-3 py-1 rounded text-sm font-medium transition-colors ${\n            game.isJoined \n              ? 'bg-destructive/20 text-destructive dark:bg-destructive/30 dark:text-destructive hover:bg-destructive/30 dark:hover:bg-destructive/40' \n              : 'bg-primary text-primary-foreground hover:bg-primary/90'\n          }`}\n        >\n          {game.isJoined ? 'Leave' : 'Join'}\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport function HomeScreen() {\n  const navigate = useNavigate();\n  const { games, setGames, isLoading, setLoading, user } = useAppStore();\n  const [refreshing, setRefreshing] = useState(false);\n  const [timedOut, setTimedOut] = useState(false);\n  const userPreferredSports = useMemo(() => user?.preferences?.sports ?? [], [user]);\n  const { onlineCount, isLoading: presenceLoading } = useUserPresence();\n\n  // Calculate real stats\n  const stats = useMemo(() => {\n    const now = new Date();\n    const startOfWeek = new Date(now);\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of current week (Sunday)\n    startOfWeek.setHours(0, 0, 0, 0);\n    \n    const endOfWeek = new Date(startOfWeek);\n    endOfWeek.setDate(startOfWeek.getDate() + 6); // End of current week (Saturday)\n    endOfWeek.setHours(23, 59, 59, 999);\n\n    // Count games this week\n    const thisWeekGames = games.filter(game => {\n      const gameDate = new Date(game.date);\n      return gameDate >= startOfWeek && gameDate <= endOfWeek;\n    }).length;\n\n    return {\n      totalGames: games.length,\n      thisWeekGames,\n      onlinePlayers: onlineCount\n    };\n  }, [games, onlineCount]);\n\n  // Load games only once on mount, prevent multiple calls\n  useEffect(() => {\n    if (games.length === 0 && !isLoading) {\n      loadGames();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Safety timeout to prevent infinite loading\n  useEffect(() => {\n    if (isLoading && games.length === 0) {\n      const timeout = setTimeout(() => {\n        console.warn('Loading timeout - clearing loading state');\n        setLoading(false);\n        setTimedOut(true);\n      }, 10000); // 10 second timeout\n\n      return () => clearTimeout(timeout);\n    }\n  }, [isLoading, games.length, setLoading]);\n\n\n  // Disabled realtime to prevent WebSocket connection issues\n  // useEffect(() => {\n  //   let timeoutId: NodeJS.Timeout;\n  //   \n  //   const sub = SupabaseService.subscribeToAllGames((payload) => {\n  //     console.log('[Realtime] games INSERT received', payload?.new?.id || '');\n  //     \n  //     // Debounce realtime updates to avoid excessive API calls\n  //     clearTimeout(timeoutId);\n  //     timeoutId = setTimeout(async () => {\n  //       try {\n  //         const data = feedMode === 'recommended'\n  //           ? await SupabaseService.getRecommendedGames(userPreferredSports)\n  //           : await SupabaseService.getGames();\n  //         setGames(data);\n  //       } catch (error) {\n  //         console.error('[Realtime] Failed to refresh games:', error);\n  //       }\n  //     }, 1000);\n  //   });\n  //   \n  //   return () => {\n  //     clearTimeout(timeoutId);\n  //     try { sub.unsubscribe(); } catch {}\n  //   };\n  //   // eslint-disable-next-line react-hooks/exhaustive-deps\n  // }, [feedMode, userPreferredSports.join?.('|') ?? '']);\n\n  // Safety: clear global loading if this screen unmounts mid-request\n  useEffect(() => {\n    return () => {\n      setLoading(false);\n    };\n  }, [setLoading]);\n\n\n  const loadGames = async () => {\n    if (isLoading) {\n      console.log('Already loading games, skipping duplicate call');\n      return;\n    }\n    \n    setTimedOut(false);\n    setLoading(true);\n    \n    try {\n      const gamesData = await SupabaseService.getGames();\n      setGames(gamesData);\n    } catch (error) {\n      console.error('Error loading games:', error);\n      setTimedOut(true);\n      setGames([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRefresh = async () => {\n    if (refreshing) return; // Prevent multiple concurrent refreshes\n    \n    setTimedOut(false);\n    setRefreshing(true);\n    try {\n      await loadGames();\n    } finally {\n      setRefreshing(false);\n    }\n  };\n\n  const handleGameSelect = (gameId: string) => {\n    navigate(`/game/${gameId}`);\n  };\n\n  const handleCreateGame = () => {\n    navigate('/create');\n  };\n\n  // Sort games chronologically with smart grouping\n  const sortedGames = games\n    .map(game => {\n      const gameDate = new Date(game.date);\n      const today = new Date();\n      const tomorrow = new Date(today);\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      \n      // Determine game category for sorting and display\n      let category = 'future';\n      let sortOrder = gameDate.getTime();\n      \n      if (gameDate.toDateString() === today.toDateString()) {\n        category = 'today';\n        sortOrder = 0; // Today's games first\n      } else if (gameDate.toDateString() === tomorrow.toDateString()) {\n        category = 'tomorrow';\n        sortOrder = 1; // Tomorrow's games second\n      }\n      \n      return {\n        ...game,\n        category,\n        sortOrder,\n        gameDate\n      };\n    })\n    .sort((a, b) => {\n      // First sort by category (today, tomorrow, future)\n      if (a.sortOrder !== b.sortOrder) {\n        return a.sortOrder - b.sortOrder;\n      }\n      // Then sort by time within each category\n      return a.gameDate.getTime() - b.gameDate.getTime();\n    });\n\n  // Show loading state\n  if (isLoading && games.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading games...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Timed-out empty state with retry - only show if no games at all\n  if (timedOut && games.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center space-y-3\">\n          <p className=\"text-muted-foreground\">Connection issues detected. Showing sample games.</p>\n          <Button onClick={handleRefresh} variant=\"outline\">\n            <RefreshCw className=\"w-4 h-4 mr-2\" /> Try Again\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"max-w-7xl mx-auto p-4 md:p-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\n          {/* Main Content */}\n          <div className=\"lg:col-span-8\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div>\n                <h1 className=\"text-2xl md:text-3xl font-bold\">TribeUp</h1>\n                <p className=\"text-muted-foreground\">Find your next game</p>\n              </div>\n              <Button onClick={handleCreateGame} className=\"hidden md:flex\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Create Game\n              </Button>\n              <Button \n                onClick={handleCreateGame}\n                size=\"icon\"\n                className=\"md:hidden\"\n                aria-label=\"Create new game\"\n              >\n                <Plus className=\"w-5 h-5\" />\n              </Button>\n            </div>\n\n            {/* Quick Stats - Mobile */}\n            <div className=\"grid grid-cols-3 gap-4 mb-6 lg:hidden\">\n              <div className=\"bg-card rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-primary\">{stats.totalGames}</div>\n                <div className=\"text-sm text-muted-foreground\">Active Games</div>\n              </div>\n              <div className=\"bg-card rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-primary\">\n                  {presenceLoading ? '...' : stats.onlinePlayers}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">Players Online</div>\n              </div>\n              <div className=\"bg-card rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-primary\">{stats.thisWeekGames}</div>\n                <div className=\"text-sm text-muted-foreground\">This Week</div>\n              </div>\n            </div>\n\n            {/* Games List */}\n            <div className=\"flex items-center justify-between mb-4\">\n              <h2 className=\"text-lg md:text-xl font-semibold\">Upcoming Games</h2>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={isLoading}\n                className=\"hidden md:flex\"\n              >\n                <RefreshCw className={`w-4 h-4 mr-2 ${isLoading ? 'animate-spin' : ''}`} />\n                Refresh\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={isLoading}\n                className=\"md:hidden\"\n                aria-label=\"Refresh games\"\n              >\n                <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n              </Button>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {sortedGames.map((game) => (\n                <div key={game.id}>\n                  <SimpleGameCard\n                    game={game}\n                    onSelect={() => handleGameSelect(game.id)}\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Sidebar - Desktop Only */}\n          <div className=\"hidden lg:block lg:col-span-4\">\n            <div className=\"bg-card rounded-lg p-6 sticky top-6\">\n              <h3 className=\"text-lg font-semibold mb-4\">Quick Stats</h3>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Active Games</span>\n                  <span className=\"font-semibold\">{stats.totalGames}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Players Online</span>\n                  <span className=\"font-semibold\">\n                    {presenceLoading ? '...' : stats.onlinePlayers}\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">This Week</span>\n                  <span className=\"font-semibold\">{stats.thisWeekGames}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["useUserPresence","onlineUsers","setOnlineUsers","useState","isLoading","setIsLoading","useEffect","intervalId","presenceChannel","updatePresence","user","supabase","fiveMinutesAgo","presenceData","error","users","p","state","presence","key","newPresences","leftPresences","status","SimpleGameCard","game","onSelect","joinGame","leaveGame","useAppStore","handleJoinClick","e","handleCardClick","getCategoryBadge","jsx","jsxs","MapPin","Users","Clock","formatTimeString","HomeScreen","navigate","useNavigate","games","setGames","setLoading","refreshing","setRefreshing","timedOut","setTimedOut","useMemo","onlineCount","presenceLoading","stats","now","startOfWeek","endOfWeek","thisWeekGames","gameDate","loadGames","timeout","gamesData","SupabaseService","handleRefresh","handleGameSelect","gameId","handleCreateGame","sortedGames","today","tomorrow","category","sortOrder","a","b","Button","RefreshCw","Plus"],"mappings":"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"}