{"version":3,"file":"Auth-DScvzDlS.js","sources":["../../src/components/login-form.tsx","../../src/components/EnhancedAuth.tsx"],"sourcesContent":["import { cn } from '../lib/utils'\nimport { supabase } from '../lib/supabase'\nimport { Button } from './ui/button'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from './ui/card'\nimport { Input } from './ui/input'\nimport { Alert, AlertDescription } from './ui/alert'\nimport { useState } from 'react'\nimport { Chrome, Apple, Mail } from 'lucide-react'\n\ninterface LoginFormProps extends React.ComponentPropsWithoutRef<'div'> {\n  onEmailAuth?: (email: string, password: string, isSignUp: boolean) => Promise<void>\n  onForgotPassword?: () => void\n}\n\nexport function LoginForm({ className, onEmailAuth, onForgotPassword, ...props }: LoginFormProps) {\n  const [error, setError] = useState<string | null>(null)\n  const [success, setSuccess] = useState<string | null>(null)\n  const [isLoading, setIsLoading] = useState(false)\n  const [showEmailForm, setShowEmailForm] = useState(false)\n  const [isSignUp, setIsSignUp] = useState(false)\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [name, setName] = useState('')\n\n  const handleSocialLogin = async (provider: 'google' | 'apple') => {\n    setIsLoading(true)\n    setError(null)\n\n    try {\n      const { error } = await supabase.auth.signInWithOAuth({\n        provider,\n        options: {\n          redirectTo: `${window.location.origin}/auth/callback`,\n          queryParams: {\n            access_type: 'offline',\n            prompt: 'consent',\n          }\n        }\n      })\n\n      if (error) throw error\n      // OAuth will redirect automatically\n    } catch (error: unknown) {\n      setError(error instanceof Error ? error.message : 'An error occurred')\n      setIsLoading(false)\n    }\n  }\n\n  const handleEmailAuth = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!onEmailAuth) return\n    \n    setIsLoading(true)\n    setError(null)\n    setSuccess(null)\n\n    try {\n      await onEmailAuth(email, password, isSignUp)\n      if (isSignUp) {\n        setSuccess('Check your email for confirmation link!')\n      }\n    } catch (error: unknown) {\n      setError(error instanceof Error ? error.message : 'An error occurred')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className={cn('flex flex-col gap-6', className)} {...props}>\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-2xl\">Welcome to TribeUp!</CardTitle>\n          <CardDescription>Find your tribe and join the game</CardDescription>\n        </CardHeader>\n        <CardContent>\n          {!showEmailForm ? (\n            <div className=\"space-y-4\">\n              {/* Social Login Buttons */}\n              <div className=\"grid grid-cols-2 gap-4\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => handleSocialLogin('google')}\n                  disabled={isLoading}\n                  className=\"w-full\"\n                >\n                  <Chrome className=\"mr-2 h-4 w-4\" />\n                  Google\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => handleSocialLogin('apple')}\n                  disabled={isLoading}\n                  className=\"w-full\"\n                >\n                  <Apple className=\"mr-2 h-4 w-4\" />\n                  Apple\n                </Button>\n              </div>\n\n              {/* Divider */}\n              <div className=\"relative my-6\">\n                <div className=\"absolute inset-0 flex items-center\">\n                  <span className=\"w-full border-t\" />\n                </div>\n                <div className=\"relative flex justify-center text-xs uppercase\">\n                  <span className=\"bg-background px-2 text-muted-foreground\">\n                    Or continue with email\n                  </span>\n                </div>\n              </div>\n\n              {/* Email Button */}\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowEmailForm(true)}\n                disabled={isLoading}\n                className=\"w-full\"\n              >\n                <Mail className=\"mr-2 h-4 w-4\" />\n                Continue with Email\n              </Button>\n\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n            </div>\n          ) : (\n            <form onSubmit={handleEmailAuth} className=\"space-y-4\">\n              {isSignUp && (\n                <div>\n                  <label htmlFor=\"name\" className=\"text-sm font-medium\">Name</label>\n                  <Input\n                    id=\"name\"\n                    type=\"text\"\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    required={isSignUp}\n                    placeholder=\"Enter your full name\"\n                  />\n                </div>\n              )}\n              \n              <div>\n                <label htmlFor=\"email\" className=\"text-sm font-medium\">Email</label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                  placeholder=\"Enter your email\"\n                />\n              </div>\n              \n              <div>\n                <label htmlFor=\"password\" className=\"text-sm font-medium\">Password</label>\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                  placeholder=\"Enter your password\"\n                />\n              </div>\n\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n\n              {success && (\n                <Alert>\n                  <AlertDescription>{success}</AlertDescription>\n                </Alert>\n              )}\n\n              <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n                {isLoading ? 'Loading...' : (isSignUp ? 'Sign Up' : 'Sign In')}\n              </Button>\n\n              <div className=\"text-center space-y-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setIsSignUp(!isSignUp)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground\"\n                >\n                  {isSignUp ? 'Already have an account? Sign In' : 'Need an account? Sign Up'}\n                </button>\n                <br />\n                {!isSignUp && onForgotPassword && (\n                  <>\n                    <button\n                      type=\"button\"\n                      onClick={onForgotPassword}\n                      className=\"text-sm text-muted-foreground hover:text-foreground\"\n                    >\n                      Forgot your password?\n                    </button>\n                    <br />\n                  </>\n                )}\n                <button\n                  type=\"button\"\n                  onClick={() => setShowEmailForm(false)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground\"\n                >\n                  Back to social login\n                </button>\n              </div>\n            </form>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n","import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { LoginForm } from './login-form';\nimport { useAuth } from '../providers/AuthProvider';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { toast } from 'sonner';\n\nfunction EnhancedAuth() {\n  const navigate = useNavigate();\n  const { signIn, signUp } = useAuth();\n\n  const handleEmailAuth = async (email: string, password: string, isSignUp: boolean) => {\n    try {\n      if (isSignUp) {\n        // Use the existing signUp function which properly creates user profiles\n        await signUp(email, password, { \n          name: email.split('@')[0], // Default name from email\n          email \n        });\n        toast.success('Check your email for confirmation link!');\n      } else {\n        await signIn(email, password);\n        // Navigation will be handled by AuthProvider\n      }\n    } catch (error: any) {\n      console.error('Email auth error:', error);\n      throw error; // Re-throw so LoginForm can handle the error display\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <LoginForm \n          onEmailAuth={handleEmailAuth}\n          className=\"w-full\"\n        />\n        \n        <div className=\"mt-6 text-center\">\n          <p className=\"text-xs text-muted-foreground\">\n            By continuing, you agree to our Terms of Service and Privacy Policy\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default EnhancedAuth;\n"],"names":["LoginForm","className","onEmailAuth","onForgotPassword","props","error","setError","useState","success","setSuccess","isLoading","setIsLoading","showEmailForm","setShowEmailForm","isSignUp","setIsSignUp","email","setEmail","password","setPassword","name","setName","handleSocialLogin","async","provider","supabase","auth","signInWithOAuth","options","redirectTo","window","location","origin","queryParams","access_type","prompt","Error","message","jsx","cn","children","jsxs","Card","CardHeader","CardTitle","CardDescription","CardContent","onSubmit","e","preventDefault","htmlFor","Input","id","type","value","onChange","target","required","placeholder","Alert","variant","AlertDescription","Button","disabled","onClick","Fragment","Chrome","Apple","Mail","EnhancedAuth","useNavigate","signIn","signUp","useAuth","split","toast"],"mappings":"sWAoBO,SAASA,GAAUC,UAAEA,EAAAC,YAAWA,mBAAaC,KAAqBC,IACvE,MAAOC,EAAOC,GAAYC,EAAAA,SAAwB,OAC3CC,EAASC,GAAcF,EAAAA,SAAwB,OAC/CG,EAAWC,GAAgBJ,EAAAA,UAAS,IACpCK,EAAeC,GAAoBN,EAAAA,UAAS,IAC5CO,EAAUC,GAAeR,EAAAA,UAAS,IAClCS,EAAOC,GAAYV,EAAAA,SAAS,KAC5BW,EAAUC,GAAeZ,EAAAA,SAAS,KAClCa,EAAMC,GAAWd,EAAAA,SAAS,IAE3Be,EAAoBC,MAAOC,IAC/Bb,GAAa,GACbL,EAAS,MAET,IACE,MAAQD,MAAAA,SAAgBoB,EAASC,KAAKC,gBAAgB,CACpDH,WACAI,QAAS,CACPC,WAAY,GAAGC,OAAOC,SAASC,uBAC/BC,YAAa,CACXC,YAAa,UACbC,OAAQ,cAKd,GAAI9B,EAAO,MAAMA,CAEnB,OAASA,GACPC,EAASD,aAAiB+B,MAAQ/B,EAAMgC,QAAU,qBAClD1B,GAAa,EACf,GAuBF,OACE2B,EAAAA,IAAC,MAAA,CAAIrC,UAAWsC,EAAG,sBAAuBtC,MAAgBG,EACxDoC,SAAAC,EAAAA,KAACC,EAAA,CACCF,SAAA,CAAAC,OAACE,EAAA,CACCH,SAAA,CAAAF,EAAAA,IAACM,EAAA,CAAU3C,UAAU,WAAWuC,SAAA,wBAChCF,EAAAA,IAACO,GAAgBL,SAAA,+CAElBM,EAAA,CACEN,SAAC5B,EAsDA6B,EAAAA,KAAC,OAAA,CAAKM,SAlFQxB,MAAOyB,IAE7B,GADAA,EAAEC,iBACG/C,EAAL,CAEAS,GAAa,GACbL,EAAS,MACTG,EAAW,MAEX,UACQP,EAAYc,EAAOE,EAAUJ,GAC/BA,GACFL,EAAW,0CAEf,OAASJ,GACPC,EAASD,aAAiB+B,MAAQ/B,EAAMgC,QAAU,oBACpD,CAAA,QACE1B,GAAa,EACf,CAfkB,GAgFuBV,UAAU,YACxCuC,SAAA,CAAA1B,UACE,MAAA,CACC0B,SAAA,CAAAF,MAAC,QAAA,CAAMY,QAAQ,OAAOjD,UAAU,sBAAsBuC,SAAA,SACtDF,EAAAA,IAACa,EAAA,CACCC,GAAG,OACHC,KAAK,OACLC,MAAOlC,EACPmC,SAAWP,GAAM3B,EAAQ2B,EAAEQ,OAAOF,OAClCG,SAAU3C,EACV4C,YAAY,mCAKjB,MAAA,CACClB,SAAA,CAAAF,MAAC,QAAA,CAAMY,QAAQ,QAAQjD,UAAU,sBAAsBuC,SAAA,UACvDF,EAAAA,IAACa,EAAA,CACCC,GAAG,QACHC,KAAK,QACLC,MAAOtC,EACPuC,SAAWP,GAAM/B,EAAS+B,EAAEQ,OAAOF,OACnCG,UAAQ,EACRC,YAAY,+BAIf,MAAA,CACClB,SAAA,CAAAF,MAAC,QAAA,CAAMY,QAAQ,WAAWjD,UAAU,sBAAsBuC,SAAA,aAC1DF,EAAAA,IAACa,EAAA,CACCC,GAAG,WACHC,KAAK,WACLC,MAAOpC,EACPqC,SAAWP,GAAM7B,EAAY6B,EAAEQ,OAAOF,OACtCG,UAAQ,EACRC,YAAY,2BAIfrD,SACEsD,EAAA,CAAMC,QAAQ,cACbpB,SAAAF,EAAAA,IAACuB,EAAA,CAAkBrB,eAItBhC,GACC8B,EAAAA,IAACqB,EAAA,CACCnB,SAAAF,EAAAA,IAACuB,EAAA,CAAkBrB,eAIvBF,EAAAA,IAACwB,EAAA,CAAOT,KAAK,SAASpD,UAAU,SAAS8D,SAAUrD,EAChD8B,SAAA9B,EAAY,aAAgBI,EAAW,UAAY,YAGtD2B,EAAAA,KAAC,MAAA,CAAIxC,UAAU,wBACbuC,SAAA,CAAAF,EAAAA,IAAC,SAAA,CACCe,KAAK,SACLW,QAAS,IAAMjD,GAAaD,GAC5Bb,UAAU,sDAETuC,WAAW,mCAAqC,mCAElD,KAAA,KACC1B,GAAYX,GACZsC,EAAAA,KAAAwB,EAAAA,SAAA,CACEzB,SAAA,CAAAF,EAAAA,IAAC,SAAA,CACCe,KAAK,SACLW,QAAS7D,EACTF,UAAU,sDACXuC,SAAA,gCAGA,KAAA,CAAA,MAGLF,EAAAA,IAAC,SAAA,CACCe,KAAK,SACLW,QAAS,IAAMnD,GAAiB,GAChCZ,UAAU,sDACXuC,SAAA,+BArILC,OAAC,MAAA,CAAIxC,UAAU,YAEbuC,SAAA,CAAAC,EAAAA,KAAC,MAAA,CAAIxC,UAAU,yBACbuC,SAAA,CAAAC,EAAAA,KAACqB,EAAA,CACCF,QAAQ,UACRI,QAAS,IAAM1C,EAAkB,UACjCyC,SAAUrD,EACVT,UAAU,SAEVuC,SAAA,CAAAF,EAAAA,IAAC4B,EAAA,CAAOjE,UAAU,iBAAiB,YAGrCwC,EAAAA,KAACqB,EAAA,CACCF,QAAQ,UACRI,QAAS,IAAM1C,EAAkB,SACjCyC,SAAUrD,EACVT,UAAU,SAEVuC,SAAA,CAAAF,EAAAA,IAAC6B,EAAA,CAAMlE,UAAU,iBAAiB,cAMtCwC,EAAAA,KAAC,MAAA,CAAIxC,UAAU,gBACbuC,SAAA,CAAAF,EAAAA,IAAC,OAAIrC,UAAU,qCACbuC,eAAC,OAAA,CAAKvC,UAAU,sBAElBqC,EAAAA,IAAC,OAAIrC,UAAU,iDACbuC,eAAC,OAAA,CAAKvC,UAAU,2CAA2CuC,SAAA,gCAO/DC,EAAAA,KAACqB,EAAA,CACCF,QAAQ,UACRI,QAAS,IAAMnD,GAAiB,GAChCkD,SAAUrD,EACVT,UAAU,SAEVuC,SAAA,CAAAF,EAAAA,IAAC8B,EAAA,CAAKnE,UAAU,iBAAiB,yBAIlCI,SACEsD,EAAA,CAAMC,QAAQ,cACbpB,SAAAF,EAAAA,IAACuB,EAAA,CAAkBrB,wBA+FrC,CC3NA,SAAS6B,IACUC,IACjB,MAAMC,OAAEA,EAAAC,OAAQA,GAAWC,IAqB3B,aACG,MAAA,CAAIxE,UAAU,kEACbuC,SAAAC,EAAAA,KAAC,MAAA,CAAIxC,UAAU,kBACbuC,SAAA,CAAAF,EAAAA,IAACtC,EAAA,CACCE,YAvBgBqB,MAAOP,EAAeE,EAAkBJ,KAC9D,IACMA,SAEI0D,EAAOxD,EAAOE,EAAU,CAC5BE,KAAMJ,EAAM0D,MAAM,KAAK,GACvB1D,UAEF2D,EAAMnE,QAAQ,kDAER+D,EAAOvD,EAAOE,EAGxB,OAASb,GAEP,MAAMA,CACR,GAQMJ,UAAU,WAGZqC,EAAAA,IAAC,OAAIrC,UAAU,mBACbuC,eAAC,IAAA,CAAEvC,UAAU,gCAAgCuC,SAAA,8EAOvD"}