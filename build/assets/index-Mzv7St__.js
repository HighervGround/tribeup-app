const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeScreen-BAZHUiRZ.js","assets/ui-CuzVkv4o.js","assets/vendor-Dit9F4CM.js","assets/useGames-D4AGQlA-.js","assets/useMutation-M2-MJ6DD.js","assets/UnifiedGameCard-XtxUGUD_.js","assets/ImageWithFallback-Ba8Vz0S_.js","assets/useGameJoinToggle-DY4Cct5e.js","assets/dateUtils-But3d3jk.js","assets/calendar-siSf3sT-.js","assets/map-pin-DThEIEnm.js","assets/users-B0YSAO-v.js","assets/skeleton-BgRgzBNy.js","assets/SearchDiscovery-BksIq8AI.js","assets/input-CMStqkNd.js","assets/arrow-left-BwnB17kP.js","assets/CreateGame-DferleHj.js","assets/progress-Br14-YiG.js","assets/textarea-Dzmojl_a.js","assets/alert-CUeGNN31.js","assets/select-0FuCrqZO.js","assets/check-Cc1EEBk7.js","assets/circle-alert-CBmJDmqw.js","assets/circle-check-big-CGHnT8vq.js","assets/UserProfile-DNwm-n6Z.js","assets/tabs-B7z5shTn.js","assets/useUserProfile-BP1eR5NT.js","assets/useAchievements-ZERxui_l.js","assets/trophy-DMPUdLzu.js","assets/star-Tmo82Azu.js","assets/zap-rk26cxk-.js","assets/settings-AgVDWnt0.js","assets/EditProfile-DuTkFPsn.js","assets/x-B_ALiaLW.js","assets/GameDetails-tEiuyAZx.js","assets/separator-Dtjp1JrK.js","assets/useDeepLinks-Djy8NZ40.js","assets/mail-C-VrYSf9.js","assets/message-square-cKaRp0dW.js","assets/share-CXE-REBo.js","assets/trash-2-D2p9QFTQ.js","assets/flag-C4mZsLb-.js","assets/OtherUserProfile-X4lLI1EG.js","assets/shield-Csm5h7CZ.js","assets/NotificationCenter-CY8Pe3nr.js","assets/Settings-1LxXK3_5.js","assets/switch-r5sIWW4P.js","assets/accessibility-vnJtvNy1.js","assets/sun-CdL2iHMT.js","assets/AccessibilitySettings-CEOoZXT2.js","assets/eye-BjMoWS9I.js","assets/NotificationSettings-Cd-UPcQs.js","assets/circle-x-CEIw2VN2.js","assets/DesignSystem-ChnOdYDB.js","assets/AdminDashboard-C6uDUTrP.js","assets/AuthCallback-GlyeEK3Q.js","assets/Onboarding-Bh7bmmNJ.js","assets/NavigationTest-CJcXdDfs.js","assets/Auth-BuLi3Bel.js"])))=>i.map(i=>d[i]);
import{j as y,S as ii,c as Za,P as Is,u as eo,a as ts}from"./ui-CuzVkv4o.js";import{a as to,r as f,g as ro,d as ye,R as k,c as so}from"./vendor-Dit9F4CM.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var ai,cn=to;ai=cn.createRoot,cn.hydrateRoot;const no="modulepreload",io=function(r){return"/"+r},un={},V=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=Promise.allSettled(t.map(l=>{if(l=io(l),l in un)return;un[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":no,c||(u.as="script"),u.crossOrigin="",u.href=l,o&&u.setAttribute("nonce",o),document.head.appendChild(u),c)return new Promise((h,m)=>{u.addEventListener("load",h),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var dn="popstate";function ao(r={}){function e(s,n){let{pathname:i,search:a,hash:o}=s.location;return rs("",{pathname:i,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(s,n){return typeof n=="string"?n:Gt(n)}return lo(e,t,null,r)}function H(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function ve(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oo(){return Math.random().toString(36).substring(2,10)}function hn(r,e){return{usr:r.state,key:r.key,idx:e}}function rs(r,e,t=null,s){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?At(e):e,state:t,key:e&&e.key||s||oo()}}function Gt({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function At(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let s=r.indexOf("?");s>=0&&(e.search=r.substring(s),r=r.substring(0,s)),r&&(e.pathname=r)}return e}function lo(r,e,t,s={}){let{window:n=document.defaultView,v5Compat:i=!1}=s,a=n.history,o="POP",l=null,c=d();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function d(){return(a.state||{idx:null}).idx}function u(){o="POP";let w=d(),v=w==null?null:w-c;c=w,l&&l({action:o,location:g.location,delta:v})}function h(w,v){o="PUSH";let b=rs(g.location,w,v);c=d()+1;let _=hn(b,c),S=g.createHref(b);try{a.pushState(_,"",S)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;n.location.assign(S)}i&&l&&l({action:o,location:g.location,delta:1})}function m(w,v){o="REPLACE";let b=rs(g.location,w,v);c=d();let _=hn(b,c),S=g.createHref(b);a.replaceState(_,"",S),i&&l&&l({action:o,location:g.location,delta:0})}function p(w){return co(w)}let g={get action(){return o},get location(){return r(n,a)},listen(w){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(dn,u),l=w,()=>{n.removeEventListener(dn,u),l=null}},createHref(w){return e(n,w)},createURL:p,encodeLocation(w){let v=p(w);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:m,go(w){return a.go(w)}};return g}function co(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),H(t,"No window.location.(origin|href) available to create URL");let s=typeof r=="string"?r:Gt(r);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function oi(r,e,t="/"){return uo(r,e,t,!1)}function uo(r,e,t,s){let n=typeof e=="string"?At(e):e,i=qe(n.pathname||"/",t);if(i==null)return null;let a=li(r);ho(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=ko(i);o=_o(a[l],c,s)}return o}function li(r,e=[],t=[],s="",n=!1){let i=(a,o,l=n,c)=>{let d={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(s)&&l)return;H(d.relativePath.startsWith(s),`Absolute route path "${d.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(s.length)}let u=Be([s,d.relativePath]),h=t.concat(d);a.children&&a.children.length>0&&(H(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),li(a.children,e,h,u,l)),!(a.path==null&&!a.index)&&e.push({path:u,score:wo(u,a.index),routesMeta:h})};return r.forEach((a,o)=>{if(a.path===""||!a.path?.includes("?"))i(a,o);else for(let l of ci(a.path))i(a,o,!0,l)}),e}function ci(r){let e=r.split("/");if(e.length===0)return[];let[t,...s]=e,n=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return n?[i,""]:[i];let a=ci(s.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),n&&o.push(...a),o.map(l=>r.startsWith("/")&&l===""?"/":l)}function ho(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:bo(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var fo=/^:[\w-]+$/,mo=3,po=2,go=1,yo=10,vo=-2,fn=r=>r==="*";function wo(r,e){let t=r.split("/"),s=t.length;return t.some(fn)&&(s+=vo),e&&(s+=po),t.filter(n=>!fn(n)).reduce((n,i)=>n+(fo.test(i)?mo:i===""?go:yo),s)}function bo(r,e){return r.length===e.length&&r.slice(0,-1).every((s,n)=>s===e[n])?r[r.length-1]-e[e.length-1]:0}function _o(r,e,t=!1){let{routesMeta:s}=r,n={},i="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],c=o===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",u=yr({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},d),h=l.route;if(!u&&c&&t&&!s[s.length-1].route.index&&(u=yr({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!u)return null;Object.assign(n,u.params),a.push({params:n,pathname:Be([i,u.pathname]),pathnameBase:Po(Be([i,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(i=Be([i,u.pathnameBase]))}return a}function yr(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,s]=xo(r.path,r.caseSensitive,r.end),n=e.match(t);if(!n)return null;let i=n[0],a=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:s.reduce((c,{paramName:d,isOptional:u},h)=>{if(d==="*"){let p=o[h]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const m=o[h];return u&&!m?c[d]=void 0:c[d]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:r}}function xo(r,e=!1,t=!0){ve(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let s=[],n="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(s.push({paramName:"*"}),n+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":r!==""&&r!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),s]}function ko(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ve(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function qe(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=r.charAt(t);return s&&s!=="/"?null:r.slice(t)||"/"}function So(r,e="/"){let{pathname:t,search:s="",hash:n=""}=typeof r=="string"?At(r):r;return{pathname:t?t.startsWith("/")?t:Eo(t,e):e,search:Co(s),hash:Ro(n)}}function Eo(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function Fr(r,e,t,s){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function To(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $s(r){let e=To(r);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function Ns(r,e,t,s=!1){let n;typeof r=="string"?n=At(r):(n={...r},H(!n.pathname||!n.pathname.includes("?"),Fr("?","pathname","search",n)),H(!n.pathname||!n.pathname.includes("#"),Fr("#","pathname","hash",n)),H(!n.search||!n.search.includes("#"),Fr("#","search","hash",n)));let i=r===""||n.pathname==="",a=i?"/":n.pathname,o;if(a==null)o=t;else{let u=e.length-1;if(!s&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),u-=1;n.pathname=h.join("/")}o=u>=0?e[u]:"/"}let l=So(n,o),c=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}var Be=r=>r.join("/").replace(/\/\/+/g,"/"),Po=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Co=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Ro=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Ao(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var ui=["POST","PUT","PATCH","DELETE"];new Set(ui);var Oo=["GET",...ui];new Set(Oo);var Ot=f.createContext(null);Ot.displayName="DataRouter";var Sr=f.createContext(null);Sr.displayName="DataRouterState";f.createContext(!1);var di=f.createContext({isTransitioning:!1});di.displayName="ViewTransition";var jo=f.createContext(new Map);jo.displayName="Fetchers";var Io=f.createContext(null);Io.displayName="Await";var Ce=f.createContext(null);Ce.displayName="Navigation";var Xt=f.createContext(null);Xt.displayName="Location";var we=f.createContext({outlet:null,matches:[],isDataRoute:!1});we.displayName="Route";var Us=f.createContext(null);Us.displayName="RouteError";function $o(r,{relative:e}={}){H(jt(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=f.useContext(Ce),{hash:n,pathname:i,search:a}=Zt(r,{relative:e}),o=i;return t!=="/"&&(o=i==="/"?t:Be([t,i])),s.createHref({pathname:o,search:a,hash:n})}function jt(){return f.useContext(Xt)!=null}function me(){return H(jt(),"useLocation() may be used only in the context of a <Router> component."),f.useContext(Xt).location}var hi="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function fi(r){f.useContext(Ce).static||f.useLayoutEffect(r)}function ut(){let{isDataRoute:r}=f.useContext(we);return r?Jo():No()}function No(){H(jt(),"useNavigate() may be used only in the context of a <Router> component.");let r=f.useContext(Ot),{basename:e,navigator:t}=f.useContext(Ce),{matches:s}=f.useContext(we),{pathname:n}=me(),i=JSON.stringify($s(s)),a=f.useRef(!1);return fi(()=>{a.current=!0}),f.useCallback((l,c={})=>{if(ve(a.current,hi),!a.current)return;if(typeof l=="number"){t.go(l);return}let d=Ns(l,JSON.parse(i),n,c.relative==="path");r==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Be([e,d.pathname])),(c.replace?t.replace:t.push)(d,c.state,c)},[e,t,i,n,r])}var Uo=f.createContext(null);function Lo(r){let e=f.useContext(we).outlet;return e&&f.createElement(Uo.Provider,{value:r},e)}function bm(){let{matches:r}=f.useContext(we),e=r[r.length-1];return e?e.params:{}}function Zt(r,{relative:e}={}){let{matches:t}=f.useContext(we),{pathname:s}=me(),n=JSON.stringify($s(t));return f.useMemo(()=>Ns(r,JSON.parse(n),s,e==="path"),[r,n,s,e])}function Do(r,e){return mi(r,e)}function mi(r,e,t,s,n){H(jt(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=f.useContext(Ce),{matches:a}=f.useContext(we),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",d=o?o.pathnameBase:"/",u=o&&o.route;{let b=u&&u.path||"";pi(c,!u||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let h=me(),m;if(e){let b=typeof e=="string"?At(e):e;H(d==="/"||b.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${b.pathname}" was given in the \`location\` prop.`),m=b}else m=h;let p=m.pathname||"/",g=p;if(d!=="/"){let b=d.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(b.length).join("/")}let w=oi(r,{pathname:g});ve(u||w!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),ve(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=zo(w&&w.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Be([d,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:Be([d,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,t,s,n);return e&&v?f.createElement(Xt.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},v):v}function Mo(){let r=Ko(),e=Ao(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,s="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},a=null;return console.error("Error handled by React Router default ErrorBoundary:",r),a=f.createElement(f.Fragment,null,f.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),f.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",f.createElement("code",{style:i},"ErrorBoundary")," or"," ",f.createElement("code",{style:i},"errorElement")," prop on your route.")),f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),t?f.createElement("pre",{style:n},t):null,a)}var Fo=f.createElement(Mo,null),Bo=class extends f.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){this.props.unstable_onError?this.props.unstable_onError(r,e):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?f.createElement(we.Provider,{value:this.props.routeContext},f.createElement(Us.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function qo({routeContext:r,match:e,children:t}){let s=f.useContext(Ot);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),f.createElement(we.Provider,{value:r},t)}function zo(r,e=[],t=null,s=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let i=r,a=t?.errors;if(a!=null){let c=i.findIndex(d=>d.route.id&&a?.[d.route.id]!==void 0);H(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,c+1))}let o=!1,l=-1;if(t)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:u,errors:h}=t,m=d.route.loader&&!u.hasOwnProperty(d.route.id)&&(!h||h[d.route.id]===void 0);if(d.route.lazy||m){o=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}return i.reduceRight((c,d,u)=>{let h,m=!1,p=null,g=null;t&&(h=a&&d.route.id?a[d.route.id]:void 0,p=d.route.errorElement||Fo,o&&(l<0&&u===0?(pi("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,g=null):l===u&&(m=!0,g=d.route.hydrateFallbackElement||null)));let w=e.concat(i.slice(0,u+1)),v=()=>{let b;return h?b=p:m?b=g:d.route.Component?b=f.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,f.createElement(qo,{match:d,routeContext:{outlet:c,matches:w,isDataRoute:t!=null},children:b})};return t&&(d.route.ErrorBoundary||d.route.errorElement||u===0)?f.createElement(Bo,{location:t.location,revalidation:t.revalidation,component:p,error:h,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0},unstable_onError:s}):v()},null)}function Ls(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wo(r){let e=f.useContext(Ot);return H(e,Ls(r)),e}function Ho(r){let e=f.useContext(Sr);return H(e,Ls(r)),e}function Go(r){let e=f.useContext(we);return H(e,Ls(r)),e}function Ds(r){let e=Go(r),t=e.matches[e.matches.length-1];return H(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function Vo(){return Ds("useRouteId")}function Ko(){let r=f.useContext(Us),e=Ho("useRouteError"),t=Ds("useRouteError");return r!==void 0?r:e.errors?.[t]}function Jo(){let{router:r}=Wo("useNavigate"),e=Ds("useNavigate"),t=f.useRef(!1);return fi(()=>{t.current=!0}),f.useCallback(async(n,i={})=>{ve(t.current,hi),t.current&&(typeof n=="number"?r.navigate(n):await r.navigate(n,{fromRouteId:e,...i}))},[r,e])}var mn={};function pi(r,e,t){!e&&!mn[r]&&(mn[r]=!0,ve(!1,t))}f.memo(Qo);function Qo({routes:r,future:e,state:t,unstable_onError:s}){return mi(r,void 0,t,s,e)}function ss({to:r,replace:e,state:t,relative:s}){H(jt(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=f.useContext(Ce);ve(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=f.useContext(we),{pathname:a}=me(),o=ut(),l=Ns(r,$s(i),a,s==="path"),c=JSON.stringify(l);return f.useEffect(()=>{o(JSON.parse(c),{replace:e,state:t,relative:s})},[o,c,s,e,t]),null}function pn(r){return Lo(r.context)}function K(r){H(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Yo({basename:r="/",children:e=null,location:t,navigationType:s="POP",navigator:n,static:i=!1}){H(!jt(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=r.replace(/^\/*/,"/"),o=f.useMemo(()=>({basename:a,navigator:n,static:i,future:{}}),[a,n,i]);typeof t=="string"&&(t=At(t));let{pathname:l="/",search:c="",hash:d="",state:u=null,key:h="default"}=t,m=f.useMemo(()=>{let p=qe(l,a);return p==null?null:{location:{pathname:p,search:c,hash:d,state:u,key:h},navigationType:s}},[a,l,c,d,u,h,s]);return ve(m!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${d}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:f.createElement(Ce.Provider,{value:o},f.createElement(Xt.Provider,{children:e,value:m}))}function Xo({children:r,location:e}){return Do(ns(r),e)}function ns(r,e=[]){let t=[];return f.Children.forEach(r,(s,n)=>{if(!f.isValidElement(s))return;let i=[...e,n];if(s.type===f.Fragment){t.push.apply(t,ns(s.props.children,i));return}H(s.type===K,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),H(!s.props.index||!s.props.children,"An index route cannot have child routes.");let a={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=ns(s.props.children,i)),t.push(a)}),t}var pr="get",gr="application/x-www-form-urlencoded";function Er(r){return r!=null&&typeof r.tagName=="string"}function Zo(r){return Er(r)&&r.tagName.toLowerCase()==="button"}function el(r){return Er(r)&&r.tagName.toLowerCase()==="form"}function tl(r){return Er(r)&&r.tagName.toLowerCase()==="input"}function rl(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function sl(r,e){return r.button===0&&(!e||e==="_self")&&!rl(r)}function is(r=""){return new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((e,t)=>{let s=r[t];return e.concat(Array.isArray(s)?s.map(n=>[t,n]):[[t,s]])},[]))}function nl(r,e){let t=is(r);return e&&e.forEach((s,n)=>{t.has(n)||e.getAll(n).forEach(i=>{t.append(n,i)})}),t}var ir=null;function il(){if(ir===null)try{new FormData(document.createElement("form"),0),ir=!1}catch{ir=!0}return ir}var al=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Br(r){return r!=null&&!al.has(r)?(ve(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gr}"`),null):r}function ol(r,e){let t,s,n,i,a;if(el(r)){let o=r.getAttribute("action");s=o?qe(o,e):null,t=r.getAttribute("method")||pr,n=Br(r.getAttribute("enctype"))||gr,i=new FormData(r)}else if(Zo(r)||tl(r)&&(r.type==="submit"||r.type==="image")){let o=r.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=r.getAttribute("formaction")||o.getAttribute("action");if(s=l?qe(l,e):null,t=r.getAttribute("formmethod")||o.getAttribute("method")||pr,n=Br(r.getAttribute("formenctype"))||Br(o.getAttribute("enctype"))||gr,i=new FormData(o,r),!il()){let{name:c,type:d,value:u}=r;if(d==="image"){let h=c?`${c}.`:"";i.append(`${h}x`,"0"),i.append(`${h}y`,"0")}else c&&i.append(c,u)}}else{if(Er(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=pr,s=null,n=gr,a=r}return i&&n==="text/plain"&&(a=i,i=void 0),{action:s,method:t.toLowerCase(),encType:n,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ms(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function ll(r,e,t){let s=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&qe(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function cl(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ul(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function dl(r,e,t){let s=await Promise.all(r.map(async n=>{let i=e.routes[n.route.id];if(i){let a=await cl(i,t);return a.links?a.links():[]}return[]}));return pl(s.flat(1).filter(ul).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function gn(r,e,t,s,n,i){let a=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>t[c].pathname!==l.pathname||t[c].route.path?.endsWith("*")&&t[c].params["*"]!==l.params["*"];return i==="assets"?e.filter((l,c)=>a(l,c)||o(l,c)):i==="data"?e.filter((l,c)=>{let d=s.routes[l.route.id];if(!d||!d.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let u=l.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof u=="boolean")return u}return!0}):[]}function hl(r,e,{includeHydrateFallback:t}={}){return fl(r.map(s=>{let n=e.routes[s.route.id];if(!n)return[];let i=[n.module];return n.clientActionModule&&(i=i.concat(n.clientActionModule)),n.clientLoaderModule&&(i=i.concat(n.clientLoaderModule)),t&&n.hydrateFallbackModule&&(i=i.concat(n.hydrateFallbackModule)),n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function fl(r){return[...new Set(r)]}function ml(r){let e={},t=Object.keys(r).sort();for(let s of t)e[s]=r[s];return e}function pl(r,e){let t=new Set;return new Set(e),r.reduce((s,n)=>{let i=JSON.stringify(ml(n));return t.has(i)||(t.add(i),s.push({key:i,link:n})),s},[])}function gi(){let r=f.useContext(Ot);return Ms(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function gl(){let r=f.useContext(Sr);return Ms(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Fs=f.createContext(void 0);Fs.displayName="FrameworkContext";function yi(){let r=f.useContext(Fs);return Ms(r,"You must render this element inside a <HydratedRouter> element"),r}function yl(r,e){let t=f.useContext(Fs),[s,n]=f.useState(!1),[i,a]=f.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:d,onTouchStart:u}=e,h=f.useRef(null);f.useEffect(()=>{if(r==="render"&&a(!0),r==="viewport"){let g=v=>{v.forEach(b=>{a(b.isIntersecting)})},w=new IntersectionObserver(g,{threshold:.5});return h.current&&w.observe(h.current),()=>{w.disconnect()}}},[r]),f.useEffect(()=>{if(s){let g=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(g)}}},[s]);let m=()=>{n(!0)},p=()=>{n(!1),a(!1)};return t?r!=="intent"?[i,h,{}]:[i,h,{onFocus:Dt(o,m),onBlur:Dt(l,p),onMouseEnter:Dt(c,m),onMouseLeave:Dt(d,p),onTouchStart:Dt(u,m)}]:[!1,h,{}]}function Dt(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function vl({page:r,...e}){let{router:t}=gi(),s=f.useMemo(()=>oi(t.routes,r,t.basename),[t.routes,r,t.basename]);return s?f.createElement(bl,{page:r,matches:s,...e}):null}function wl(r){let{manifest:e,routeModules:t}=yi(),[s,n]=f.useState([]);return f.useEffect(()=>{let i=!1;return dl(r,e,t).then(a=>{i||n(a)}),()=>{i=!0}},[r,e,t]),s}function bl({page:r,matches:e,...t}){let s=me(),{manifest:n,routeModules:i}=yi(),{basename:a}=gi(),{loaderData:o,matches:l}=gl(),c=f.useMemo(()=>gn(r,e,l,n,s,"data"),[r,e,l,n,s]),d=f.useMemo(()=>gn(r,e,l,n,s,"assets"),[r,e,l,n,s]),u=f.useMemo(()=>{if(r===s.pathname+s.search+s.hash)return[];let p=new Set,g=!1;if(e.forEach(v=>{let b=n.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in o&&i[v.route.id]?.shouldRevalidate||b.hasClientLoader?g=!0:p.add(v.route.id))}),p.size===0)return[];let w=ll(r,a,"data");return g&&p.size>0&&w.searchParams.set("_routes",e.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[w.pathname+w.search]},[a,o,s,n,c,e,r,i]),h=f.useMemo(()=>hl(d,n),[d,n]),m=wl(d);return f.createElement(f.Fragment,null,u.map(p=>f.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),h.map(p=>f.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),m.map(({key:p,link:g})=>f.createElement("link",{key:p,nonce:t.nonce,...g})))}function _l(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var vi=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vi&&(window.__reactRouterVersion="7.8.2")}catch{}function xl({basename:r,children:e,window:t}){let s=f.useRef();s.current==null&&(s.current=ao({window:t,v5Compat:!0}));let n=s.current,[i,a]=f.useState({action:n.action,location:n.location}),o=f.useCallback(l=>{f.startTransition(()=>a(l))},[a]);return f.useLayoutEffect(()=>n.listen(o),[n,o]),f.createElement(Yo,{basename:r,children:e,location:i.location,navigationType:i.action,navigator:n})}var wi=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bi=f.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:n,reloadDocument:i,replace:a,state:o,target:l,to:c,preventScrollReset:d,viewTransition:u,...h},m){let{basename:p}=f.useContext(Ce),g=typeof c=="string"&&wi.test(c),w,v=!1;if(typeof c=="string"&&g&&(w=c,vi))try{let q=new URL(window.location.href),ie=c.startsWith("//")?new URL(q.protocol+c):new URL(c),Ne=qe(ie.pathname,p);ie.origin===q.origin&&Ne!=null?c=Ne+ie.search+ie.hash:v=!0}catch{ve(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=$o(c,{relative:n}),[_,S,O]=yl(s,h),R=Tl(c,{replace:a,state:o,target:l,preventScrollReset:d,relative:n,viewTransition:u});function N(q){e&&e(q),q.defaultPrevented||R(q)}let C=f.createElement("a",{...h,...O,href:w||b,onClick:v||i?e:N,ref:_l(m,S),target:l,"data-discover":!g&&t==="render"?"true":void 0});return _&&!g?f.createElement(f.Fragment,null,C,f.createElement(vl,{page:b})):C});bi.displayName="Link";var kl=f.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:n=!1,style:i,to:a,viewTransition:o,children:l,...c},d){let u=Zt(a,{relative:c.relative}),h=me(),m=f.useContext(Sr),{navigator:p,basename:g}=f.useContext(Ce),w=m!=null&&Ol(u)&&o===!0,v=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,b=h.pathname,_=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;t||(b=b.toLowerCase(),_=_?_.toLowerCase():null,v=v.toLowerCase()),_&&g&&(_=qe(_,g)||_);const S=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let O=b===v||!n&&b.startsWith(v)&&b.charAt(S)==="/",R=_!=null&&(_===v||!n&&_.startsWith(v)&&_.charAt(v.length)==="/"),N={isActive:O,isPending:R,isTransitioning:w},C=O?e:void 0,q;typeof s=="function"?q=s(N):q=[s,O?"active":null,R?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let ie=typeof i=="function"?i(N):i;return f.createElement(bi,{...c,"aria-current":C,className:q,ref:d,style:ie,to:a,viewTransition:o},typeof l=="function"?l(N):l)});kl.displayName="NavLink";var Sl=f.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:n,state:i,method:a=pr,action:o,onSubmit:l,relative:c,preventScrollReset:d,viewTransition:u,...h},m)=>{let p=Rl(),g=Al(o,{relative:c}),w=a.toLowerCase()==="get"?"get":"post",v=typeof o=="string"&&wi.test(o),b=_=>{if(l&&l(_),_.defaultPrevented)return;_.preventDefault();let S=_.nativeEvent.submitter,O=S?.getAttribute("formmethod")||a;p(S||_.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:n,state:i,relative:c,preventScrollReset:d,viewTransition:u})};return f.createElement("form",{ref:m,method:w,action:g,onSubmit:s?l:b,...h,"data-discover":!v&&r==="render"?"true":void 0})});Sl.displayName="Form";function El(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _i(r){let e=f.useContext(Ot);return H(e,El(r)),e}function Tl(r,{target:e,replace:t,state:s,preventScrollReset:n,relative:i,viewTransition:a}={}){let o=ut(),l=me(),c=Zt(r,{relative:i});return f.useCallback(d=>{if(sl(d,e)){d.preventDefault();let u=t!==void 0?t:Gt(l)===Gt(c);o(r,{replace:u,state:s,preventScrollReset:n,relative:i,viewTransition:a})}},[l,o,c,t,s,e,r,n,i,a])}function _m(r){ve(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=f.useRef(is(r)),t=f.useRef(!1),s=me(),n=f.useMemo(()=>nl(s.search,t.current?null:e.current),[s.search]),i=ut(),a=f.useCallback((o,l)=>{const c=is(typeof o=="function"?o(new URLSearchParams(n)):o);t.current=!0,i("?"+c,l)},[i,n]);return[n,a]}var Pl=0,Cl=()=>`__${String(++Pl)}__`;function Rl(){let{router:r}=_i("useSubmit"),{basename:e}=f.useContext(Ce),t=Vo();return f.useCallback(async(s,n={})=>{let{action:i,method:a,encType:o,formData:l,body:c}=ol(s,e);if(n.navigate===!1){let d=n.fetcherKey||Cl();await r.fetch(d,t,n.action||i,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,flushSync:n.flushSync})}else await r.navigate(n.action||i,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,replace:n.replace,state:n.state,fromRouteId:t,flushSync:n.flushSync,viewTransition:n.viewTransition})},[r,e,t])}function Al(r,{relative:e}={}){let{basename:t}=f.useContext(Ce),s=f.useContext(we);H(s,"useFormAction must be used inside a RouteContext");let[n]=s.matches.slice(-1),i={...Zt(r||".",{relative:e})},a=me();if(r==null){i.search=a.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(d=>d==="")){o.delete("index"),l.filter(u=>u).forEach(u=>o.append("index",u));let d=o.toString();i.search=d?`?${d}`:""}}return(!r||r===".")&&n.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Be([t,i.pathname])),Gt(i)}function Ol(r,{relative:e}={}){let t=f.useContext(di);H(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=_i("useViewTransitionState"),n=Zt(r,{relative:e});if(!t.isTransitioning)return!1;let i=qe(t.currentLocation.pathname,s)||t.currentLocation.pathname,a=qe(t.nextLocation.pathname,s)||t.nextLocation.pathname;return yr(n.pathname,a)!=null||yr(n.pathname,i)!=null}function xi(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=xi(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function ki(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=xi(r))&&(s&&(s+=" "),s+=e);return s}const yn=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,vn=ki,Si=(r,e)=>t=>{var s;if(e?.variants==null)return vn(r,t?.class,t?.className);const{variants:n,defaultVariants:i}=e,a=Object.keys(n).map(c=>{const d=t?.[c],u=i?.[c];if(d===null)return null;const h=yn(d)||yn(u);return n[c][h]}),o=t&&Object.entries(t).reduce((c,d)=>{let[u,h]=d;return h===void 0||(c[u]=h),c},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((c,d)=>{let{class:u,className:h,...m}=d;return Object.entries(m).every(p=>{let[g,w]=p;return Array.isArray(w)?w.includes({...i,...o}[g]):{...i,...o}[g]===w})?[...c,u,h]:c},[]);return vn(r,a,l,t?.class,t?.className)},Bs="-",jl=r=>{const e=$l(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=r;return{getClassGroupId:a=>{const o=a.split(Bs);return o[0]===""&&o.length!==1&&o.shift(),Ei(o,e)||Il(a)},getConflictingClassGroupIds:(a,o)=>{const l=t[a]||[];return o&&s[a]?[...l,...s[a]]:l}}},Ei=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],s=e.nextPart.get(t),n=s?Ei(r.slice(1),s):void 0;if(n)return n;if(e.validators.length===0)return;const i=r.join(Bs);return e.validators.find(({validator:a})=>a(i))?.classGroupId},wn=/^\[(.+)\]$/,Il=r=>{if(wn.test(r)){const e=wn.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},$l=r=>{const{theme:e,classGroups:t}=r,s={nextPart:new Map,validators:[]};for(const n in t)as(t[n],s,n,e);return s},as=(r,e,t,s)=>{r.forEach(n=>{if(typeof n=="string"){const i=n===""?e:bn(e,n);i.classGroupId=t;return}if(typeof n=="function"){if(Nl(n)){as(n(s),e,t,s);return}e.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([i,a])=>{as(a,bn(e,i),t,s)})})},bn=(r,e)=>{let t=r;return e.split(Bs).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},Nl=r=>r.isThemeGetter,Ul=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,s=new Map;const n=(i,a)=>{t.set(i,a),e++,e>r&&(e=0,s=t,t=new Map)};return{get(i){let a=t.get(i);if(a!==void 0)return a;if((a=s.get(i))!==void 0)return n(i,a),a},set(i,a){t.has(i)?t.set(i,a):n(i,a)}}},os="!",ls=":",Ll=ls.length,Dl=r=>{const{prefix:e,experimentalParseClassName:t}=r;let s=n=>{const i=[];let a=0,o=0,l=0,c;for(let p=0;p<n.length;p++){let g=n[p];if(a===0&&o===0){if(g===ls){i.push(n.slice(l,p)),l=p+Ll;continue}if(g==="/"){c=p;continue}}g==="["?a++:g==="]"?a--:g==="("?o++:g===")"&&o--}const d=i.length===0?n:n.substring(l),u=Ml(d),h=u!==d,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:u,maybePostfixModifierPosition:m}};if(e){const n=e+ls,i=s;s=a=>a.startsWith(n)?i(a.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(t){const n=s;s=i=>t({className:i,parseClassName:n})}return s},Ml=r=>r.endsWith(os)?r.substring(0,r.length-1):r.startsWith(os)?r.substring(1):r,Fl=r=>{const e=Object.fromEntries(r.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const n=[];let i=[];return s.forEach(a=>{a[0]==="["||e[a]?(n.push(...i.sort(),a),i=[]):i.push(a)}),n.push(...i.sort()),n}},Bl=r=>({cache:Ul(r.cacheSize),parseClassName:Dl(r),sortModifiers:Fl(r),...jl(r)}),ql=/\s+/,zl=(r,e)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:i}=e,a=[],o=r.trim().split(ql);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{isExternal:u,modifiers:h,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:g}=t(d);if(u){l=d+(l.length>0?" "+l:l);continue}let w=!!g,v=s(w?p.substring(0,g):p);if(!v){if(!w){l=d+(l.length>0?" "+l:l);continue}if(v=s(p),!v){l=d+(l.length>0?" "+l:l);continue}w=!1}const b=i(h).join(":"),_=m?b+os:b,S=_+v;if(a.includes(S))continue;a.push(S);const O=n(v,w);for(let R=0;R<O.length;++R){const N=O[R];a.push(_+N)}l=d+(l.length>0?" "+l:l)}return l};function Wl(){let r=0,e,t,s="";for(;r<arguments.length;)(e=arguments[r++])&&(t=Ti(e))&&(s&&(s+=" "),s+=t);return s}const Ti=r=>{if(typeof r=="string")return r;let e,t="";for(let s=0;s<r.length;s++)r[s]&&(e=Ti(r[s]))&&(t&&(t+=" "),t+=e);return t};function Hl(r,...e){let t,s,n,i=a;function a(l){const c=e.reduce((d,u)=>u(d),r());return t=Bl(c),s=t.cache.get,n=t.cache.set,i=o,o(l)}function o(l){const c=s(l);if(c)return c;const d=zl(l,t);return n(l,d),d}return function(){return i(Wl.apply(null,arguments))}}const J=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},Pi=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Ci=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Gl=/^\d+\/\d+$/,Vl=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Kl=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Jl=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ql=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Yl=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,pt=r=>Gl.test(r),$=r=>!!r&&!Number.isNaN(Number(r)),Ke=r=>!!r&&Number.isInteger(Number(r)),qr=r=>r.endsWith("%")&&$(r.slice(0,-1)),De=r=>Vl.test(r),Xl=()=>!0,Zl=r=>Kl.test(r)&&!Jl.test(r),Ri=()=>!1,ec=r=>Ql.test(r),tc=r=>Yl.test(r),rc=r=>!E(r)&&!T(r),sc=r=>It(r,ji,Ri),E=r=>Pi.test(r),rt=r=>It(r,Ii,Zl),zr=r=>It(r,lc,$),_n=r=>It(r,Ai,Ri),nc=r=>It(r,Oi,tc),ar=r=>It(r,$i,ec),T=r=>Ci.test(r),Mt=r=>$t(r,Ii),ic=r=>$t(r,cc),xn=r=>$t(r,Ai),ac=r=>$t(r,ji),oc=r=>$t(r,Oi),or=r=>$t(r,$i,!0),It=(r,e,t)=>{const s=Pi.exec(r);return s?s[1]?e(s[1]):t(s[2]):!1},$t=(r,e,t=!1)=>{const s=Ci.exec(r);return s?s[1]?e(s[1]):t:!1},Ai=r=>r==="position"||r==="percentage",Oi=r=>r==="image"||r==="url",ji=r=>r==="length"||r==="size"||r==="bg-size",Ii=r=>r==="length",lc=r=>r==="number",cc=r=>r==="family-name",$i=r=>r==="shadow",uc=()=>{const r=J("color"),e=J("font"),t=J("text"),s=J("font-weight"),n=J("tracking"),i=J("leading"),a=J("breakpoint"),o=J("container"),l=J("spacing"),c=J("radius"),d=J("shadow"),u=J("inset-shadow"),h=J("text-shadow"),m=J("drop-shadow"),p=J("blur"),g=J("perspective"),w=J("aspect"),v=J("ease"),b=J("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],S=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],O=()=>[...S(),T,E],R=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto","contain","none"],C=()=>[T,E,l],q=()=>[pt,"full","auto",...C()],ie=()=>[Ke,"none","subgrid",T,E],Ne=()=>["auto",{span:["full",Ke,T,E]},Ke,T,E],Re=()=>[Ke,"auto",T,E],ce=()=>["auto","min","max","fr",T,E],We=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],pe=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...C()],z=()=>[pt,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],P=()=>[r,T,E],Ae=()=>[...S(),xn,_n,{position:[T,E]}],ae=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Oe=()=>["auto","cover","contain",ac,sc,{size:[T,E]}],He=()=>[qr,Mt,rt],A=()=>["","none","full",c,T,E],D=()=>["",$,Mt,rt],M=()=>["solid","dashed","dotted","double"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>[$,qr,xn,_n],F=()=>["","none",p,T,E],be=()=>["none",$,T,E],Ue=()=>["none",$,T,E],Ge=()=>[$,T,E],_e=()=>[pt,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[De],breakpoint:[De],color:[Xl],container:[De],"drop-shadow":[De],ease:["in","out","in-out"],font:[rc],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[De],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[De],shadow:[De],spacing:["px",$],text:[De],"text-shadow":[De],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",pt,E,T,w]}],container:["container"],columns:[{columns:[$,E,T,o]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:O()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:q()}],"inset-x":[{"inset-x":q()}],"inset-y":[{"inset-y":q()}],start:[{start:q()}],end:[{end:q()}],top:[{top:q()}],right:[{right:q()}],bottom:[{bottom:q()}],left:[{left:q()}],visibility:["visible","invisible","collapse"],z:[{z:[Ke,"auto",T,E]}],basis:[{basis:[pt,"full","auto",o,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[$,pt,"auto","initial","none",E]}],grow:[{grow:["",$,T,E]}],shrink:[{shrink:["",$,T,E]}],order:[{order:[Ke,"first","last","none",T,E]}],"grid-cols":[{"grid-cols":ie()}],"col-start-end":[{col:Ne()}],"col-start":[{"col-start":Re()}],"col-end":[{"col-end":Re()}],"grid-rows":[{"grid-rows":ie()}],"row-start-end":[{row:Ne()}],"row-start":[{"row-start":Re()}],"row-end":[{"row-end":Re()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ce()}],"auto-rows":[{"auto-rows":ce()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...We(),"normal"]}],"justify-items":[{"justify-items":[...pe(),"normal"]}],"justify-self":[{"justify-self":["auto",...pe()]}],"align-content":[{content:["normal",...We()]}],"align-items":[{items:[...pe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...pe(),{baseline:["","last"]}]}],"place-content":[{"place-content":We()}],"place-items":[{"place-items":[...pe(),"baseline"]}],"place-self":[{"place-self":["auto",...pe()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:z()}],w:[{w:[o,"screen",...z()]}],"min-w":[{"min-w":[o,"screen","none",...z()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...z()]}],h:[{h:["screen","lh",...z()]}],"min-h":[{"min-h":["screen","lh","none",...z()]}],"max-h":[{"max-h":["screen","lh",...z()]}],"font-size":[{text:["base",t,Mt,rt]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,T,zr]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",qr,E]}],"font-family":[{font:[ic,E,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,T,E]}],"line-clamp":[{"line-clamp":[$,"none",T,zr]}],leading:[{leading:[i,...C()]}],"list-image":[{"list-image":["none",T,E]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",T,E]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:P()}],"text-color":[{text:P()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...M(),"wavy"]}],"text-decoration-thickness":[{decoration:[$,"from-font","auto",T,rt]}],"text-decoration-color":[{decoration:P()}],"underline-offset":[{"underline-offset":[$,"auto",T,E]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",T,E]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",T,E]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Ae()}],"bg-repeat":[{bg:ae()}],"bg-size":[{bg:Oe()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ke,T,E],radial:["",T,E],conic:[Ke,T,E]},oc,nc]}],"bg-color":[{bg:P()}],"gradient-from-pos":[{from:He()}],"gradient-via-pos":[{via:He()}],"gradient-to-pos":[{to:He()}],"gradient-from":[{from:P()}],"gradient-via":[{via:P()}],"gradient-to":[{to:P()}],rounded:[{rounded:A()}],"rounded-s":[{"rounded-s":A()}],"rounded-e":[{"rounded-e":A()}],"rounded-t":[{"rounded-t":A()}],"rounded-r":[{"rounded-r":A()}],"rounded-b":[{"rounded-b":A()}],"rounded-l":[{"rounded-l":A()}],"rounded-ss":[{"rounded-ss":A()}],"rounded-se":[{"rounded-se":A()}],"rounded-ee":[{"rounded-ee":A()}],"rounded-es":[{"rounded-es":A()}],"rounded-tl":[{"rounded-tl":A()}],"rounded-tr":[{"rounded-tr":A()}],"rounded-br":[{"rounded-br":A()}],"rounded-bl":[{"rounded-bl":A()}],"border-w":[{border:D()}],"border-w-x":[{"border-x":D()}],"border-w-y":[{"border-y":D()}],"border-w-s":[{"border-s":D()}],"border-w-e":[{"border-e":D()}],"border-w-t":[{"border-t":D()}],"border-w-r":[{"border-r":D()}],"border-w-b":[{"border-b":D()}],"border-w-l":[{"border-l":D()}],"divide-x":[{"divide-x":D()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":D()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...M(),"hidden","none"]}],"divide-style":[{divide:[...M(),"hidden","none"]}],"border-color":[{border:P()}],"border-color-x":[{"border-x":P()}],"border-color-y":[{"border-y":P()}],"border-color-s":[{"border-s":P()}],"border-color-e":[{"border-e":P()}],"border-color-t":[{"border-t":P()}],"border-color-r":[{"border-r":P()}],"border-color-b":[{"border-b":P()}],"border-color-l":[{"border-l":P()}],"divide-color":[{divide:P()}],"outline-style":[{outline:[...M(),"none","hidden"]}],"outline-offset":[{"outline-offset":[$,T,E]}],"outline-w":[{outline:["",$,Mt,rt]}],"outline-color":[{outline:P()}],shadow:[{shadow:["","none",d,or,ar]}],"shadow-color":[{shadow:P()}],"inset-shadow":[{"inset-shadow":["none",u,or,ar]}],"inset-shadow-color":[{"inset-shadow":P()}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:P()}],"ring-offset-w":[{"ring-offset":[$,rt]}],"ring-offset-color":[{"ring-offset":P()}],"inset-ring-w":[{"inset-ring":D()}],"inset-ring-color":[{"inset-ring":P()}],"text-shadow":[{"text-shadow":["none",h,or,ar]}],"text-shadow-color":[{"text-shadow":P()}],opacity:[{opacity:[$,T,E]}],"mix-blend":[{"mix-blend":[...te(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":te()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[$]}],"mask-image-linear-from-pos":[{"mask-linear-from":W()}],"mask-image-linear-to-pos":[{"mask-linear-to":W()}],"mask-image-linear-from-color":[{"mask-linear-from":P()}],"mask-image-linear-to-color":[{"mask-linear-to":P()}],"mask-image-t-from-pos":[{"mask-t-from":W()}],"mask-image-t-to-pos":[{"mask-t-to":W()}],"mask-image-t-from-color":[{"mask-t-from":P()}],"mask-image-t-to-color":[{"mask-t-to":P()}],"mask-image-r-from-pos":[{"mask-r-from":W()}],"mask-image-r-to-pos":[{"mask-r-to":W()}],"mask-image-r-from-color":[{"mask-r-from":P()}],"mask-image-r-to-color":[{"mask-r-to":P()}],"mask-image-b-from-pos":[{"mask-b-from":W()}],"mask-image-b-to-pos":[{"mask-b-to":W()}],"mask-image-b-from-color":[{"mask-b-from":P()}],"mask-image-b-to-color":[{"mask-b-to":P()}],"mask-image-l-from-pos":[{"mask-l-from":W()}],"mask-image-l-to-pos":[{"mask-l-to":W()}],"mask-image-l-from-color":[{"mask-l-from":P()}],"mask-image-l-to-color":[{"mask-l-to":P()}],"mask-image-x-from-pos":[{"mask-x-from":W()}],"mask-image-x-to-pos":[{"mask-x-to":W()}],"mask-image-x-from-color":[{"mask-x-from":P()}],"mask-image-x-to-color":[{"mask-x-to":P()}],"mask-image-y-from-pos":[{"mask-y-from":W()}],"mask-image-y-to-pos":[{"mask-y-to":W()}],"mask-image-y-from-color":[{"mask-y-from":P()}],"mask-image-y-to-color":[{"mask-y-to":P()}],"mask-image-radial":[{"mask-radial":[T,E]}],"mask-image-radial-from-pos":[{"mask-radial-from":W()}],"mask-image-radial-to-pos":[{"mask-radial-to":W()}],"mask-image-radial-from-color":[{"mask-radial-from":P()}],"mask-image-radial-to-color":[{"mask-radial-to":P()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":S()}],"mask-image-conic-pos":[{"mask-conic":[$]}],"mask-image-conic-from-pos":[{"mask-conic-from":W()}],"mask-image-conic-to-pos":[{"mask-conic-to":W()}],"mask-image-conic-from-color":[{"mask-conic-from":P()}],"mask-image-conic-to-color":[{"mask-conic-to":P()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Ae()}],"mask-repeat":[{mask:ae()}],"mask-size":[{mask:Oe()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",T,E]}],filter:[{filter:["","none",T,E]}],blur:[{blur:F()}],brightness:[{brightness:[$,T,E]}],contrast:[{contrast:[$,T,E]}],"drop-shadow":[{"drop-shadow":["","none",m,or,ar]}],"drop-shadow-color":[{"drop-shadow":P()}],grayscale:[{grayscale:["",$,T,E]}],"hue-rotate":[{"hue-rotate":[$,T,E]}],invert:[{invert:["",$,T,E]}],saturate:[{saturate:[$,T,E]}],sepia:[{sepia:["",$,T,E]}],"backdrop-filter":[{"backdrop-filter":["","none",T,E]}],"backdrop-blur":[{"backdrop-blur":F()}],"backdrop-brightness":[{"backdrop-brightness":[$,T,E]}],"backdrop-contrast":[{"backdrop-contrast":[$,T,E]}],"backdrop-grayscale":[{"backdrop-grayscale":["",$,T,E]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[$,T,E]}],"backdrop-invert":[{"backdrop-invert":["",$,T,E]}],"backdrop-opacity":[{"backdrop-opacity":[$,T,E]}],"backdrop-saturate":[{"backdrop-saturate":[$,T,E]}],"backdrop-sepia":[{"backdrop-sepia":["",$,T,E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",T,E]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[$,"initial",T,E]}],ease:[{ease:["linear","initial",v,T,E]}],delay:[{delay:[$,T,E]}],animate:[{animate:["none",b,T,E]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,T,E]}],"perspective-origin":[{"perspective-origin":O()}],rotate:[{rotate:be()}],"rotate-x":[{"rotate-x":be()}],"rotate-y":[{"rotate-y":be()}],"rotate-z":[{"rotate-z":be()}],scale:[{scale:Ue()}],"scale-x":[{"scale-x":Ue()}],"scale-y":[{"scale-y":Ue()}],"scale-z":[{"scale-z":Ue()}],"scale-3d":["scale-3d"],skew:[{skew:Ge()}],"skew-x":[{"skew-x":Ge()}],"skew-y":[{"skew-y":Ge()}],transform:[{transform:[T,E,"","none","gpu","cpu"]}],"transform-origin":[{origin:O()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:_e()}],"translate-x":[{"translate-x":_e()}],"translate-y":[{"translate-y":_e()}],"translate-z":[{"translate-z":_e()}],"translate-none":["translate-none"],accent:[{accent:P()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:P()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",T,E]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",T,E]}],fill:[{fill:["none",...P()]}],"stroke-w":[{stroke:[$,Mt,rt,zr]}],stroke:[{stroke:["none",...P()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},dc=Hl(uc);function $e(...r){return dc(ki(r))}const hc=Si("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive shadow-sm hover:shadow-md active:scale-[0.98] transform",{variants:{variant:{default:"bg-gradient-to-r from-primary to-primary/90 text-primary-foreground hover:from-primary/90 hover:to-primary/80 hover:shadow-primary/25",destructive:"bg-gradient-to-r from-destructive to-destructive/90 text-white hover:from-destructive/90 hover:to-destructive/80 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 hover:shadow-destructive/25",outline:"border-2 bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:border-primary/50",secondary:"bg-gradient-to-r from-secondary to-secondary/90 text-secondary-foreground hover:from-secondary/90 hover:to-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 hover:shadow-none",link:"text-primary underline-offset-4 hover:underline shadow-none hover:shadow-none",message:"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 hover:shadow-blue-500/25 font-semibold"},size:{default:"h-10 px-5 py-2.5 has-[>svg]:px-4",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-12 rounded-lg px-8 has-[>svg]:px-6 text-base",icon:"size-10 rounded-lg"}},defaultVariants:{variant:"default",size:"default"}});function Et({className:r,variant:e,size:t,asChild:s=!1,...n}){const i=s?ii:"button";return y.jsx(i,{"data-slot":"button",className:$e(hc({variant:e,size:t,className:r})),...n})}function fc({className:r,...e}){return y.jsx("div",{"data-slot":"card",className:$e("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",r),...e})}function mc({className:r,...e}){return y.jsx("div",{"data-slot":"card-header",className:$e("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...e})}function pc({className:r,...e}){return y.jsx("h4",{"data-slot":"card-title",className:$e("leading-none",r),...e})}function gc({className:r,...e}){return y.jsx("div",{"data-slot":"card-content",className:$e("px-6 [&:last-child]:pb-6",r),...e})}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),vc=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),kn=r=>{const e=vc(r);return e.charAt(0).toUpperCase()+e.slice(1)},Ni=(...r)=>r.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=f.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:n="",children:i,iconNode:a,...o},l)=>f.createElement("svg",{ref:l,...wc,width:e,height:e,stroke:r,strokeWidth:s?Number(t)*24/Number(e):t,className:Ni("lucide",n),...o},[...a.map(([c,d])=>f.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=(r,e)=>{const t=f.forwardRef(({className:s,...n},i)=>f.createElement(bc,{ref:i,iconNode:e,className:Ni(`lucide-${yc(kn(r))}`,`lucide-${r}`,s),...n}));return t.displayName=kn(r),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ui=ze("bell",_c);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Li=ze("house",xc);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Sc=ze("loader-circle",kc);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ec=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],Tc=ze("menu",Ec);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Di=ze("plus",Pc);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Rc=ze("refresh-cw",Cc);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Mi=ze("search",Ac);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],jc=ze("triangle-alert",Oc);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Fi=ze("user",Ic);class Bi extends f.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:y.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:y.jsxs(fc,{className:"w-full max-w-md",children:[y.jsxs(mc,{className:"text-center",children:[y.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-destructive/10",children:y.jsx(jc,{className:"h-6 w-6 text-destructive"})}),y.jsx(pc,{className:"text-xl",children:"Something went wrong"})]}),y.jsxs(gc,{className:"space-y-4",children:[y.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"We encountered an unexpected error. This has been logged and we'll look into it."}),!1,y.jsxs("div",{className:"flex gap-2",children:[y.jsxs(Et,{onClick:this.handleRetry,className:"flex-1",variant:"default",children:[y.jsx(Rc,{className:"w-4 h-4 mr-2"}),"Try Again"]}),y.jsx(Et,{onClick:()=>window.location.reload(),variant:"outline",className:"flex-1",children:"Reload Page"})]})]})]})}):this.props.children}}function qs({size:r="md",className:e="",text:t}){const s={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};return y.jsxs("div",{className:`flex flex-col items-center justify-center gap-3 ${e}`,children:[y.jsx("div",{className:"animate-spin",children:y.jsx(Sc,{className:`${s[r]} text-primary`})}),t&&y.jsx("p",{className:"text-sm text-muted-foreground",children:t})]})}const $c=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>V(async()=>{const{default:s}=await Promise.resolve().then(()=>Nt);return{default:s}},[]).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class zs extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Nc extends zs{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sn extends zs{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class En extends zs{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var cs;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(cs||(cs={}));var Uc=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class Lc{constructor(e,{headers:t={},customFetch:s,region:n=cs.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=$c(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Uc(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let d;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(o["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(o["Content-Type"]="application/json",d=JSON.stringify(a)));const u=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:d}).catch(g=>{throw new Nc(g)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new Sn(u);if(!u.ok)throw new En(u);let m=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return m==="application/json"?p=yield u.json():m==="application/octet-stream"?p=yield u.blob():m==="text/event-stream"?p=u:m==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null,response:u}}catch(n){return{data:null,error:n,response:n instanceof En||n instanceof Sn?n.context:void 0}}})}}var le={},Ws={},Tr={},er={},Pr={},Cr={},Dc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Tt=Dc();const Mc=Tt.fetch,qi=Tt.fetch.bind(Tt),zi=Tt.Headers,Fc=Tt.Request,Bc=Tt.Response,Nt=Object.freeze(Object.defineProperty({__proto__:null,Headers:zi,Request:Fc,Response:Bc,default:qi,fetch:Mc},Symbol.toStringTag,{value:"Module"})),qc=ro(Nt);var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});let zc=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Rr.default=zc;var Wi=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Cr,"__esModule",{value:!0});const Wc=Wi(qc),Hc=Wi(Rr);let Gc=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Wc.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l,c;let d=null,u=null,h=null,m=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?u=b:u=JSON.parse(b))}const w=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const w=await i.text();try{d=JSON.parse(w),Array.isArray(d)&&i.status===404&&(u=[],d=null,m=200,p="OK")}catch{i.status===404&&w===""?(m=204,p="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((c=d?.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,m=200,p="OK"),d&&this.shouldThrowOnError)throw new Hc.default(d)}return{error:d,data:u,count:h,status:m,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var a,o,l;return{error:{message:`${(a=i?.name)!==null&&a!==void 0?a:"FetchError"}: ${i?.message}`,details:`${(o=i?.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}};Cr.default=Gc;var Vc=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Pr,"__esModule",{value:!0});const Kc=Vc(Cr);let Jc=class extends Kc.default{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Pr.default=Jc;var Qc=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(er,"__esModule",{value:!0});const Yc=Qc(Pr);let Xc=class extends Yc.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};er.default=Xc;var Zc=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Tr,"__esModule",{value:!0});const Ft=Zc(er);let eu=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new Ft.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var n;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ft.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ft.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var s;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Ft.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Ft.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};Tr.default=eu;var Hi=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ws,"__esModule",{value:!0});const tu=Hi(Tr),ru=Hi(er);let su=class Gi{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new tu.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Gi(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:i}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||n?(o=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=t);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new ru.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};Ws.default=su;var Ut=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(le,"__esModule",{value:!0});le.PostgrestError=le.PostgrestBuilder=le.PostgrestTransformBuilder=le.PostgrestFilterBuilder=le.PostgrestQueryBuilder=le.PostgrestClient=void 0;const Vi=Ut(Ws);le.PostgrestClient=Vi.default;const Ki=Ut(Tr);le.PostgrestQueryBuilder=Ki.default;const Ji=Ut(er);le.PostgrestFilterBuilder=Ji.default;const Qi=Ut(Pr);le.PostgrestTransformBuilder=Qi.default;const Yi=Ut(Cr);le.PostgrestBuilder=Yi.default;const Xi=Ut(Rr);le.PostgrestError=Xi.default;var nu=le.default={PostgrestClient:Vi.default,PostgrestQueryBuilder:Ki.default,PostgrestFilterBuilder:Ji.default,PostgrestTransformBuilder:Qi.default,PostgrestBuilder:Yi.default,PostgrestError:Xi.default};const{PostgrestClient:iu,PostgrestQueryBuilder:Pm,PostgrestFilterBuilder:Cm,PostgrestTransformBuilder:Rm,PostgrestBuilder:Am,PostgrestError:Om}=nu;class au{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ou="2.15.1",lu=`realtime-js/${ou}`,cu="1.0.0",us=1e4,uu=1e3,du=100;var qt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(qt||(qt={}));var Q;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Q||(Q={}));var Te;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Te||(Te={}));var ds;(function(r){r.websocket="websocket"})(ds||(ds={}));var ot;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(ot||(ot={}));class hu{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+n));a=a+n;const l=s.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Zi{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var B;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(B||(B={}));const Tn=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=fu(a,r,e,n),i),{})},fu=(r,e,t,s)=>{const n=e.find(o=>o.name===r),i=n?.type,a=t[r];return i&&!s.includes(i)?ea(i,a):hs(a)},ea=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return yu(e,t)}switch(r){case B.bool:return mu(e);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return pu(e);case B.json:case B.jsonb:return gu(e);case B.timestamp:return vu(e);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return hs(e);default:return hs(e)}},hs=r=>r,mu=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},pu=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},gu=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},yu=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>ea(e,o))}return r},vu=r=>typeof r=="string"?r.replace(" ","T"):r,ta=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Wr{constructor(e,t,s={},n=us){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Pn;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Pn||(Pn={}));class zt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zt.syncState(this.state,n,i,a),this.pendingDiffs.forEach(l=>{this.state=zt.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=zt.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,d)=>{a[c]||(l[c]=d)}),this.map(a,(c,d)=>{const u=i[c];if(u){const h=d.map(w=>w.presence_ref),m=u.map(w=>w.presence_ref),p=d.filter(w=>m.indexOf(w.presence_ref)<0),g=u.filter(w=>h.indexOf(w.presence_ref)<0);p.length>0&&(o[c]=p),g.length>0&&(l[c]=g)}else o[c]=d}),this.syncDiff(i,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var c;const d=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),d.length>0){const u=e[o].map(m=>m.presence_ref),h=d.filter(m=>u.indexOf(m.presence_ref)<0);e[o].unshift(...h)}s(o,d,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const d=l.map(u=>u.presence_ref);c=c.filter(u=>d.indexOf(u.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Cn;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Cn||(Cn={}));var Wt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Wt||(Wt={}));var Fe;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Fe||(Fe={}));class Hs{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Wr(this,Te.join,this.params,this.timeout),this.rejoinTimer=new Zi(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Q.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Te.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new zt(this),this.broadcastEndpointURL=ta(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==Q.closed){const{config:{broadcast:i,presence:a,private:o}}=this.params,l=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(h=>h.filter))!==null&&n!==void 0?n:[],c=!!this.bindings[Wt.PRESENCE]&&this.bindings[Wt.PRESENCE].length>0,d={},u={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(h=>e?.(Fe.CHANNEL_ERROR,h)),this._onClose(()=>e?.(Fe.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var m;if(this.socket.setAuth(),h===void 0){e?.(Fe.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,g=(m=p?.length)!==null&&m!==void 0?m:0,w=[];for(let v=0;v<g;v++){const b=p[v],{filter:{event:_,schema:S,table:O,filter:R}}=b,N=h&&h[v];if(N&&N.event===_&&N.schema===S&&N.table===O&&N.filter===R)w.push(Object.assign(Object.assign({},b),{id:N.id}));else{this.unsubscribe(),this.state=Q.errored,e?.(Fe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(Fe.SUBSCRIBED);return}}).receive("error",h=>{this.state=Q.errored,e?.(Fe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e?.(Fe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===Q.joined&&e===Wt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Te.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Wr(this,Te.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Q.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Wr(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>du){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:d}=Te;if(s&&[o,l,c,d].indexOf(a)>=0&&s!==this._joinRef())return;let h=this._onMessage(a,t,s);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var p,g,w;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((w=(g=m.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(m=>m.callback(h,s)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var p,g,w,v,b,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const S=m.id,O=(p=m.filter)===null||p===void 0?void 0:p.event;return S&&((g=t.ids)===null||g===void 0?void 0:g.includes(S))&&(O==="*"||O?.toLocaleLowerCase()===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const S=(b=(v=m?.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return S==="*"||S===((_=t?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:g,table:w,commit_timestamp:v,type:b,errors:_}=p;h=Object.assign(Object.assign({},{schema:g,table:w,commit_timestamp:v,eventType:b,new:{},old:{},errors:_}),this._getPayloadRecords(p))}m.callback(h,s)})}_isClosed(){return this.state===Q.closed}_isJoined(){return this.state===Q.joined}_isJoining(){return this.state===Q.joining}_isLeaving(){return this.state===Q.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Hs.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Te.close,{},e)}_onError(e){this._on(Te.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Tn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Tn(e.columns,e.old_record)),t}}const Rn=()=>{},lr={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},wu=[1e3,2e3,5e3,1e4],bu=1e4,_u=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xu{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=us,this.transport=null,this.heartbeatIntervalMs=lr.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Rn,this.ref=0,this.reconnectTimer=null,this.logger=Rn,this.conn=null,this.sendBuffer=[],this.serializer=new hu,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...a)=>V(async()=>{const{default:o}=await Promise.resolve().then(()=>Nt);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((s=t?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ds.websocket}`,this.httpEndpoint=ta(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=au.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cu}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case qt.connecting:return ot.Connecting;case qt.open:return ot.Open;case qt.closing:return ot.Closing;default:return ot.Closed}}isConnected(){return this.connectionState()===ot.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new Hs(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(uu,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},lr.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:i,ref:a}=t,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${n} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(n,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Te.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([_u],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const n={access_token:t,version:lu};t&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Te.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Zi(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lr.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,i,a,o,l,c;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:us,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:lr.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=e?.reconnectAfterMs)!==null&&o!==void 0?o:d=>wu[d-1]||bu,this.encode=(l=e?.encode)!==null&&l!==void 0?l:(d,u)=>u(JSON.stringify(d)),this.decode=(c=e?.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Gs extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Y(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class ku extends Gs{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class fs extends Gs{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Su=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const ra=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>V(async()=>{const{default:s}=await Promise.resolve().then(()=>Nt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Eu=()=>Su(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield V(()=>Promise.resolve().then(()=>Nt),void 0)).Response:Response}),ms=r=>{if(Array.isArray(r))return r.map(t=>ms(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=ms(s)}),e},Tu=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var dt=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Hr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Pu=(r,e,t)=>dt(void 0,void 0,void 0,function*(){const s=yield Eu();r instanceof s&&!t?.noResolveJson?r.json().then(n=>{const i=r.status||500,a=n?.statusCode||i+"";e(new ku(Hr(n),i,a))}).catch(n=>{e(new fs(Hr(n),n))}):e(new fs(Hr(r),r))}),Cu=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"||!s?n:(Tu(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),t))};function tr(r,e,t,s,n,i){return dt(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,Cu(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Pu(l,o,s))})})}function vr(r,e,t,s){return dt(this,void 0,void 0,function*(){return tr(r,"GET",e,t,s)})}function Ie(r,e,t,s,n){return dt(this,void 0,void 0,function*(){return tr(r,"POST",e,s,n,t)})}function ps(r,e,t,s,n){return dt(this,void 0,void 0,function*(){return tr(r,"PUT",e,s,n,t)})}function Ru(r,e,t,s){return dt(this,void 0,void 0,function*(){return tr(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function sa(r,e,t,s,n){return dt(this,void 0,void 0,function*(){return tr(r,"DELETE",e,s,n,t)})}var re=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Au={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},An={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ou{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=ra(n)}uploadOrUpdate(e,t,s,n){return re(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},An),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),d=this._getFinalPath(c),u=yield(e=="PUT"?ps:Ie)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:o},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:u.Id,fullPath:u.Key},error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}})}upload(e,t,s){return re(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return re(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:An.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const u=yield ps(this.fetch,o.toString(),l,{headers:d});return{data:{path:i,fullPath:u.Key},error:null}}catch(l){if(Y(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return re(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t?.upsert&&(n["x-upsert"]="true");const i=yield Ie(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new Gs("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}update(e,t,s){return re(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return re(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}copy(e,t,s){return re(this,void 0,void 0,function*(){try{return{data:{path:(yield Ie(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return re(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Ie(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return re(this,void 0,void 0,function*(){try{const n=yield Ie(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}download(e,t){return re(this,void 0,void 0,function*(){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield vr(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Y(o))return{data:null,error:o};throw o}})}info(e){return re(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield vr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ms(s),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}exists(e){return re(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ru(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Y(s)&&s instanceof fs){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return re(this,void 0,void 0,function*(){try{return{data:yield sa(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}})}list(e,t,s){return re(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Au),t),{prefix:e||""});return{data:yield Ie(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}listV2(e,t){return re(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Ie(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ju="2.11.0",Iu={"X-Client-Info":`storage-js/${ju}`};var gt=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class $u{constructor(e,t={},s,n){const i=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Iu),t),this.fetch=ra(s)}listBuckets(){return gt(this,void 0,void 0,function*(){try{return{data:yield vr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}})}getBucket(e){return gt(this,void 0,void 0,function*(){try{return{data:yield vr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return gt(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return gt(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}emptyBucket(e){return gt(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}})}deleteBucket(e){return gt(this,void 0,void 0,function*(){try{return{data:yield sa(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}})}}class Nu extends $u{constructor(e,t={},s,n){super(e,t,s,n)}from(e){return new Ou(this.url,this.headers,e,this.fetch)}}const Uu="2.56.0";let Bt="";typeof Deno<"u"?Bt="deno":typeof document<"u"?Bt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bt="react-native":Bt="node";const Lu={"X-Client-Info":`supabase-js-${Bt}/${Uu}`},Du={headers:Lu},Mu={schema:"public"},Fu={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Bu={};var qu=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const zu=r=>{let e;return r?e=r:typeof fetch>"u"?e=qi:e=fetch,(...t)=>e(...t)},Wu=()=>typeof Headers>"u"?zi:Headers,Hu=(r,e,t)=>{const s=zu(t),n=Wu();return(i,a)=>qu(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new n(a?.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:c}))})};var Gu=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};function Vu(r){return r.endsWith("/")?r:r+"/"}function Ku(r,e){var t,s;const{db:n,auth:i,realtime:a,global:o}=r,{db:l,auth:c,realtime:d,global:u}=e,h={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},(t=u?.headers)!==null&&t!==void 0?t:{}),(s=o?.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>Gu(this,void 0,void 0,function*(){return""})};return r.accessToken?h.accessToken=r.accessToken:delete h.accessToken,h}const na="2.71.1",_t=30*1e3,gs=3,Gr=gs*_t,Ju="http://localhost:9999",Qu="supabase.auth.token",Yu={"X-Client-Info":`gotrue-js/${na}`},ys="X-Supabase-Api-Version",ia={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Xu=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Zu=10*60*1e3;class Vs extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function j(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class ed extends Vs{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function td(r){return j(r)&&r.name==="AuthApiError"}class aa extends Vs{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class et extends Vs{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Qe extends et{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rd(r){return j(r)&&r.name==="AuthSessionMissingError"}class cr extends et{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ur extends et{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class dr extends et{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sd(r){return j(r)&&r.name==="AuthImplicitGrantRedirectError"}class On extends et{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vs extends et{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Vr(r){return j(r)&&r.name==="AuthRetryableFetchError"}class jn extends et{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class ws extends et{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const wr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),In=` 	
\r=`.split(""),nd=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<In.length;e+=1)r[In[e].charCodeAt(0)]=-2;for(let e=0;e<wr.length;e+=1)r[wr[e].charCodeAt(0)]=e;return r})();function $n(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(wr[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(wr[s]),e.queuedBits-=6}}function oa(r,e,t){const s=nd[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Nn(r){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=a=>{od(a,s,t)};for(let a=0;a<r.length;a+=1)oa(r.charCodeAt(a),n,i);return e.join("")}function id(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function ad(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}id(s,e)}}function od(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if(!(r>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ld(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)oa(r.charCodeAt(n),t,s);return new Uint8Array(e)}function cd(r){const e=[];return ad(r,t=>e.push(t)),new Uint8Array(e)}function ud(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>$n(n,t,s)),$n(null,t,s),e.join("")}function dd(r){return Math.round(Date.now()/1e3)+r}function hd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Se=()=>typeof window<"u"&&typeof document<"u",st={tested:!1,writable:!1},la=()=>{if(!Se())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(st.tested)return st.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),st.tested=!0,st.writable=!0}catch{st.tested=!0,st.writable=!1}return st.writable};function fd(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const ca=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>V(async()=>{const{default:s}=await Promise.resolve().then(()=>Nt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},md=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",xt=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},nt=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Je=async(r,e)=>{await r.removeItem(e)};class Ar{constructor(){this.promise=new Ar.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ar.promiseConstructor=Promise;function Kr(r){const e=r.split(".");if(e.length!==3)throw new ws("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Xu.test(e[s]))throw new ws("JWT not in base64url format");return{header:JSON.parse(Nn(e[0])),payload:JSON.parse(Nn(e[1])),signature:ld(e[2]),raw:{header:e[0],payload:e[1]}}}async function pd(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function gd(r,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function yd(r){return("0"+r.toString(16)).substr(-2)}function vd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,yd).join("")}async function wd(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function bd(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await wd(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yt(r,e,t=!1){const s=vd();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await xt(r,`${e}-code-verifier`,n);const i=await bd(s);return[i,s===i?"plain":"s256"]}const _d=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xd(r){const e=r.headers.get(ys);if(!e||!e.match(_d))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function kd(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Sd(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ed=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function vt(r){if(!Ed.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Jr(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Un(r){return JSON.parse(JSON.stringify(r))}var Td=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const it=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Pd=[502,503,504];async function Ln(r){var e;if(!md(r))throw new vs(it(r),0);if(Pd.includes(r.status))throw new vs(it(r),r.status);let t;try{t=await r.json()}catch(i){throw new aa(it(i),i)}let s;const n=xd(r);if(n&&n.getTime()>=ia["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new jn(it(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Qe}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new jn(it(t),r.status,t.weak_password.reasons);throw new ed(it(t),r.status||500,s)}const Cd=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function U(r,e,t,s){var n;const i=Object.assign({},s?.headers);i[ys]||(i[ys]=ia["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Rd(r,e,t+o,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function Rd(r,e,t,s,n,i){const a=Cd(e,s,n,i);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new vs(it(l),0)}if(o.ok||await Ln(o),s?.noResolveJson)return o;try{return await o.json()}catch(l){await Ln(l)}}function Me(r){var e;let t=null;Id(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=dd(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Dn(r){const e=Me(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Ye(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Ad(r){return{data:r,error:null}}function Od(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i}=r,a=Td(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function jd(r){return r}function Id(r){return r.access_token&&r.refresh_token&&r.expires_in}const Qr=["global","local","others"];var $d=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Nd{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=ca(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Qr[0]){if(Qr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qr.join(", ")}`);try{return await U(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(j(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await U(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ye})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=$d(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await U(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Od,redirectTo:t?.redirectTo})}catch(t){if(j(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await U(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ye})}catch(t){if(j(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},d=await U(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:jd});if(d.error)throw d.error;const u=await d.json(),h=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(p.split(";")[1].split("=")[1]);c[`${w}Page`]=g}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(j(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){vt(e);try{return await U(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ye})}catch(t){if(j(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){vt(e);try{return await U(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ye})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){vt(e);try{return await U(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ye})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){vt(e.userId);try{const{data:t,error:s}=await U(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(j(t))return{data:null,error:t};throw t}}async _deleteFactor(e){vt(e.userId),vt(e.id);try{return{data:await U(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(j(t))return{data:null,error:t};throw t}}}function Mn(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Ud(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wt={debug:!!(globalThis&&la()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ua extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ld extends ua{}async function Dd(r,e,t){wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),wt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Ld(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(wt.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Ud();const Md={url:Ju,storageKey:Qu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Yu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Fn(r,e,t){return await t()}const bt={};class Vt{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Vt.nextInstanceID,Vt.nextInstanceID+=1,this.instanceID>0&&Se()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Md),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Nd({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=ca(n.fetch),this.lock=n.lock||Fn,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Se()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Dd:this.lock=Fn,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:la()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Mn(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Mn(this.memoryStorage)),Se()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=bt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){bt[this.storageKey]=Object.assign(Object.assign({},bt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=bt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){bt[this.storageKey]=Object.assign(Object.assign({},bt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${na}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=fd(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Se()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),sd(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return j(t)?{error:t}:{error:new aa("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Me}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(j(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:d,password:u,options:h}=e;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await yt(this.storage,this.storageKey)),i=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:d,password:u,data:(t=h?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:m,code_challenge_method:p},xform:Me})}else if("phone"in e){const{phone:d,password:u,options:h}=e;i=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:u,data:(s=h?.data)!==null&&s!==void 0?s:{},channel:(n=h?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Me})}else throw new ur("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(j(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Dn})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Dn})}else throw new ur("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new cr}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,i,a,o,l,c,d,u,h,m;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:w,wallet:v,statement:b,options:_}=e;let S;if(Se())if(typeof v=="object")S=v;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))S=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=v}const O=new URL((t=_?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in S&&S.signIn){const R=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),b?{statement:b}:null));let N;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")N=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)N=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)p=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),g=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${O.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(n=(s=_?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=_?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((u=(d=_?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||u===void 0)&&u.length?["Resources",..._.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const R=await S.signMessage(new TextEncoder().encode(p),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=R}}try{const{data:w,error:v}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ud(g)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Me});if(v)throw v;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new cr}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:v})}catch(w){if(j(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const t=await nt(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:i,error:a}=await U(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Me});if(await Je(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new cr}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(j(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,o=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Me}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new cr}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await yt(this.storage,this.storageKey));const{error:u}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:d}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:d}}throw new ur("You must provide either an email or phone number.")}catch(o){if(j(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await U(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Me});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(j(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await yt(this.storage,this.storageKey)),await U(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Ad})}catch(i){if(j(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Qe;const{error:n}=await U(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await U(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:o}=await U(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:o}}throw new ur("You must provide either an email or phone number and a type")}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await nt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Gr:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await nt(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=Jr()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,d)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,d))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ye}):await this._useSession(async t=>{var s,n,i;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qe}:await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ye})})}catch(t){if(j(t))return rd(t)&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Qe;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await yt(this.storage,this.storageKey));const{data:c,error:d}=await U(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Ye});if(d)throw d;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Qe;const t=Date.now()/1e3;let s=t,n=!0,i=null;const{payload:a}=Kr(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(j(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Qe;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Se())throw new dr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new dr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new On("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new dr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new On("No code detected.");const{data:b,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new dr("No session defined in URL");const d=Math.round(Date.now()/1e3),u=parseInt(o);let h=d+u;l&&(h=parseInt(l));const m=h-d;m*1e3<=_t&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${u}s`);const p=h-u;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:g,error:w}=await this._getUser(i);if(w)throw w;const v={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:h,refresh_token:a,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(s){if(j(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await nt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{error:i};const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(td(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=hd(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await yt(this.storage,this.storageKey,!0));try{return await U(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(j(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(j(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async i=>{var a,o,l,c,d;const{data:u,error:h}=i;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await U(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(c=u.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return Se()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(j(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await U(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(j(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await gd(async n=>(n>0&&await pd(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await U(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Me})),(n,i)=>{const a=200*Math.pow(2,n);return i&&Vr(i)&&Date.now()+a-s<_t})}catch(s){if(this._debug(t,"error",s),j(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Se()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await nt(this.storage,this.storageKey);if(n&&this.userStorage){let a=await nt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await xt(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a?.user)!==null&&e!==void 0?e:Jr()}else if(n&&!n.user&&!n.user){const a=await nt(this.storage,this.storageKey+"-user");a&&a?.user?(n.user=a.user,await Je(this.storage,this.storageKey+"-user"),await xt(this.storage,this.storageKey,n)):n.user=Jr()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Gr;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Gr}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Vr(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(n.access_token);!o&&a?.user?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Qe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Ar;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Qe;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),j(i)){const a={session:null,error:i};return Vr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await xt(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const i=Un(n);await xt(this.storage,this.storageKey,i)}else{const n=Un(t);await xt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Je(this.storage,this.storageKey),await Je(this.storage,this.storageKey+"-code-verifier"),await Je(this.storage,this.storageKey+"-user"),this.userStorage&&await Je(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Se()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),_t);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/_t);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${_t}ms, refresh threshold is ${gs} ticks`),n<=gs&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ua)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Se()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await yt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await U(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(j(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await U(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(j(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(j(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(j(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=e?.factors||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Kr(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(o=>o.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+Zu>n)return s;const{data:i,error:a}=await U(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:m,error:p}=await this.getSession();if(p||!m.session)return{data:null,error:p};s=m.session.access_token}const{header:n,payload:i,signature:a,raw:{header:o,payload:l}}=Kr(s);t?.allowExpired||kd(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!c){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:i,header:n,signature:a},error:null}}const d=Sd(n.alg),u=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,u,a,cd(`${o}.${l}`)))throw new ws("Invalid JWT signature");return{data:{claims:i,header:n,signature:a},error:null}}catch(s){if(j(s))return{data:null,error:s};throw s}}}Vt.nextInstanceID=0;const Fd=Vt;class Bd extends Fd{constructor(e){super(e)}}var qd=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?i(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class zd{constructor(e,t,s){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Vu(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Mu,realtime:Bu,auth:Object.assign(Object.assign({},Fu),{storageKey:c}),global:Du},u=Ku(s??{},d);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=Hu(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new iu(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Nu(this.storageUrl.href,this.headers,this.fetch,s?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Lc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return qd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:i,flowType:a,lock:o,debug:l},c,d){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bd({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:o,debug:l,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new xu(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s?.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Wd=(r,e,t)=>new zd(r,e,t);function Hd(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Hd()&&console.warn("âš ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Gd="https://alegufnopsminqcokelr.supabase.co",Vd="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFsZWd1Zm5vcHNtaW5xY29rZWxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyMzUwMjIsImV4cCI6MjA3MTgxMTAyMn0.YgwFtX87MiSXA83DN2um0WP-1uYU6qsPXhwGmIWjadQ";console.log("ðŸš€ App starting with environment variables:",{supabaseUrl:"SET",supabaseKey:"SET"});console.log("ðŸ”§ All fixes deployed: table name, CreateGame step 3, location search, environment variables, JOIN/LEAVE FIXED, FIRST-CLASS ARCHITECTURE DEPLOYED");const Kd=()=>Wd(Gd,Vd,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"tribeup-auth",flowType:"pkce"},db:{schema:"public"},global:{headers:{"x-client-info":"tribeup-web@1.0.0"}},realtime:{params:{eventsPerSecond:2}}}),x=globalThis.__supabase__||Kd();typeof globalThis<"u"&&(globalThis.__supabase__=x);const se=(r,e=!1)=>({id:r.id,title:r.title,sport:r.sport,date:r.date,time:r.time,duration:r.duration||60,location:r.location,latitude:r.latitude,longitude:r.longitude,cost:r.cost,maxPlayers:r.max_players,currentPlayers:r.current_players,description:r.description,imageUrl:r.image_url||"",sportColor:Jd(r.sport),isJoined:e,createdBy:r.creator?.full_name||r.creator?.username||`User ${r.creator_id?.slice(0,8)||"Unknown"}`,creatorId:r.creator_id,creatorData:r.creator?{id:r.creator.id,name:r.creator.full_name||r.creator.username||r.creator.email?.split("@")[0]||`User ${r.creator.id.slice(0,8)}`,avatar:r.creator.avatar_url||""}:{id:r.creator_id,name:`User ${r.creator_id?.slice(0,8)||"Unknown"}`,avatar:""},createdAt:r.created_at}),Yr=r=>({id:r.id,name:r.full_name||r.username||r.email?.split("@")[0]||`User ${r.id.slice(0,8)}`,username:r.username||r.email?.split("@")[0]||`user_${r.id.slice(0,8)}`,email:r.email,avatar:r.avatar_url||"",bio:r.bio||"",location:r.location||"",role:r.role||"user",preferences:{theme:"auto",highContrast:!1,largeText:!1,reducedMotion:!1,colorBlindFriendly:!1,notifications:{push:!0,email:!1,gameReminders:!0},privacy:{locationSharing:!0,profileVisibility:"public"},sports:r.preferred_sports||[]}}),Jd=r=>({basketball:"#FA4616",soccer:"#22C55E",tennis:"#3B82F6",pickleball:"#65A30D",volleyball:"#8B5CF6",football:"#F59E0B",baseball:"#EF4444",swimming:"#06B6D4",running:"#10B981",cycling:"#6366F1",yoga:"#EC4899"})[r.toLowerCase()]||"#6B7280",Qd={VITE_ENABLE_MOCK_DATA:"false",VITE_OPENWEATHER_API_KEY:"***REMOVED***",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFsZWd1Zm5vcHNtaW5xY29rZWxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyMzUwMjIsImV4cCI6MjA3MTgxMTAyMn0.YgwFtX87MiSXA83DN2um0WP-1uYU6qsPXhwGmIWjadQ",VITE_SUPABASE_URL:"https://alegufnopsminqcokelr.supabase.co"};class kt{static instance;config;constructor(){this.config=this.loadConfig(),this.validateConfig()}static getInstance(){return kt.instance||(kt.instance=new kt),kt.instance}loadConfig(){const e=Qd;return{supabaseUrl:e.VITE_SUPABASE_URL,supabaseAnonKey:e.VITE_SUPABASE_ANON_KEY,openWeatherApiKey:e.VITE_OPENWEATHER_API_KEY,weatherTempUnit:e.VITE_WEATHER_TEMP_UNIT||"fahrenheit",weatherUpdateInterval:parseInt(e.VITE_WEATHER_UPDATE_INTERVAL||"3600"),weatherIncludeHourly:e.VITE_WEATHER_INCLUDE_HOURLY!=="false",weatherRainThreshold:parseFloat(e.VITE_WEATHER_RAIN_THRESHOLD||"0.1"),weatherWindThreshold:parseInt(e.VITE_WEATHER_WIND_THRESHOLD||"15"),vapidPublicKey:e.VITE_VAPID_PUBLIC_KEY,profileCheckTimeout:parseInt(e.VITE_PROFILE_CHECK_TIMEOUT||"5000"),profileForceTimeout:parseInt(e.VITE_PROFILE_FORCE_TIMEOUT||"15000"),presenceHeartbeatInterval:parseInt(e.VITE_PRESENCE_HEARTBEAT_INTERVAL||"30000"),locationMonitoringInterval:parseInt(e.VITE_LOCATION_MONITORING_INTERVAL||"1800000"),gameEditRestrictionHours:parseInt(e.VITE_GAME_EDIT_RESTRICTION_HOURS||"2"),gameDeletionRestrictionHours:parseInt(e.VITE_GAME_DELETION_RESTRICTION_HOURS||"4"),enableMockData:e.VITE_ENABLE_MOCK_DATA==="true",logLevel:e.VITE_LOG_LEVEL||"info"}}validateConfig(){const e=[];if(this.config.supabaseUrl||e.push("VITE_SUPABASE_URL is required"),this.config.supabaseAnonKey||e.push("VITE_SUPABASE_ANON_KEY is required"),(isNaN(this.config.weatherUpdateInterval)||this.config.weatherUpdateInterval<60)&&e.push("VITE_WEATHER_UPDATE_INTERVAL must be a number >= 60"),(isNaN(this.config.weatherRainThreshold)||this.config.weatherRainThreshold<0)&&e.push("VITE_WEATHER_RAIN_THRESHOLD must be a number >= 0"),(isNaN(this.config.weatherWindThreshold)||this.config.weatherWindThreshold<0)&&e.push("VITE_WEATHER_WIND_THRESHOLD must be a number >= 0"),(isNaN(this.config.profileCheckTimeout)||this.config.profileCheckTimeout<1e3)&&e.push("VITE_PROFILE_CHECK_TIMEOUT must be a number >= 1000"),(isNaN(this.config.profileForceTimeout)||this.config.profileForceTimeout<5e3)&&e.push("VITE_PROFILE_FORCE_TIMEOUT must be a number >= 5000"),(isNaN(this.config.presenceHeartbeatInterval)||this.config.presenceHeartbeatInterval<1e4)&&e.push("VITE_PRESENCE_HEARTBEAT_INTERVAL must be a number >= 10000"),(isNaN(this.config.gameEditRestrictionHours)||this.config.gameEditRestrictionHours<0)&&e.push("VITE_GAME_EDIT_RESTRICTION_HOURS must be a number >= 0"),(isNaN(this.config.gameDeletionRestrictionHours)||this.config.gameDeletionRestrictionHours<0)&&e.push("VITE_GAME_DELETION_RESTRICTION_HOURS must be a number >= 0"),["fahrenheit","celsius"].includes(this.config.weatherTempUnit)||e.push('VITE_WEATHER_TEMP_UNIT must be "fahrenheit" or "celsius"'),["debug","info","warn","error"].includes(this.config.logLevel)||e.push("VITE_LOG_LEVEL must be one of: debug, info, warn, error"),e.length>0)throw console.error("Environment configuration errors:",e),new Error(`Environment configuration errors:
${e.join(`
`)}`);const t=[];this.config.openWeatherApiKey||t.push("VITE_OPENWEATHER_API_KEY not set - weather features will use mock data"),this.config.vapidPublicKey||t.push("VITE_VAPID_PUBLIC_KEY not set - push notifications will be disabled"),t.length>0&&console.warn("Environment configuration warnings:",t)}getConfig(){return{...this.config}}get(e){return this.config[e]}isFeatureEnabled(e){switch(e){case"weather":return!!this.config.openWeatherApiKey;case"pushNotifications":return!!this.config.vapidPublicKey;case"mockData":return this.config.enableMockData;default:return!1}}}const Ht=kt.getInstance(),Yd={maxRetries:3,baseDelay:1e3,maxDelay:1e4,timeout:15e3};class St{static instance;connectionAttempts=new Map;lastConnectionTime=new Map;config;constructor(e=Yd){this.config=e}static getInstance(e){return St.instance||(St.instance=new St(e)),St.instance}calculateDelay(e){const t=Math.min(this.config.baseDelay*Math.pow(2,e),this.config.maxDelay),s=Math.random()*.1*t;return t+s}shouldThrottle(e){const t=this.connectionAttempts.get(e)||0,s=this.lastConnectionTime.get(e)||0,n=Date.now();if(t>=this.config.maxRetries){const i=n-s,a=this.calculateDelay(t);if(i<a)return console.log(`ðŸš¦ Throttling connection attempt for ${e}. Wait ${Math.ceil((a-i)/1e3)}s`),!0;this.connectionAttempts.set(e,0)}return!1}recordAttempt(e){const t=this.connectionAttempts.get(e)||0;this.connectionAttempts.set(e,t+1),this.lastConnectionTime.set(e,Date.now())}resetAttempts(e){this.connectionAttempts.delete(e),this.lastConnectionTime.delete(e)}async executeWithRetry(e,t,s){const n={...this.config,...s};if(this.shouldThrottle(t))throw new Error(`Operation ${t} is being throttled due to repeated failures`);let i=null;for(let a=0;a<=n.maxRetries;a++)try{this.recordAttempt(t);const o=new Promise((c,d)=>{setTimeout(()=>d(new Error("Operation timeout")),n.timeout)}),l=await Promise.race([e(),o]);return this.resetAttempts(t),l}catch(o){if(i=o,console.error(`âŒ Attempt ${a+1} failed for ${t}:`,o.message),this.isNonRetryableError(o))throw o;if(a<n.maxRetries){const l=this.calculateDelay(a);console.log(`â³ Retrying ${t} in ${Math.ceil(l/1e3)}s...`),await new Promise(c=>setTimeout(c,l))}}throw i||new Error(`Operation ${t} failed after ${n.maxRetries} attempts`)}isNonRetryableError(e){const t=["Invalid API key","Unauthorized","Forbidden","Not found","Bad request","Invalid JWT","JWT expired"],s=e.message?.toLowerCase()||"";return t.some(n=>s.includes(n.toLowerCase()))}async checkConnectivity(){try{const{error:e}=await x.from("users").select("id").limit(1);return!e}catch{return!1}}getConnectionStats(){const e={};for(const[t,s]of this.connectionAttempts.entries())e[t]={attempts:s,lastAttempt:this.lastConnectionTime.get(t)||0};return e}clearConnectionTracking(){this.connectionAttempts.clear(),this.lastConnectionTime.clear(),console.log("ðŸ§¹ Cleared all connection tracking")}}const Xd=St.getInstance();class G{static async signUp(e,t,s){const{data:n,error:i}=await x.auth.signUp({email:e,password:t,options:{data:{full_name:s.name,username:s.name?.toLowerCase().replace(/\s+/g,"_")}}});if(i)throw i;return n.user&&await this.createUserProfile(n.user.id,s),n}static async signIn(e,t){const{data:s,error:n}=await x.auth.signInWithPassword({email:e,password:t});if(n)throw n;return s}static async signOut(){const{error:e}=await x.auth.signOut();if(e)throw e}static async getCurrentUser(){const{data:{user:e},error:t}=await x.auth.getUser();if(t)throw t;return e}static async createUserProfile(e,t){console.log("Creating/updating user profile with data:",{userId:e,userData:t});try{const{data:s,error:n}=await x.from("users").select("id").eq("id",e).maybeSingle();if(n&&n.code!=="PGRST116")throw n;let i=t.email||null;if(!i){const{data:c}=await x.auth.getUser();i=c.user?.email??null}if(!i)throw new Error("Unable to determine user email for profile creation");const a={id:e,email:i,full_name:`${t.firstName||""} ${t.lastName||""}`.trim()||t.name||"New User",username:t.username||`user_${Math.random().toString(36).substring(2,10)}`,bio:t.bio||"",location:t.location||"",role:t.role||"user",preferred_sports:Array.isArray(t.selectedSports)?t.selectedSports.filter(c=>typeof c=="string"&&c.trim().length>0):[]};console.log("Profile data to save:",a);const{data:o,error:l}=await x.from("users").upsert(a,{onConflict:"id"}).select().single();if(l)throw console.error("Error saving profile:",l),l;return console.log("Profile saved successfully:",o),o}catch(s){throw console.error("Error in createUserProfile:",s),s}}static async getUserProfile(e){try{if(console.log("ðŸ” Getting user profile for:",e),!e||e.trim()==="")return console.log("âŒ Invalid user ID provided:",e),null;const{data:{user:t}}=await x.auth.getUser();if(!t)return console.log("â„¹ï¸ Anonymous user cannot access user profiles due to RLS - returning null"),null;console.log("ðŸ” Executing query for user ID:",e.trim());const s=await Xd.executeWithRetry(async()=>{const{data:i,error:a}=await x.from("users").select(`
              id,
              email,
              username,
              full_name,
              avatar_url,
              bio,
              location,
              preferred_sports,
              role,
              stats,
              created_at
            `).eq("id",e.trim()).maybeSingle();if(a){if(a.code==="PGRST116"){console.error("âŒ PGRST116 Error: Cannot coerce result to single JSON object"),console.error("âŒ This usually means multiple rows returned or data type mismatch");const{data:o,error:l}=await x.from("users").select("id, email, username, full_name, avatar_url, bio, location, role").eq("id",e.trim()).limit(1).single();if(l)throw l;return console.log("âœ… Fallback query succeeded, using basic user data"),{...o,preferred_sports:[],stats:{},created_at:new Date().toISOString()}}throw a}return i},`getUserProfile-${e}`,{maxRetries:1,timeout:3e3});if(!s){console.log("âŒ No user found for ID:",e);const{data:i,error:a}=await x.from("users").select("id, full_name").limit(5);return console.log("ðŸ” Sample users in database:",i?.map(o=>({id:o.id,name:o.full_name}))),null}console.log("âœ… User profile loaded:",s?.id,s?.full_name),console.log("ðŸ” Raw user data from DB:",{id:s?.id,full_name:s?.full_name,username:s?.username,email:s?.email,avatar_url:s?.avatar_url,bio:s?.bio,location:s?.location,preferred_sports:s?.preferred_sports,role:s?.role});const n=Yr(s);return console.log("ðŸ” Transformed user (complete):",n),n}catch(t){return console.error("âŒ getUserProfile failed:",t),t instanceof Error&&t.message==="getUserProfile timeout",null}}static async isUsernameAvailable(e,t){const s=x.from("users").select("id",{count:"exact",head:!0}).ilike("username",e),{count:n,error:i}=t?await s.neq("id",t):await s;if(i)throw i;return(n??0)===0}static async uploadAvatar(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");const s=`${Date.now()}_${e.name}`.replace(/\s+/g,"_"),n=`${t.id}/${s}`,{error:i}=await x.storage.from("avatars").upload(n,e,{upsert:!0,cacheControl:"3600"});if(i)throw i;const{data:a}=x.storage.from("avatars").getPublicUrl(n);return a.publicUrl}static async updateUserProfile(e,t){console.log("ðŸ”§ updateUserProfile called with:",{userId:e,updates:t});const s={full_name:t.full_name,username:t.username,avatar_url:t.avatar_url,bio:t.bio,location:t.location,preferred_sports:t.preferred_sports||t.sports_preferences};t.role&&(s.role=t.role);const{data:n,error:i}=await x.from("users").update(s).eq("id",e).select().single();if(i)throw console.error("âŒ Profile update error:",i),i;return console.log("âœ… Profile updated successfully:",n),Yr(n)}static async isProfileComplete(e){try{const t=await this.getUserProfile(e);return!!(t&&t.name&&t.username)}catch{return!1}}static async hasAdminRole(e){try{const{data:t,error:s}=await x.from("users").select("role").eq("id",e).single();return s?!1:t.role==="admin"}catch{return!1}}static async hasModeratorRole(e){try{const{data:t,error:s}=await x.from("users").select("role").eq("id",e).single();return s?!1:t.role==="moderator"||t.role==="admin"}catch{return!1}}static async updateUserRole(e,t){const s=await this.getCurrentUser();if(!s)throw new Error("Not authenticated");if(!await this.hasAdminRole(s.id))throw new Error("Only admins can update user roles");const{error:i}=await x.from("users").update({role:t}).eq("id",e);if(i)throw i;await this.logAdminAction("update_user_role","user",e,{role:t})}static async deleteGame(e,t){const s=await this.getCurrentUser();if(!s)throw new Error("Not authenticated");const{data:n,error:i}=await x.from("games").select("creator_id, date, time, title").eq("id",e).single();if(i)throw i;const a=n.creator_id===s.id,o=await this.hasModeratorRole(s.id);if(!a&&!o)throw new Error("Only game creators, moderators, or admins can delete games");if(a&&!o){const c=new Date(`${n.date}T${n.time}`),d=new Date,u=(c.getTime()-d.getTime())/(1e3*60*60),h=Ht.get("gameDeletionRestrictionHours");if(u<h)throw new Error(`Cannot delete game within ${h} hours of start time`)}await this.notifyGameParticipants(e,"game_cancelled",{title:"Game Cancelled",message:`The game "${n.title}" has been cancelled${t?`: ${t}`:"."}`}),await x.from("game_participants").delete().eq("game_id",e),await x.from("chat_messages").delete().eq("game_id",e);const{error:l}=await x.from("games").delete().eq("id",e);if(l)throw l;o&&!a&&await this.logAdminAction("delete_game","game",e,{reason:t||"admin_deletion",game_title:n.title})}static async getAllUsers(){const e=await this.getCurrentUser();if(!e)throw new Error("Not authenticated");if(!await this.hasAdminRole(e.id))throw new Error("Only admins can view all users");const{data:s,error:n}=await x.from("users").select("*").order("created_at",{ascending:!1});if(n)throw n;return s.map(Yr)}static async logAdminAction(e,t,s,n){if(!await this.getCurrentUser())return;const{error:a}=await x.rpc("log_admin_action",{p_action:e,p_target_type:t,p_target_id:s,p_details:n});a&&console.error("Failed to log admin action:",a)}static async getAdminAuditLog(e=50){const t=await this.getCurrentUser();if(!t)throw new Error("Not authenticated");if(!await this.hasAdminRole(t.id))throw new Error("Only admins can view audit logs");const{data:n,error:i}=await x.from("admin_audit_log").select(`
        *,
        admin:admin_id(full_name, username, email)
      `).order("created_at",{ascending:!1}).limit(e);if(i)throw i;return n}static getMockGames(){const e=new Date,t=new Date(e);return t.setDate(t.getDate()+1),[{id:"mock-1",title:"Basketball Pickup Game",sport:"basketball",date:e.toISOString().split("T")[0],time:"18:00",duration:90,location:"Local Community Center",cost:"Free",maxPlayers:10,currentPlayers:6,description:"Casual pickup basketball game. All skill levels welcome!",imageUrl:"",sportColor:"#FA4616",isJoined:!1,createdBy:"mock-user",createdAt:e.toISOString()},{id:"mock-2",title:"Soccer Match",sport:"soccer",date:t.toISOString().split("T")[0],time:"19:30",duration:120,location:"City Park Field",cost:"$5",maxPlayers:22,currentPlayers:18,description:"Friendly soccer match. Bring your own water!",imageUrl:"",sportColor:"#22C55E",isJoined:!1,createdBy:"mock-user",createdAt:e.toISOString()}]}static async getGames(){const e=performance.now();console.log("ðŸš€ Starting getGames...");try{const{data:{user:t}}=await x.auth.getUser(),s=t?.id,n=performance.now();if(console.log(`ðŸ” Getting games for user: ${s}`),s){const{data:i,error:a}=await x.from("games").select(`
            *,
            game_participants(user_id),
            creator:users!games_creator_id_fkey(id, full_name, username, avatar_url)
          `).gte("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!0}).limit(50),o=performance.now()-n;if(console.log(`ðŸ“Š Supabase query with participants took: ${o.toFixed(2)}ms`),a)throw a;const l=performance.now(),c=(i||[]).map(h=>{try{const m=h.game_participants?.some(p=>p.user_id===s)||!1;return console.log(`ðŸ” Game ${h.id} (${h.title}): isJoined=${m}, participants=`,h.game_participants),se(h,m)}catch(m){return console.error("âŒ Transform error for game:",h.id,m),{id:h.id,title:h.title,sport:h.sport,date:h.date,time:h.time,location:h.location,latitude:h.latitude,longitude:h.longitude,cost:h.cost,maxPlayers:h.max_players,currentPlayers:h.current_players,description:h.description,imageUrl:h.image_url||"",sportColor:"#6B7280",isJoined:!1,createdBy:h.creator_id,createdAt:h.created_at}}}),d=performance.now()-l,u=performance.now()-e;return console.log(`âš¡ Transform took: ${d.toFixed(2)}ms`),console.log(`âœ… Total getGames took: ${u.toFixed(2)}ms`),console.log(`ðŸ“¦ Returned ${c.length} games`),c}else{const{data:i,error:a}=await x.from("games").select(`
            *,
            creator:users!games_creator_id_fkey(id, full_name, username, avatar_url)
          `).gte("date",new Date().toISOString().split("T")[0]).order("created_at",{ascending:!1}).limit(50),o=performance.now()-n;if(console.log(`ðŸ“Š Supabase query took: ${o.toFixed(2)}ms`),a)throw a;const l=performance.now(),c=(i||[]).map(h=>{try{return se(h,!1)}catch(m){return console.error("âŒ Transform error for game:",h.id,m),{id:h.id,title:h.title,sport:h.sport,date:h.date,time:h.time,location:h.location,latitude:h.latitude,longitude:h.longitude,cost:h.cost,maxPlayers:h.max_players,currentPlayers:h.current_players,description:h.description,imageUrl:h.image_url||"",sportColor:"#6B7280",isJoined:!1,createdBy:h.creator_id,createdAt:h.created_at}}}),d=performance.now()-l,u=performance.now()-e;return console.log(`âš¡ Transform took: ${d.toFixed(2)}ms`),console.log(`âœ… Total getGames took: ${u.toFixed(2)}ms`),console.log(`ðŸ“¦ Returned ${c.length} games`),c}}catch(t){return console.error("âŒ getGames error:",t),this.getMockGames()}}static async getMyGames(e){const{data:t,error:s}=await x.from("games").select(`
        *,
        creator:users!games_creator_id_fkey(full_name, username)
      `).eq("creator_id",e).gte("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!0});if(s)throw s;return t.map(n=>se(n,!0))}static async getNearbyGames(e,t,s=25){try{const{data:{user:n}}=await x.auth.getUser(),i=n?.id;let a=x.from("games").select("id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id");if(!e&&!t&&(a=a.gte("date",new Date().toISOString().split("T")[0])),e&&t&&(a=a.filter("latitude","gte",e-.1).filter("latitude","lte",e+.1).filter("longitude","gte",t-.1).filter("longitude","lte",t+.1)),!i){const{data:c,error:d}=await a.order("date",{ascending:!0}).limit(50);if(d)throw d;return(c||[]).map(u=>se(u,!1))}const{data:o,error:l}=await a.select(`
          *,
          game_participants(user_id)
        `).order("date",{ascending:!0}).limit(50);if(l)throw l;return(o||[]).map(c=>{const d=c.game_participants?.some(u=>u.user_id===i)||!1;return se(c,d)})}catch(n){return console.error("[SupabaseService.getNearbyGames] Error:",n),this.getGames()}}static async createGame(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");try{const{data:i,error:a}=await x.from("users").select("id").eq("id",t.id).maybeSingle();if(i){if(a&&a.code!=="PGRST116")throw a}else{const{data:o}=await x.auth.getUser(),l=o.user?.email||"";if(!l)throw new Error("Cannot create user profile: missing email from auth");const c={id:t.id,email:l,full_name:o.user?.user_metadata?.full_name||o.user?.user_metadata?.name||"New User",username:o.user?.user_metadata?.username||`user_${Math.random().toString(36).slice(2,10)}`,bio:"",location:"",preferred_sports:[]},{error:d}=await x.from("users").upsert(c,{onConflict:"id"});if(d)throw d}}catch(i){console.warn("Failed to ensure user profile exists (continuing):",i)}const{data:s,error:n}=await x.from("games").insert([{title:e.title,sport:e.sport,date:e.date,time:e.time,duration:e.duration,location:e.location,latitude:e.latitude,longitude:e.longitude,cost:e.cost,max_players:e.maxPlayers,current_players:1,description:e.description,creator_id:t.id}]).select().single();if(n)throw n;try{await x.from("game_participants").insert({game_id:s.id,user_id:t.id})}catch(i){console.warn("Failed to add creator as participant (continuing):",i)}return s.id}static async updateGame(e,t){const s=await this.getCurrentUser();if(!s)throw new Error("User not authenticated");const{data:n,error:i}=await x.from("games").select("creator_id, date, time").eq("id",e).single();if(i)throw i;if(n.creator_id!==s.id)throw new Error("Only the game creator can edit this game");const a=new Date(`${n.date}T${n.time}`),o=new Date,l=(a.getTime()-o.getTime())/(1e3*60*60),c=Ht.get("gameEditRestrictionHours");if(l<c)throw new Error(`Cannot edit game within ${c} hours of start time`);let d;if(t.cost!==void 0)if(t.cost==="FREE")d=0;else{const p=t.cost.match(/\$(\d+)/);d=p?parseInt(p[1]):0}const u={};t.title!==void 0&&(u.title=t.title),t.sport!==void 0&&(u.sport=t.sport),t.description!==void 0&&(u.description=t.description),t.date!==void 0&&(u.date=t.date),t.time!==void 0&&(u.time=t.time),t.duration!==void 0&&(u.duration=t.duration),t.location!==void 0&&(u.location=t.location),t.latitude!==void 0&&(u.latitude=t.latitude),t.longitude!==void 0&&(u.longitude=t.longitude),t.maxPlayers!==void 0&&(u.max_players=t.maxPlayers),d!==void 0&&(u.cost=d),t.imageUrl!==void 0&&(u.image_url=t.imageUrl);const{data:h,error:m}=await x.from("games").update(u).eq("id",e).select().single();if(m)throw m;return await this.notifyGameParticipants(e,"game_updated",{title:"Game Updated",message:`The game "${h.title}" has been updated by the organizer.`}),se(h,!1)}static async notifyGameParticipants(e,t,s){try{const{data:n,error:i}=await x.from("game_participants").select("user_id").eq("game_id",e);if(i||!n)return;const a=n.map(o=>({user_id:o.user_id,type:t,title:s.title,message:s.message,data:{gameId:e},read:!1}));a.length>0&&await x.from("notifications").insert(a)}catch(n){console.error("Error notifying participants:",n)}}static async joinGame(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");console.log(`ðŸ”§ User ${t.id} joining game ${e}`);const{error:s}=await x.rpc("join_game",{game_uuid:e});if(s)throw console.error("âŒ Join game RPC error:",s),s;console.log("âœ… Successfully joined game via RPC");try{await G.recordGameParticipation(t.id,e,"joined"),console.log("âœ… Game participation recorded")}catch(n){!n?.message?.includes("Could not find the 'status' column")&&!n?.message?.includes('column "status" of relation "game_participants" does not exist')&&console.warn("âš ï¸ Failed to record game participation:",n)}}static async leaveGame(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");console.log(`ðŸ”§ User ${t.id} leaving game ${e}`);const{error:s}=await x.rpc("leave_game",{game_uuid:e});if(s)throw console.error("âŒ Leave game RPC error:",s),s;console.log("âœ… Successfully left game via RPC");try{await G.recordGameParticipation(t.id,e,"left"),console.log("âœ… Game participation recorded")}catch(n){!n?.message?.includes("Could not find the 'status' column")&&!n?.message?.includes('column "status" of relation "game_participants" does not exist')&&console.warn("âš ï¸ Failed to record game participation:",n)}}static async getPublicRSVPs(e){const{data:t,error:s}=await x.from("public_rsvps").select("*").eq("game_id",e).order("created_at",{ascending:!1});if(s)throw s;return t||[]}static async createPublicRSVP(e,t){const{data:s}=await x.from("public_rsvps").select("id").eq("game_id",e).eq("email",t.email).single();if(s)throw new Error("This email has already RSVPed for this game");const{error:n}=await x.from("public_rsvps").insert({game_id:e,name:t.name,email:t.email,phone:t.phone});if(n)throw n}static async getGameById(e){const{data:{user:t}}=await x.auth.getUser(),s=t?.id;if(s){const{data:n,error:i}=await x.from("games").select(`
          *,
          game_participants(user_id),
          creator:users!creator_id(id, full_name, username, avatar_url)
        `).eq("id",e).single();if(i)throw i;const a=n.game_participants?.some(o=>o.user_id===s)||!1;return se(n,a)}else{const{data:n,error:i}=await x.from("games").select(`
          *,
          creator:users!creator_id(id, full_name, username, avatar_url)
        `).eq("id",e).single();if(i)throw i;return se(n,!1)}}static async getNotifications(){const e=await this.getCurrentUser();if(!e)throw new Error("User not authenticated");const{data:t,error:s}=await x.from("notifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;return t.map(n=>({id:n.id,type:n.type,title:n.title,message:n.message,timestamp:new Date(n.created_at),read:n.read,actionUrl:n.data?.actionUrl,gameId:n.data?.gameId,userId:n.data?.userId,data:n.data}))}static async markNotificationAsRead(e){const{error:t}=await x.from("notifications").update({read:!0}).eq("id",e);if(t)throw t}static async deleteNotification(e){const{error:t}=await x.from("notifications").delete().eq("id",e);if(t)throw t}static async clearAllNotifications(){const e=await this.getCurrentUser();if(!e)throw new Error("User not authenticated");const{error:t}=await x.from("notifications").delete().eq("user_id",e.id);if(t)throw t}static async getGameParticipants(e){try{const{data:t,error:s}=await x.from("game_participants").select("user_id, joined_at").eq("game_id",e);if(s)throw s;if(console.log("ðŸ” Raw participants data:",t),!t||t.length===0)return[];const n=t.map(o=>o.user_id),{data:i,error:a}=await x.from("users").select("id, full_name, username, avatar_url, email").in("id",n);return a?(console.error("âŒ Error fetching user details:",a),t.map(o=>({id:o.user_id,name:`User ${o.user_id.slice(0,8)}`,avatar:null,isHost:!1,rating:4.5}))):(console.log("ðŸ” Fetched user details:",i),t.map(o=>{const l=i?.find(c=>c.id===o.user_id);return console.log("ðŸ” Processing participant:",o.user_id,"user:",l),{id:o.user_id,name:l?.full_name||l?.username||l?.email?.split("@")[0]||`User ${o.user_id.slice(0,8)}`,avatar:l?.avatar_url||null,isHost:!1,rating:4.5}}))}catch(t){return console.error("âŒ getGameParticipants failed:",t),[]}}static async createTestUser(e){try{const{data:t,error:s}=await x.from("users").insert([{id:e.id||crypto.randomUUID(),full_name:e.full_name,username:e.username,email:e.email,bio:e.bio||"",location:e.location||"",role:"user",created_at:new Date().toISOString()}]).select().single();if(s)throw s;return console.log("âœ… Test user created:",t),t}catch(t){throw console.error("âŒ Failed to create test user:",t),t}}static subscribeToGameUpdates(e,t){return x.channel(`game:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"games",filter:`id=eq.${e}`},t).on("postgres_changes",{event:"*",schema:"public",table:"game_participants",filter:`game_id=eq.${e}`},t).subscribe()}static subscribeToChatMessages(e,t){return x.channel(`chat:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`game_id=eq.${e}`},t).subscribe()}static subscribeToNotifications(e){return console.log("Realtime notifications disabled to prevent WebSocket failures"),{unsubscribe:()=>{}}}static subscribeToAllGames(e){return console.log("Realtime subscriptions disabled to prevent WebSocket failures"),{unsubscribe:()=>{}}}static subscribeToPublicRSVPs(e,t){return console.log("Realtime subscriptions disabled to prevent WebSocket failures"),{unsubscribe:()=>{}}}static async searchGames(e){try{const{data:{user:t}}=await x.auth.getUser(),s=t?.id;let n=x.from("games").select("id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id");if(e.dateRange?.start||(n=n.gte("date",new Date().toISOString().split("T")[0])),e.sports&&e.sports.length>0&&(n=n.in("sport",e.sports)),e.dateRange?.start&&(n=n.gte("date",e.dateRange.start.toISOString().split("T")[0])),e.dateRange?.end&&(n=n.lte("date",e.dateRange.end.toISOString().split("T")[0])),!s){const{data:o,error:l}=await n.order("date",{ascending:!0}).limit(50);if(l)throw l;return(o||[]).map(c=>se(c,!1))}const{data:i,error:a}=await n.select(`
          *,
          game_participants(user_id)
        `).order("date",{ascending:!0}).limit(50);if(a)throw a;return(i||[]).map(o=>{const l=o.game_participants?.some(c=>c.user_id===s)||!1;return se(o,l)})}catch(t){return console.error("[SupabaseService.searchGames] Error:",t),[]}}static async getRecommendedGames(e){const t=`SupabaseService.getRecommendedGames ${Date.now()}-${Math.random().toString(36).slice(2,6)}`;console.time?.(t);try{let s;if(Array.isArray(e)&&e.length>0)s=e.filter(a=>typeof a=="string"&&a.length>0);else{const{data:{user:a}}=await x.auth.getUser(),o=a?.id;if(!o)return console.timeEnd?.(t),this.getGames();const{data:l}=await x.from("users").select("preferred_sports").eq("id",o).single();s=(l?.preferred_sports??[]).filter(c=>typeof c=="string"&&c.length>0)}if(!s.length)return console.timeEnd?.(t),this.getGames();const{data:{user:n}}=await x.auth.getUser(),i=n?.id;if(i){const{data:a,error:o}=await x.from("games").select(`
            id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id,
            game_participants(user_id)
          `).in("sport",s).gte("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!0}).limit(50);if(o)throw o;return(a||[]).map(l=>{const c=l.game_participants?.some(d=>d.user_id===i)||!1;return se(l,c)})}else{const{data:a,error:o}=await x.from("games").select("id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id").in("sport",s).gte("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!0}).limit(50);if(o)throw o;return(a||[]).map(l=>se(l,!1))}}catch(s){return console.error("[SupabaseService.getRecommendedGames] Error:",s),this.getGames()}finally{console.timeEnd?.(t)}}static async getArchivedGames(e){try{let t=x.from("games").select("*").lt("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!1}).limit(50);if(e){const{data:s,error:n}=await x.from("games").select(`
            *,
            game_participants(user_id)
          `).lt("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!1}).limit(50);if(n)throw n;return(s||[]).filter(i=>i.creator_id===e||i.game_participants?.some(a=>a.user_id===e)).map(i=>{const a=i.game_participants?.some(o=>o.user_id===e)||!1;return se(i,a)})}else{const{data:s,error:n}=await t;if(n)throw n;return(s||[]).map(i=>se(i,!1))}}catch(t){return console.error("[SupabaseService.getArchivedGames] Error:",t),[]}}static async archiveOldGames(){try{const e=new Date;e.setDate(e.getDate()-1);const t=e.toISOString().split("T")[0],s=null;console.log("âœ… Old games processed successfully")}catch(e){console.error("âŒ Error archiving old games:",e)}}static async getUserStats(e){try{const{data:t,error:s}=await x.from("user_stats").select("*").eq("user_id",e).maybeSingle();if(s&&s.code!=="PGRST116")throw console.error("âŒ getUserStats database error:",s),s;let n=null;if(!t){console.log("ðŸ“Š No user_stats record found, calculating from game participation");const{data:l,error:c}=await x.from("games").select("id, sport").eq("creator_id",e);c&&console.error("âŒ Error fetching hosted games:",c);const{data:d,error:u}=await x.from("game_participants").select(`
            game_id,
            play_time_minutes,
            games!inner(sport, date)
          `).eq("user_id",e);u&&console.error("âŒ Error fetching participated games:",u);const h=l?.length||0,m=d?.length||0,p=d?.reduce((v,b)=>v+(b.play_time_minutes||0),0)||0,g={};l?.forEach(v=>{g[v.sport]=(g[v.sport]||0)+1}),d?.forEach(v=>{const b=v.games?.sport;b&&(g[b]=(g[b]||0)+1)});const w=Object.keys(g).length>0?Object.entries(g).reduce((v,b)=>g[v[0]]>g[b[0]]?v:b)[0]:null;n={user_id:e,games_played:m,games_hosted:h,total_play_time_minutes:p,favorite_sport:w,last_activity:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},console.log("ðŸ“Š Calculated stats from live data:",n)}let i=[];try{const{data:l}=await x.from("game_reviews").select("rating").eq("reviewee_id",e);i=l||[]}catch{console.log("âš ï¸ game_reviews table not found, skipping rating calculation"),i=[]}const a=i.length>0?i.reduce((l,c)=>l+c.rating,0)/i.length:0;return{...t||n||{user_id:e,games_played:0,games_hosted:0,total_play_time_minutes:0,favorite_sport:null,last_activity:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},average_rating:a}}catch(t){return console.error("âŒ getUserStats failed:",t),{user_id:e,games_played:0,games_hosted:0,total_play_time_minutes:0,favorite_sport:null,average_rating:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}}static async getUserRecentGames(e,t=5){try{const{data:s,error:n}=await x.from("game_participants").select(`
          *,
          games (
            id,
            title,
            sport,
            date,
            time,
            location,
            created_by
          )
        `).eq("user_id",e).order("joined_at",{ascending:!1}).limit(t);return n?(console.error("âŒ getUserRecentGames database error:",n),console.log("âš ï¸ getUserRecentGames error, returning empty array:",n.message),[]):s||[]}catch(s){return console.error("âŒ getUserRecentGames catch block error:",s),console.log("âš ï¸ getUserRecentGames failed, returning empty array"),[]}}static async getUserAchievements(e){const{data:t,error:s}=await x.from("user_achievements").select(`
        *,
        achievements (
          id,
          name,
          description,
          icon,
          category,
          criteria,
          points,
          is_active
        )
      `).eq("user_id",e).order("earned_at",{ascending:!1});if(s)throw s;return t||[]}static async getAllAchievements(){const{data:e,error:t}=await x.from("achievements").select("*").eq("is_active",!0).order("points",{ascending:!0});if(t)throw t;return e||[]}static async checkAndAwardAchievements(e){const t=await this.getUserStats(e),{data:s,error:n}=await x.from("achievements").select("*").eq("is_active",!0);if(n)throw n;const{data:i,error:a}=await x.from("user_achievements").select("achievement_id").eq("user_id",e);if(a)throw a;const o=new Set(i?.map(c=>c.achievement_id)||[]),l=[];for(const c of s||[]){if(o.has(c.id))continue;const d=c.criteria;let u=!1;d.games_played&&t.games_played>=d.games_played&&(u=!0),d.games_hosted&&t.games_hosted>=d.games_hosted&&(u=!0),u&&l.push(c)}if(l.length>0){const c=l.map(u=>({user_id:e,achievement_id:u.id,earned_at:new Date().toISOString()})),{error:d}=await x.from("user_achievements").insert(c);if(d)throw d}return l}static async recordGameParticipation(e,t,s="joined"){const{data:n,error:i}=await x.from("information_schema.columns").select("column_name").eq("table_name","game_participants").eq("column_name","status");if(i){console.log("Could not check for status column, using basic participation tracking");const{data:a,error:o}=await x.from("game_participants").upsert({user_id:e,game_id:t},{onConflict:"user_id,game_id"});if(o)throw o;return a}if(n&&n.length>0){const{data:a,error:o}=await x.from("game_participants").upsert({user_id:e,game_id:t,status:s,joined_at:s==="joined"?new Date().toISOString():void 0,left_at:s==="left"||s==="completed"?new Date().toISOString():void 0},{onConflict:"user_id,game_id"});if(o)throw o;return a}else{const{data:a,error:o}=await x.from("game_participants").upsert({user_id:e,game_id:t},{onConflict:"user_id,game_id"});if(o)throw o;return a}}static async markGameCompleted(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");const{data:s,error:n}=await x.from("games").select("created_by").eq("id",e).single();if(n)throw n;if(s.created_by!==t.id)throw new Error("Only the game creator can mark a game as completed");const{error:i}=await x.from("game_participants").update({status:"completed",left_at:new Date().toISOString()}).eq("game_id",e).eq("status","joined");if(i)throw i;const{data:a,error:o}=await x.from("game_participants").select("user_id").eq("game_id",e).eq("status","completed");if(o)throw o;for(const l of a||[])try{await this.checkAndAwardAchievements(l.user_id)}catch(c){console.warn(`Failed to check achievements for user ${l.user_id}:`,c)}}static async joinWaitlist(e){const{data:t,error:s}=await x.rpc("join_waitlist",{game_uuid:e});if(s)throw s;return t}static async leaveWaitlist(e){const{data:t,error:s}=await x.rpc("leave_waitlist",{game_uuid:e});if(s)throw s;return t}static async joinFromWaitlist(e){const{data:t,error:s}=await x.rpc("join_from_waitlist",{game_uuid:e});if(s)throw s;return t}static async getGameWaitlist(e){const{data:t,error:s}=await x.from("game_waitlist").select(`
        *,
        user:users!game_waitlist_user_id_fkey(id, full_name, username, avatar_url)
      `).eq("game_id",e).order("position",{ascending:!0});if(s)throw s;return(t||[]).map(n=>({id:n.id,position:n.position,joinedAt:n.joined_at,status:n.status,expiresAt:n.expires_at,user:{id:n.user.id,name:n.user.full_name||n.user.username,username:n.user.username,avatarUrl:n.user.avatar_url}}))}static async getUserWaitlistStatus(e){const t=await this.getCurrentUser();if(!t)return{isOnWaitlist:!1};const{data:s,error:n}=await x.from("game_waitlist").select("position, status").eq("game_id",e).eq("user_id",t.id).single();if(n&&n.code!=="PGRST116")throw n;return s?{isOnWaitlist:!0,position:s.position,status:s.status}:{isOnWaitlist:!1}}static async createRecurringTemplate(e){const{data:t,error:s}=await x.rpc("create_recurring_template",{p_title:e.title,p_sport:e.sport,p_location:e.location,p_latitude:e.latitude||null,p_longitude:e.longitude||null,p_cost:e.cost||"Free",p_max_players:e.maxPlayers,p_description:e.description||"",p_image_url:e.imageUrl||null,p_recurrence_type:e.recurrenceType,p_recurrence_interval:1,p_day_of_week:e.dayOfWeek||null,p_day_of_month:e.dayOfMonth||null,p_time_of_day:e.timeOfDay,p_start_date:e.startDate,p_end_date:e.endDate||null,p_max_occurrences:e.maxOccurrences||null});if(s)throw s;return t}static async getRecurringTemplates(e){let t=x.from("recurring_game_templates").select(`
        *,
        creator:users!recurring_game_templates_creator_id_fkey(id, full_name, username, avatar_url),
        _count:recurring_game_instances(count)
      `).eq("is_active",!0).order("created_at",{ascending:!1});e&&(t=t.eq("creator_id",e));const{data:s,error:n}=await t;if(n)throw n;return(s||[]).map(i=>({id:i.id,title:i.title,sport:i.sport,location:i.location,recurrenceType:i.recurrence_type,dayOfWeek:i.day_of_week,dayOfMonth:i.day_of_month,timeOfDay:i.time_of_day,startDate:i.start_date,endDate:i.end_date,maxOccurrences:i.max_occurrences,isActive:i.is_active,createdAt:i.created_at,creator:{id:i.creator.id,name:i.creator.full_name||i.creator.username,username:i.creator.username,avatarUrl:i.creator.avatar_url},instanceCount:i._count?.[0]?.count||0}))}static async updateRecurringTemplate(e,t){const{data:s,error:n}=await x.rpc("update_recurring_template",{template_id:e,updates:t});if(n)throw n;return s}static async cancelRecurringTemplate(e,t=!0){const{data:s,error:n}=await x.rpc("cancel_recurring_template",{template_id:e,cancel_future_games:t});if(n)throw n;return s}static async getRecurringGameInstances(e){const{data:t,error:s}=await x.from("recurring_game_instances").select(`
        *,
        game:games!recurring_game_instances_game_id_fkey(*)
      `).eq("template_id",e).order("scheduled_date",{ascending:!0});if(s)throw s;return(t||[]).map(n=>({id:n.id,scheduledDate:n.scheduled_date,instanceNumber:n.instance_number,status:n.status,game:n.game?se(n.game,!1):null}))}static async submitGameReview(e){try{const{data:t,error:s}=await x.rpc("submit_game_review",{p_game_id:e.gameId,p_overall_rating:e.overallRating,p_organization_rating:e.organizationRating||null,p_skill_level_rating:e.skillLevelRating||null,p_fun_rating:e.funRating||null,p_review_text:e.reviewText||null,p_would_play_again:e.wouldPlayAgain??!0,p_recommend_to_others:e.recommendToOthers??!0});if(s)throw s;return t}catch{throw console.log("âš ï¸ Rating system disabled - submit_game_review function not available"),new Error("Rating system is currently disabled")}}static async submitPlayerRating(e){try{const{data:t,error:s}=await x.rpc("submit_player_rating",{p_game_id:e.gameId,p_rated_player_id:e.ratedPlayerId,p_skill_rating:e.skillRating,p_sportsmanship_rating:e.sportsmanshipRating,p_communication_rating:e.communicationRating,p_feedback_text:e.feedbackText||null});if(s)throw s;return t}catch{throw console.log("âš ï¸ Rating system disabled - submit_player_rating function not available"),new Error("Rating system is currently disabled")}}static async getGameReviews(e){try{const{data:t,error:s}=await x.from("game_reviews").select(`
          *,
          reviewer:users!game_reviews_reviewer_id_fkey(id, full_name, username, avatar_url)
        `).eq("game_id",e).order("created_at",{ascending:!1});return s?(console.error("Error fetching game reviews:",s),[]):t||[]}catch{return console.log("âš ï¸ game_reviews table not found, returning empty array"),[]}}static async getGameRatingSummary(e){const{data:t,error:s}=await x.from("game_rating_summary").select("*").eq("game_id",e).single();if(s&&s.code!=="PGRST116")throw s;return t?{totalReviews:t.total_reviews,avgOverallRating:t.avg_overall_rating,avgOrganizationRating:t.avg_organization_rating,avgSkillLevelRating:t.avg_skill_level_rating,avgFunRating:t.avg_fun_rating,wouldPlayAgainCount:t.would_play_again_count,recommendCount:t.recommend_count,lastUpdated:t.last_updated}:null}static async getUserRatingSummary(e){const{data:t,error:s}=await x.from("user_rating_summary").select("*").eq("user_id",e).single();if(s&&s.code!=="PGRST116")throw s;return t?{totalRatingsReceived:t.total_ratings_received,avgSkillRating:t.avg_skill_rating,avgSportsmanshipRating:t.avg_sportsmanship_rating,avgCommunicationRating:t.avg_communication_rating,avgOverallPlayerRating:t.avg_overall_player_rating,gamesOrganized:t.games_organized,avgGameRating:t.avg_game_rating,lastUpdated:t.last_updated}:null}static async getReviewableGames(){const{data:e,error:t}=await x.rpc("get_reviewable_games");if(t)throw t;return(e||[]).map(s=>({gameId:s.game_id,title:s.game_title,date:s.game_date,time:s.game_time,sport:s.sport,hasReviewed:s.has_reviewed}))}static async getPlayerRatings(e,t){let s=x.from("player_ratings").select(`
        *,
        rater:users!player_ratings_rater_id_fkey(id, full_name, username, avatar_url),
        rated_player:users!player_ratings_rated_player_id_fkey(id, full_name, username, avatar_url)
      `).eq("game_id",e);t&&(s=s.eq("rated_player_id",t));const{data:n,error:i}=await s.order("created_at",{ascending:!1});if(i)throw i;return(n||[]).map(a=>({id:a.id,skillRating:a.skill_rating,sportsmanshipRating:a.sportsmanship_rating,communicationRating:a.communication_rating,feedbackText:a.feedback_text,createdAt:a.created_at,rater:{id:a.rater.id,name:a.rater.full_name||a.rater.username,username:a.rater.username,avatarUrl:a.rater.avatar_url},ratedPlayer:{id:a.rated_player.id,name:a.rated_player.full_name||a.rated_player.username,username:a.rated_player.username,avatarUrl:a.rated_player.avatar_url}}))}}const Bn=r=>{let e;const t=new Set,s=(c,d)=>{const u=typeof c=="function"?c(e):c;if(!Object.is(u,e)){const h=e;e=d??(typeof u!="object"||u===null)?u:Object.assign({},e,u),t.forEach(m=>m(e,h))}},n=()=>e,o={setState:s,getState:n,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=r(s,n,o);return o},Zd=r=>r?Bn(r):Bn,eh=r=>r;function th(r,e=eh){const t=k.useSyncExternalStore(r.subscribe,k.useCallback(()=>e(r.getState()),[r,e]),k.useCallback(()=>e(r.getInitialState()),[r,e]));return k.useDebugValue(t),t}const rh=r=>{const e=Zd(r),t=s=>th(e,s);return Object.assign(t,e),t},sh=r=>rh;function da(r,e){let t;try{t=r()}catch{return}return{getItem:n=>{var i;const a=l=>l===null?null:JSON.parse(l,void 0),o=(i=t.getItem(n))!=null?i:null;return o instanceof Promise?o.then(a):a(o)},setItem:(n,i)=>t.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>t.removeItem(n)}}const bs=r=>e=>{try{const t=r(e);return t instanceof Promise?t:{then(s){return bs(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return bs(s)(t)}}}},nh=(r,e)=>(t,s,n)=>{let i={storage:da(()=>localStorage),partialize:g=>g,version:0,merge:(g,w)=>({...w,...g}),...e},a=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return r((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...g)},s,n);const d=()=>{const g=i.partialize({...s()});return c.setItem(i.name,{state:g,version:i.version})},u=n.setState;n.setState=(g,w)=>(u(g,w),d());const h=r((...g)=>(t(...g),d()),s,n);n.getInitialState=()=>h;let m;const p=()=>{var g,w;if(!c)return;a=!1,o.forEach(b=>{var _;return b((_=s())!=null?_:h)});const v=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(g=s())!=null?g:h))||void 0;return bs(c.getItem.bind(c))(i.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate){const _=i.migrate(b.state,b.version);return _ instanceof Promise?_.then(S=>[!0,S]):[!0,_]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var _;const[S,O]=b;if(m=i.merge(O,(_=s())!=null?_:h),t(m,!0),S)return d()}).then(()=>{v?.(m,void 0),m=s(),a=!0,l.forEach(b=>b(m))}).catch(b=>{v?.(void 0,b)})};return n.persist={setOptions:g=>{i={...i,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>a,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},i.skipHydration||p(),m||h},ih=nh;var ha=Symbol.for("immer-nothing"),qn=Symbol.for("immer-draftable"),he=Symbol.for("immer-state");function Pe(r,...e){throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var Pt=Object.getPrototypeOf;function Ct(r){return!!r&&!!r[he]}function lt(r){return r?fa(r)||Array.isArray(r)||!!r[qn]||!!r.constructor?.[qn]||jr(r)||Ir(r):!1}var ah=Object.prototype.constructor.toString();function fa(r){if(!r||typeof r!="object")return!1;const e=Pt(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===ah}function br(r,e){Or(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,s)=>e(s,t,r))}function Or(r){const e=r[he];return e?e.type_:Array.isArray(r)?1:jr(r)?2:Ir(r)?3:0}function _s(r,e){return Or(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function ma(r,e,t){const s=Or(r);s===2?r.set(e,t):s===3?r.add(t):r[e]=t}function oh(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function jr(r){return r instanceof Map}function Ir(r){return r instanceof Set}function at(r){return r.copy_||r.base_}function xs(r,e){if(jr(r))return new Map(r);if(Ir(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=fa(r);if(e===!0||e==="class_only"&&!t){const s=Object.getOwnPropertyDescriptors(r);delete s[he];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const a=n[i],o=s[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(s[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:r[a]})}return Object.create(Pt(r),s)}else{const s=Pt(r);if(s!==null&&t)return{...r};const n=Object.create(s);return Object.assign(n,r)}}function Ks(r,e=!1){return $r(r)||Ct(r)||!lt(r)||(Or(r)>1&&(r.set=r.add=r.clear=r.delete=lh),Object.freeze(r),e&&Object.entries(r).forEach(([t,s])=>Ks(s,!0))),r}function lh(){Pe(2)}function $r(r){return Object.isFrozen(r)}var ch={};function ct(r){const e=ch[r];return e||Pe(0,r),e}var Kt;function pa(){return Kt}function uh(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function zn(r,e){e&&(ct("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function ks(r){Ss(r),r.drafts_.forEach(dh),r.drafts_=null}function Ss(r){r===Kt&&(Kt=r.parent_)}function Wn(r){return Kt=uh(Kt,r)}function dh(r){const e=r[he];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Hn(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[he].modified_&&(ks(e),Pe(4)),lt(r)&&(r=_r(e,r),e.parent_||xr(e,r)),e.patches_&&ct("Patches").generateReplacementPatches_(t[he].base_,r,e.patches_,e.inversePatches_)):r=_r(e,t,[]),ks(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==ha?r:void 0}function _r(r,e,t){if($r(e))return e;const s=e[he];if(!s)return br(e,(n,i)=>Gn(r,s,e,n,i,t)),e;if(s.scope_!==r)return e;if(!s.modified_)return xr(r,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,a=!1;s.type_===3&&(i=new Set(n),n.clear(),a=!0),br(i,(o,l)=>Gn(r,s,n,o,l,t,a)),xr(r,n,!1),t&&r.patches_&&ct("Patches").generatePatches_(s,t,r.patches_,r.inversePatches_)}return s.copy_}function Gn(r,e,t,s,n,i,a){if(Ct(n)){const o=i&&e&&e.type_!==3&&!_s(e.assigned_,s)?i.concat(s):void 0,l=_r(r,n,o);if(ma(t,s,l),Ct(l))r.canAutoFreeze_=!1;else return}else a&&t.add(n);if(lt(n)&&!$r(n)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;_r(r,n),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,s)&&xr(r,n)}}function xr(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&Ks(e,t)}function hh(r,e){const t=Array.isArray(r),s={type_:t?1:0,scope_:e?e.scope_:pa(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=Js;t&&(n=[s],i=Jt);const{revoke:a,proxy:o}=Proxy.revocable(n,i);return s.draft_=o,s.revoke_=a,o}var Js={get(r,e){if(e===he)return r;const t=at(r);if(!_s(t,e))return fh(r,t,e);const s=t[e];return r.finalized_||!lt(s)?s:s===Xr(r.base_,e)?(Zr(r),r.copy_[e]=Ts(s,r)):s},has(r,e){return e in at(r)},ownKeys(r){return Reflect.ownKeys(at(r))},set(r,e,t){const s=ga(at(r),e);if(s?.set)return s.set.call(r.draft_,t),!0;if(!r.modified_){const n=Xr(at(r),e),i=n?.[he];if(i&&i.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(oh(t,n)&&(t!==void 0||_s(r.base_,e)))return!0;Zr(r),Es(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return Xr(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,Zr(r),Es(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=at(r),s=Reflect.getOwnPropertyDescriptor(t,e);return s&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:s.enumerable,value:t[e]}},defineProperty(){Pe(11)},getPrototypeOf(r){return Pt(r.base_)},setPrototypeOf(){Pe(12)}},Jt={};br(Js,(r,e)=>{Jt[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Jt.deleteProperty=function(r,e){return Jt.set.call(this,r,e,void 0)};Jt.set=function(r,e,t){return Js.set.call(this,r[0],e,t,r[0])};function Xr(r,e){const t=r[he];return(t?at(t):r)[e]}function fh(r,e,t){const s=ga(e,t);return s?"value"in s?s.value:s.get?.call(r.draft_):void 0}function ga(r,e){if(!(e in r))return;let t=Pt(r);for(;t;){const s=Object.getOwnPropertyDescriptor(t,e);if(s)return s;t=Pt(t)}}function Es(r){r.modified_||(r.modified_=!0,r.parent_&&Es(r.parent_))}function Zr(r){r.copy_||(r.copy_=xs(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var mh=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,s)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const a=this;return function(l=i,...c){return a.produce(l,d=>t.call(this,d,...c))}}typeof t!="function"&&Pe(6),s!==void 0&&typeof s!="function"&&Pe(7);let n;if(lt(e)){const i=Wn(this),a=Ts(e,void 0);let o=!0;try{n=t(a),o=!1}finally{o?ks(i):Ss(i)}return zn(i,s),Hn(n,i)}else if(!e||typeof e!="object"){if(n=t(e),n===void 0&&(n=e),n===ha&&(n=void 0),this.autoFreeze_&&Ks(n,!0),s){const i=[],a=[];ct("Patches").generateReplacementPatches_(e,n,i,a),s(i,a)}return n}else Pe(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let s,n;return[this.produce(e,t,(a,o)=>{s=a,n=o}),s,n]},typeof r?.autoFreeze=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof r?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){lt(r)||Pe(8),Ct(r)&&(r=ph(r));const e=Wn(this),t=Ts(r,void 0);return t[he].isManual_=!0,Ss(e),t}finishDraft(r,e){const t=r&&r[he];(!t||!t.isManual_)&&Pe(9);const{scope_:s}=t;return zn(s,e),Hn(void 0,s)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const n=e[t];if(n.path.length===0&&n.op==="replace"){r=n.value;break}}t>-1&&(e=e.slice(t+1));const s=ct("Patches").applyPatches_;return Ct(r)?s(r,e):this.produce(r,n=>s(n,e))}};function Ts(r,e){const t=jr(r)?ct("MapSet").proxyMap_(r,e):Ir(r)?ct("MapSet").proxySet_(r,e):hh(r,e);return(e?e.scope_:pa()).drafts_.push(t),t}function ph(r){return Ct(r)||Pe(10,r),ya(r)}function ya(r){if(!lt(r)||$r(r))return r;const e=r[he];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=xs(r,e.scope_.immer_.useStrictShallowCopy_)}else t=xs(r,!0);return br(t,(s,n)=>{ma(t,s,ya(n))}),e&&(e.finalized_=!1),t}var fe=new mh,gh=fe.produce;fe.produceWithPatches.bind(fe);fe.setAutoFreeze.bind(fe);fe.setUseStrictShallowCopy.bind(fe);fe.applyPatches.bind(fe);fe.createDraft.bind(fe);fe.finishDraft.bind(fe);const yh=r=>(e,t,s)=>(s.setState=(n,i,...a)=>{const o=typeof n=="function"?gh(n):n;return e(o,i,...a)},r(s.setState,t,s)),vh=yh,va={sports:[],dateRange:{start:null,end:null},distance:25,priceRange:{min:0,max:100}},Vn={user:null,isAuthenticated:!1,games:[],myGames:[],nearbyGames:[],isLoading:!1,error:null,chatContext:null,searchFilters:va},Ze=sh()(ih(vh((r,e)=>({...Vn,setUser:t=>r(s=>{s.user=t,s.isAuthenticated=!!t}),updateUserPreferences:async t=>{const{setLoading:s,setError:n}=e();try{s(!0);const i=await G.getCurrentUser();i&&(await G.updateUserProfile(i.id,{preferences:t}),r(a=>{a.user&&(a.user.preferences={...a.user.preferences,...t})}))}catch(i){n(i instanceof Error?i.message:"Failed to update preferences")}finally{s(!1)}},signOut:async()=>{const{setLoading:t,setError:s}=e();try{t(!0),await G.signOut(),r(n=>{n.user=null,n.isAuthenticated=!1,n.myGames=[],n.chatContext=null})}catch(n){s(n instanceof Error?n.message:"Failed to sign out")}finally{t(!1)}},signIn:async(t,s)=>{const{setLoading:n,setError:i}=e();try{n(!0);const{user:a}=await G.signIn(t,s);if(a){const o=await G.getUserProfile(a.id);r(l=>{l.user=o,l.isAuthenticated=!0})}}catch(a){i(a instanceof Error?a.message:"Failed to sign in")}finally{n(!1)}},signUp:async(t,s,n)=>{const{setLoading:i,setError:a}=e();try{i(!0);const{user:o}=await G.signUp(t,s,n);if(o){const l=await G.getUserProfile(o.id);r(c=>{c.user=l,c.isAuthenticated=!0})}}catch(o){a(o instanceof Error?o.message:"Failed to sign up")}finally{i(!1)}},initializeAuth:async()=>{const{setLoading:t,setError:s,setGames:n}=e(),i=e();if(!i.isLoading)try{if(t(!0),i.games.length===0){const a=await G.getGames();n(a)}}catch(a){s(a instanceof Error?a.message:"Failed to initialize auth")}finally{t(!1)}},setGames:t=>{r(s=>{s.games=t,s.isLoading=!1;const n=s.user?.id;s.myGames=t.filter(i=>i.createdBy===n||i.isJoined),s.nearbyGames=t.slice(0,10)})},addGame:async t=>{const{setLoading:s,setError:n}=e();try{s(!0);const i=await G.createGame(t);r(a=>{a.games.unshift(i),i.createdBy===a.user?.id&&a.myGames.unshift(i)})}catch(i){n(i instanceof Error?i.message:"Failed to create game")}finally{s(!1)}},updateGame:async(t,s)=>{const{setLoading:n,setError:i}=e();try{n(!0),r(a=>{const o=a.games.findIndex(c=>c.id===t);o!==-1&&(a.games[o]={...a.games[o],...s});const l=a.myGames.findIndex(c=>c.id===t);l!==-1&&(a.myGames[l]={...a.myGames[l],...s})})}catch(a){i(a instanceof Error?a.message:"Failed to update game")}finally{n(!1)}},joinGame:async t=>{console.warn("ðŸš« Zustand joinGame method is deprecated - use React Query mutations instead")},leaveGame:async t=>{console.warn("ðŸš« Zustand leaveGame method is deprecated - use React Query mutations instead")},setLoading:t=>r(s=>{s.isLoading=t}),setError:t=>r(s=>{s.error=t,s.isLoading=!1}),clearError:()=>r(t=>{t.error=null}),setChatContext:t=>r(s=>{s.chatContext=t}),updateSearchFilters:t=>r(s=>{s.searchFilters={...s.searchFilters,...t}}),clearSearchFilters:()=>r(t=>{t.searchFilters=va}),reset:()=>r(()=>Vn)})),{name:"tribeup-store",storage:da(()=>localStorage),partialize:r=>({user:r.user,searchFilters:r.searchFilters})}));function wh(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}const bh=r=>{switch(r){case"success":return kh;case"info":return Eh;case"warning":return Sh;case"error":return Th;default:return null}},_h=Array(12).fill(0),xh=({visible:r,className:e})=>k.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":r},k.createElement("div",{className:"sonner-spinner"},_h.map((t,s)=>k.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),kh=k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},k.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Sh=k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},k.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Eh=k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},k.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Th=k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},k.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ph=k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},k.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),k.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Ch=()=>{const[r,e]=k.useState(document.hidden);return k.useEffect(()=>{const t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),r};let Ps=1;class Rh{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:s,...n}=e,i=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Ps++,a=this.toasts.find(l=>l.id===i),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:s}),{...l,...e,id:i,dismissible:o,title:s}):l):this.addToast({title:s,...n,dismissible:o,id:i}),i},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(s=>s({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let s;t.loading!==void 0&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const n=Promise.resolve(e instanceof Function?e():e);let i=s!==void 0,a;const o=n.then(async c=>{if(a=["resolve",c],k.isValidElement(c))i=!1,this.create({id:s,type:"default",message:c});else if(Oh(c)&&!c.ok){i=!1;const u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,h=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description,p=typeof u=="object"&&!k.isValidElement(u)?u:{message:u};this.create({id:s,type:"error",description:h,...p})}else if(c instanceof Error){i=!1;const u=typeof t.error=="function"?await t.error(c):t.error,h=typeof t.description=="function"?await t.description(c):t.description,p=typeof u=="object"&&!k.isValidElement(u)?u:{message:u};this.create({id:s,type:"error",description:h,...p})}else if(t.success!==void 0){i=!1;const u=typeof t.success=="function"?await t.success(c):t.success,h=typeof t.description=="function"?await t.description(c):t.description,p=typeof u=="object"&&!k.isValidElement(u)?u:{message:u};this.create({id:s,type:"success",description:h,...p})}}).catch(async c=>{if(a=["reject",c],t.error!==void 0){i=!1;const d=typeof t.error=="function"?await t.error(c):t.error,u=typeof t.description=="function"?await t.description(c):t.description,m=typeof d=="object"&&!k.isValidElement(d)?d:{message:d};this.create({id:s,type:"error",description:u,...m})}}).finally(()=>{i&&(this.dismiss(s),s=void 0),t.finally==null||t.finally.call(t)}),l=()=>new Promise((c,d)=>o.then(()=>a[0]==="reject"?d(a[1]):c(a[1])).catch(d));return typeof s!="string"&&typeof s!="number"?{unwrap:l}:Object.assign(s,{unwrap:l})},this.custom=(e,t)=>{const s=t?.id||Ps++;return this.create({jsx:e(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const oe=new Rh,Ah=(r,e)=>{const t=e?.id||Ps++;return oe.addToast({title:r,...e,id:t}),t},Oh=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",jh=Ah,Ih=()=>oe.toasts,$h=()=>oe.getActiveToasts(),Xe=Object.assign(jh,{success:oe.success,info:oe.info,warning:oe.warning,error:oe.error,custom:oe.custom,message:oe.message,promise:oe.promise,dismiss:oe.dismiss,loading:oe.loading},{getHistory:Ih,getToasts:$h});wh("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function hr(r){return r.label!==void 0}const Nh=3,Uh="24px",Lh="16px",Kn=4e3,Dh=356,Mh=14,Fh=45,Bh=200;function je(...r){return r.filter(Boolean).join(" ")}function qh(r){const[e,t]=r.split("-"),s=[];return e&&s.push(e),t&&s.push(t),s}const zh=r=>{var e,t,s,n,i,a,o,l,c;const{invert:d,toast:u,unstyled:h,interacting:m,setHeights:p,visibleToasts:g,heights:w,index:v,toasts:b,expanded:_,removeToast:S,defaultRichColors:O,closeButton:R,style:N,cancelButtonStyle:C,actionButtonStyle:q,className:ie="",descriptionClassName:Ne="",duration:Re,position:ce,gap:We,expandByDefault:pe,classNames:L,icons:z,closeButtonAriaLabel:P="Close toast"}=r,[Ae,ae]=k.useState(null),[Oe,He]=k.useState(null),[A,D]=k.useState(!1),[M,te]=k.useState(!1),[W,F]=k.useState(!1),[be,Ue]=k.useState(!1),[Ge,_e]=k.useState(!1),[Ba,Lr]=k.useState(0),[qa,Zs]=k.useState(0),Lt=k.useRef(u.duration||Re||Kn),en=k.useRef(null),Le=k.useRef(null),za=v===0,Wa=v+1<=g,ue=u.type,ht=u.dismissible!==!1,Ha=u.className||"",Ga=u.descriptionClassName||"",rr=k.useMemo(()=>w.findIndex(I=>I.toastId===u.id)||0,[w,u.id]),Va=k.useMemo(()=>{var I;return(I=u.closeButton)!=null?I:R},[u.closeButton,R]),tn=k.useMemo(()=>u.duration||Re||Kn,[u.duration,Re]),Dr=k.useRef(0),ft=k.useRef(0),rn=k.useRef(0),mt=k.useRef(null),[Ka,Ja]=ce.split("-"),sn=k.useMemo(()=>w.reduce((I,X,ee)=>ee>=rr?I:I+X.height,0),[w,rr]),nn=Ch(),Qa=u.invert||d,Mr=ue==="loading";ft.current=k.useMemo(()=>rr*We+sn,[rr,sn]),k.useEffect(()=>{Lt.current=tn},[tn]),k.useEffect(()=>{D(!0)},[]),k.useEffect(()=>{const I=Le.current;if(I){const X=I.getBoundingClientRect().height;return Zs(X),p(ee=>[{toastId:u.id,height:X,position:u.position},...ee]),()=>p(ee=>ee.filter(de=>de.toastId!==u.id))}},[p,u.id]),k.useLayoutEffect(()=>{if(!A)return;const I=Le.current,X=I.style.height;I.style.height="auto";const ee=I.getBoundingClientRect().height;I.style.height=X,Zs(ee),p(de=>de.find(Z=>Z.toastId===u.id)?de.map(Z=>Z.toastId===u.id?{...Z,height:ee}:Z):[{toastId:u.id,height:ee,position:u.position},...de])},[A,u.title,u.description,p,u.id,u.jsx,u.action,u.cancel]);const Ve=k.useCallback(()=>{te(!0),Lr(ft.current),p(I=>I.filter(X=>X.toastId!==u.id)),setTimeout(()=>{S(u)},Bh)},[u,S,p,ft]);k.useEffect(()=>{if(u.promise&&ue==="loading"||u.duration===1/0||u.type==="loading")return;let I;return _||m||nn?(()=>{if(rn.current<Dr.current){const de=new Date().getTime()-Dr.current;Lt.current=Lt.current-de}rn.current=new Date().getTime()})():(()=>{Lt.current!==1/0&&(Dr.current=new Date().getTime(),I=setTimeout(()=>{u.onAutoClose==null||u.onAutoClose.call(u,u),Ve()},Lt.current))})(),()=>clearTimeout(I)},[_,m,u,ue,nn,Ve]),k.useEffect(()=>{u.delete&&(Ve(),u.onDismiss==null||u.onDismiss.call(u,u))},[Ve,u.delete]);function Ya(){var I;if(z?.loading){var X;return k.createElement("div",{className:je(L?.loader,u==null||(X=u.classNames)==null?void 0:X.loader,"sonner-loader"),"data-visible":ue==="loading"},z.loading)}return k.createElement(xh,{className:je(L?.loader,u==null||(I=u.classNames)==null?void 0:I.loader),visible:ue==="loading"})}const Xa=u.icon||z?.[ue]||bh(ue);var an,on;return k.createElement("li",{tabIndex:0,ref:Le,className:je(ie,Ha,L?.toast,u==null||(e=u.classNames)==null?void 0:e.toast,L?.default,L?.[ue],u==null||(t=u.classNames)==null?void 0:t[ue]),"data-sonner-toast":"","data-rich-colors":(an=u.richColors)!=null?an:O,"data-styled":!(u.jsx||u.unstyled||h),"data-mounted":A,"data-promise":!!u.promise,"data-swiped":Ge,"data-removed":M,"data-visible":Wa,"data-y-position":Ka,"data-x-position":Ja,"data-index":v,"data-front":za,"data-swiping":W,"data-dismissible":ht,"data-type":ue,"data-invert":Qa,"data-swipe-out":be,"data-swipe-direction":Oe,"data-expanded":!!(_||pe&&A),"data-testid":u.testId,style:{"--index":v,"--toasts-before":v,"--z-index":b.length-v,"--offset":`${M?Ba:ft.current}px`,"--initial-height":pe?"auto":`${qa}px`,...N,...u.style},onDragEnd:()=>{F(!1),ae(null),mt.current=null},onPointerDown:I=>{I.button!==2&&(Mr||!ht||(en.current=new Date,Lr(ft.current),I.target.setPointerCapture(I.pointerId),I.target.tagName!=="BUTTON"&&(F(!0),mt.current={x:I.clientX,y:I.clientY})))},onPointerUp:()=>{var I,X,ee;if(be||!ht)return;mt.current=null;const de=Number(((I=Le.current)==null?void 0:I.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),sr=Number(((X=Le.current)==null?void 0:X.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Z=new Date().getTime()-((ee=en.current)==null?void 0:ee.getTime()),ge=Ae==="x"?de:sr,nr=Math.abs(ge)/Z;if(Math.abs(ge)>=Fh||nr>.11){Lr(ft.current),u.onDismiss==null||u.onDismiss.call(u,u),He(Ae==="x"?de>0?"right":"left":sr>0?"down":"up"),Ve(),Ue(!0);return}else{var xe,ke;(xe=Le.current)==null||xe.style.setProperty("--swipe-amount-x","0px"),(ke=Le.current)==null||ke.style.setProperty("--swipe-amount-y","0px")}_e(!1),F(!1),ae(null)},onPointerMove:I=>{var X,ee,de;if(!mt.current||!ht||((X=window.getSelection())==null?void 0:X.toString().length)>0)return;const Z=I.clientY-mt.current.y,ge=I.clientX-mt.current.x;var nr;const xe=(nr=r.swipeDirections)!=null?nr:qh(ce);!Ae&&(Math.abs(ge)>1||Math.abs(Z)>1)&&ae(Math.abs(ge)>Math.abs(Z)?"x":"y");let ke={x:0,y:0};const ln=tt=>1/(1.5+Math.abs(tt)/20);if(Ae==="y"){if(xe.includes("top")||xe.includes("bottom"))if(xe.includes("top")&&Z<0||xe.includes("bottom")&&Z>0)ke.y=Z;else{const tt=Z*ln(Z);ke.y=Math.abs(tt)<Math.abs(Z)?tt:Z}}else if(Ae==="x"&&(xe.includes("left")||xe.includes("right")))if(xe.includes("left")&&ge<0||xe.includes("right")&&ge>0)ke.x=ge;else{const tt=ge*ln(ge);ke.x=Math.abs(tt)<Math.abs(ge)?tt:ge}(Math.abs(ke.x)>0||Math.abs(ke.y)>0)&&_e(!0),(ee=Le.current)==null||ee.style.setProperty("--swipe-amount-x",`${ke.x}px`),(de=Le.current)==null||de.style.setProperty("--swipe-amount-y",`${ke.y}px`)}},Va&&!u.jsx&&ue!=="loading"?k.createElement("button",{"aria-label":P,"data-disabled":Mr,"data-close-button":!0,onClick:Mr||!ht?()=>{}:()=>{Ve(),u.onDismiss==null||u.onDismiss.call(u,u)},className:je(L?.closeButton,u==null||(s=u.classNames)==null?void 0:s.closeButton)},(on=z?.close)!=null?on:Ph):null,(ue||u.icon||u.promise)&&u.icon!==null&&(z?.[ue]!==null||u.icon)?k.createElement("div",{"data-icon":"",className:je(L?.icon,u==null||(n=u.classNames)==null?void 0:n.icon)},u.promise||u.type==="loading"&&!u.icon?u.icon||Ya():null,u.type!=="loading"?Xa:null):null,k.createElement("div",{"data-content":"",className:je(L?.content,u==null||(i=u.classNames)==null?void 0:i.content)},k.createElement("div",{"data-title":"",className:je(L?.title,u==null||(a=u.classNames)==null?void 0:a.title)},u.jsx?u.jsx:typeof u.title=="function"?u.title():u.title),u.description?k.createElement("div",{"data-description":"",className:je(Ne,Ga,L?.description,u==null||(o=u.classNames)==null?void 0:o.description)},typeof u.description=="function"?u.description():u.description):null),k.isValidElement(u.cancel)?u.cancel:u.cancel&&hr(u.cancel)?k.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||C,onClick:I=>{hr(u.cancel)&&ht&&(u.cancel.onClick==null||u.cancel.onClick.call(u.cancel,I),Ve())},className:je(L?.cancelButton,u==null||(l=u.classNames)==null?void 0:l.cancelButton)},u.cancel.label):null,k.isValidElement(u.action)?u.action:u.action&&hr(u.action)?k.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||q,onClick:I=>{hr(u.action)&&(u.action.onClick==null||u.action.onClick.call(u.action,I),!I.defaultPrevented&&Ve())},className:je(L?.actionButton,u==null||(c=u.classNames)==null?void 0:c.actionButton)},u.action.label):null)};function Jn(){if(typeof window>"u"||typeof document>"u")return"ltr";const r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}function Wh(r,e){const t={};return[r,e].forEach((s,n)=>{const i=n===1,a=i?"--mobile-offset":"--offset",o=i?Lh:Uh;function l(c){["top","right","bottom","left"].forEach(d=>{t[`${a}-${d}`]=typeof c=="number"?`${c}px`:c})}typeof s=="number"||typeof s=="string"?l(s):typeof s=="object"?["top","right","bottom","left"].forEach(c=>{s[c]===void 0?t[`${a}-${c}`]=o:t[`${a}-${c}`]=typeof s[c]=="number"?`${s[c]}px`:s[c]}):l(o)}),t}const Hh=k.forwardRef(function(e,t){const{id:s,invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:o,closeButton:l,className:c,offset:d,mobileOffset:u,theme:h="light",richColors:m,duration:p,style:g,visibleToasts:w=Nh,toastOptions:v,dir:b=Jn(),gap:_=Mh,icons:S,containerAriaLabel:O="Notifications"}=e,[R,N]=k.useState([]),C=k.useMemo(()=>s?R.filter(A=>A.toasterId===s):R.filter(A=>!A.toasterId),[R,s]),q=k.useMemo(()=>Array.from(new Set([i].concat(C.filter(A=>A.position).map(A=>A.position)))),[C,i]),[ie,Ne]=k.useState([]),[Re,ce]=k.useState(!1),[We,pe]=k.useState(!1),[L,z]=k.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),P=k.useRef(null),Ae=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),ae=k.useRef(null),Oe=k.useRef(!1),He=k.useCallback(A=>{N(D=>{var M;return(M=D.find(te=>te.id===A.id))!=null&&M.delete||oe.dismiss(A.id),D.filter(({id:te})=>te!==A.id)})},[]);return k.useEffect(()=>oe.subscribe(A=>{if(A.dismiss){requestAnimationFrame(()=>{N(D=>D.map(M=>M.id===A.id?{...M,delete:!0}:M))});return}setTimeout(()=>{so.flushSync(()=>{N(D=>{const M=D.findIndex(te=>te.id===A.id);return M!==-1?[...D.slice(0,M),{...D[M],...A},...D.slice(M+1)]:[A,...D]})})})}),[R]),k.useEffect(()=>{if(h!=="system"){z(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?z("dark"):z("light")),typeof window>"u")return;const A=window.matchMedia("(prefers-color-scheme: dark)");try{A.addEventListener("change",({matches:D})=>{z(D?"dark":"light")})}catch{A.addListener(({matches:M})=>{try{z(M?"dark":"light")}catch(te){console.error(te)}})}},[h]),k.useEffect(()=>{R.length<=1&&ce(!1)},[R]),k.useEffect(()=>{const A=D=>{var M;if(a.every(F=>D[F]||D.code===F)){var W;ce(!0),(W=P.current)==null||W.focus()}D.code==="Escape"&&(document.activeElement===P.current||(M=P.current)!=null&&M.contains(document.activeElement))&&ce(!1)};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[a]),k.useEffect(()=>{if(P.current)return()=>{ae.current&&(ae.current.focus({preventScroll:!0}),ae.current=null,Oe.current=!1)}},[P.current]),k.createElement("section",{ref:t,"aria-label":`${O} ${Ae}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},q.map((A,D)=>{var M;const[te,W]=A.split("-");return C.length?k.createElement("ol",{key:A,dir:b==="auto"?Jn():b,tabIndex:-1,ref:P,className:c,"data-sonner-toaster":!0,"data-sonner-theme":L,"data-y-position":te,"data-x-position":W,style:{"--front-toast-height":`${((M=ie[0])==null?void 0:M.height)||0}px`,"--width":`${Dh}px`,"--gap":`${_}px`,...g,...Wh(d,u)},onBlur:F=>{Oe.current&&!F.currentTarget.contains(F.relatedTarget)&&(Oe.current=!1,ae.current&&(ae.current.focus({preventScroll:!0}),ae.current=null))},onFocus:F=>{F.target instanceof HTMLElement&&F.target.dataset.dismissible==="false"||Oe.current||(Oe.current=!0,ae.current=F.relatedTarget)},onMouseEnter:()=>ce(!0),onMouseMove:()=>ce(!0),onMouseLeave:()=>{We||ce(!1)},onDragEnd:()=>ce(!1),onPointerDown:F=>{F.target instanceof HTMLElement&&F.target.dataset.dismissible==="false"||pe(!0)},onPointerUp:()=>pe(!1)},C.filter(F=>!F.position&&D===0||F.position===A).map((F,be)=>{var Ue,Ge;return k.createElement(zh,{key:F.id,icons:S,index:be,toast:F,defaultRichColors:m,duration:(Ue=v?.duration)!=null?Ue:p,className:v?.className,descriptionClassName:v?.descriptionClassName,invert:n,visibleToasts:w,closeButton:(Ge=v?.closeButton)!=null?Ge:l,interacting:We,position:A,style:v?.style,unstyled:v?.unstyled,classNames:v?.classNames,cancelButtonStyle:v?.cancelButtonStyle,actionButtonStyle:v?.actionButtonStyle,closeButtonAriaLabel:v?.closeButtonAriaLabel,removeToast:He,toasts:C.filter(_e=>_e.position==F.position),heights:ie.filter(_e=>_e.position==F.position),setHeights:Ne,expandByDefault:o,gap:_,expanded:Re,swipeDirections:e.swipeDirections})})):null}))}),wa=f.createContext(void 0);function Gh({children:r}){const[e,t]=f.useState(null),[s,n]=f.useState(null),[i,a]=f.useState(!0),{setUser:o,initializeAuth:l}=Ze();f.useEffect(()=>{const g=typeof window<"u"&&localStorage.getItem("DEBUG_AUTH")==="1";(async()=>{g&&console.log("[Auth] bootstrap:loading=true");try{const{data:{session:b},error:_}=await x.auth.getSession();if(_){console.error("Error getting session:",_);return}n(b),t(b?.user??null),b?.user&&(g&&console.log("[Auth] Found session, loading profile..."),G.getUserProfile(b.user.id).then(S=>{S&&(g&&console.log("[Auth] Profile loaded:",S.id),o(S))}).catch(S=>{console.error("Error loading profile:",S),o({id:b.user.id,email:b.user.email||"",name:b.user.user_metadata?.full_name||b.user.email||"",username:b.user.user_metadata?.username||b.user.email?.split("@")[0]||"",avatar:b.user.user_metadata?.avatar_url||"",preferences:{sports:[],notifications:{push:!0,email:!0,gameReminders:!0},theme:"light",highContrast:!1,largeText:!1,reducedMotion:!1,colorBlindFriendly:!1,privacy:{locationSharing:!0,profileVisibility:"public"}}})}))}catch(b){console.error("Error getting initial session:",b)}finally{a(!1),g&&console.log("[Auth] bootstrap:loading=false")}})();const{data:{subscription:v}}=x.auth.onAuthStateChange(async(b,_)=>{if(g&&console.log("[Auth] onAuthStateChange:",b,_?.user?.id),n(_),t(_?.user??null),b==="SIGNED_IN"&&_?.user)try{g&&console.log("[Auth] Load profile for:",_.user.id);const S=await G.getUserProfile(_.user.id);if(S){g&&console.log("[Auth] Profile loaded:",S.name),o(S);const O=localStorage.getItem("pendingGameJoin");if(O){localStorage.removeItem("pendingGameJoin");try{const{joinGame:R}=Ze.getState();await R(O),Xe.success("Welcome! You've been automatically joined to the game.")}catch(R){console.error("Error auto-joining game:",R),Xe.error("Welcome! Please manually join the game you were interested in.")}}else window.location.pathname==="/onboarding"?g&&console.log("[Auth] Onboarding page active"):Xe.success("Welcome back!")}else g&&console.log("[Auth] No profile found (ProfileCheck handles onboarding)")}catch(S){console.error("Error loading user profile on sign in:",S)}else b==="SIGNED_OUT"?(o(null),Xe.success("Signed out successfully")):b==="PASSWORD_RECOVERY"?Xe.info("Check your email for password reset instructions"):b==="USER_UPDATED"&&g&&console.log("[Auth] User updated:",_?.user?.id);a(!1),g&&console.log("[Auth] onAuthStateChange:loading=false")});return()=>{v.unsubscribe()}},[o]);const p={user:e,session:s,loading:i,signIn:async(g,w)=>{try{const{error:v}=await x.auth.signInWithPassword({email:g,password:w});if(v)throw v}catch(v){throw console.error("Sign in error:",v),new Error(v.message||"Failed to sign in")}},signUp:async(g,w,v)=>{try{const{data:b,error:_}=await x.auth.signUp({email:g,password:w,options:{data:{full_name:v.name,username:v.name?.toLowerCase().replace(/\s+/g,"_"),pending_game_id:v.pendingGameId,phone:v.phone}}});if(_)throw _;if(b.user)try{await G.createUserProfile(b.user.id,{email:b.user.email,name:v.name,phone:v.phone}),v.pendingGameId&&localStorage.setItem("pendingGameJoin",v.pendingGameId)}catch(S){console.error("Error creating user profile:",S)}}catch(b){throw console.error("Sign up error:",b),new Error(b.message||"Failed to sign up")}},signInWithOAuth:async(g,w)=>{try{const v=`${window.location.origin}/auth/callback`;w?.pendingGameId&&localStorage.setItem("pendingGameJoin",w.pendingGameId);const{error:b}=await x.auth.signInWithOAuth({provider:g,options:{redirectTo:v,queryParams:{access_type:"offline",prompt:"consent"}}});if(b)throw b}catch(v){throw console.error("OAuth sign in error:",v),new Error(v.message||`Failed to sign in with ${g}`)}},signOut:async()=>{try{const{error:g}=await x.auth.signOut();if(g)throw g}catch(g){throw console.error("Sign out error:",g),new Error(g.message||"Failed to sign out")}},resetPassword:async g=>{try{const{error:w}=await x.auth.resetPasswordForEmail(g,{redirectTo:`${window.location.origin}/auth?reset=true`});if(w)throw w}catch(w){throw console.error("Password reset error:",w),new Error(w.message||"Failed to send reset email")}}};return y.jsx(wa.Provider,{value:p,children:r})}function ba(){const r=f.useContext(wa);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r}function Qn({children:r=null,requireAuth:e=!0,redirectTo:t="/auth"}){const{user:s,loading:n}=ba(),i=me();return n?y.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:y.jsx(qs,{size:"lg",text:"Loading..."})}):e&&!s?y.jsx(ss,{to:t,state:{from:i},replace:!0}):!e&&s?y.jsx(ss,{to:"/",replace:!0}):y.jsx(y.Fragment,{children:r||null})}function Vh({children:r=null}){const e=ut(),{user:t}=ba(),{user:s}=Ze(),[n,i]=f.useState(!0),a=f.useRef(!1),o=f.useRef(null);return f.useEffect(()=>{const c=setTimeout(async()=>{if(a.current){console.log("ProfileCheck: Already checked, skipping"),i(!1);return}if(console.log("ProfileCheck: Starting profile check"),console.log("ProfileCheck: Current user from auth:",t),console.log("ProfileCheck: Current app user from store:",s),console.log("ProfileCheck: Current pathname:",window.location.pathname),window.location.pathname==="/onboarding"){console.log("ProfileCheck: Already on onboarding page, skipping check"),a.current=!0,i(!1);return}const d=window.history.state?.usr||{};if(console.log("ProfileCheck: Current location state:",d),d.fromOnboarding){console.log("ProfileCheck: Just completed onboarding, skipping check"),a.current=!0,i(!1);return}if(!t){console.log("ProfileCheck: No authenticated user found - user needs to sign in"),console.log("ProfileCheck: Redirecting to auth page"),a.current=!0,i(!1);return}try{const u=Ze.getState().user;if(u){const h=u.name&&u.email,m=u.id&&u.email;if(console.log("ProfileCheck: Profile check",{hasRequiredData:h,hasBasicProfile:m,name:u.name,email:u.email,id:u.id}),m){console.log("ProfileCheck: User has basic profile, allowing access"),a.current=!0,i(!1);return}if(!h){if(console.log("ProfileCheck: App user data incomplete, checking if we should redirect to onboarding"),window.location.pathname!=="/onboarding"){console.log("ProfileCheck: Redirecting to onboarding"),a.current=!0,i(!1),e("/onboarding",{replace:!0,state:{fromProfileCheck:!0}});return}else console.log("ProfileCheck: Already on onboarding page, not redirecting");a.current=!0,i(!1);return}}else{console.log("ProfileCheck: Loading user profile from Supabase");const h=G.getUserProfile(t.id),m=new Promise((w,v)=>{o.current=setTimeout(()=>{v(new Error("Profile check timeout"))},Ht.get("profileCheckTimeout"))}),p=await Promise.race([h,m]);if(o.current&&(clearTimeout(o.current),o.current=null),console.log("ProfileCheck: Loaded user profile",p),!p){console.log("ProfileCheck: Profile missing, redirecting to onboarding"),a.current=!0,i(!1),e("/onboarding",{replace:!0});return}if(p?.id&&p?.email){console.log("ProfileCheck: User has basic data, allowing access"),a.current=!0,i(!1);return}if(!p.name&&!p.username){console.log("ProfileCheck: Profile incomplete (no name or username), redirecting to onboarding"),a.current=!0,i(!1),e("/onboarding",{replace:!0});return}}}catch(u){console.error("ProfileCheck: Error checking profile:",u),a.current=!0,i(!1);return}console.log("ProfileCheck: Profile check complete, rendering children"),a.current=!0,i(!1)},100);return()=>{clearTimeout(c),o.current&&clearTimeout(o.current)}},[t?.id,e]),f.useEffect(()=>{const l=setTimeout(()=>{n&&(console.warn(`ProfileCheck: Force timeout after ${Ht.get("profileForceTimeout")}ms`),a.current=!0,i(!1))},Ht.get("profileForceTimeout"));return()=>clearTimeout(l)},[n]),n?y.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:y.jsx(qs,{size:"lg",text:"Getting ready..."})}):y.jsx(y.Fragment,{children:r||null})}const Kh=Si("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Cs({className:r,variant:e,asChild:t=!1,...s}){const n=t?ii:"span";return y.jsx(n,{"data-slot":"badge",className:$e(Kh({variant:e}),r),...s})}var _a={exports:{}},xa={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rt=f;function Jh(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Qh=typeof Object.is=="function"?Object.is:Jh,Yh=Rt.useState,Xh=Rt.useEffect,Zh=Rt.useLayoutEffect,ef=Rt.useDebugValue;function tf(r,e){var t=e(),s=Yh({inst:{value:t,getSnapshot:e}}),n=s[0].inst,i=s[1];return Zh(function(){n.value=t,n.getSnapshot=e,es(n)&&i({inst:n})},[r,t,e]),Xh(function(){return es(n)&&i({inst:n}),r(function(){es(n)&&i({inst:n})})},[r]),ef(t),t}function es(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!Qh(r,t)}catch{return!0}}function rf(r,e){return e()}var sf=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rf:tf;xa.useSyncExternalStore=Rt.useSyncExternalStore!==void 0?Rt.useSyncExternalStore:sf;_a.exports=xa;var nf=_a.exports;function af(){return nf.useSyncExternalStore(of,()=>!0,()=>!1)}function of(){return()=>{}}var Qs="Avatar",[lf,jm]=Za(Qs),[cf,ka]=lf(Qs),Sa=f.forwardRef((r,e)=>{const{__scopeAvatar:t,...s}=r,[n,i]=f.useState("idle");return y.jsx(cf,{scope:t,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:y.jsx(Is.span,{...s,ref:e})})});Sa.displayName=Qs;var Ea="AvatarImage",Ta=f.forwardRef((r,e)=>{const{__scopeAvatar:t,src:s,onLoadingStatusChange:n=()=>{},...i}=r,a=ka(Ea,t),o=uf(s,i),l=eo(c=>{n(c),a.onImageLoadingStatusChange(c)});return ts(()=>{o!=="idle"&&l(o)},[o,l]),o==="loaded"?y.jsx(Is.img,{...i,ref:e,src:s}):null});Ta.displayName=Ea;var Pa="AvatarFallback",Ca=f.forwardRef((r,e)=>{const{__scopeAvatar:t,delayMs:s,...n}=r,i=ka(Pa,t),[a,o]=f.useState(s===void 0);return f.useEffect(()=>{if(s!==void 0){const l=window.setTimeout(()=>o(!0),s);return()=>window.clearTimeout(l)}},[s]),a&&i.imageLoadingStatus!=="loaded"?y.jsx(Is.span,{...n,ref:e}):null});Ca.displayName=Pa;function Yn(r,e){return r?e?(r.src!==e&&(r.src=e),r.complete&&r.naturalWidth>0?"loaded":"loading"):"error":"idle"}function uf(r,{referrerPolicy:e,crossOrigin:t}){const s=af(),n=f.useRef(null),i=s?(n.current||(n.current=new window.Image),n.current):null,[a,o]=f.useState(()=>Yn(i,r));return ts(()=>{o(Yn(i,r))},[i,r]),ts(()=>{const l=u=>()=>{o(u)};if(!i)return;const c=l("loaded"),d=l("error");return i.addEventListener("load",c),i.addEventListener("error",d),e&&(i.referrerPolicy=e),typeof t=="string"&&(i.crossOrigin=t),()=>{i.removeEventListener("load",c),i.removeEventListener("error",d)}},[i,t,e]),a}var df=Sa,hf=Ta,ff=Ca;function Ra({className:r,...e}){return y.jsx(df,{"data-slot":"avatar",className:$e("relative flex size-10 shrink-0 overflow-hidden rounded-full",r),...e})}function Aa({className:r,...e}){return y.jsx(hf,{"data-slot":"avatar-image",className:$e("aspect-square size-full",r),...e})}function Oa({className:r,...e}){return y.jsx(ff,{"data-slot":"avatar-fallback",className:$e("bg-muted flex size-full items-center justify-center rounded-full",r),...e})}const mf={sm:"size-6",md:"size-8",lg:"size-10",xl:"size-12"};function pf({userId:r,src:e,alt:t,fallback:s,size:n="md",className:i,onClick:a,disabled:o=!1}){const l=ut(),c=u=>{u.stopPropagation(),a?a():r&&!o&&l(`/user/${r}`)},d=u=>u?u.split(" ").map(h=>h.charAt(0)).join("").toUpperCase().slice(0,2):"?";return y.jsxs(Ra,{className:$e(mf[n],(r||a)&&!o&&"cursor-pointer hover:ring-2 hover:ring-primary/20 transition-all",o&&"opacity-50 cursor-not-allowed",i),onClick:c,children:[e&&y.jsx(Aa,{src:e,alt:t||"User avatar"}),y.jsx(Oa,{className:"bg-primary/10 text-primary font-medium",children:s||d(t)})]})}function ja(){const[r,e]=f.useState([]),[t,s]=f.useState({pushNotifications:!0,emailNotifications:!1,gameReminders:!0,messageNotifications:!0,soundEnabled:!0});f.useEffect(()=>{(async()=>{try{const p=await G.getNotifications();e(p)}catch(p){console.error("Error loading notifications:",p)}})()},[]),f.useEffect(()=>{let m=null;return(async()=>{m=await G.subscribeToNotifications(g=>{e(w=>[g,...w]),t.pushNotifications&&n(g)})})(),()=>{m?.unsubscribe&&m.unsubscribe()}},[t.pushNotifications]);const n=f.useCallback(m=>{if(!t.pushNotifications)return;t.soundEnabled&&console.log("ðŸ”Š Notification sound played"),["new_message","game_reminder","join_request"].includes(m.type)?"Notification"in window&&Notification.permission==="granted"&&["new_message","game_reminder"].includes(m.type)?new Notification(m.title,{body:m.message,icon:"/favicon.ico",badge:"/favicon.ico",timestamp:m.timestamp.getTime(),silent:!1}):Xe(m.title,{description:m.message,action:m.actionUrl?{label:"View",onClick:()=>{console.log("Navigate to:",m.actionUrl)}}:void 0,duration:4e3}):Xe(m.title,{description:m.message,duration:3e3})},[t.pushNotifications,t.soundEnabled]),i=f.useCallback(async m=>{try{await G.markNotificationAsRead(m),e(p=>p.map(g=>g.id===m?{...g,read:!0}:g))}catch(p){console.error("Error marking notification as read:",p)}},[]),a=f.useCallback(async()=>{try{const m=r.filter(p=>!p.read);await Promise.all(m.map(p=>G.markNotificationAsRead(p.id))),e(p=>p.map(g=>({...g,read:!0})))}catch(m){console.error("Error marking all notifications as read:",m)}},[r]),o=f.useCallback(async m=>{try{await G.deleteNotification(m),e(p=>p.filter(g=>g.id!==m))}catch(p){console.error("Error deleting notification:",p)}},[]),l=f.useCallback(async()=>{try{await G.clearAllNotifications(),e([])}catch(m){console.error("Error clearing all notifications:",m)}},[]),c=f.useCallback(async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?(console.log("Notifications are blocked by user"),!1):await Notification.requestPermission()==="granted"?(Xe.success("Notifications enabled!"),!0):(console.log("Notification permission denied by user"),!1):(console.log("Browser notifications not supported"),!1),[]),d=f.useCallback(m=>{s(p=>({...p,...m})),m.pushNotifications&&!t.pushNotifications&&c()},[t.pushNotifications,c]),u=r.filter(m=>!m.read).length;return{notifications:r.slice(0,10),unreadCount:u,settings:t,markAsRead:i,markAllAsRead:a,deleteNotification:o,clearAll:l,updateSettings:d,requestPermission:c}}const gf=[{path:"/",icon:Li,label:"Home"},{path:"/search",icon:Mi,label:"Search"},{path:"/create",icon:Di,label:"Create"},{path:"/notifications",icon:Ui,label:"Notifications",showBadge:!0},{path:"/profile",icon:Fi,label:"Profile"}],Ia=f.forwardRef((r,e)=>{const t=ut(),s=me(),{unreadCount:n}=ja(),{user:i}=Ze();return y.jsxs("div",{ref:e,className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t border-border",children:[y.jsx("div",{className:"flex items-center justify-between px-4 py-2 max-w-lg mx-auto",children:gf.map(a=>{const o=s.pathname===a.path,l=a.icon;return y.jsx("div",{className:"relative flex-1 flex justify-center",children:y.jsxs(Et,{variant:"ghost",onClick:()=>t(a.path),className:`flex flex-col items-center gap-1 p-2 h-auto w-full transition-all duration-200 ${o?"text-primary":"text-muted-foreground hover:text-foreground"}`,"aria-label":`Navigate to ${a.label}`,"aria-current":o?"page":void 0,children:[y.jsxs("div",{className:"relative",children:[a.path==="/profile"&&i?y.jsx(pf,{src:i.avatar,alt:i.name,size:"sm",onClick:()=>t("/profile"),className:"w-5 h-5"}):y.jsx(l,{className:"w-5 h-5"}),a.showBadge&&n>0&&y.jsx(Cs,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 text-xs flex items-center justify-center min-w-[20px]",children:n>99?"99+":n})]}),y.jsx("span",{className:"text-xs font-medium",children:a.label}),o&&y.jsx("div",{className:"absolute -top-1 left-1/2 w-1 h-1 bg-primary rounded-full transition-all duration-200",style:{transform:"translateX(-50%)"}})]})},a.path)})}),y.jsx("div",{className:"pb-safe bg-background/95"})]})});Ia.displayName="BottomNavigation";const yf=[{path:"/",icon:Li,label:"Home",description:"Discover games"},{path:"/search",icon:Mi,label:"Search",description:"Find your game"},{path:"/notifications",icon:Ui,label:"Notifications",description:"Stay updated",showBadge:!0},{path:"/profile",icon:Fi,label:"Profile",description:"Your account"}];function vf({children:r}){const e=ut(),t=me(),{unreadCount:s}=ja(),{user:n}=Ze(),[i,a]=f.useState(!1);return y.jsxs("div",{className:"flex h-screen bg-background",children:[y.jsxs("aside",{className:`bg-card border-r border-border transition-all duration-300 ${i?"w-16":"w-64"}`,children:[y.jsx("div",{className:"p-6 border-b border-border",children:y.jsxs("div",{className:"flex items-center justify-between",children:[!i&&y.jsxs("div",{children:[y.jsx("h1",{className:"text-xl text-foreground",children:"TribeUp"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Find your tribe"})]}),y.jsx(Et,{variant:"ghost",size:"icon",onClick:()=>a(!i),"aria-label":i?"Expand sidebar":"Collapse sidebar",children:y.jsx(Tc,{className:"w-5 h-5"})})]})}),y.jsx("div",{className:"p-4",children:y.jsxs(Et,{onClick:()=>e("/create"),className:"w-full justify-start gap-3","aria-label":"Create new game",children:[y.jsx(Di,{className:"w-5 h-5"}),!i&&"Create Game"]})}),y.jsx("nav",{className:"flex-1 px-4 space-y-2",role:"menubar",children:yf.map(o=>{const l=t.pathname===o.path,c=o.icon;return y.jsx("div",{children:y.jsxs(Et,{variant:l?"default":"ghost",onClick:()=>e(o.path),className:`w-full justify-start gap-3 h-12 relative ${i?"px-2":"px-4"}`,role:"menuitem","aria-current":l?"page":void 0,title:i?o.label:void 0,children:[y.jsxs("div",{className:"relative",children:[y.jsx(c,{className:"w-5 h-5 flex-shrink-0"}),o.showBadge&&s>0&&y.jsx(Cs,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 min-w-4 p-0 text-xs flex items-center justify-center",children:s>99?"99+":s})]}),!i&&y.jsxs("div",{className:"flex-1 text-left",children:[y.jsxs("div",{className:"font-medium flex items-center gap-2",children:[o.label,o.showBadge&&s>0&&y.jsx(Cs,{variant:"destructive",className:"h-5 px-2 text-xs",children:s>99?"99+":s})]}),y.jsx("div",{className:"text-xs text-muted-foreground",children:o.description})]})]})},o.path)})}),y.jsx("div",{className:"p-4 border-t border-border",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs(Ra,{className:"cursor-pointer",onClick:()=>e("/profile"),children:[n?.avatar&&y.jsx(Aa,{src:n.avatar,alt:n.name||"User"}),y.jsx(Oa,{children:n?.name?.charAt(0)||"U"})]}),!i&&y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("p",{className:"text-sm font-medium truncate",children:n?.name||"User"}),y.jsx("p",{className:"text-xs text-muted-foreground truncate",children:n?.email||"user@example.com"})]})]})})]}),y.jsx("main",{className:"flex-1 overflow-hidden",children:r})]})}function wf(){const r=Ze(o=>o.user),e=Ze(o=>o.updateUserPreferences),t=f.useCallback((o,l="polite")=>{let c=document.getElementById("live-region");c?c.setAttribute("aria-live",l):(c=document.createElement("div"),c.id="live-region",c.setAttribute("aria-live",l),c.setAttribute("aria-atomic","true"),c.className="sr-only",document.body.appendChild(c)),c.textContent="",setTimeout(()=>{c&&(c.textContent=o)},100),setTimeout(()=>{c&&c.textContent===o&&(c.textContent="")},5e3)},[]),s=f.useCallback(o=>{const l=document.documentElement;if(l.classList.remove("light","dark"),o.theme==="dark")l.classList.add("dark");else if(o.theme==="light")l.classList.add("light");else{const c=window.matchMedia("(prefers-color-scheme: dark)").matches;l.classList.toggle("dark",c),l.classList.toggle("light",!c)}l.classList.toggle("high-contrast",o.highContrast),l.classList.toggle("large-text",o.largeText),l.classList.toggle("colorblind-friendly",o.colorBlindFriendly),o.reducedMotion?(l.style.setProperty("--duration-fast","0ms"),l.style.setProperty("--duration-normal","0ms"),l.style.setProperty("--duration-slow","0ms")):(l.style.removeProperty("--duration-fast"),l.style.removeProperty("--duration-normal"),l.style.removeProperty("--duration-slow"))},[]);f.useEffect(()=>{if(r?.preferences)s({theme:r.preferences.theme,highContrast:r.preferences.highContrast,largeText:r.preferences.largeText,reducedMotion:r.preferences.reducedMotion,colorBlindFriendly:r.preferences.colorBlindFriendly});else{const o=document.documentElement;window.matchMedia("(prefers-color-scheme: dark)").matches&&o.classList.add("dark"),window.matchMedia("(prefers-contrast: high)").matches&&o.classList.add("high-contrast"),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(o.style.setProperty("--duration-fast","0ms"),o.style.setProperty("--duration-normal","0ms"),o.style.setProperty("--duration-slow","0ms"))}},[r?.preferences,s]);const n=f.useCallback(o=>{if(r){const l={...r.preferences,...o};e(l),s({theme:l.theme,highContrast:l.highContrast,largeText:l.largeText,reducedMotion:l.reducedMotion,colorBlindFriendly:l.colorBlindFriendly})}},[r,e,s]),i=f.useCallback(o=>{o&&(o.focus(),t(`Focused on ${o.getAttribute("aria-label")||o.textContent||"element"}`))},[t]),a=f.useCallback(o=>{const l=o.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),c=l[0],d=l[l.length-1],u=h=>{h.key==="Tab"&&(h.shiftKey?document.activeElement===c&&(h.preventDefault(),d.focus()):document.activeElement===d&&(h.preventDefault(),c.focus()))};return o.addEventListener("keydown",u),c?.focus(),()=>{o.removeEventListener("keydown",u)}},[]);return{preferences:r?.preferences,updatePreferences:n,applyPreferences:s,announceToScreenReader:t,focusElement:i,trapFocus:a}}function bf(){const[r,e]=f.useState(!1);return f.useEffect(()=>{const t=()=>{e(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),{isMobile:r}}function _f(){const{isMobile:r}=bf(),e=me(),{announceToScreenReader:t}=wf(),[s,n]=k.useState(!1),i=f.useRef(null),[a,o]=f.useState(0);if(k.useEffect(()=>{const l=e.state||window.history.state?.usr||{};console.log("AppContent: Current location state:",l),l.fromOnboarding&&!s&&(console.log("AppContent: Detected navigation from onboarding, marking as complete"),n(!0),window.history.replaceState({...window.history.state,usr:{...window.history.state?.usr,fromOnboarding:!1}},""))},[e.state,s]),k.useEffect(()=>{const c=(d=>d==="/"?"Home":d==="/search"?"Search":d==="/create"?"Create Game":d==="/profile"?"Profile":d.startsWith("/game/")?"Game Details":d.startsWith("/chat/")?"Chat":d.startsWith("/user/")?"User Profile":d.startsWith("/settings")?"Settings":"Page")(e.pathname);t(`Navigated to ${c}`),document.title=`${c} - TribeUp`},[e.pathname,t]),f.useEffect(()=>{const l=()=>{if(i.current){const c=i.current.offsetHeight;o(c)}};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),r){const l=e.pathname==="/create";return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"min-h-screen bg-background",children:[y.jsx("main",{style:{paddingBottom:l?"0px":`${a+16}px`},children:y.jsx(pn,{})}),!l&&y.jsx(Ia,{ref:i})]})})}return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"min-h-screen bg-background",children:y.jsx(vf,{children:y.jsx("main",{id:"main-content",className:"flex-1 overflow-hidden",children:y.jsx(pn,{})})})}),y.jsx(Hh,{position:"bottom-right",theme:"system",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{className:"animate-slide-in-down"}})]})}const xf=f.lazy(()=>V(()=>import("./HomeScreen-BAZHUiRZ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),kf=f.lazy(()=>V(()=>import("./SearchDiscovery-BksIq8AI.js"),__vite__mapDeps([13,1,2,14,3,4,5,6,7,8,9,10,11,15]))),Sf=f.lazy(()=>V(()=>import("./CreateGame-DferleHj.js"),__vite__mapDeps([16,1,2,17,14,18,19,20,21,15,10,22,23]))),Ef=f.lazy(()=>V(()=>import("./UserProfile-DNwm-n6Z.js"),__vite__mapDeps([24,1,2,25,26,4,27,28,29,17,30,8,9,10,31]))),Tf=f.lazy(()=>V(()=>import("./EditProfile-DuTkFPsn.js"),__vite__mapDeps([32,1,2,14,18,26,4,15,33]))),Pf=f.lazy(()=>V(()=>import("./GameDetails-tEiuyAZx.js"),__vite__mapDeps([34,1,2,35,19,33,14,18,6,3,4,7,36,37,10,9,11,38,27,28,23,29,8,15,39,40,41]))),Cf=f.lazy(()=>V(()=>import("./OtherUserProfile-X4lLI1EG.js"),__vite__mapDeps([42,1,2,35,26,4,15,39,41,43,10,29,28,11,9]))),Rf=f.lazy(()=>V(()=>import("./NotificationCenter-CY8Pe3nr.js"),__vite__mapDeps([44,1,2,9,38,23,36,15,31,40,21,11]))),Af=f.lazy(()=>V(()=>import("./Settings-1LxXK3_5.js"),__vite__mapDeps([45,1,2,46,20,21,35,19,31,47,15,43,48]))),Of=f.lazy(()=>V(()=>import("./AccessibilitySettings-CEOoZXT2.js"),__vite__mapDeps([49,1,2,46,20,21,35,15,48,50,30,11]))),jf=f.lazy(()=>V(()=>import("./NotificationSettings-Cd-UPcQs.js"),__vite__mapDeps([51,1,2,46,19,52,38,9,11,37,28,23]))),If=f.lazy(()=>V(()=>import("./DesignSystem-ChnOdYDB.js"),__vite__mapDeps([53,1,2,14,19,25,46,21,17,12,15,39,23,22,52,31,50,29,28,9,10,11]))),$f=f.lazy(()=>V(()=>import("./AdminDashboard-C6uDUTrP.js"),__vite__mapDeps([54,1,2,18,4,3,43,15,11,9,50,40]))),Nf=f.lazy(()=>V(()=>import("./AuthCallback-GlyeEK3Q.js"),__vite__mapDeps([55,1,2,19,23,52]))),Uf=f.lazy(()=>V(()=>import("./Onboarding-Bh7bmmNJ.js"),__vite__mapDeps([56,1,2,14,17,6,11,9,28,21,10]))),Lf=f.lazy(()=>V(()=>import("./NavigationTest-CJcXdDfs.js"),__vite__mapDeps([57,1,2,15,31,47,38,23]))),Df=f.lazy(()=>V(()=>import("./Auth-BuLi3Bel.js"),__vite__mapDeps([58,1,2,14,19]))),fr=({text:r="Loading..."})=>y.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:y.jsx(qs,{size:"lg",text:r})}),Mf=({children:r})=>y.jsx("div",{className:"min-h-screen bg-background",children:r});function Ff(){return y.jsx(xl,{children:y.jsx(Bi,{children:y.jsx(Mf,{children:y.jsx(f.Suspense,{fallback:y.jsx(fr,{text:"Loading application..."}),children:y.jsxs(Xo,{children:[y.jsxs(K,{path:"/",element:y.jsx(Qn,{children:y.jsx(Vh,{children:y.jsx(_f,{})})}),children:[y.jsx(K,{index:!0,element:y.jsx(xf,{})}),y.jsx(K,{path:"search",element:y.jsx(kf,{})}),y.jsx(K,{path:"create",element:y.jsx(Sf,{})}),y.jsx(K,{path:"profile",element:y.jsx(Ef,{})}),y.jsx(K,{path:"profile/edit",element:y.jsx(Tf,{})}),y.jsx(K,{path:"game/:gameId",element:y.jsx(Pf,{})}),y.jsx(K,{path:"user/:userId",element:y.jsx(Cf,{})}),y.jsx(K,{path:"notifications",element:y.jsx(Rf,{})}),y.jsx(K,{path:"settings",element:y.jsx(Af,{})}),y.jsx(K,{path:"settings/accessibility",element:y.jsx(Of,{})}),y.jsx(K,{path:"settings/notifications",element:y.jsx(jf,{})}),y.jsx(K,{path:"admin",element:y.jsx($f,{})}),y.jsx(K,{path:"design",element:y.jsx(If,{onBack:()=>{}})}),y.jsx(K,{path:"navigation-test",element:y.jsx(Lf,{})})]}),y.jsx(K,{path:"/auth",element:y.jsx(Qn,{requireAuth:!1,children:y.jsx(f.Suspense,{fallback:y.jsx(fr,{text:"Loading authentication..."}),children:y.jsx(Df,{})})})}),y.jsx(K,{path:"/auth/callback",element:y.jsx(f.Suspense,{fallback:y.jsx(fr,{text:"Processing authentication..."}),children:y.jsx(Nf,{})})}),y.jsx(K,{path:"onboarding",element:y.jsx(f.Suspense,{fallback:y.jsx(fr,{text:"Loading onboarding..."}),children:y.jsx(Uf,{onComplete:()=>{}})})}),y.jsx(K,{path:"*",element:y.jsx(ss,{to:"/",replace:!0})})]})})})})})}var Nr=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Bf={setTimeout:(r,e)=>setTimeout(r,e),clearTimeout:r=>clearTimeout(r),setInterval:(r,e)=>setInterval(r,e),clearInterval:r=>clearInterval(r)},qf=class{#e=Bf;#t=!1;setTimeoutProvider(r){this.#e=r}setTimeout(r,e){return this.#e.setTimeout(r,e)}clearTimeout(r){this.#e.clearTimeout(r)}setInterval(r,e){return this.#e.setInterval(r,e)}clearInterval(r){this.#e.clearInterval(r)}},Rs=new qf;function zf(r){setTimeout(r,0)}var Ur=typeof window>"u"||"Deno"in globalThis;function Ee(){}function Wf(r,e){return typeof r=="function"?r(e):r}function Hf(r){return typeof r=="number"&&r>=0&&r!==1/0}function Gf(r,e){return Math.max(r+(e||0)-Date.now(),0)}function As(r,e){return typeof r=="function"?r(e):r}function Vf(r,e){return typeof r=="function"?r(e):r}function Xn(r,e){const{type:t="all",exact:s,fetchStatus:n,predicate:i,queryKey:a,stale:o}=r;if(a){if(s){if(e.queryHash!==Ys(a,e.options))return!1}else if(!Yt(e.queryKey,a))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||n&&n!==e.state.fetchStatus||i&&!i(e))}function Zn(r,e){const{exact:t,status:s,predicate:n,mutationKey:i}=r;if(i){if(!e.options.mutationKey)return!1;if(t){if(Qt(e.options.mutationKey)!==Qt(i))return!1}else if(!Yt(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||n&&!n(e))}function Ys(r,e){return(e?.queryKeyHashFn||Qt)(r)}function Qt(r){return JSON.stringify(r,(e,t)=>Os(t)?Object.keys(t).sort().reduce((s,n)=>(s[n]=t[n],s),{}):t)}function Yt(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?Object.keys(e).every(t=>Yt(r[t],e[t])):!1}var Kf=Object.prototype.hasOwnProperty;function $a(r,e){if(r===e)return r;const t=ei(r)&&ei(e);if(!t&&!(Os(r)&&Os(e)))return e;const n=(t?r:Object.keys(r)).length,i=t?e:Object.keys(e),a=i.length,o=t?new Array(a):{};let l=0;for(let c=0;c<a;c++){const d=t?c:i[c],u=r[d],h=e[d];if(u===h){o[d]=u,(t?c<n:Kf.call(r,d))&&l++;continue}if(u===null||h===null||typeof u!="object"||typeof h!="object"){o[d]=h;continue}const m=$a(u,h);o[d]=m,m===u&&l++}return n===a&&l===n?r:o}function Im(r,e){if(!e||Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function ei(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Os(r){if(!ti(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!ti(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function ti(r){return Object.prototype.toString.call(r)==="[object Object]"}function Jf(r){return new Promise(e=>{Rs.setTimeout(e,r)})}function Qf(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?$a(r,e):e}function Yf(r,e,t=0){const s=[...r,e];return t&&s.length>t?s.slice(1):s}function Xf(r,e,t=0){const s=[e,...r];return t&&s.length>t?s.slice(0,-1):s}var Xs=Symbol();function Na(r,e){return!r.queryFn&&e?.initialPromise?()=>e.initialPromise:!r.queryFn||r.queryFn===Xs?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function $m(r,e){return typeof r=="function"?r(...e):!!r}var Zf=class extends Nr{#e;#t;#r;constructor(){super(),this.#r=r=>{if(!Ur&&window.addEventListener){const e=()=>r();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#r=r,this.#t?.(),this.#t=r(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(r){this.#e!==r&&(this.#e=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(e=>{e(r)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Ua=new Zf;function em(){let r,e;const t=new Promise((n,i)=>{r=n,e=i});t.status="pending",t.catch(()=>{});function s(n){Object.assign(t,n),delete t.resolve,delete t.reject}return t.resolve=n=>{s({status:"fulfilled",value:n}),r(n)},t.reject=n=>{s({status:"rejected",reason:n}),e(n)},t}var tm=zf;function rm(){let r=[],e=0,t=o=>{o()},s=o=>{o()},n=tm;const i=o=>{e?r.push(o):n(()=>{t(o)})},a=()=>{const o=r;r=[],o.length&&n(()=>{s(()=>{o.forEach(l=>{t(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{i(()=>{o(...l)})},schedule:i,setNotifyFunction:o=>{t=o},setBatchNotifyFunction:o=>{s=o},setScheduler:o=>{n=o}}}var ne=rm(),sm=class extends Nr{#e=!0;#t;#r;constructor(){super(),this.#r=r=>{if(!Ur&&window.addEventListener){const e=()=>r(!0),t=()=>r(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#r=r,this.#t?.(),this.#t=r(this.setOnline.bind(this))}setOnline(r){this.#e!==r&&(this.#e=r,this.listeners.forEach(t=>{t(r)}))}isOnline(){return this.#e}},kr=new sm;function nm(r){return Math.min(1e3*2**r,3e4)}function La(r){return(r??"online")==="online"?kr.isOnline():!0}var js=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function Da(r){let e=!1,t=0,s;const n=em(),i=()=>n.status!=="pending",a=g=>{if(!i()){const w=new js(g);h(w),r.onCancel?.(w)}},o=()=>{e=!0},l=()=>{e=!1},c=()=>Ua.isFocused()&&(r.networkMode==="always"||kr.isOnline())&&r.canRun(),d=()=>La(r.networkMode)&&r.canRun(),u=g=>{i()||(s?.(),n.resolve(g))},h=g=>{i()||(s?.(),n.reject(g))},m=()=>new Promise(g=>{s=w=>{(i()||c())&&g(w)},r.onPause?.()}).then(()=>{s=void 0,i()||r.onContinue?.()}),p=()=>{if(i())return;let g;const w=t===0?r.initialPromise:void 0;try{g=w??r.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(u).catch(v=>{if(i())return;const b=r.retry??(Ur?0:3),_=r.retryDelay??nm,S=typeof _=="function"?_(t,v):_,O=b===!0||typeof b=="number"&&t<b||typeof b=="function"&&b(t,v);if(e||!O){h(v);return}t++,r.onFail?.(t,v),Jf(S).then(()=>c()?void 0:m()).then(()=>{e?h(v):p()})})};return{promise:n,status:()=>n.status,cancel:a,continue:()=>(s?.(),n),cancelRetry:o,continueRetry:l,canStart:d,start:()=>(d()?p():m().then(p),n)}}var Ma=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hf(this.gcTime)&&(this.#e=Rs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Ur?1/0:5*60*1e3))}clearGcTimeout(){this.#e&&(Rs.clearTimeout(this.#e),this.#e=void 0)}},im=class extends Ma{#e;#t;#r;#n;#s;#a;#o;constructor(r){super(),this.#o=!1,this.#a=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#n=r.client,this.#r=this.#n.getQueryCache(),this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#e=ri(this.options),this.state=r.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(r){if(this.options={...this.#a,...r},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=ri(this.options);e.data!==void 0&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(r,e){const t=Qf(this.state.data,r,this.options);return this.#i({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(r,e){this.#i({type:"setState",state:r,setStateOptions:e})}cancel(r){const e=this.#s?.promise;return this.#s?.cancel(r),e?e.then(Ee).catch(Ee):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(r=>Vf(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xs||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>As(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!Gf(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(e=>e!==r),this.observers.length||(this.#s&&(this.#o?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(r,e){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(r&&this.setOptions(r),!this.options.queryFn){const o=this.observers.find(l=>l.options.queryFn);o&&this.setOptions(o.options)}const t=new AbortController,s=o=>{Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(this.#o=!0,t.signal)})},n=()=>{const o=Na(this.options,e),c=(()=>{const d={client:this.#n,queryKey:this.queryKey,meta:this.meta};return s(d),d})();return this.#o=!1,this.options.persister?this.options.persister(o,c,this):o(c)},a=(()=>{const o={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:n};return s(o),o})();this.options.behavior?.onFetch(a,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==a.fetchOptions?.meta)&&this.#i({type:"fetch",meta:a.fetchOptions?.meta}),this.#s=Da({initialPromise:e?.initialPromise,fn:a.fetchFn,onCancel:o=>{o instanceof js&&o.revert&&this.setState({...this.#t,fetchStatus:"idle"}),t.abort()},onFail:(o,l)=>{this.#i({type:"failed",failureCount:o,error:l})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0});try{const o=await this.#s.start();if(o===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(o),this.#r.config.onSuccess?.(o,this),this.#r.config.onSettled?.(o,this.state.error,this),o}catch(o){if(o instanceof js){if(o.silent)return this.#s.promise;if(o.revert){if(this.state.data===void 0)throw o;return this.state.data}}throw this.#i({type:"error",error:o}),this.#r.config.onError?.(o,this),this.#r.config.onSettled?.(this.state.data,o,this),o}finally{this.scheduleGc()}}#i(r){const e=t=>{switch(r.type){case"failed":return{...t,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...am(t.data,this.options),fetchMeta:r.meta??null};case"success":const s={...t,data:r.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=r.manual?s:void 0,s;case"error":const n=r.error;return{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...r.state}}};this.state=e(this.state),ne.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:r})})}};function am(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:La(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function ri(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,s=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}function si(r){return{onFetch:(e,t)=>{const s=e.options,n=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let d=!1;const u=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(e.signal.aborted?d=!0:e.signal.addEventListener("abort",()=>{d=!0}),e.signal)})},h=Na(e.options,e.fetchOptions),m=async(p,g,w)=>{if(d)return Promise.reject();if(g==null&&p.pages.length)return Promise.resolve(p);const b=(()=>{const R={client:e.client,queryKey:e.queryKey,pageParam:g,direction:w?"backward":"forward",meta:e.options.meta};return u(R),R})(),_=await h(b),{maxPages:S}=e.options,O=w?Xf:Yf;return{pages:O(p.pages,_,S),pageParams:O(p.pageParams,g,S)}};if(n&&i.length){const p=n==="backward",g=p?om:ni,w={pages:i,pageParams:a},v=g(s,w);o=await m(w,v,p)}else{const p=r??i.length;do{const g=l===0?a[0]??s.initialPageParam:ni(s,o);if(l>0&&g==null)break;o=await m(o,g),l++}while(l<p)}return o};e.options.persister?e.fetchFn=()=>e.options.persister?.(c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=c}}}function ni(r,{pages:e,pageParams:t}){const s=e.length-1;return e.length>0?r.getNextPageParam(e[s],e,t[s],t):void 0}function om(r,{pages:e,pageParams:t}){return e.length>0?r.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var lm=class extends Ma{#e;#t;#r;constructor(r){super(),this.mutationId=r.mutationId,this.#t=r.mutationCache,this.#e=[],this.state=r.state||cm(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#e.includes(r)||(this.#e.push(r),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#e=this.#e.filter(e=>e!==r),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(r){const e=()=>{this.#n({type:"continue"})};this.#r=Da({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(n,i)=>{this.#n({type:"failed",failureCount:n,error:i})},onPause:()=>{this.#n({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const t=this.state.status==="pending",s=!this.#r.canStart();try{if(t)e();else{this.#n({type:"pending",variables:r,isPaused:s}),await this.#t.config.onMutate?.(r,this);const i=await this.options.onMutate?.(r);i!==this.state.context&&this.#n({type:"pending",context:i,variables:r,isPaused:s})}const n=await this.#r.start();return await this.#t.config.onSuccess?.(n,r,this.state.context,this),await this.options.onSuccess?.(n,r,this.state.context),await this.#t.config.onSettled?.(n,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(n,null,r,this.state.context),this.#n({type:"success",data:n}),n}catch(n){try{throw await this.#t.config.onError?.(n,r,this.state.context,this),await this.options.onError?.(n,r,this.state.context),await this.#t.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,n,r,this.state.context),n}finally{this.#n({type:"error",error:n})}}finally{this.#t.runNext(this)}}#n(r){const e=t=>{switch(r.type){case"failed":return{...t,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...t,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:r.error,failureCount:t.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=e(this.state),ne.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(r)}),this.#t.notify({mutation:this,type:"updated",action:r})})}};function cm(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var um=class extends Nr{constructor(r={}){super(),this.config=r,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(r,e,t){const s=new lm({mutationCache:this,mutationId:++this.#r,options:r.defaultMutationOptions(e),state:t});return this.add(s),s}add(r){this.#e.add(r);const e=mr(r);if(typeof e=="string"){const t=this.#t.get(e);t?t.push(r):this.#t.set(e,[r])}this.notify({type:"added",mutation:r})}remove(r){if(this.#e.delete(r)){const e=mr(r);if(typeof e=="string"){const t=this.#t.get(e);if(t)if(t.length>1){const s=t.indexOf(r);s!==-1&&t.splice(s,1)}else t[0]===r&&this.#t.delete(e)}}this.notify({type:"removed",mutation:r})}canRun(r){const e=mr(r);if(typeof e=="string"){const s=this.#t.get(e)?.find(n=>n.state.status==="pending");return!s||s===r}else return!0}runNext(r){const e=mr(r);return typeof e=="string"?this.#t.get(e)?.find(s=>s!==r&&s.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){ne.batch(()=>{this.#e.forEach(r=>{this.notify({type:"removed",mutation:r})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(r){const e={exact:!0,...r};return this.getAll().find(t=>Zn(e,t))}findAll(r={}){return this.getAll().filter(e=>Zn(r,e))}notify(r){ne.batch(()=>{this.listeners.forEach(e=>{e(r)})})}resumePausedMutations(){const r=this.getAll().filter(e=>e.state.isPaused);return ne.batch(()=>Promise.all(r.map(e=>e.continue().catch(Ee))))}};function mr(r){return r.options.scope?.id}var dm=class extends Nr{constructor(r={}){super(),this.config=r,this.#e=new Map}#e;build(r,e,t){const s=e.queryKey,n=e.queryHash??Ys(s,e);let i=this.get(n);return i||(i=new im({client:r,queryKey:s,queryHash:n,options:r.defaultQueryOptions(e),state:t,defaultOptions:r.getQueryDefaults(s)}),this.add(i)),i}add(r){this.#e.has(r.queryHash)||(this.#e.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const e=this.#e.get(r.queryHash);e&&(r.destroy(),e===r&&this.#e.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){ne.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#e.get(r)}getAll(){return[...this.#e.values()]}find(r){const e={exact:!0,...r};return this.getAll().find(t=>Xn(e,t))}findAll(r={}){const e=this.getAll();return Object.keys(r).length>0?e.filter(t=>Xn(r,t)):e}notify(r){ne.batch(()=>{this.listeners.forEach(e=>{e(r)})})}onFocus(){ne.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){ne.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},hm=class{#e;#t;#r;#n;#s;#a;#o;#i;constructor(r={}){this.#e=r.queryCache||new dm,this.#t=r.mutationCache||new um,this.#r=r.defaultOptions||{},this.#n=new Map,this.#s=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Ua.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=kr.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#i?.(),this.#i=void 0)}isFetching(r){return this.#e.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#t.findAll({...r,status:"pending"}).length}getQueryData(r){const e=this.defaultQueryOptions({queryKey:r});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(r){const e=this.defaultQueryOptions(r),t=this.#e.build(this,e),s=t.state.data;return s===void 0?this.fetchQuery(r):(r.revalidateIfStale&&t.isStaleByTime(As(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(r){return this.#e.findAll(r).map(({queryKey:e,state:t})=>{const s=t.data;return[e,s]})}setQueryData(r,e,t){const s=this.defaultQueryOptions({queryKey:r}),i=this.#e.get(s.queryHash)?.state.data,a=Wf(e,i);if(a!==void 0)return this.#e.build(this,s).setData(a,{...t,manual:!0})}setQueriesData(r,e,t){return ne.batch(()=>this.#e.findAll(r).map(({queryKey:s})=>[s,this.setQueryData(s,e,t)]))}getQueryState(r){const e=this.defaultQueryOptions({queryKey:r});return this.#e.get(e.queryHash)?.state}removeQueries(r){const e=this.#e;ne.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=this.#e;return ne.batch(()=>(t.findAll(r).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...r},e)))}cancelQueries(r,e={}){const t={revert:!0,...e},s=ne.batch(()=>this.#e.findAll(r).map(n=>n.cancel(t)));return Promise.all(s).then(Ee).catch(Ee)}invalidateQueries(r,e={}){return ne.batch(()=>(this.#e.findAll(r).forEach(t=>{t.invalidate()}),r?.refetchType==="none"?Promise.resolve():this.refetchQueries({...r,type:r?.refetchType??r?.type??"active"},e)))}refetchQueries(r,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},s=ne.batch(()=>this.#e.findAll(r).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,t);return t.throwOnError||(i=i.catch(Ee)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Ee)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(As(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Ee).catch(Ee)}fetchInfiniteQuery(r){return r.behavior=si(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Ee).catch(Ee)}ensureInfiniteQueryData(r){return r.behavior=si(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return kr.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(r){this.#r=r}setQueryDefaults(r,e){this.#n.set(Qt(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...this.#n.values()],t={};return e.forEach(s=>{Yt(r,s.queryKey)&&Object.assign(t,s.defaultOptions)}),t}setMutationDefaults(r,e){this.#s.set(Qt(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...this.#s.values()],t={};return e.forEach(s=>{Yt(r,s.mutationKey)&&Object.assign(t,s.defaultOptions)}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...this.#r.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=Ys(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Xs&&(e.enabled=!1),e}defaultMutationOptions(r){return r?._defaulted?r:{...this.#r.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Fa=f.createContext(void 0),Nm=r=>{const e=f.useContext(Fa);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},fm=({client:r,children:e})=>(f.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),y.jsx(Fa.Provider,{value:r,children:e}));const mm=new hm({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(r,e)=>e?.status>=400&&e?.status<500?!1:r<3,retryDelay:r=>Math.min(1e3*2**r,3e4)},mutations:{retry:1}}});function pm({children:r}){return y.jsxs(fm,{client:mm,children:[r,!1]})}function gm(){return y.jsx(Bi,{children:y.jsx(pm,{children:y.jsx(Gh,{children:y.jsx(Ff,{})})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(r=>{console.log("SW registered: ",r)}).catch(r=>{console.log("SW registration failed: ",r)})});ai(document.getElementById("root")).render(y.jsx(gm,{}));export{Ra as A,Et as B,fc as C,Vf as D,Im as E,As as F,Ee as G,Li as H,Ur as I,Hf as J,Gf as K,Sc as L,Rs as M,Ua as N,am as O,Di as P,Qf as Q,Rc as R,Mi as S,jc as T,Fi as U,ne as V,Qt as W,cm as X,$m as Y,_m as Z,Si as _,gc as a,Ze as b,ze as c,Cs as d,Ht as e,pf as f,mc as g,pc as h,G as i,$e as j,Aa as k,Oa as l,ba as m,bm as n,Nm as o,Ui as p,ja as q,qs as r,x as s,Xe as t,ut as u,me as v,dc as w,ki as x,Nr as y,em as z};
//# sourceMappingURL=index-Mzv7St__.js.map
