{"version":3,"file":"EditProfile-8pUAGRy9.js","sources":["../../src/components/EditProfile.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Textarea } from './ui/textarea';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { Badge } from './ui/badge';\nimport { ArrowLeft, Save, Upload, X } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { useUpdateUserProfile } from '../hooks/useUserProfile';\nimport { useAppStore } from '../store/appStore';\n\ninterface ProfileFormData {\n  fullName: string;\n  username: string;\n  bio: string;\n  location: string;\n  avatarUrl: string;\n  sportsPreferences: string[];\n}\n\nconst availableSports = [\n  'Basketball', 'Soccer', 'Tennis', 'Volleyball', 'Football', \n  'Baseball', 'Swimming', 'Running', 'Cycling', 'Yoga'\n];\n\nfunction EditProfile() {\n  const navigate = useNavigate();\n  const { user, setUser } = useAppStore();\n  const updateProfileMutation = useUpdateUserProfile();\n  const loading = updateProfileMutation.isPending;\n  const [formData, setFormData] = useState<ProfileFormData>({\n    fullName: '',\n    username: '',\n    bio: '',\n    location: '',\n    avatarUrl: '',\n    sportsPreferences: []\n  });\n  const [usernameError, setUsernameError] = useState(null as string | null);\n  const [checkingUsername, setCheckingUsername] = useState(false);\n  const [selectedFile, setSelectedFile] = useState(null as File | null);\n  const [previewUrl, setPreviewUrl] = useState('');\n  const [avatarError, setAvatarError] = useState(null as string | null);\n  const initialFormRef = React.useRef(null as ProfileFormData | null);\n\n  const BIO_MAX = 200;\n  const USERNAME_REGEX = /^[a-zA-Z0-9._-]{3,20}$/;\n\n  // Load current user data\n  useEffect(() => {\n    const loadUserData = async () => {\n      if (!user) {\n        navigate('/auth');\n        return;\n      }\n\n      try {\n        const userProfile = await SupabaseService.getUserProfile(user.id);\n        if (!userProfile) return;\n        const loaded: ProfileFormData = {\n          fullName: userProfile.name || '',\n          username: userProfile.username || '',\n          bio: userProfile.bio || '',\n          location: userProfile.location || '',\n          avatarUrl: userProfile.avatar || '',\n          sportsPreferences: Array.isArray(userProfile.preferences?.sports) ? userProfile.preferences.sports : []\n        };\n        setFormData(loaded);\n        initialFormRef.current = loaded;\n      } catch (error) {\n        console.error('Error loading user profile:', error);\n        toast.error('Failed to load profile data');\n      }\n    };\n    loadUserData();\n  }, [user, navigate]);\n\n  // Debounced username availability check while typing (top-level)\n  useEffect(() => {\n    let timer: any;\n    const uname = (formData.username || '').trim();\n    if (!uname) {\n      setUsernameError(null);\n      return;\n    }\n    if (!USERNAME_REGEX.test(uname)) {\n      setUsernameError('3-20 chars. Letters, numbers, dot, underscore, or hyphen.');\n      return;\n    }\n    // If unchanged vs current store user, skip\n    if (user?.username && user.username.trim().toLowerCase() === uname.toLowerCase()) {\n      setUsernameError(null);\n      return;\n    }\n    setCheckingUsername(true);\n    timer = setTimeout(async () => {\n      try {\n        const available = await SupabaseService.isUsernameAvailable(uname, user?.id);\n        setUsernameError(available ? null : 'Username is already taken');\n      } catch {\n        setUsernameError('Unable to validate username right now');\n      } finally {\n        setCheckingUsername(false);\n      }\n    }, 450);\n    return () => clearTimeout(timer);\n  }, [formData.username, user]);\n\n  const handleInputChange = (field: keyof ProfileFormData, value: string | string[]) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n    if (field === 'username') {\n      setUsernameError(null);\n    }\n    if (field === 'bio' && typeof value === 'string' && value.length > BIO_MAX) {\n      // hard limit in UI\n      setFormData(prev => ({ ...prev, bio: value.slice(0, BIO_MAX) }));\n    }\n  };\n\n  const handleSportToggle = (sport: string) => {\n    setFormData(prev => ({\n      ...prev,\n      sportsPreferences: prev.sportsPreferences.includes(sport)\n        ? prev.sportsPreferences.filter(s => s !== sport)\n        : [...prev.sportsPreferences, sport]\n    }));\n  };\n\n  const handleUsernameBlur = async () => {\n    if (!user) return;\n    const uname = (formData.username || '').trim();\n    if (!uname) return;\n    // client-side validation rules first\n    if (!USERNAME_REGEX.test(uname)) {\n      setUsernameError('3-20 chars. Letters, numbers, dot, underscore, or hyphen.');\n      return;\n    }\n    if (user.username && user.username.trim().toLowerCase() === uname.toLowerCase()) return;\n    try {\n      setCheckingUsername(true);\n      const available = await SupabaseService.isUsernameAvailable(uname, user.id);\n      if (!available) setUsernameError('Username is already taken');\n    } catch (e) {\n      setUsernameError('Unable to validate username right now');\n    } finally {\n      setCheckingUsername(false);\n    }\n  };\n\n  const handleFileChange = (e: any) => {\n    const file = e.target.files?.[0] || null;\n    setSelectedFile(file);\n    setAvatarError(null);\n    if (file) {\n      const validTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];\n      const maxBytes = 5 * 1024 * 1024; // 5MB\n      if (!validTypes.includes(file.type)) {\n        setAvatarError('Please upload a JPG, PNG, WEBP, or GIF image.');\n        setSelectedFile(null);\n        return;\n      }\n      if (file.size > maxBytes) {\n        setAvatarError('Image is too large. Max size is 5 MB.');\n        setSelectedFile(null);\n        return;\n      }\n      const url = URL.createObjectURL(file);\n      setPreviewUrl(url);\n    } else {\n      setPreviewUrl('');\n    }\n  };\n\n  const handleSave = async () => {\n    console.log('ðŸ”§ Starting profile save...', { user: user?.id, formData });\n    if (!user) {\n      console.error('âŒ No user found for profile save');\n      return;\n    }\n\n    try {\n      // Validate username availability before save\n      const uname = (formData.username || '').trim();\n      if (uname) {\n        if (!USERNAME_REGEX.test(uname)) {\n          setUsernameError('3-20 chars. Letters, numbers, dot, underscore, or hyphen.');\n          return;\n        }\n        const available = await SupabaseService.isUsernameAvailable(uname, user.id);\n        if (!available) {\n          setUsernameError('Username is already taken');\n          return;\n        }\n      }\n\n      // Upload avatar if a file is selected\n      let finalAvatarUrl = formData.avatarUrl;\n      if (selectedFile) {\n        try {\n          finalAvatarUrl = await SupabaseService.uploadAvatar(selectedFile);\n          console.log('Avatar uploaded successfully:', finalAvatarUrl);\n        } catch (avatarError) {\n          console.error('Avatar upload failed:', avatarError);\n          toast.error('Failed to upload profile picture. Profile will be saved without image.');\n          // Continue with profile update even if avatar upload fails\n        }\n      }\n\n      // Use React Query mutation for profile update\n      updateProfileMutation.mutate({\n        userId: user.id,\n        profileData: {\n          full_name: formData.fullName,\n          username: formData.username,\n          bio: formData.bio,\n          location: formData.location,\n          avatar_url: finalAvatarUrl,\n          preferred_sports: formData.sportsPreferences\n        }\n      }, {\n        onSuccess: (updatedProfile) => {\n          console.log('âœ… Profile update successful:', updatedProfile);\n          // Update the user in the store\n          setUser(updatedProfile);\n          navigate('/profile');\n        },\n        onError: (error) => {\n          console.error('âŒ Profile update failed:', error);\n          toast.error('Failed to update profile: ' + error.message);\n        }\n      });\n    } catch (error) {\n      console.error('Error in profile save:', error);\n      toast.error('Failed to validate profile data');\n    }\n  };\n\n  const handleBack = () => {\n    const isDirty = initialFormRef.current && JSON.stringify(initialFormRef.current) !== JSON.stringify(formData);\n    if (isDirty) {\n      const confirmLeave = window.confirm('Discard unsaved changes?');\n      if (!confirmLeave) return;\n    }\n    navigate('/profile');\n  };\n\n  // Warn on browser/tab close if form is dirty\n  useEffect(() => {\n    const isDirty = initialFormRef.current && JSON.stringify(initialFormRef.current) !== JSON.stringify(formData);\n    const beforeUnload = (e: BeforeUnloadEvent) => {\n      if (isDirty) {\n        e.preventDefault();\n        e.returnValue = '';\n      }\n    };\n    window.addEventListener('beforeunload', beforeUnload);\n    return () => window.removeEventListener('beforeunload', beforeUnload);\n  }, [formData]);\n\n  const isDirty = (initialFormRef.current && JSON.stringify(initialFormRef.current) !== JSON.stringify(formData)) || selectedFile !== null;\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl mb-4\">Please sign in</h1>\n          <Button onClick={() => navigate('/auth')}>Sign In</Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 pt-12 pb-6\">\n        <div className=\"flex items-center gap-4\">\n          <Button variant=\"ghost\" size=\"icon\" onClick={handleBack}>\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n          <h1 className=\"text-xl font-semibold\">Edit Profile</h1>\n        </div>\n        <Button \n          onClick={handleSave} \n          disabled={!isDirty || loading || checkingUsername || !!usernameError || !!avatarError || !formData.fullName || !formData.username}\n          className=\"flex items-center gap-2\"\n        >\n          <Save className=\"w-4 h-4\" />\n          {loading ? 'Saving...' : 'Save'}\n        </Button>\n      </div>\n\n      <div className=\"px-4 space-y-6\">\n        {/* Profile Picture */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Profile Picture</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center gap-4\">\n              <Avatar className=\"w-20 h-20\">\n                {(previewUrl || formData.avatarUrl) && (\n                  <AvatarImage src={previewUrl || formData.avatarUrl} alt=\"Avatar preview\" />\n                )}\n                <AvatarFallback className=\"text-xl\">\n                  {formData.fullName ? formData.fullName.charAt(0).toUpperCase() : 'U'}\n                </AvatarFallback>\n              </Avatar>\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-3\">\n                  <Input type=\"file\" accept=\"image/*\" onChange={handleFileChange} />\n                  <Upload className=\"w-4 h-4 text-muted-foreground\" />\n                </div>\n                <p className=\"text-sm text-muted-foreground mt-1\">Upload an image for your avatar</p>\n                {avatarError && (\n                  <p className=\"text-xs text-red-500 mt-1\" role=\"alert\" aria-live=\"polite\">{avatarError}</p>\n                )}\n                {/* Preview now shown inside Avatar above */}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Basic Information */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Basic Information</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Full Name</label>\n              <Input\n                placeholder=\"Enter your full name\"\n                value={formData.fullName}\n                onChange={(e) => handleInputChange('fullName', e.target.value)}\n              />\n            </div>\n            \n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Username <span className=\"text-muted-foreground font-normal\">(3â€“20 chars)</span></label>\n              <Input\n                placeholder=\"Choose a username\"\n                value={formData.username}\n                onChange={(e) => handleInputChange('username', e.target.value)}\n                onBlur={handleUsernameBlur}\n                aria-describedby={\n                  usernameError ? 'username-error' : 'username-help'\n                }\n              />\n              {checkingUsername && (\n                <p className=\"text-xs text-muted-foreground mt-1\" aria-live=\"polite\">Checking availabilityâ€¦</p>\n              )}\n              {usernameError && (\n                <p id=\"username-error\" className=\"text-xs text-red-500 mt-1\" role=\"alert\" aria-live=\"polite\">{usernameError}</p>\n              )}\n              {!usernameError && !checkingUsername && formData.username && (\n                <p id=\"username-help\" className=\"text-xs text-muted-foreground mt-1\">Allowed: letters, numbers, dot, underscore, hyphen.</p>\n              )}\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Location</label>\n              <Input\n                placeholder=\"City, State\"\n                value={formData.location}\n                onChange={(e) => handleInputChange('location', e.target.value)}\n              />\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Bio <span className=\"text-muted-foreground font-normal\">(max {BIO_MAX} chars)</span></label>\n              <Textarea\n                placeholder=\"Tell us about yourself...\"\n                value={formData.bio}\n                onChange={(e) => handleInputChange('bio', e.target.value)}\n                rows={3}\n                maxLength={BIO_MAX}\n                aria-describedby=\"bio-counter\"\n              />\n              <div className=\"flex justify-end\">\n                <span id=\"bio-counter\" className={`text-xs ${formData.bio.length >= BIO_MAX ? 'text-red-500' : 'text-muted-foreground'}`}>{formData.bio.length}/{BIO_MAX}</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Sports Preferences */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Sports I Play</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-wrap gap-2\">\n              {availableSports.map((sport) => (\n                <Badge\n                  key={sport}\n                  variant={formData.sportsPreferences.includes(sport) ? \"default\" : \"secondary\"}\n                  className=\"cursor-pointer hover:opacity-80 transition-opacity\"\n                  onClick={() => handleSportToggle(sport)}\n                >\n                  {sport}\n                  {formData.sportsPreferences.includes(sport) && (\n                    <X className=\"w-3 h-3 ml-1\" />\n                  )}\n                </Badge>\n              ))}\n            </div>\n            <p className=\"text-sm text-muted-foreground mt-3\">\n              Click on sports to add or remove them from your preferences\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\nexport default EditProfile;\n"],"names":["availableSports","EditProfile","navigate","useNavigate","user","setUser","useAppStore","updateProfileMutation","useUpdateUserProfile","loading","isPending","formData","setFormData","useState","fullName","username","bio","location","avatarUrl","sportsPreferences","usernameError","setUsernameError","checkingUsername","setCheckingUsername","selectedFile","setSelectedFile","previewUrl","setPreviewUrl","avatarError","setAvatarError","initialFormRef","React","useRef","BIO_MAX","USERNAME_REGEX","useEffect","async","userProfile","SupabaseService","getUserProfile","id","loaded","name","avatar","Array","isArray","preferences","sports","current","error","toast","loadUserData","timer","uname","trim","test","toLowerCase","setTimeout","available","isUsernameAvailable","clearTimeout","handleInputChange","field","value","prev","length","slice","isDirty","JSON","stringify","beforeUnload","e","preventDefault","returnValue","window","addEventListener","removeEventListener","jsxs","className","children","jsx","Button","variant","size","onClick","confirm","ArrowLeft","finalAvatarUrl","uploadAvatar","mutate","userId","profileData","full_name","avatar_url","preferred_sports","onSuccess","updatedProfile","onError","message","disabled","Save","Card","CardHeader","CardTitle","CardContent","Avatar","AvatarImage","src","alt","AvatarFallback","charAt","toUpperCase","Input","type","accept","onChange","file","target","files","maxBytes","includes","url","URL","createObjectURL","Upload","role","placeholder","onBlur","Textarea","rows","maxLength","map","sport","Badge","filter","s","handleSportToggle","X"],"mappings":"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"}