import{r as e}from"./vendor-CTE-63Sz.js";import{t}from"./utils-B5KmqWpW.js";import{u as s,S as i}from"./index-DLF2PjT_.js";function a(){const{user:a}=s(),[n,r]=e.useState([]),[c,o]=e.useState(null),[m,h]=e.useState(!0);e.useEffect(()=>{if(!a?.id)return;(async()=>{try{h(!0);const[e,t]=await Promise.all([i.getUserAchievements(a.id),i.getUserStats(a.id)]);r(e),o(t)}catch(e){}finally{h(!1)}})()},[a?.id]);const d=e=>{t.success("ðŸŽ‰ Achievement Unlocked!",{description:`${e.icon} ${e.name} - ${e.description} (+${e.points} points)`,duration:6e3,action:{label:"View All",onClick:()=>{window.location.href="/profile?tab=achievements"}}})},l=(e,t)=>{const s=e.criteria;let i=0,a=1;return s.games_played?(a=s.games_played,i=Math.min(t.games_played,a)):s.games_hosted&&(a=s.games_hosted,i=Math.min(t.games_hosted,a)),{progress:i,total:a,percentage:Math.round(i/a*100)}};return{achievements:n,userStats:c,isLoading:m,checkForNewAchievements:async()=>{if(a?.id)try{const e=await i.checkAndAwardAchievements(a.id);if(e.length>0){e.forEach(e=>{d(e)});const t=await i.getUserAchievements(a.id);r(t)}}catch(e){}},showAchievementToast:d,getAchievementProgress:l,getNextAchievements:async()=>{if(!a?.id||!c)return[];try{const e=await i.getAllAchievements(),t=new Set(n.map(e=>e.achievement_id));return e.filter(e=>!t.has(e.id)&&e.is_active).map(e=>({...e,progress:l(e,c)})).sort((e,t)=>t.progress.percentage-e.progress.percentage).slice(0,3)}catch(e){return[]}}}}export{a as u};
//# sourceMappingURL=useAchievements-sHSBulEr.js.map
