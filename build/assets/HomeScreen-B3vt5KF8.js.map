{"version":3,"file":"HomeScreen-B3vt5KF8.js","sources":["../../src/hooks/useLocation.ts","../../src/components/GameCardSkeleton.tsx","../../src/utils/supabaseDiagnostics.ts","../../src/utils/supabaseSpeedTest.ts","../../src/utils/connectionDiagnostic.ts","../../src/components/CacheClearButton.tsx","../../src/components/HomeScreen.tsx","../../src/hooks/useGameRealtime.ts"],"sourcesContent":["import { useState, useEffect, useCallback, useRef } from 'react';\nimport { toast } from 'sonner';\n\nexport interface LocationCoordinates {\n  latitude: number;\n  longitude: number;\n  accuracy?: number;\n  altitude?: number;\n  heading?: number;\n  speed?: number;\n}\n\nexport interface LocationState {\n  currentLocation: LocationCoordinates | null;\n  isLoading: boolean;\n  error: string | null;\n  permission: 'granted' | 'denied' | 'prompt' | 'unknown';\n  lastUpdated: Date | null;\n}\n\nexport interface MapBounds {\n  north: number;\n  south: number;\n  east: number;\n  west: number;\n}\n\ninterface UseLocationOptions {\n  enableHighAccuracy?: boolean;\n  timeout?: number;\n  maximumAge?: number;\n  watchPosition?: boolean;\n  autoRequest?: boolean;\n}\n\n// Utility functions for location calculations\nexport function calculateDistance(\n  lat1: number,\n  lon1: number,\n  lat2: number,\n  lon2: number\n): number {\n  const R = 6371; // Earth's radius in kilometers\n  const dLat = toRadians(lat2 - lat1);\n  const dLon = toRadians(lon2 - lon1);\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRadians(lat1)) * Math.cos(toRadians(lat2)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c; // Distance in kilometers\n}\n\nexport function toRadians(degrees: number): number {\n  return degrees * (Math.PI / 180);\n}\n\nexport function formatDistance(distance: number, unit: 'km' | 'mi' = 'km'): string {\n  if (unit === 'mi') {\n    distance = distance * 0.621371; // Convert km to miles\n  }\n  \n  if (distance < 1) {\n    return unit === 'km' \n      ? `${Math.round(distance * 1000)}m`\n      : `${Math.round(distance * 5280)}ft`;\n  }\n  \n  return `${distance.toFixed(1)}${unit}`;\n}\n\nexport function isWithinBounds(\n  location: LocationCoordinates,\n  bounds: MapBounds\n): boolean {\n  return (\n    location.latitude >= bounds.south &&\n    location.latitude <= bounds.north &&\n    location.longitude >= bounds.west &&\n    location.longitude <= bounds.east\n  );\n}\n\nexport function getBoundsFromCenter(\n  center: LocationCoordinates,\n  radiusKm: number\n): MapBounds {\n  const latOffset = radiusKm / 111; // Approximate: 1 degree lat = 111 km\n  const lonOffset = radiusKm / (111 * Math.cos(toRadians(center.latitude)));\n  \n  return {\n    north: center.latitude + latOffset,\n    south: center.latitude - latOffset,\n    east: center.longitude + lonOffset,\n    west: center.longitude - lonOffset\n  };\n}\n\nexport function useLocation(options: UseLocationOptions = {}) {\n  const {\n    enableHighAccuracy = true,\n    timeout = 10000,\n    maximumAge = 60000,\n    watchPosition = false,\n    autoRequest = true\n  } = options;\n\n  const [state, setState] = useState<LocationState>({\n    currentLocation: null,\n    isLoading: false,\n    error: null,\n    permission: 'unknown',\n    lastUpdated: null\n  });\n\n  const watchIdRef = useRef<number | null>(null);\n  const requestInProgressRef = useRef(false);\n\n  // Check if geolocation is supported\n  const isSupported = 'geolocation' in navigator;\n\n  // Check current permission status\n  const checkPermission = useCallback(async () => {\n    if (!isSupported) {\n      setState(prev => ({ ...prev, permission: 'denied', error: 'Geolocation not supported' }));\n      return 'denied';\n    }\n\n    try {\n      if ('permissions' in navigator) {\n        const permission = await navigator.permissions.query({ name: 'geolocation' });\n        setState(prev => ({ ...prev, permission: permission.state as any }));\n        return permission.state;\n      }\n    } catch (error) {\n      console.warn('Permission API not supported');\n    }\n\n    return 'unknown';\n  }, [isSupported]);\n\n  // Request location permission and get current position\n  const requestLocation = useCallback(async (): Promise<LocationCoordinates | null> => {\n    if (!isSupported) {\n      toast.error('Location services are not supported by your browser');\n      return null;\n    }\n\n    if (requestInProgressRef.current) {\n      return null;\n    }\n\n    requestInProgressRef.current = true;\n    setState(prev => ({ ...prev, isLoading: true, error: null }));\n\n    return new Promise((resolve) => {\n      const geoOptions: PositionOptions = {\n        enableHighAccuracy,\n        timeout,\n        maximumAge\n      };\n\n      const successCallback = (position: GeolocationPosition) => {\n        const location: LocationCoordinates = {\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude,\n          accuracy: position.coords.accuracy,\n          altitude: position.coords.altitude || undefined,\n          heading: position.coords.heading || undefined,\n          speed: position.coords.speed || undefined\n        };\n\n        setState(prev => ({\n          ...prev,\n          currentLocation: location,\n          isLoading: false,\n          error: null,\n          permission: 'granted',\n          lastUpdated: new Date()\n        }));\n\n        requestInProgressRef.current = false;\n        resolve(location);\n      };\n\n      const errorCallback = (error: GeolocationPositionError) => {\n        let errorMessage = 'Failed to get location';\n        let permission: LocationState['permission'] = 'unknown';\n\n        switch (error.code) {\n          case error.PERMISSION_DENIED:\n            errorMessage = 'Location access denied by user';\n            permission = 'denied';\n            toast.error('Please enable location access to find nearby games');\n            break;\n          case error.POSITION_UNAVAILABLE:\n            errorMessage = 'Location information unavailable';\n            break;\n          case error.TIMEOUT:\n            errorMessage = 'Location request timed out';\n            break;\n        }\n\n        setState(prev => ({\n          ...prev,\n          isLoading: false,\n          error: errorMessage,\n          permission\n        }));\n\n        requestInProgressRef.current = false;\n        resolve(null);\n      };\n\n      navigator.geolocation.getCurrentPosition(\n        successCallback,\n        errorCallback,\n        geoOptions\n      );\n    });\n  }, [isSupported, enableHighAccuracy, timeout, maximumAge]);\n\n  // Start watching position\n  const startWatching = useCallback(() => {\n    if (!isSupported || watchIdRef.current !== null) {\n      return;\n    }\n\n    const geoOptions: PositionOptions = {\n      enableHighAccuracy,\n      timeout,\n      maximumAge\n    };\n\n    const successCallback = (position: GeolocationPosition) => {\n      const location: LocationCoordinates = {\n        latitude: position.coords.latitude,\n        longitude: position.coords.longitude,\n        accuracy: position.coords.accuracy,\n        altitude: position.coords.altitude || undefined,\n        heading: position.coords.heading || undefined,\n        speed: position.coords.speed || undefined\n      };\n\n      setState(prev => ({\n        ...prev,\n        currentLocation: location,\n        lastUpdated: new Date()\n      }));\n    };\n\n    const errorCallback = (error: GeolocationPositionError) => {\n      console.error('Location watch error:', error);\n    };\n\n    watchIdRef.current = navigator.geolocation.watchPosition(\n      successCallback,\n      errorCallback,\n      geoOptions\n    );\n  }, [isSupported, enableHighAccuracy, timeout, maximumAge]);\n\n  // Stop watching position\n  const stopWatching = useCallback(() => {\n    if (watchIdRef.current !== null) {\n      navigator.geolocation.clearWatch(watchIdRef.current);\n      watchIdRef.current = null;\n    }\n  }, []);\n\n  // Clear location data\n  const clearLocation = useCallback(() => {\n    setState(prev => ({\n      ...prev,\n      currentLocation: null,\n      error: null,\n      lastUpdated: null\n    }));\n  }, []);\n\n  // Get distance to a location\n  const getDistanceTo = useCallback((\n    target: LocationCoordinates,\n    unit: 'km' | 'mi' = 'km'\n  ): number | null => {\n    if (!state.currentLocation) return null;\n    \n    const distance = calculateDistance(\n      state.currentLocation.latitude,\n      state.currentLocation.longitude,\n      target.latitude,\n      target.longitude\n    );\n    \n    return unit === 'mi' ? distance * 0.621371 : distance;\n  }, [state.currentLocation]);\n\n  // Get formatted distance to a location\n  const getFormattedDistanceTo = useCallback((\n    target: LocationCoordinates,\n    unit: 'km' | 'mi' = 'km'\n  ): string | null => {\n    const distance = getDistanceTo(target, unit);\n    return distance ? formatDistance(distance, unit) : null;\n  }, [getDistanceTo]);\n\n  // Check if a location is nearby\n  const isNearby = useCallback((\n    target: LocationCoordinates,\n    radiusKm: number = 5\n  ): boolean => {\n    const distance = getDistanceTo(target, 'km');\n    return distance !== null && distance <= radiusKm;\n  }, [getDistanceTo]);\n\n  // Initialize\n  useEffect(() => {\n    checkPermission();\n    \n    if (autoRequest) {\n      requestLocation();\n    }\n    \n    if (watchPosition) {\n      startWatching();\n    }\n\n    return () => {\n      stopWatching();\n    };\n  }, [checkPermission, requestLocation, startWatching, stopWatching, autoRequest, watchPosition]);\n\n  return {\n    // State\n    ...state,\n    isSupported,\n    \n    // Actions\n    requestLocation,\n    clearLocation,\n    startWatching,\n    stopWatching,\n    \n    // Utilities\n    getDistanceTo,\n    getFormattedDistanceTo,\n    isNearby,\n    calculateDistance: (lat1: number, lon1: number, lat2: number, lon2: number) => \n      calculateDistance(lat1, lon1, lat2, lon2),\n    formatDistance,\n    getBoundsFromCenter: (radiusKm: number) => \n      state.currentLocation ? getBoundsFromCenter(state.currentLocation, radiusKm) : null\n  };\n}\n\n// Hook for managing map state\nexport function useMapState() {\n  const [mapCenter, setMapCenter] = useState<LocationCoordinates | null>(null);\n  const [mapZoom, setMapZoom] = useState(13);\n  const [selectedLocation, setSelectedLocation] = useState<LocationCoordinates | null>(null);\n  const [isMapLoaded, setIsMapLoaded] = useState(false);\n\n  const centerOnLocation = useCallback((location: LocationCoordinates, zoom?: number) => {\n    setMapCenter(location);\n    if (zoom !== undefined) {\n      setMapZoom(zoom);\n    }\n  }, []);\n\n  const selectLocation = useCallback((location: LocationCoordinates) => {\n    setSelectedLocation(location);\n  }, []);\n\n  const clearSelection = useCallback(() => {\n    setSelectedLocation(null);\n  }, []);\n\n  return {\n    mapCenter,\n    mapZoom,\n    selectedLocation,\n    isMapLoaded,\n    setMapCenter,\n    setMapZoom,\n    setSelectedLocation,\n    setIsMapLoaded,\n    centerOnLocation,\n    selectLocation,\n    clearSelection\n  };\n}","import { Card, CardContent } from './ui/card';\nimport { Skeleton } from './ui/skeleton';\n\nexport function GameCardSkeleton() {\n  return (\n    <Card className=\"w-full\">\n      <CardContent className=\"p-4\">\n        <div className=\"space-y-3\">\n          {/* Header */}\n          <div className=\"flex items-start justify-between\">\n            <div className=\"space-y-2 flex-1\">\n              <Skeleton className=\"h-5 w-3/4\" />\n              <Skeleton className=\"h-4 w-1/2\" />\n            </div>\n            <Skeleton className=\"h-8 w-16\" />\n          </div>\n          \n          {/* Location and time */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center gap-2\">\n              <Skeleton className=\"h-4 w-4\" />\n              <Skeleton className=\"h-4 w-2/3\" />\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Skeleton className=\"h-4 w-4\" />\n              <Skeleton className=\"h-4 w-1/3\" />\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Skeleton className=\"h-4 w-4\" />\n              <Skeleton className=\"h-4 w-1/4\" />\n            </div>\n          </div>\n          \n          {/* Description */}\n          <Skeleton className=\"h-4 w-full\" />\n          <Skeleton className=\"h-4 w-3/4\" />\n          \n          {/* Footer */}\n          <div className=\"flex items-center justify-between pt-2\">\n            <Skeleton className=\"h-6 w-20\" />\n            <Skeleton className=\"h-8 w-16\" />\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function GameDetailsSkeleton() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <div className=\"sticky top-0 z-10 bg-background/95 backdrop-blur-sm border-b border-border\">\n        <div className=\"flex items-center justify-between p-4\">\n          <Skeleton className=\"h-8 w-8\" />\n          <div className=\"flex gap-2\">\n            <Skeleton className=\"h-8 w-8\" />\n            <Skeleton className=\"h-8 w-8\" />\n            <Skeleton className=\"h-8 w-8\" />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"px-4 py-6 space-y-6\">\n        {/* Hero Image */}\n        <Skeleton className=\"h-48 w-full rounded-lg\" />\n        \n        {/* Basic Info */}\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Skeleton className=\"h-8 w-3/4\" />\n            <Skeleton className=\"h-4 w-1/2\" />\n          </div>\n          \n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Skeleton className=\"h-4 w-16\" />\n              <Skeleton className=\"h-4 w-24\" />\n            </div>\n            <div className=\"space-y-2\">\n              <Skeleton className=\"h-4 w-16\" />\n              <Skeleton className=\"h-4 w-20\" />\n            </div>\n          </div>\n        </div>\n        \n        {/* Description */}\n        <div className=\"space-y-2\">\n          <Skeleton className=\"h-4 w-20\" />\n          <Skeleton className=\"h-4 w-full\" />\n          <Skeleton className=\"h-4 w-3/4\" />\n        </div>\n        \n        {/* Join Button */}\n        <Skeleton className=\"h-12 w-full\" />\n        \n        {/* Players List */}\n        <div className=\"space-y-4\">\n          <Skeleton className=\"h-6 w-32\" />\n          <div className=\"space-y-3\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex items-center gap-3\">\n                <Skeleton className=\"h-10 w-10 rounded-full\" />\n                <div className=\"space-y-2 flex-1\">\n                  <Skeleton className=\"h-4 w-24\" />\n                  <Skeleton className=\"h-3 w-16\" />\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","/**\n * Supabase Database Diagnostics\n * \n * This tool helps identify why queries are hanging by testing\n * different database operations and RLS policies.\n */\n\nimport { supabase } from '../lib/supabase';\n\nexport class SupabaseDiagnostics {\n  \n  /**\n   * Run comprehensive database diagnostics\n   */\n  static async runDiagnostics(): Promise<void> {\n    console.log('üîç [Diagnostics] Starting Supabase diagnostics...');\n    \n    try {\n      // Test 1: Basic connection\n      await this.testConnection();\n      \n      // Test 2: Auth status\n      await this.testAuth();\n      \n      // Test 3: Simple table queries\n      await this.testTableAccess();\n      \n      // Test 4: RLS policies\n      await this.testRLSPolicies();\n      \n      // Test 5: Specific game query\n      await this.testGameQuery();\n      \n      console.log('‚úÖ [Diagnostics] All tests completed');\n      \n    } catch (error) {\n      console.error('‚ùå [Diagnostics] Failed:', error);\n    }\n  }\n  \n  /**\n   * Test basic Supabase connection\n   */\n  private static async testConnection(): Promise<void> {\n    console.log('üß™ [Test 1] Testing Supabase connection...');\n    \n    try {\n      const startTime = performance.now();\n      \n      // Simple health check - this should always work\n      const { data, error } = await Promise.race([\n        supabase.from('games').select('count', { count: 'exact', head: true }),\n        new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Connection timeout')), 5000)\n        )\n      ]) as any;\n      \n      const duration = performance.now() - startTime;\n      \n      if (error) {\n        console.error('‚ùå [Test 1] Connection failed:', error);\n        console.error('üö® This indicates a fundamental Supabase connection issue');\n      } else {\n        console.log(`‚úÖ [Test 1] Connection OK (${duration.toFixed(2)}ms)`);\n      }\n      \n    } catch (error) {\n      console.error('‚ùå [Test 1] Connection timeout or error:', error);\n      console.error('üö® Supabase is not responding - check network/URL/keys');\n    }\n  }\n  \n  /**\n   * Test authentication status\n   */\n  private static async testAuth(): Promise<void> {\n    console.log('üß™ [Test 2] Testing authentication...');\n    \n    try {\n      const startTime = performance.now();\n      \n      const { data: { user }, error } = await Promise.race([\n        supabase.auth.getUser(),\n        new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Auth timeout')), 3000)\n        )\n      ]) as any;\n      \n      const duration = performance.now() - startTime;\n      \n      if (error) {\n        console.error('‚ùå [Test 2] Auth error:', error);\n      } else {\n        console.log(`‚úÖ [Test 2] Auth OK (${duration.toFixed(2)}ms)`, {\n          userId: user?.id || 'anonymous',\n          email: user?.email || 'none',\n          role: user?.role || 'anon'\n        });\n      }\n      \n    } catch (error) {\n      console.error('‚ùå [Test 2] Auth timeout:', error);\n    }\n  }\n  \n  /**\n   * Test basic table access without RLS complications\n   */\n  private static async testTableAccess(): Promise<void> {\n    console.log('üß™ [Test 3] Testing table access...');\n    \n    const tables = ['games', 'users', 'game_participants'];\n    \n    for (const table of tables) {\n      try {\n        const startTime = performance.now();\n        \n        const { data, error } = await Promise.race([\n          supabase.from(table).select('*').limit(1),\n          new Promise((_, reject) => \n            setTimeout(() => reject(new Error(`${table} query timeout`)), 8000)\n          )\n        ]) as any;\n        \n        const duration = performance.now() - startTime;\n        \n        if (error) {\n          console.error(`‚ùå [Test 3] ${table} failed:`, error);\n          \n          // Analyze the error\n          if (error.code === 'PGRST301') {\n            console.error(`üö® ${table}: RLS is blocking ALL access - policies too restrictive`);\n          } else if (error.message?.includes('timeout')) {\n            console.error(`üö® ${table}: Query hanging - likely RLS infinite loop`);\n          } else {\n            console.error(`üö® ${table}: Unknown error - ${error.message}`);\n          }\n        } else {\n          console.log(`‚úÖ [Test 3] ${table} OK (${duration.toFixed(2)}ms) - ${data?.length || 0} rows`);\n        }\n        \n      } catch (error) {\n        console.error(`‚ùå [Test 3] ${table} timeout:`, error);\n        console.error(`üö® ${table}: Hanging query detected - RLS issue likely`);\n      }\n    }\n  }\n  \n  /**\n   * Test RLS policies by trying different user contexts\n   */\n  private static async testRLSPolicies(): Promise<void> {\n    console.log('üß™ [Test 4] Testing RLS policies...');\n    \n    try {\n      // Test anonymous access\n      console.log('üîç Testing anonymous access...');\n      const { data: anonGames, error: anonError } = await Promise.race([\n        supabase.from('games').select('id, title').limit(1),\n        new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Anonymous query timeout')), 5000)\n        )\n      ]) as any;\n      \n      if (anonError) {\n        console.error('‚ùå Anonymous access failed:', anonError);\n        console.error('üö® RLS is blocking anonymous users - this breaks public game viewing');\n      } else {\n        console.log('‚úÖ Anonymous access OK');\n      }\n      \n      // Test authenticated access\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user) {\n        console.log('üîç Testing authenticated access...');\n        const { data: authGames, error: authError } = await Promise.race([\n          supabase.from('games').select('id, title').limit(1),\n          new Promise((_, reject) => \n            setTimeout(() => reject(new Error('Authenticated query timeout')), 5000)\n          )\n        ]) as any;\n        \n        if (authError) {\n          console.error('‚ùå Authenticated access failed:', authError);\n          console.error('üö® RLS is blocking authenticated users - major issue');\n        } else {\n          console.log('‚úÖ Authenticated access OK');\n        }\n      }\n      \n    } catch (error) {\n      console.error('‚ùå [Test 4] RLS test failed:', error);\n    }\n  }\n  \n  /**\n   * Test the specific game query that's failing\n   */\n  private static async testGameQuery(): Promise<void> {\n    console.log('üß™ [Test 5] Testing specific game query...');\n    \n    try {\n      // First, get any game ID\n      const { data: games } = await supabase\n        .from('games')\n        .select('id')\n        .limit(1);\n        \n      if (!games || games.length === 0) {\n        console.warn('‚ö†Ô∏è No games found to test with');\n        return;\n      }\n      \n      const gameId = games[0].id;\n      console.log('üîç Testing with game ID:', gameId);\n      \n      // Test the exact query that's failing\n      const startTime = performance.now();\n      \n      const { data, error } = await Promise.race([\n        supabase\n          .from('games')\n          .select(`\n            *,\n            game_participants(user_id),\n            creator:users!creator_id(id, full_name, username, avatar_url)\n          `)\n          .eq('id', gameId)\n          .single(),\n        new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Game query timeout')), 10000)\n        )\n      ]) as any;\n      \n      const duration = performance.now() - startTime;\n      \n      if (error) {\n        console.error('‚ùå [Test 5] Game query failed:', error);\n        console.error('üö® This is the exact query that\\'s causing the hang!');\n        \n        // Try simpler version\n        console.log('üîç Trying simpler game query...');\n        const { data: simpleData, error: simpleError } = await supabase\n          .from('games')\n          .select('*')\n          .eq('id', gameId)\n          .single();\n          \n        if (simpleError) {\n          console.error('‚ùå Even simple game query failed:', simpleError);\n        } else {\n          console.log('‚úÖ Simple game query works - issue is with joins');\n          console.log('üö® Problem is likely with users table RLS or foreign key constraints');\n        }\n      } else {\n        console.log(`‚úÖ [Test 5] Game query OK (${duration.toFixed(2)}ms)`);\n      }\n      \n    } catch (error) {\n      console.error('‚ùå [Test 5] Game query timeout:', error);\n      console.error('üö® The game query is definitely hanging - RLS issue confirmed');\n    }\n  }\n  \n  /**\n   * Generate RLS fix SQL based on detected issues\n   */\n  static generateRLSFix(): string {\n    return `\n-- RLS Fix SQL for TribeUp\n-- Run this in your Supabase SQL Editor\n\n-- 1. Enable RLS on all tables\nALTER TABLE public.games ENABLE ROW LEVEL SECURITY;\nALTER TABLE public.users ENABLE ROW LEVEL SECURITY;\nALTER TABLE public.game_participants ENABLE ROW LEVEL SECURITY;\n\n-- 2. Games table policies (allow public read, authenticated write)\nDROP POLICY IF EXISTS \"Games are viewable by everyone\" ON public.games;\nCREATE POLICY \"Games are viewable by everyone\" ON public.games\n    FOR SELECT USING (true);\n\nDROP POLICY IF EXISTS \"Users can create games\" ON public.games;\nCREATE POLICY \"Users can create games\" ON public.games\n    FOR INSERT WITH CHECK (auth.uid() = creator_id);\n\nDROP POLICY IF EXISTS \"Users can update their own games\" ON public.games;\nCREATE POLICY \"Users can update their own games\" ON public.games\n    FOR UPDATE USING (auth.uid() = creator_id);\n\n-- 3. Users table policies (allow public read of basic info)\nDROP POLICY IF EXISTS \"Users can view basic profile info\" ON public.users;\nCREATE POLICY \"Users can view basic profile info\" ON public.users\n    FOR SELECT USING (true);\n\nDROP POLICY IF EXISTS \"Users can update their own profile\" ON public.users;\nCREATE POLICY \"Users can update their own profile\" ON public.users\n    FOR UPDATE USING (auth.uid() = id);\n\n-- 4. Game participants policies\nDROP POLICY IF EXISTS \"Game participants are viewable by everyone\" ON public.game_participants;\nCREATE POLICY \"Game participants are viewable by everyone\" ON public.game_participants\n    FOR SELECT USING (true);\n\nDROP POLICY IF EXISTS \"Users can join games\" ON public.game_participants;\nCREATE POLICY \"Users can join games\" ON public.game_participants\n    FOR INSERT WITH CHECK (auth.uid() = user_id);\n\nDROP POLICY IF EXISTS \"Users can leave games\" ON public.game_participants;\nCREATE POLICY \"Users can leave games\" ON public.game_participants\n    FOR DELETE USING (auth.uid() = user_id);\n\n-- 5. Fix any foreign key constraints that might cause issues\n-- (These should already exist, but just in case)\nALTER TABLE public.games \n    ADD CONSTRAINT games_creator_id_fkey \n    FOREIGN KEY (creator_id) REFERENCES public.users(id) \n    ON DELETE CASCADE;\n\nALTER TABLE public.game_participants \n    ADD CONSTRAINT game_participants_user_id_fkey \n    FOREIGN KEY (user_id) REFERENCES public.users(id) \n    ON DELETE CASCADE;\n\nALTER TABLE public.game_participants \n    ADD CONSTRAINT game_participants_game_id_fkey \n    FOREIGN KEY (game_id) REFERENCES public.games(id) \n    ON DELETE CASCADE;\n`;\n  }\n}\n\n// Global access for debugging\nif (typeof window !== 'undefined') {\n  (window as any).supabaseDiagnostics = SupabaseDiagnostics;\n  (window as any).runDiagnostics = () => SupabaseDiagnostics.runDiagnostics();\n  (window as any).getRLSFix = () => {\n    console.log(SupabaseDiagnostics.generateRLSFix());\n    return SupabaseDiagnostics.generateRLSFix();\n  };\n}\n","/**\n * Supabase Speed Test - Let's see what's actually slow\n */\n\nimport { supabase } from '../lib/supabase';\n\nexport class SupabaseSpeedTest {\n  \n  static async runFullSpeedTest() {\n    console.log('üèÉ‚Äç‚ôÇÔ∏è [SpeedTest] Starting comprehensive Supabase speed test...');\n    \n    const results = {\n      connection: 0,\n      auth: 0,\n      simpleQuery: 0,\n      complexQuery: 0,\n      joinQuery: 0,\n      participantsQuery: 0,\n      usersQuery: 0\n    };\n    \n    try {\n      // Test 1: Basic connection\n      console.log('üß™ Test 1: Basic connection...');\n      const start1 = performance.now();\n      \n      const { count, error: countError } = await supabase\n        .from('games')\n        .select('*', { count: 'exact', head: true });\n        \n      results.connection = performance.now() - start1;\n      console.log(`‚úÖ Connection: ${results.connection.toFixed(2)}ms (${count} games total)`);\n      \n      if (countError) {\n        console.error('‚ùå Connection failed:', countError);\n        return results;\n      }\n      \n      // Test 2: Auth check\n      console.log('üß™ Test 2: Auth check...');\n      const start2 = performance.now();\n      \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      results.auth = performance.now() - start2;\n      console.log(`‚úÖ Auth: ${results.auth.toFixed(2)}ms (User: ${user?.id || 'anonymous'})`);\n      \n      // Test 3: Simple games query\n      console.log('üß™ Test 3: Simple games query...');\n      const start3 = performance.now();\n      \n      const { data: simpleGames, error: simpleError } = await supabase\n        .from('games')\n        .select('id, title, sport, date')\n        .limit(10);\n        \n      results.simpleQuery = performance.now() - start3;\n      console.log(`‚úÖ Simple query: ${results.simpleQuery.toFixed(2)}ms (${simpleGames?.length || 0} games)`);\n      \n      // Test 4: Complex games query (what we were doing)\n      console.log('üß™ Test 4: Complex games query with joins...');\n      const start4 = performance.now();\n      \n      const { data: complexGames, error: complexError } = await supabase\n        .from('games')\n        .select(`\n          *,\n          game_participants(user_id),\n          creator:users!games_creator_id_fkey(id, full_name, username, avatar_url)\n        `)\n        .limit(10);\n        \n      results.complexQuery = performance.now() - start4;\n      console.log(`‚úÖ Complex query: ${results.complexQuery.toFixed(2)}ms (${complexGames?.length || 0} games)`);\n      \n      if (complexError) {\n        console.error('‚ùå Complex query failed:', complexError);\n      }\n      \n      // Test 5: Just the join that might be slow\n      console.log('üß™ Test 5: Testing participants join...');\n      const start5 = performance.now();\n      \n      const { data: participants, error: partError } = await supabase\n        .from('game_participants')\n        .select('game_id, user_id')\n        .limit(50);\n        \n      results.participantsQuery = performance.now() - start5;\n      console.log(`‚úÖ Participants query: ${results.participantsQuery.toFixed(2)}ms (${participants?.length || 0} participants)`);\n      \n      // Test 6: Users table query\n      console.log('üß™ Test 6: Testing users query...');\n      const start6 = performance.now();\n      \n      const { data: users, error: usersError } = await supabase\n        .from('users')\n        .select('id, full_name, username')\n        .limit(10);\n        \n      results.usersQuery = performance.now() - start6;\n      console.log(`‚úÖ Users query: ${results.usersQuery.toFixed(2)}ms (${users?.length || 0} users)`);\n      \n      if (usersError) {\n        console.error('‚ùå Users query failed:', usersError);\n        console.error('üö® This might be the RLS issue!');\n      }\n      \n      // Summary\n      console.log('\\nüìä SPEED TEST RESULTS:');\n      console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      console.log(`üîå Connection:        ${results.connection.toFixed(2)}ms`);\n      console.log(`üîê Auth Check:        ${results.auth.toFixed(2)}ms`);\n      console.log(`üìã Simple Query:      ${results.simpleQuery.toFixed(2)}ms`);\n      console.log(`üîó Complex Query:     ${results.complexQuery.toFixed(2)}ms`);\n      console.log(`üë• Participants:      ${results.participantsQuery.toFixed(2)}ms`);\n      console.log(`üë§ Users:             ${results.usersQuery.toFixed(2)}ms`);\n      console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      \n      // Analysis\n      if (results.complexQuery > 5000) {\n        console.warn('üö® COMPLEX QUERY IS SLOW! This is why your app hangs.');\n        console.warn('üí° Solution: Use simple queries instead of complex joins');\n      }\n      \n      if (results.usersQuery > 3000) {\n        console.warn('üö® USERS TABLE IS SLOW! RLS policies might be the issue.');\n        console.warn('üí° Solution: Fix RLS policies or avoid users table joins');\n      }\n      \n      if (results.connection > 2000) {\n        console.warn('üö® BASIC CONNECTION IS SLOW! Network or Supabase issue.');\n        console.warn('üí° Solution: Check network, Supabase region, or switch providers');\n      }\n      \n      if (results.simpleQuery < 1000 && results.complexQuery > 5000) {\n        console.log('‚úÖ DIAGNOSIS: Simple queries are fast, complex joins are slow');\n        console.log('üí° SOLUTION: Use the SimpleGameService instead of complex joins');\n      }\n      \n      return results;\n      \n    } catch (error) {\n      console.error('‚ùå Speed test failed:', error);\n      return results;\n    }\n  }\n  \n  /**\n   * Test network latency to Supabase\n   */\n  static async testNetworkLatency() {\n    console.log('üåê Testing network latency to Supabase...');\n    \n    const times: number[] = [];\n    \n    for (let i = 0; i < 5; i++) {\n      const start = performance.now();\n      \n      try {\n        await supabase.from('games').select('count', { count: 'exact', head: true });\n        const time = performance.now() - start;\n        times.push(time);\n        console.log(`Ping ${i + 1}: ${time.toFixed(2)}ms`);\n      } catch (error) {\n        console.error(`Ping ${i + 1}: FAILED`);\n      }\n    }\n    \n    const avg = times.reduce((a, b) => a + b, 0) / times.length;\n    const min = Math.min(...times);\n    const max = Math.max(...times);\n    \n    console.log(`üìä Latency - Min: ${min.toFixed(2)}ms, Max: ${max.toFixed(2)}ms, Avg: ${avg.toFixed(2)}ms`);\n    \n    if (avg > 1000) {\n      console.warn('üö® HIGH LATENCY! Your connection to Supabase is slow.');\n      console.warn('üí° Consider: Different Supabase region, network issues, or local development proxy');\n    }\n    \n    return { min, max, avg };\n  }\n  \n  /**\n   * Test specific problematic query\n   */\n  static async testProblematicQuery() {\n    console.log('üéØ Testing the exact query that was hanging...');\n    \n    const start = performance.now();\n    \n    try {\n      const { data, error } = await supabase\n        .from('games')\n        .select(`\n          *,\n          game_participants(user_id),\n          creator:users!games_creator_id_fkey(id, full_name, username, avatar_url)\n        `)\n        .gte('date', new Date().toISOString().split('T')[0])\n        .order('date', { ascending: true })\n        .limit(50);\n        \n      const duration = performance.now() - start;\n      \n      console.log(`‚è±Ô∏è Problematic query took: ${duration.toFixed(2)}ms`);\n      console.log(`üì¶ Returned: ${data?.length || 0} games`);\n      \n      if (error) {\n        console.error('‚ùå Query failed:', error);\n      }\n      \n      if (duration > 10000) {\n        console.warn('üö® CONFIRMED: This query is too slow!');\n        console.warn('üí° This is why your app was hanging - the query takes 10+ seconds');\n      } else if (duration > 5000) {\n        console.warn('‚ö†Ô∏è Query is slow but not terrible');\n      } else {\n        console.log('‚úÖ Query is actually fast - the timeouts were the problem');\n      }\n      \n      return { duration, count: data?.length || 0, error };\n      \n    } catch (error) {\n      const duration = performance.now() - start;\n      console.error('‚ùå Problematic query failed:', error);\n      return { duration, count: 0, error };\n    }\n  }\n}\n\n// Global access\nif (typeof window !== 'undefined') {\n  (window as any).supabaseSpeedTest = SupabaseSpeedTest;\n  (window as any).testSupabaseSpeed = () => SupabaseSpeedTest.runFullSpeedTest();\n  (window as any).testLatency = () => SupabaseSpeedTest.testNetworkLatency();\n  (window as any).testProblematicQuery = () => SupabaseSpeedTest.testProblematicQuery();\n}\n","/**\n * Connection Diagnostic Tool\n * Tests and fixes Supabase connection issues\n */\n\nimport { supabase } from '../lib/supabase';\n\nexport class ConnectionDiagnostic {\n  \n  /**\n   * Run comprehensive connection diagnostics\n   */\n  static async runConnectionTest(): Promise<void> {\n    console.log('üîç [Connection] Starting comprehensive connection test...');\n    \n    const results = {\n      basicFetch: false,\n      supabaseHealth: false,\n      dnsResolution: false,\n      networkLatency: 0,\n      corsIssues: false,\n      authEndpoint: false,\n      restEndpoint: false\n    };\n    \n    try {\n      // Test 1: Basic fetch to Supabase\n      console.log('üß™ Test 1: Basic fetch to Supabase...');\n      const basicStart = performance.now();\n      \n      try {\n        const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n        const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n        \n        const response = await fetch(`${supabaseUrl}/rest/v1/`, {\n          method: 'HEAD',\n          headers: {\n            'apikey': supabaseKey\n          }\n        });\n        \n        results.basicFetch = response.ok;\n        results.networkLatency = performance.now() - basicStart;\n        \n        console.log(`‚úÖ Basic fetch: ${results.basicFetch ? 'SUCCESS' : 'FAILED'} (${results.networkLatency.toFixed(2)}ms)`);\n      } catch (error) {\n        console.error('‚ùå Basic fetch failed:', error);\n        results.basicFetch = false;\n      }\n      \n      // Test 2: DNS Resolution\n      console.log('üß™ Test 2: DNS Resolution...');\n      try {\n        const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n        const url = new URL(supabaseUrl);\n        const dnsStart = performance.now();\n        \n        // Try to resolve the hostname\n        await fetch(`https://${url.hostname}`, { method: 'HEAD', mode: 'no-cors' });\n        \n        results.dnsResolution = true;\n        console.log(`‚úÖ DNS Resolution: SUCCESS (${(performance.now() - dnsStart).toFixed(2)}ms)`);\n      } catch (error) {\n        console.error('‚ùå DNS Resolution failed:', error);\n        results.dnsResolution = false;\n      }\n      \n      // Test 3: Supabase Health Check\n      console.log('üß™ Test 3: Supabase Health Check...');\n      try {\n        const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n        const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n        \n        const healthResponse = await fetch(`${supabaseUrl}/rest/v1/`, {\n          headers: {\n            'apikey': supabaseKey,\n            'Accept': 'application/json'\n          }\n        });\n        \n        results.supabaseHealth = healthResponse.ok;\n        console.log(`‚úÖ Supabase Health: ${results.supabaseHealth ? 'HEALTHY' : 'UNHEALTHY'}`);\n        \n        if (!healthResponse.ok) {\n          console.error('‚ùå Supabase response:', await healthResponse.text());\n        }\n      } catch (error) {\n        console.error('‚ùå Supabase Health failed:', error);\n        results.supabaseHealth = false;\n      }\n      \n      // Test 4: CORS Issues\n      console.log('üß™ Test 4: CORS Test...');\n      try {\n        const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n        const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n        \n        const corsResponse = await fetch(`${supabaseUrl}/rest/v1/games?select=count&limit=0`, {\n          headers: {\n            'apikey': supabaseKey,\n            'Accept': 'application/json'\n          }\n        });\n        \n        results.corsIssues = !corsResponse.ok && corsResponse.status === 0;\n        console.log(`‚úÖ CORS: ${results.corsIssues ? 'BLOCKED' : 'OK'}`);\n      } catch (error: any) {\n        results.corsIssues = error.message?.includes('CORS') || error.message?.includes('blocked');\n        console.log(`‚úÖ CORS: ${results.corsIssues ? 'BLOCKED' : 'OK'}`);\n      }\n      \n      // Test 5: Auth Endpoint\n      console.log('üß™ Test 5: Auth Endpoint...');\n      try {\n        const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n        const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n        \n        const authResponse = await fetch(`${supabaseUrl}/auth/v1/settings`, {\n          headers: {\n            'apikey': supabaseKey\n          }\n        });\n        \n        results.authEndpoint = authResponse.ok;\n        console.log(`‚úÖ Auth Endpoint: ${results.authEndpoint ? 'OK' : 'FAILED'}`);\n      } catch (error) {\n        console.error('‚ùå Auth Endpoint failed:', error);\n        results.authEndpoint = false;\n      }\n      \n      // Test 6: REST Endpoint with actual query\n      console.log('üß™ Test 6: REST Endpoint Query...');\n      try {\n        const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n        const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n        \n        const restResponse = await fetch(`${supabaseUrl}/rest/v1/games?select=id&limit=1`, {\n          headers: {\n            'apikey': supabaseKey,\n            'Accept': 'application/json'\n          }\n        });\n        \n        results.restEndpoint = restResponse.ok;\n        console.log(`‚úÖ REST Endpoint: ${results.restEndpoint ? 'OK' : 'FAILED'}`);\n        \n        if (restResponse.ok) {\n          const data = await restResponse.json();\n          console.log('üìä Sample data:', data);\n        } else {\n          console.error('‚ùå REST response:', await restResponse.text());\n        }\n      } catch (error) {\n        console.error('‚ùå REST Endpoint failed:', error);\n        results.restEndpoint = false;\n      }\n      \n      // Summary and Recommendations\n      console.log('\\nüìä CONNECTION TEST RESULTS:');\n      console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      console.log(`üåê Basic Fetch:      ${results.basicFetch ? '‚úÖ OK' : '‚ùå FAILED'}`);\n      console.log(`üè• Supabase Health:  ${results.supabaseHealth ? '‚úÖ HEALTHY' : '‚ùå UNHEALTHY'}`);\n      console.log(`üîç DNS Resolution:   ${results.dnsResolution ? '‚úÖ OK' : '‚ùå FAILED'}`);\n      console.log(`‚è±Ô∏è  Network Latency:  ${results.networkLatency.toFixed(2)}ms`);\n      console.log(`üö´ CORS Issues:      ${results.corsIssues ? '‚ùå BLOCKED' : '‚úÖ OK'}`);\n      console.log(`üîê Auth Endpoint:    ${results.authEndpoint ? '‚úÖ OK' : '‚ùå FAILED'}`);\n      console.log(`üì° REST Endpoint:    ${results.restEndpoint ? '‚úÖ OK' : '‚ùå FAILED'}`);\n      console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      \n      // Provide specific recommendations\n      this.provideRecommendations(results);\n      \n    } catch (error) {\n      console.error('‚ùå Connection test failed:', error);\n    }\n  }\n  \n  /**\n   * Provide specific recommendations based on test results\n   */\n  private static provideRecommendations(results: any): void {\n    console.log('\\nüí° RECOMMENDATIONS:');\n    \n    if (!results.basicFetch) {\n      console.log('üö® CRITICAL: Basic fetch failed');\n      console.log('   ‚Üí Check internet connection');\n      console.log('   ‚Üí Try different network (mobile hotspot)');\n      console.log('   ‚Üí Check firewall/antivirus settings');\n    }\n    \n    if (!results.dnsResolution) {\n      console.log('üö® CRITICAL: DNS resolution failed');\n      console.log('   ‚Üí Try different DNS servers (8.8.8.8, 1.1.1.1)');\n      console.log('   ‚Üí Check /etc/hosts file for conflicts');\n      console.log('   ‚Üí Restart network adapter');\n    }\n    \n    if (!results.supabaseHealth) {\n      console.log('üö® CRITICAL: Supabase is unhealthy');\n      console.log('   ‚Üí Check status.supabase.com');\n      console.log('   ‚Üí Verify project isn\\'t paused/suspended');\n      console.log('   ‚Üí Check billing status');\n    }\n    \n    if (results.corsIssues) {\n      console.log('üö® CRITICAL: CORS blocking requests');\n      console.log('   ‚Üí Check Supabase project settings');\n      console.log('   ‚Üí Add localhost to allowed origins');\n      console.log('   ‚Üí Try incognito mode');\n    }\n    \n    if (results.networkLatency > 5000) {\n      console.log('‚ö†Ô∏è  WARNING: High network latency');\n      console.log('   ‚Üí Try different Supabase region');\n      console.log('   ‚Üí Check network quality');\n      console.log('   ‚Üí Consider CDN/proxy');\n    }\n    \n    if (!results.authEndpoint) {\n      console.log('‚ö†Ô∏è  WARNING: Auth endpoint failed');\n      console.log('   ‚Üí Check API keys');\n      console.log('   ‚Üí Verify project configuration');\n    }\n    \n    if (!results.restEndpoint) {\n      console.log('üö® CRITICAL: REST endpoint failed');\n      console.log('   ‚Üí This is likely your main issue');\n      console.log('   ‚Üí Check RLS policies');\n      console.log('   ‚Üí Verify table permissions');\n    }\n    \n    // Overall assessment\n    const criticalIssues = [\n      !results.basicFetch,\n      !results.dnsResolution, \n      !results.supabaseHealth,\n      results.corsIssues,\n      !results.restEndpoint\n    ].filter(Boolean).length;\n    \n    if (criticalIssues === 0) {\n      console.log('‚úÖ All tests passed - connection should work!');\n    } else if (criticalIssues <= 2) {\n      console.log(`‚ö†Ô∏è  ${criticalIssues} issues found - fixable`);\n    } else {\n      console.log(`üö® ${criticalIssues} critical issues - major connection problems`);\n    }\n  }\n  \n  /**\n   * Quick network fixes to try\n   */\n  static async tryQuickFixes(): Promise<void> {\n    console.log('üîß [Connection] Trying quick fixes...');\n    \n    // Fix 1: Clear browser cache\n    console.log('üßπ Clearing browser cache...');\n    try {\n      if ('caches' in window) {\n        const cacheNames = await caches.keys();\n        await Promise.all(cacheNames.map(name => caches.delete(name)));\n        console.log('‚úÖ Browser cache cleared');\n      }\n    } catch (error) {\n      console.warn('‚ö†Ô∏è Could not clear cache:', error);\n    }\n    \n    // Fix 2: Reset fetch configuration\n    console.log('üîÑ Resetting fetch configuration...');\n    // Force new connection by adding timestamp\n    const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n    const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n    const testUrl = `${supabaseUrl}/rest/v1/?t=${Date.now()}`;\n    \n    try {\n      const response = await fetch(testUrl, {\n        headers: {\n          'apikey': supabaseKey,\n          'Cache-Control': 'no-cache',\n          'Pragma': 'no-cache'\n        }\n      });\n      \n      console.log(`‚úÖ Fresh connection test: ${response.ok ? 'SUCCESS' : 'FAILED'}`);\n    } catch (error) {\n      console.error('‚ùå Fresh connection failed:', error);\n    }\n    \n    // Fix 3: Test with different headers\n    console.log('üîÑ Testing with minimal headers...');\n    try {\n      const supabaseUrl = (import.meta as any).env?.VITE_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\n      const supabaseKey = (import.meta as any).env?.VITE_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\n      \n      const response = await fetch(`${supabaseUrl}/rest/v1/games?select=count`, {\n        method: 'GET',\n        headers: {\n          'apikey': supabaseKey\n        }\n      });\n      \n      console.log(`‚úÖ Minimal headers test: ${response.ok ? 'SUCCESS' : 'FAILED'}`);\n      if (response.ok) {\n        const data = await response.json();\n        console.log('üìä Response data:', data);\n      }\n    } catch (error) {\n      console.error('‚ùå Minimal headers failed:', error);\n    }\n  }\n}\n\n// Global access for debugging\nif (typeof window !== 'undefined') {\n  (window as any).connectionTest = () => ConnectionDiagnostic.runConnectionTest();\n  (window as any).quickFixes = () => ConnectionDiagnostic.tryQuickFixes();\n}\n","import React, { useState } from 'react';\nimport { useQueryClient } from '@tanstack/react-query';\nimport { Button } from './ui/button';\nimport { RefreshCw, Trash2, AlertTriangle, Bug, Zap, Wifi } from 'lucide-react';\nimport { gameKeys } from '../hooks/useGames';\nimport { queryDebugger } from '../utils/queryDebugger';\nimport { SupabaseDiagnostics } from '../utils/supabaseDiagnostics';\nimport { SupabaseSpeedTest } from '../utils/supabaseSpeedTest';\nimport { ConnectionDiagnostic } from '../utils/connectionDiagnostic';\n\nexport function CacheClearButton() {\n  const queryClient = useQueryClient();\n  const [clearing, setClearing] = useState(false);\n  const [lastCleared, setLastCleared] = useState<Date | null>(null);\n  const [runningDiagnostics, setRunningDiagnostics] = useState(false);\n  const [runningSpeedTest, setRunningSpeedTest] = useState(false);\n  const [runningConnectionTest, setRunningConnectionTest] = useState(false);\n\n  const clearGameCache = async () => {\n    setClearing(true);\n    console.log('üßπ [CacheClearButton] Clearing game cache...');\n    \n    try {\n      // Remove all game-related queries\n      queryClient.removeQueries({\n        predicate: (query) => \n          query.queryKey.includes('games') || \n          query.queryKey.some(key => typeof key === 'string' && key.includes('game'))\n      });\n      \n      // Invalidate any remaining game queries\n      await queryClient.invalidateQueries({ queryKey: gameKeys.all });\n      \n      // Clear query debugger cache\n      queryDebugger.clearAllGameQueries();\n      \n      setLastCleared(new Date());\n      console.log('‚úÖ [CacheClearButton] Game cache cleared successfully');\n      \n      // Force a fresh fetch\n      setTimeout(() => {\n        queryClient.refetchQueries({ queryKey: gameKeys.lists() });\n      }, 100);\n      \n    } catch (error) {\n      console.error('‚ùå [CacheClearButton] Error clearing cache:', error);\n    } finally {\n      setClearing(false);\n    }\n  };\n\n  const clearAllCache = async () => {\n    setClearing(true);\n    console.log('üßπ [CacheClearButton] Clearing ALL cache...');\n    \n    try {\n      // Clear React Query cache\n      queryClient.clear();\n      \n      // Clear browser storage\n      localStorage.removeItem('supabase.auth.token');\n      sessionStorage.clear();\n      \n      setLastCleared(new Date());\n      console.log('‚úÖ [CacheClearButton] All cache cleared');\n      \n      // Reload the page after clearing everything\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n      \n    } catch (error) {\n      console.error('‚ùå [CacheClearButton] Error clearing all cache:', error);\n    } finally {\n      setClearing(false);\n    }\n  };\n\n  const runDiagnostics = async () => {\n    setRunningDiagnostics(true);\n    console.log('üîç [CacheClearButton] Running Supabase diagnostics...');\n    \n    try {\n      await SupabaseDiagnostics.runDiagnostics();\n      console.log('‚úÖ [CacheClearButton] Diagnostics completed - check console for results');\n    } catch (error) {\n      console.error('‚ùå [CacheClearButton] Diagnostics failed:', error);\n    } finally {\n      setRunningDiagnostics(false);\n    }\n  };\n\n  const runSpeedTest = async () => {\n    setRunningSpeedTest(true);\n    console.log('üèÉ‚Äç‚ôÇÔ∏è [CacheClearButton] Running Supabase speed test...');\n    \n    try {\n      await SupabaseSpeedTest.runFullSpeedTest();\n      console.log('‚úÖ [CacheClearButton] Speed test completed - check console for results');\n    } catch (error) {\n      console.error('‚ùå [CacheClearButton] Speed test failed:', error);\n    } finally {\n      setRunningSpeedTest(false);\n    }\n  };\n\n  const runConnectionTest = async () => {\n    setRunningConnectionTest(true);\n    console.log('üîç [CacheClearButton] Running connection diagnostic...');\n    \n    try {\n      await ConnectionDiagnostic.runConnectionTest();\n      console.log('‚úÖ [CacheClearButton] Connection test completed - check console for results');\n    } catch (error) {\n      console.error('‚ùå [CacheClearButton] Connection test failed:', error);\n    } finally {\n      setRunningConnectionTest(false);\n    }\n  };\n\n  const getQueryStats = () => {\n    const cache = queryClient.getQueryCache();\n    const queries = cache.getAll();\n    \n    const gameQueries = queries.filter(q => \n      q.queryKey.includes('games') || \n      q.queryKey.some(key => typeof key === 'string' && key.includes('game'))\n    );\n    \n    const staleQueries = gameQueries.filter(q => q.isStale());\n    \n    return {\n      total: queries.length,\n      gameQueries: gameQueries.length,\n      staleGameQueries: staleQueries.length\n    };\n  };\n\n  const stats = getQueryStats();\n\n  return (\n    <div className=\"fixed bottom-4 right-4 z-50 bg-card border rounded-lg p-4 shadow-lg max-w-sm\">\n      <div className=\"flex items-center gap-2 mb-3\">\n        <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />\n        <span className=\"text-sm font-medium\">Cache Debug</span>\n      </div>\n      \n      <div className=\"text-xs text-muted-foreground mb-3 space-y-1\">\n        <div>Total Queries: {stats.total}</div>\n        <div>Game Queries: {stats.gameQueries}</div>\n        <div className={stats.staleGameQueries > 0 ? 'text-yellow-600' : ''}>\n          Stale Game Queries: {stats.staleGameQueries}\n        </div>\n        {lastCleared && (\n          <div>Last Cleared: {lastCleared.toLocaleTimeString()}</div>\n        )}\n      </div>\n      \n      <div className=\"space-y-2\">\n        <div className=\"flex gap-2\">\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={clearGameCache}\n            disabled={clearing}\n            className=\"flex-1\"\n          >\n            <RefreshCw className={`w-3 h-3 mr-1 ${clearing ? 'animate-spin' : ''}`} />\n            Clear Games\n          </Button>\n          \n          <Button\n            size=\"sm\"\n            variant=\"destructive\"\n            onClick={clearAllCache}\n            disabled={clearing}\n            className=\"flex-1\"\n          >\n            <Trash2 className=\"w-3 h-3 mr-1\" />\n            Clear All\n          </Button>\n        </div>\n        \n        <Button\n          size=\"sm\"\n          variant=\"secondary\"\n          onClick={runDiagnostics}\n          disabled={runningDiagnostics}\n          className=\"w-full\"\n        >\n          <Bug className={`w-3 h-3 mr-1 ${runningDiagnostics ? 'animate-pulse' : ''}`} />\n          {runningDiagnostics ? 'Running Diagnostics...' : 'Diagnose DB Issues'}\n        </Button>\n        \n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={runSpeedTest}\n          disabled={runningSpeedTest}\n          className=\"w-full\"\n        >\n          <Zap className={`w-3 h-3 mr-1 ${runningSpeedTest ? 'animate-bounce' : ''}`} />\n          {runningSpeedTest ? 'Testing Speed...' : 'Test Supabase Speed'}\n        </Button>\n        \n        <Button\n          size=\"sm\"\n          variant=\"destructive\"\n          onClick={runConnectionTest}\n          disabled={runningConnectionTest}\n          className=\"w-full\"\n        >\n          <Wifi className={`w-3 h-3 mr-1 ${runningConnectionTest ? 'animate-pulse' : ''}`} />\n          {runningConnectionTest ? 'Testing Connection...' : 'Fix Connection Issues'}\n        </Button>\n      </div>\n      \n      <div className=\"text-xs text-muted-foreground mt-2\">\n        \"Fix Connection\" will diagnose network/DNS/CORS issues\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Button } from './ui/button';\nimport { Plus, RefreshCw, MapPin, Clock, Users } from 'lucide-react';\nimport { formatEventHeader, formatCalendarInfo, formatTimeString } from '../lib/dateUtils';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { useAppStore } from '../store/appStore';\nimport { useUserPresence } from '../hooks/useUserPresence';\nimport { useGames } from '../hooks/useGames';\nimport { useLocation } from '../hooks/useLocation';\nimport { useAllGamesRealtime } from '../hooks/useGameRealtime';\nimport { UnifiedGameCard } from './UnifiedGameCard';\nimport { GameCardSkeleton } from './GameCardSkeleton';\nimport { CacheClearButton } from './CacheClearButton';\n\n\n\n// Using UnifiedGameCard component for consistency\n\nfunction HomeScreen() {\n  const navigate = useNavigate();\n  const { user } = useAppStore();\n  const { data: games = [], isLoading, error, refetch, isError, isPending, isRefetching } = useGames();\n  const [refreshing, setRefreshing] = useState(false);\n  const [timedOut, setTimedOut] = useState(false);\n  const [forceTimeout, setForceTimeout] = useState(false);\n  const userPreferredSports = useMemo(() => user?.preferences?.sports ?? [], [user]);\n  // Real-time presence tracking (no polling)\n  const { onlineCount, isLoading: presenceLoading } = useUserPresence();\n  // Location services for distance calculations\n  const { currentLocation, isLoading: locationLoading, permission, requestLocation, getFormattedDistanceTo } = useLocation();\n  // Real-time updates for all games\n  const { isConnected: realtimeConnected } = useAllGamesRealtime();\n  \n  // Force timeout if loading takes too long\n  useEffect(() => {\n    if (isLoading || isPending) {\n      console.log('üï∞Ô∏è [HomeScreen] Starting loading timeout timer');\n      const timeout = setTimeout(() => {\n        console.warn('‚ö†Ô∏è [HomeScreen] Force timeout after 20 seconds');\n        setForceTimeout(true);\n      }, 20000);\n      \n      return () => {\n        clearTimeout(timeout);\n        setForceTimeout(false);\n      };\n    }\n  }, [isLoading, isPending]);\n  \n  // Game selection handler\n  const handleGameSelect = (gameId: string) => {\n    navigate(`/game/${gameId}`);\n  };\n  \n\n  // Calculate test-focused stats with feature tracking\n  const stats = useMemo(() => {\n    const now = new Date();\n    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n    \n    // Games available today\n    const gamesToday = games.filter(game => {\n      const gameDate = new Date(game.date);\n      return gameDate.toDateString() === today.toDateString();\n    }).length;\n    \n    // Games nearby (within 10km)\n    const gamesNearby = currentLocation ? games.filter(game => {\n      if (!game.latitude || !game.longitude) return false;\n      const distance = getFormattedDistanceTo({ latitude: game.latitude, longitude: game.longitude });\n      return distance && parseFloat(distance) <= 10; // Within 10km\n    }).length : 0;\n    \n    // Games user has joined\n    const gamesJoined = games.filter(game => game.isJoined).length;\n    \n    // Games user has created (assuming creatorId matches user id)\n    const gamesCreated = games.filter(game => game.creatorId === user?.id).length;\n    \n    // Feature testing progress - ONLY trackable features\n    const featuresTestable = [\n      { name: 'Profile Setup', tested: !!(user?.name && user?.email) },\n      { name: 'Avatar Upload', tested: !!user?.avatar },\n      { name: 'Sport Preferences', tested: !!(user?.preferences?.sports && user.preferences.sports.length > 0) },\n      { name: 'Location Access', tested: permission === 'granted' },\n      { name: 'Join Game', tested: gamesJoined > 0 },\n      { name: 'Create Game', tested: gamesCreated > 0 },\n      { name: 'Game Discovery', tested: true } // Always true if they're on home screen\n    ];\n    \n    const featuresTested = featuresTestable.filter(f => f.tested).length;\n    const totalFeatures = featuresTestable.length;\n    \n    // Calculate test streak (simplified - could be enhanced with actual dates)\n    const testStreak = gamesJoined > 0 ? Math.min(gamesJoined + gamesCreated, 7) : 0;\n    \n    // Next specific actions based on what they haven't done\n    const nextActions: string[] = [];\n    if (permission !== 'granted') nextActions.push('Enable Location Access');\n    if (!user?.avatar) nextActions.push('Upload Profile Photo');\n    if (gamesCreated === 0) nextActions.push('Create Your First Game');\n    if (gamesJoined === 0 && gamesToday > 0) nextActions.push(`Join a Game (${gamesToday} today)`);\n    if (!user?.preferences?.sports || user.preferences.sports.length === 0) {\n      nextActions.push('Set Sport Preferences');\n    }\n    if (nextActions.length === 0) {\n      nextActions.push('Explore Game Details', 'Try Search/Filter', 'Check Settings');\n    }\n\n    return {\n      totalGames: games.length,\n      gamesToday,\n      gamesNearby,\n      gamesJoined,\n      gamesCreated,\n      featuresTested,\n      totalFeatures,\n      testStreak,\n      completionRate: Math.round((featuresTested / totalFeatures) * 100),\n      nextActions: nextActions.slice(0, 4) // Limit to 4 actions\n    };\n  }, [games, user, currentLocation, permission, getFormattedDistanceTo]);\n\n  // No need for manual loading with React Query\n\n\n  // Disabled realtime to prevent WebSocket connection issues\n  // useEffect(() => {\n  //   let timeoutId: NodeJS.Timeout;\n  //   \n  //   const sub = SupabaseService.subscribeToAllGames((payload) => {\n  //     console.log('[Realtime] games INSERT received', payload?.new?.id || '');\n  //     \n  //     // Debounce realtime updates to avoid excessive API calls\n  //     clearTimeout(timeoutId);\n  //     timeoutId = setTimeout(async () => {\n  //       try {\n  //         const data = feedMode === 'recommended'\n  //           ? await SupabaseService.getRecommendedGames(userPreferredSports)\n  //           : await SupabaseService.getGames();\n  //         setGames(data);\n  //       } catch (error) {\n  //         console.error('[Realtime] Failed to refresh games:', error);\n  //       }\n  //     }, 1000);\n  //   });\n  //   \n  //   return () => {\n  //     clearTimeout(timeoutId);\n  //     try { sub.unsubscribe(); } catch {}\n  //   };\n  //   // eslint-disable-next-line react-hooks/exhaustive-deps\n  // }, [feedMode, userPreferredSports.join?.('|') ?? '']);\n\n  // No need for manual loading state cleanup with React Query\n\n\n  // loadGames function removed - using React Query instead\n\n  const handleRefresh = async () => {\n    if (refreshing) return; // Prevent multiple concurrent refreshes\n    \n    setTimedOut(false);\n    setRefreshing(true);\n    try {\n      await refetch();\n    } finally {\n      setRefreshing(false);\n    }\n  };\n\n  const handleCreateGame = () => {\n    navigate('/create');\n  };\n\n  // Sort games chronologically with smart grouping\n  const sortedGames = games\n    .map(game => {\n      const gameDate = new Date(game.date);\n      const today = new Date();\n      const tomorrow = new Date(today);\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      \n      // Determine game category for sorting and display\n      let category = 'future';\n      let sortOrder = gameDate.getTime();\n      \n      if (gameDate.toDateString() === today.toDateString()) {\n        category = 'today';\n        sortOrder = 0; // Today's games first\n      } else if (gameDate.toDateString() === tomorrow.toDateString()) {\n        category = 'tomorrow';\n        sortOrder = 1; // Tomorrow's games second\n      }\n      \n      return {\n        ...game,\n        category,\n        sortOrder,\n        gameDate\n      };\n    })\n    .sort((a, b) => {\n      // First sort by category (today, tomorrow, future)\n      if (a.sortOrder !== b.sortOrder) {\n        return a.sortOrder - b.sortOrder;\n      }\n      // Then sort by time within each category\n      return a.gameDate.getTime() - b.gameDate.getTime();\n    });\n\n  // Show loading state with timeout handling\n  if ((isLoading || isPending) && games.length === 0 && !forceTimeout) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading games...</p>\n          <p className=\"text-xs text-muted-foreground/70\">\n            {isRefetching ? 'Refreshing...' : 'This should only take a moment'}\n          </p>\n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={() => {\n              console.log('üîÑ [HomeScreen] Manual refresh triggered');\n              setForceTimeout(false);\n              refetch();\n            }}\n          >\n            Refresh Now\n          </Button>\n        </div>\n      </div>\n    );\n  }\n  \n  // Show error state\n  if ((isError || error || forceTimeout) && games.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"text-destructive text-lg font-semibold\">\n            {forceTimeout ? 'Loading Timeout' : 'Connection Error'}\n          </div>\n          <p className=\"text-muted-foreground max-w-md\">\n            {forceTimeout \n              ? 'Games are taking too long to load. This might be a network or server issue.'\n              : error?.message || 'Unable to load games. Please check your connection.'}\n          </p>\n          <div className=\"flex gap-2 justify-center\">\n            <Button \n              onClick={() => {\n                console.log('üîÑ [HomeScreen] Error state refresh');\n                setForceTimeout(false);\n                setTimedOut(false);\n                refetch();\n              }}\n            >\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Try Again\n            </Button>\n            <Button \n              variant=\"outline\"\n              onClick={() => {\n                console.log('üßπ [HomeScreen] Clearing cache and refreshing');\n                localStorage.removeItem('supabase.auth.token');\n                window.location.reload();\n              }}\n            >\n              Clear Cache & Reload\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Log current state for debugging\n  console.log('üìä [HomeScreen] Current state:', {\n    isLoading,\n    isPending,\n    isError,\n    isRefetching,\n    forceTimeout,\n    gamesCount: games.length,\n    error: error?.message,\n    user: user?.id || 'anonymous'\n  });\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Cache Clear Button - only show in development or if there are stale queries */}\n      {(typeof window !== 'undefined' && \n        (window.location.hostname === 'localhost' || isError || forceTimeout)) && (\n        <CacheClearButton />\n      )}\n      \n      <div className=\"max-w-7xl mx-auto p-4 md:p-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\n          {/* Main Content */}\n          <div className=\"lg:col-span-8\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div>\n                <h1 className=\"text-2xl md:text-3xl font-bold\">TribeUp</h1>\n                <p className=\"text-muted-foreground\">Find your next game</p>\n              </div>\n              <div className=\"flex gap-2\">\n                <Button \n                  onClick={() => navigate('/create-game')}\n                  className=\"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-semibold\"\n                >\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Create Game\n                </Button>\n              </div>\n            </div>\n\n            {/* Games List */}\n            <div className=\"flex items-center justify-between mb-4\">\n              <h2 className=\"text-lg md:text-xl font-semibold\">Upcoming Games</h2>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={isLoading}\n                className=\"hidden md:flex\"\n              >\n                <RefreshCw className={`w-4 h-4 mr-2 ${isLoading ? 'animate-spin' : ''}`} />\n                Refresh\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={isLoading}\n                className=\"md:hidden\"\n                aria-label=\"Refresh games\"\n              >\n                <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n              </Button>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {isLoading ? (\n                // Show skeleton loading\n                Array.from({ length: 6 }).map((_, index) => (\n                  <GameCardSkeleton key={index} />\n                ))\n              ) : (\n                sortedGames.map((game) => (\n                  <div key={game.id}>\n                    <UnifiedGameCard\n                      game={game}\n                      variant=\"simple\"\n                      onSelect={() => handleGameSelect(game.id)}\n                    />\n                  </div>\n                ))\n              )}\n            </div>\n          </div>\n\n          {/* Sidebar - Desktop Only */}\n          <div className=\"hidden lg:block lg:col-span-4\">\n            <div className=\"bg-card rounded-lg p-6 sticky top-6\">\n              <h3 className=\"text-lg font-semibold mb-4\">Test Progress</h3>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Features Tested</span>\n                  <span className=\"font-semibold\">{stats.featuresTested}/{stats.totalFeatures}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Completion Rate</span>\n                  <span className=\"font-semibold\">{stats.completionRate}%</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Games Today</span>\n                  <span className=\"font-semibold\">{stats.gamesToday}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Games Nearby</span>\n                  <span className=\"font-semibold\">\n                    {currentLocation ? stats.gamesNearby : '?'}\n                    {!currentLocation && (\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={requestLocation}\n                        className=\"ml-2 h-6 px-2 text-xs\"\n                      >\n                        <MapPin className=\"w-3 h-3 mr-1\" />\n                        Enable\n                      </Button>\n                    )}\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Games Created</span>\n                  <span className=\"font-semibold\">{stats.gamesCreated}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Test Streak</span>\n                  <span className=\"font-semibold\">{stats.testStreak} days</span>\n                </div>\n              </div>\n              \n              <div className=\"mt-6\">\n                <h4 className=\"text-sm font-semibold mb-3\">Next Actions</h4>\n                <div className=\"space-y-2\">\n                  {stats.nextActions.map((action, index) => (\n                    <div key={index} className=\"text-sm text-muted-foreground flex items-center\">\n                      <span className=\"mr-2\">‚Üí</span>\n                      {action}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Sidebar */}\n          <div className=\"lg:col-span-4 space-y-6\">\n            {/* Stats Cards */}\n            <div className=\"grid grid-cols-2 lg:grid-cols-1 gap-4\">\n              <div className=\"bg-card rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-primary\">{stats.completionRate}%</div>\n                <div className=\"text-sm text-muted-foreground\">Features Tested</div>\n              </div>\n              <div className=\"bg-card rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-primary\">{stats.testStreak}</div>\n                <div className=\"text-sm text-muted-foreground\">Test Streak</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default HomeScreen;\n","import React, { useEffect, useRef } from 'react';\nimport { supabase } from '../lib/supabase';\nimport { useQueryClient } from '@tanstack/react-query';\n\nexport function useGameRealtime(gameId?: string) {\n  const queryClient = useQueryClient();\n  const channelRef = useRef<any>(null);\n\n  useEffect(() => {\n    // Realtime disabled to prevent WebSocket failures\n    console.log('üö´ [Realtime] Disabled for game:', gameId);\n    return;\n    \n    if (!gameId) return;\n\n    console.log('üîó Setting up realtime for game:', gameId);\n\n    try {\n      // Create channel for this specific game using proper Supabase client\n      const channel = supabase\n        .channel(`game-${gameId}`)\n        .on('postgres_changes', {\n          event: '*',\n          schema: 'public',\n          table: 'game_participants',\n          filter: `game_id=eq.${gameId}`\n        }, (payload) => {\n          console.log('üë• Participant update:', payload);\n          \n          // Invalidate queries to refetch data\n          queryClient.invalidateQueries({ queryKey: ['game', gameId] });\n          queryClient.invalidateQueries({ queryKey: ['games'] });\n        })\n        .on('postgres_changes', {\n          event: 'UPDATE',\n          schema: 'public', \n          table: 'games',\n          filter: `id=eq.${gameId}`\n        }, (payload) => {\n          console.log('üéÆ Game update:', payload);\n          \n          // Invalidate game queries\n          queryClient.invalidateQueries({ queryKey: ['game', gameId] });\n          queryClient.invalidateQueries({ queryKey: ['games'] });\n        })\n        .subscribe((status) => {\n          console.log('üì° Game realtime status:', status);\n        });\n\n      channelRef.current = channel;\n    } catch (error) {\n      console.error('‚ùå Failed to setup realtime:', error);\n    }\n\n    return () => {\n      console.log('üîå Unsubscribing from game realtime:', gameId);\n      if (channelRef.current) {\n        channelRef.current.unsubscribe();\n      }\n    };\n  }, [gameId, queryClient]);\n\n  return {\n    isConnected: channelRef.current?.state === 'joined'\n  };\n}\n\n// Hook for all games realtime updates\nexport function useAllGamesRealtime() {\n  const queryClient = useQueryClient();\n  const channelRef = useRef<any>(null);\n  const [connectionAttempts, setConnectionAttempts] = React.useState(0);\n  const [isDisabled, setIsDisabled] = React.useState(true); // DISABLED BY DEFAULT\n\n  useEffect(() => {\n    // Realtime is disabled - just return early\n    console.log('üö´ [Realtime] Disabled to prevent WebSocket failures');\n    return;\n\n    console.log('üîó Setting up realtime for all games (attempt', connectionAttempts + 1, ')');\n\n    try {\n      const channel = supabase\n        .channel('all-games-v2') // Use versioned channel name\n        .on('postgres_changes', {\n          event: '*',\n          schema: 'public',\n          table: 'games'\n        }, (payload) => {\n          console.log('üéÆ Games table update:', payload);\n          \n          // Throttle invalidations to prevent excessive refetches\n          setTimeout(() => {\n            queryClient.invalidateQueries({ queryKey: ['games'] });\n          }, 1000);\n        })\n        .on('postgres_changes', {\n          event: '*',\n          schema: 'public',\n          table: 'game_participants'\n        }, (payload) => {\n          console.log('üë• Participants table update:', payload);\n          \n          // Throttle invalidations\n          setTimeout(() => {\n            queryClient.invalidateQueries({ queryKey: ['games'] });\n          }, 1000);\n        })\n        .subscribe((status) => {\n          console.log('üì° All games realtime status:', status);\n          \n          if (status === 'SUBSCRIBED') {\n            setConnectionAttempts(0); // Reset on success\n          } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n            console.error('‚ùå Realtime connection failed:', status);\n            setConnectionAttempts(prev => prev + 1);\n            \n            // Disable after 3 failures\n            if (connectionAttempts >= 2) {\n              setIsDisabled(true);\n              console.warn('üö´ Realtime permanently disabled due to repeated failures');\n            }\n          }\n        });\n\n      channelRef.current = channel;\n      \n      // Set timeout to detect stuck connections\n      const connectionTimeout = setTimeout(() => {\n        if (channelRef.current?.state !== 'joined') {\n          console.warn('‚è∞ Realtime connection timeout, retrying...');\n          channelRef.current?.unsubscribe();\n          setConnectionAttempts(prev => prev + 1);\n        }\n      }, 10000);\n      \n      return () => {\n        clearTimeout(connectionTimeout);\n      };\n      \n    } catch (error) {\n      console.error('‚ùå Failed to setup all games realtime:', error);\n      setConnectionAttempts(prev => prev + 1);\n    }\n\n    return () => {\n      console.log('üîå Unsubscribing from all games realtime');\n      if (channelRef.current) {\n        try {\n          channelRef.current.unsubscribe();\n        } catch (error) {\n          console.warn('‚ö†Ô∏è Error unsubscribing from realtime:', error);\n        }\n      }\n    };\n  }, [queryClient, connectionAttempts, isDisabled]);\n\n  return {\n    isConnected: channelRef.current?.state === 'joined',\n    isDisabled,\n    connectionAttempts\n  };\n}\n"],"names":["calculateDistance","lat1","lon1","lat2","lon2","dLat","toRadians","dLon","a","Math","sin","cos","atan2","sqrt","degrees","PI","formatDistance","distance","unit","round","toFixed","useLocation","options","enableHighAccuracy","timeout","maximumAge","watchPosition","autoRequest","state","setState","useState","currentLocation","isLoading","error","permission","lastUpdated","watchIdRef","useRef","requestInProgressRef","isSupported","navigator","checkPermission","useCallback","async","prev","permissions","query","name","requestLocation","current","Promise","resolve","geoOptions","geolocation","getCurrentPosition","position","location","latitude","coords","longitude","accuracy","altitude","heading","speed","Date","errorMessage","code","PERMISSION_DENIED","toast","POSITION_UNAVAILABLE","TIMEOUT","startWatching","stopWatching","clearWatch","clearLocation","getDistanceTo","target","getFormattedDistanceTo","isNearby","radiusKm","useEffect","getBoundsFromCenter","center","latOffset","lonOffset","north","south","east","west","GameCardSkeleton","jsx","Card","className","children","CardContent","jsxs","Skeleton","SupabaseDiagnostics","runDiagnostics","this","testConnection","testAuth","testTableAccess","testRLSPolicies","testGameQuery","startTime","performance","now","data","race","supabase","from","select","count","head","_","reject","setTimeout","Error","user","auth","getUser","tables","table","limit","message","includes","anonGames","anonError","authGames","authError","games","length","gameId","id","eq","single","simpleData","simpleError","generateRLSFix","window","supabaseDiagnostics","getRLSFix","SupabaseSpeedTest","runFullSpeedTest","results","connection","simpleQuery","complexQuery","joinQuery","participantsQuery","usersQuery","start1","countError","start2","start3","simpleGames","start4","complexGames","complexError","start5","participants","partError","start6","users","usersError","testNetworkLatency","times","i","start","time","push","avg","reduce","b","min","max","testProblematicQuery","gte","toISOString","split","order","ascending","duration","supabaseSpeedTest","testSupabaseSpeed","testLatency","ConnectionDiagnostic","runConnectionTest","basicFetch","supabaseHealth","dnsResolution","networkLatency","corsIssues","authEndpoint","restEndpoint","basicStart","supabaseUrl","supabaseKey","response","fetch","method","headers","apikey","ok","url","URL","hostname","mode","healthResponse","Accept","corsResponse","status","authResponse","restResponse","json","provideRecommendations","filter","Boolean","tryQuickFixes","cacheNames","caches","keys","all","map","delete","testUrl","Pragma","CacheClearButton","queryClient","useQueryClient","clearing","setClearing","lastCleared","setLastCleared","runningDiagnostics","setRunningDiagnostics","runningSpeedTest","setRunningSpeedTest","runningConnectionTest","setRunningConnectionTest","stats","queries","getQueryCache","getAll","gameQueries","q","queryKey","some","key","staleQueries","isStale","total","staleGameQueries","getQueryStats","AlertTriangle","toLocaleTimeString","Button","size","variant","onClick","removeQueries","predicate","invalidateQueries","gameKeys","queryDebugger","clearAllGameQueries","refetchQueries","lists","disabled","RefreshCw","clear","localStorage","removeItem","sessionStorage","reload","Trash2","Bug","Zap","Wifi","HomeScreen","navigate","useNavigate","useAppStore","refetch","isError","isPending","isRefetching","useGames","refreshing","setRefreshing","timedOut","setTimedOut","forceTimeout","setForceTimeout","useMemo","preferences","sports","channelRef","connectionAttempts","setConnectionAttempts","React","isDisabled","setIsDisabled","useAllGamesRealtime","clearTimeout","today","getFullYear","getMonth","getDate","gamesToday","game","date","toDateString","gamesNearby","parseFloat","gamesJoined","isJoined","gamesCreated","creatorId","featuresTestable","tested","email","avatar","featuresTested","f","totalFeatures","testStreak","nextActions","totalGames","completionRate","slice","handleRefresh","sortedGames","gameDate","tomorrow","setDate","category","sortOrder","getTime","sort","Plus","Array","index","UnifiedGameCard","onSelect","handleGameSelect","MapPin","action","connectionTest","quickFixes"],"mappings":"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"}