{"version":3,"file":"UserProfile-VFBBG4D5.js","sources":["../../src/components/UserProfile.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Button } from './ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Badge } from './ui/badge';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { Settings, Trophy, Calendar, MapPin, Star } from 'lucide-react';\nimport { useAppStore } from '../store/appStore';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { formatTimeString } from '../lib/dateUtils';\n\nexport function UserProfile() {\n  const navigate = useNavigate();\n  const { user } = useAppStore();\n  const [userStats, setUserStats] = useState([\n    { label: 'Games Played', value: '0', icon: Calendar },\n    { label: 'Games Hosted', value: '0', icon: MapPin },\n    { label: 'Achievements', value: '0', icon: Trophy },\n  ]);\n  const [recentGames, setRecentGames] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  // Load user stats and recent games\n  useEffect(() => {\n    const loadUserData = async () => {\n      if (!user?.id) {\n        setLoading(false);\n        return;\n      }\n\n      try {\n        // Load real user stats (with fallback if tables don't exist yet)\n        const [stats, recentGamesData, achievements] = await Promise.all([\n          SupabaseService.getUserStats(user.id).catch(() => ({\n            user_id: user.id,\n            games_played: 0,\n            games_hosted: 0,\n            total_play_time_minutes: 0,\n            favorite_sport: null,\n            last_activity: new Date().toISOString(),\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n          })),\n          SupabaseService.getUserRecentGames(user.id, 5).catch(() => []),\n          SupabaseService.getUserAchievements(user.id).catch(() => [])\n        ]);\n\n        // Update stats with real data\n        setUserStats([\n          { label: 'Games Played', value: stats.games_played.toString(), icon: Calendar },\n          { label: 'Games Hosted', value: stats.games_hosted.toString(), icon: MapPin },\n          { label: 'Achievements', value: achievements.length.toString(), icon: Trophy },\n        ]);\n\n        // Transform recent games data\n        const transformedRecentGames = recentGamesData.map((participation: any) => ({\n          id: participation.games.id,\n          title: participation.games.title,\n          sport: participation.games.sport,\n          date: participation.games.date,\n          time: participation.games.time,\n          location: participation.games.location,\n          isHost: participation.games.created_by === user.id\n        }));\n\n        setRecentGames(transformedRecentGames);\n      } catch (error) {\n        console.error('Error loading user data:', error);\n        // Fallback to placeholder data on error\n        setUserStats([\n          { label: 'Games Played', value: '0', icon: Calendar },\n          { label: 'Games Hosted', value: '0', icon: MapPin },\n          { label: 'Achievements', value: '0', icon: Trophy },\n        ]);\n        setRecentGames([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadUserData();\n  }, [user?.id]);\n\n  // Get user data with fallbacks\n  const displayName = user?.name || 'User Profile';\n  const displayUsername = user?.username ? `@${user.username}` : '@user';\n  const displayBio = user?.bio || 'Sports enthusiast â€¢ Always up for a game!';\n  const displayAvatar = user?.avatar || '';\n  const displaySports = user?.preferences?.sports || ['Basketball', 'Soccer', 'Tennis', 'Volleyball'];\n  const needsCompletion = !(user?.name && user?.email);\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 pt-12 pb-6\">\n        <h1 className=\"text-xl font-semibold\">Profile</h1>\n        <Button variant=\"ghost\" size=\"icon\" onClick={() => navigate('/settings')}>\n          <Settings className=\"w-5 h-5\" />\n        </Button>\n      </div>\n\n      <div className=\"px-4 space-y-6\">\n        {/* Profile Info */}\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-4 mb-6\">\n              <Avatar className=\"w-16 h-16\">\n                <AvatarImage src={displayAvatar} alt={displayName} />\n                <AvatarFallback className=\"text-xl\">\n                  {displayName.charAt(0).toUpperCase()}\n                </AvatarFallback>\n              </Avatar>\n              <div className=\"flex-1\">\n                <h2 className=\"text-xl font-semibold\">{displayName}</h2>\n                <p className=\"text-muted-foreground\">{displayUsername}</p>\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  {displayBio}\n                </p>\n              </div>\n            </div>\n\n            <Button variant=\"outline\" className=\"w-full\" onClick={() => navigate('/profile/edit')}>\n              Edit Profile\n            </Button>\n            {needsCompletion && (\n              <Button variant=\"outline\" className=\"w-full mt-2\" onClick={() => navigate('/onboarding')}>\n                Complete Profile\n              </Button>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Stats */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Stats</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-3 gap-4\">\n              {userStats.map((stat) => (\n                <div key={stat.label} className=\"text-center\">\n                  <div className=\"flex justify-center mb-2\">\n                    <stat.icon className=\"w-5 h-5 text-primary\" />\n                  </div>\n                  <div className=\"text-2xl font-semibold\">{stat.value}</div>\n                  <div className=\"text-xs text-muted-foreground\">{stat.label}</div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Sports Preferences */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Sports I Play</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-wrap gap-2\">\n              {displaySports.map((sport) => (\n                <Badge key={sport} variant=\"secondary\">\n                  {sport}\n                </Badge>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Recent Games */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Games</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {loading ? (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n                  <p>Loading recent games...</p>\n                </div>\n              ) : recentGames.length > 0 ? (\n                recentGames.map((game, index) => (\n                  <div key={game.id || index} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                    <div className=\"flex-1\">\n                      <div className=\"font-medium\">{game.title}</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        {new Date(game.date).toLocaleDateString()} at {formatTimeString(game.time)}\n                      </div>\n                      <div className=\"text-xs text-muted-foreground mt-1\">\n                        {game.location}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {game.isHost && (\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          Host\n                        </Badge>\n                      )}\n                      <Badge variant=\"outline\">{game.sport}</Badge>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Calendar className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                  <p>No recent games</p>\n                  <p className=\"text-sm\">Join your first game to see it here!</p>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\nexport default UserProfile;"],"names":["UserProfile","navigate","useNavigate","user","useAppStore","userStats","setUserStats","useState","Calendar","MapPin","Trophy","recentGames","setRecentGames","loading","setLoading","useEffect","stats","recentGamesData","achievements","SupabaseService","transformedRecentGames","participation","error","displayName","displayUsername","displayBio","displayAvatar","displaySports","needsCompletion","jsxs","jsx","Button","Settings","Card","CardContent","Avatar","AvatarImage","AvatarFallback","CardHeader","CardTitle","stat","sport","Badge","game","index","formatTimeString"],"mappings":"2dAWO,SAASA,GAAc,CAC5B,MAAMC,EAAWC,EAAA,EACX,CAAE,KAAAC,CAAA,EAASC,EAAA,EACX,CAACC,EAAWC,CAAY,EAAIC,WAAS,CACzC,CAAE,MAAO,eAAgB,MAAO,IAAK,KAAMC,CAAA,EAC3C,CAAE,MAAO,eAAgB,MAAO,IAAK,KAAMC,CAAA,EAC3C,CAAE,MAAO,eAAgB,MAAO,IAAK,KAAMC,CAAA,CAAO,CACnD,EACK,CAACC,EAAaC,CAAc,EAAIL,EAAAA,SAAgB,CAAA,CAAE,EAClD,CAACM,EAASC,CAAU,EAAIP,EAAAA,SAAS,EAAI,EAG3CQ,EAAAA,UAAU,IAAM,EACO,SAAY,CAC/B,GAAI,CAACZ,GAAM,GAAI,CACbW,EAAW,EAAK,EAChB,MACF,CAEA,GAAI,CAEF,KAAM,CAACE,EAAOC,EAAiBC,CAAY,EAAI,MAAM,QAAQ,IAAI,CAC/DC,EAAgB,aAAahB,EAAK,EAAE,EAAE,MAAM,KAAO,CACjD,QAASA,EAAK,GACd,aAAc,EACd,aAAc,EACd,wBAAyB,EACzB,eAAgB,KAChB,cAAe,IAAI,KAAA,EAAO,YAAA,EAC1B,WAAY,IAAI,KAAA,EAAO,YAAA,EACvB,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EACnC,EACFgB,EAAgB,mBAAmBhB,EAAK,GAAI,CAAC,EAAE,MAAM,IAAM,EAAE,EAC7DgB,EAAgB,oBAAoBhB,EAAK,EAAE,EAAE,MAAM,IAAM,CAAA,CAAE,CAAA,CAC5D,EAGDG,EAAa,CACX,CAAE,MAAO,eAAgB,MAAOU,EAAM,aAAa,SAAA,EAAY,KAAMR,CAAA,EACrE,CAAE,MAAO,eAAgB,MAAOQ,EAAM,aAAa,SAAA,EAAY,KAAMP,CAAA,EACrE,CAAE,MAAO,eAAgB,MAAOS,EAAa,OAAO,SAAA,EAAY,KAAMR,CAAA,CAAO,CAC9E,EAGD,MAAMU,EAAyBH,EAAgB,IAAKI,IAAwB,CAC1E,GAAIA,EAAc,MAAM,GACxB,MAAOA,EAAc,MAAM,MAC3B,MAAOA,EAAc,MAAM,MAC3B,KAAMA,EAAc,MAAM,KAC1B,KAAMA,EAAc,MAAM,KAC1B,SAAUA,EAAc,MAAM,SAC9B,OAAQA,EAAc,MAAM,aAAelB,EAAK,EAAA,EAChD,EAEFS,EAAeQ,CAAsB,CACvC,OAASE,EAAO,CACd,QAAQ,MAAM,2BAA4BA,CAAK,EAE/ChB,EAAa,CACX,CAAE,MAAO,eAAgB,MAAO,IAAK,KAAME,CAAA,EAC3C,CAAE,MAAO,eAAgB,MAAO,IAAK,KAAMC,CAAA,EAC3C,CAAE,MAAO,eAAgB,MAAO,IAAK,KAAMC,CAAA,CAAO,CACnD,EACDE,EAAe,CAAA,CAAE,CACnB,QAAA,CACEE,EAAW,EAAK,CAClB,CACF,GAEA,CACF,EAAG,CAACX,GAAM,EAAE,CAAC,EAGb,MAAMoB,EAAcpB,GAAM,MAAQ,eAC5BqB,EAAkBrB,GAAM,SAAW,IAAIA,EAAK,QAAQ,GAAK,QACzDsB,EAAatB,GAAM,KAAO,4CAC1BuB,EAAgBvB,GAAM,QAAU,GAChCwB,EAAgBxB,GAAM,aAAa,QAAU,CAAC,aAAc,SAAU,SAAU,YAAY,EAC5FyB,EAAkB,EAAEzB,GAAM,MAAQA,GAAM,OAE9C,OACE0B,EAAAA,KAAC,MAAA,CAAI,UAAU,6BAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oDACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,wBAAwB,SAAA,UAAO,EAC7CA,EAAAA,IAACC,EAAA,CAAO,QAAQ,QAAQ,KAAK,OAAO,QAAS,IAAM9B,EAAS,WAAW,EACrE,SAAA6B,EAAAA,IAACE,EAAA,CAAS,UAAU,UAAU,CAAA,CAChC,CAAA,EACF,EAEAH,EAAAA,KAAC,MAAA,CAAI,UAAU,iBAEb,SAAA,CAAAC,MAACG,EAAA,CACC,SAAAJ,EAAAA,KAACK,EAAA,CAAY,UAAU,OACrB,SAAA,CAAAL,EAAAA,KAAC,MAAA,CAAI,UAAU,+BACb,SAAA,CAAAA,EAAAA,KAACM,EAAA,CAAO,UAAU,YAChB,SAAA,CAAAL,EAAAA,IAACM,EAAA,CAAY,IAAKV,EAAe,IAAKH,EAAa,EACnDO,EAAAA,IAACO,GAAe,UAAU,UACvB,WAAY,OAAO,CAAC,EAAE,aAAY,CACrC,CAAA,EACF,EACAR,EAAAA,KAAC,MAAA,CAAI,UAAU,SACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,wBAAyB,SAAAP,EAAY,EACnDO,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAyB,SAAAN,EAAgB,EACtDM,EAAAA,IAAC,IAAA,CAAE,UAAU,qCACV,SAAAL,CAAA,CACH,CAAA,CAAA,CACF,CAAA,EACF,EAEAK,EAAAA,IAACC,EAAA,CAAO,QAAQ,UAAU,UAAU,SAAS,QAAS,IAAM9B,EAAS,eAAe,EAAG,SAAA,cAAA,CAEvF,EACC2B,GACCE,EAAAA,IAACC,EAAA,CAAO,QAAQ,UAAU,UAAU,cAAc,QAAS,IAAM9B,EAAS,aAAa,EAAG,SAAA,kBAAA,CAE1F,CAAA,CAAA,CAEJ,CAAA,CACF,SAGCgC,EAAA,CACC,SAAA,CAAAH,MAACQ,EAAA,CACC,SAAAR,EAAAA,IAACS,EAAA,CAAU,SAAA,OAAA,CAAK,EAClB,EACAT,EAAAA,IAACI,EAAA,CACC,SAAAJ,EAAAA,IAAC,MAAA,CAAI,UAAU,yBACZ,SAAAzB,EAAU,IAAKmC,GACdX,EAAAA,KAAC,MAAA,CAAqB,UAAU,cAC9B,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,2BACb,SAAAA,EAAAA,IAACU,EAAK,KAAL,CAAU,UAAU,sBAAA,CAAuB,CAAA,CAC9C,EACAV,EAAAA,IAAC,MAAA,CAAI,UAAU,yBAA0B,WAAK,MAAM,EACpDA,EAAAA,IAAC,MAAA,CAAI,UAAU,gCAAiC,WAAK,KAAA,CAAM,CAAA,CAAA,EALnDU,EAAK,KAMf,CACD,CAAA,CACH,CAAA,CACF,CAAA,EACF,SAGCP,EAAA,CACC,SAAA,CAAAH,MAACQ,EAAA,CACC,SAAAR,EAAAA,IAACS,EAAA,CAAU,SAAA,eAAA,CAAa,EAC1B,QACCL,EAAA,CACC,SAAAJ,MAAC,OAAI,UAAU,uBACZ,WAAc,IAAKW,GAClBX,MAACY,GAAkB,QAAQ,YACxB,YADSD,CAEZ,CACD,EACH,CAAA,CACF,CAAA,EACF,SAGCR,EAAA,CACC,SAAA,CAAAH,MAACQ,EAAA,CACC,SAAAR,EAAAA,IAACS,EAAA,CAAU,SAAA,cAAA,CAAY,EACzB,EACAT,EAAAA,IAACI,EAAA,CACC,SAAAJ,EAAAA,IAAC,MAAA,CAAI,UAAU,YACZ,SAAAjB,EACCgB,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,6FAAA,CAA8F,EAC7GA,EAAAA,IAAC,KAAE,SAAA,yBAAA,CAAuB,CAAA,CAAA,CAC5B,EACEnB,EAAY,OAAS,EACvBA,EAAY,IAAI,CAACgC,EAAMC,IACrBf,EAAAA,KAAC,MAAA,CAA2B,UAAU,0DACpC,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,SACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,cAAe,SAAAa,EAAK,MAAM,EACzCd,EAAAA,KAAC,MAAA,CAAI,UAAU,gCACZ,SAAA,CAAA,IAAI,KAAKc,EAAK,IAAI,EAAE,mBAAA,EAAqB,OAAKE,EAAiBF,EAAK,IAAI,CAAA,EAC3E,EACAb,EAAAA,IAAC,MAAA,CAAI,UAAU,qCACZ,WAAK,QAAA,CACR,CAAA,EACF,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACZ,SAAA,CAAAc,EAAK,QACJb,MAACY,EAAA,CAAM,QAAQ,YAAY,UAAU,UAAU,SAAA,MAAA,CAE/C,EAEFZ,EAAAA,IAACY,EAAA,CAAM,QAAQ,UAAW,WAAK,KAAA,CAAM,CAAA,CAAA,CACvC,CAAA,CAAA,EAjBQC,EAAK,IAAMC,CAkBrB,CACD,EAEDf,OAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,EAAAA,IAACtB,EAAA,CAAS,UAAU,mCAAA,CAAoC,EACxDsB,EAAAA,IAAC,KAAE,SAAA,iBAAA,CAAe,EAClBA,EAAAA,IAAC,IAAA,CAAE,UAAU,UAAU,SAAA,sCAAA,CAAoC,CAAA,CAAA,CAC7D,EAEJ,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}