import{r as e}from"./vendor-C07EgOn8.js";import{t}from"./utils-sWWcUyIH.js";import{u as i,S as n}from"./index-Ce8SbcNa.js";function r(){const{user:r}=i(),[a,c]=e.useState([]),[s,o]=e.useState(null),[l,m]=e.useState(!0);e.useEffect(()=>{if(!r?.id)return;(async()=>{try{m(!0);const[e,t]=await Promise.all([n.getUserAchievements(r.id),n.getUserStats(r.id)]);c(e),o(t)}catch(e){}finally{m(!1)}})()},[r?.id]);const u=e=>{t.success("ðŸŽ‰ Achievement Unlocked!",{description:`${e.icon} ${e.name} - ${e.description} (+${e.points} points)`,duration:6e3,action:{label:"View All",onClick:()=>{window.location.href="/profile?tab=achievements"}}})},h=(e,t)=>{const i="string"==typeof e.criteria?JSON.parse(e.criteria):e.criteria;let n=0,r=1;switch(i.type){case"game_count":r=i.count,n=Math.min(t.games_played,r);break;case"host_count":r=i.count,n=Math.min(t.games_hosted,r);break;case"play_time_minutes":r=i.count,n=Math.min(t.total_play_time_minutes,r);break;case"first_login":r=1,n=t.last_activity?1:0;break;default:r=1,n=0}return{progress:n,total:r,percentage:Math.round(n/r*100)}},p=e=>e>=200?{title:"Legend",icon:"ðŸ‘‘",color:"text-yellow-600",level:6}:e>=150?{title:"Champion",icon:"ðŸ†",color:"text-purple-600",level:5}:e>=100?{title:"Expert",icon:"â­",color:"text-blue-600",level:4}:e>=50?{title:"Rising Star",icon:"ðŸŒŸ",color:"text-green-600",level:3}:e>=25?{title:"Rookie",icon:"ðŸŽ¯",color:"text-orange-600",level:2}:{title:"Beginner",icon:"ðŸ”°",color:"text-gray-600",level:1},g=a.reduce((e,t)=>{const i=t.achievement||t;return e+(i?.points||0)},0),d=p(g);return{achievements:a,userStats:s,isLoading:l,totalScore:g,currentRank:d,checkForNewAchievements:async()=>{if(r?.id)try{const e=await n.checkAndAwardAchievements(r.id);if(e.length>0){e.forEach(e=>{u(e)});const t=await n.getUserAchievements(r.id);c(t)}}catch(e){}},showAchievementToast:u,getAchievementProgress:h,getAchievementRank:p,getNextAchievements:async()=>{if(!r?.id||!s)return[];try{const e=await n.getAllAchievements(),t=new Set(a.map(e=>e.achievement_id));return e.filter(e=>!t.has(e.id)&&e.is_active).map(e=>({...e,progress:h(e,s)})).sort((e,t)=>t.progress.percentage-e.progress.percentage).slice(0,3)}catch(e){return[]}}}}export{r as u};
//# sourceMappingURL=useAchievements-Bf6AnO3N.js.map
