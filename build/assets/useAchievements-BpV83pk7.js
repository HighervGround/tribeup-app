import{r as c}from"./vendor-Dit9F4CM.js";import{b as v,h as i,t as f}from"./index-BhmEvnf0.js";function _(){const{user:r}=v(),[l,h]=c.useState([]),[o,p]=c.useState(null),[u,d]=c.useState(!0);c.useEffect(()=>{if(!r?.id)return;(async()=>{try{d(!0);const[s,e]=await Promise.all([i.getUserAchievements(r.id),i.getUserStats(r.id)]);h(s),p(e)}catch(s){console.error("Failed to load achievements:",s)}finally{d(!1)}})()},[r?.id]);const A=async()=>{if(r?.id)try{const t=await i.checkAndAwardAchievements(r.id);if(t.length>0){t.forEach(e=>{m(e)});const s=await i.getUserAchievements(r.id);h(s)}}catch(t){console.error("Failed to check achievements:",t)}},m=t=>{f.success("ðŸŽ‰ Achievement Unlocked!",{description:`${t.icon} ${t.name} - ${t.description} (+${t.points} points)`,duration:6e3,action:{label:"View All",onClick:()=>{window.location.href="/profile?tab=achievements"}}})},g=(t,s)=>{const e=t.criteria;let a=0,n=1;return e.games_played?(n=e.games_played,a=Math.min(s.games_played,n)):e.games_hosted&&(n=e.games_hosted,a=Math.min(s.games_hosted,n)),{progress:a,total:n,percentage:Math.round(a/n*100)}};return{achievements:l,userStats:o,isLoading:u,checkForNewAchievements:A,showAchievementToast:m,getAchievementProgress:g,getNextAchievements:async()=>{if(!r?.id||!o)return[];try{const t=await i.getAllAchievements(),s=new Set(l.map(e=>e.achievement_id));return t.filter(e=>!s.has(e.id)&&e.is_active).map(e=>({...e,progress:g(e,o)})).sort((e,a)=>a.progress.percentage-e.progress.percentage).slice(0,3)}catch(t){return console.error("Failed to get next achievements:",t),[]}}}}export{_ as u};
//# sourceMappingURL=useAchievements-BpV83pk7.js.map
