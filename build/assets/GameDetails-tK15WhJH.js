import{j as e,n as Fe,T as Ae,o as Te,p as We,I as Ge,q as ze,r as Ee,s as Oe,t as Le,v as Ue,w as _e,O as Je}from"./ui-CuzVkv4o.js";import{r as j}from"./vendor-Dit9F4CM.js";import{c as z,j as A,m as He,C as I,g as F,h as G,B as f,a as P,U as qe,t as S,d as O,A as Be,k as Ye,l as Ke,i as _,e as E,u as Qe,n as Ve,b as Ze,L as B,f as me}from"./index-D8qAyT0h.js";import{S as je}from"./separator-DsaR2Iz5.js";import{A as ve,a as we}from"./alert-DZhQpE5q.js";import{X as ye}from"./x-DCmgOvwp.js";import{I as R}from"./input-D1TxOH2z.js";import{T as Y}from"./textarea-DZWrHche.js";import{I as Xe}from"./ImageWithFallback-Ba8Vz0S_.js";import{a as et,b as tt}from"./useGames-Dqy-33SO.js";import{C as Ne,u as at}from"./useGameJoinToggle-SYTumV-U.js";import{u as st}from"./useDeepLinks-MwwUYIcW.js";import{M as Q}from"./mail-BWiiahrp.js";import{M as V}from"./map-pin-C3Vnxafr.js";import{C as be}from"./calendar-Dnyhi4sR.js";import{U as it}from"./users-D1NbQ7Un.js";import{M as he}from"./message-square-pivzAhjq.js";import{u as nt}from"./useAchievements-DLBneBQb.js";import{T as ue}from"./trophy-S-IcUVMi.js";import{C as rt}from"./circle-check-big-CcC9bgFa.js";import{S as Z}from"./star-Cbz5rpGL.js";import{a as ot,b as lt}from"./dateUtils-But3d3jk.js";import{A as ct}from"./arrow-left-COLykocJ.js";import{S as dt}from"./share-DSe1KJVs.js";import{T as mt}from"./trash-2-CLeul3xH.js";import{F as ht}from"./flag-DPyKRR4a.js";import"./useMutation-B3okplaF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],xe=z("copy",ut);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],pt=z("dollar-sign",xt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ft=z("ellipsis-vertical",gt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],vt=z("navigation",jt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],yt=z("pen-line",wt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],bt=z("phone",Nt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],pe=z("share-2",kt);function Ct({...s}){return e.jsx(Fe,{"data-slot":"dropdown-menu",...s})}function St({...s}){return e.jsx(Ae,{"data-slot":"dropdown-menu-trigger",...s})}function $t({className:s,sideOffset:a=4,...n}){return e.jsx(Te,{children:e.jsx(We,{"data-slot":"dropdown-menu-content",sideOffset:a,className:A("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...n})})}function ge({className:s,inset:a,variant:n="default",...t}){return e.jsx(Ge,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":n,className:A("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function X({...s}){return e.jsx(ze,{"data-slot":"dialog",...s})}function Dt({...s}){return e.jsx(_e,{"data-slot":"dialog-portal",...s})}function It({className:s,...a}){return e.jsx(Je,{"data-slot":"dialog-overlay",className:A("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function ee({className:s,children:a,...n}){return e.jsxs(Dt,{"data-slot":"dialog-portal",children:[e.jsx(It,{}),e.jsxs(Ee,{"data-slot":"dialog-content",className:A("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...n,children:[a,e.jsxs(Oe,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(ye,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function te({className:s,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:A("flex flex-col gap-2 text-center sm:text-left",s),...a})}function fe({className:s,...a}){return e.jsx("div",{"data-slot":"dialog-footer",className:A("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...a})}function ae({className:s,...a}){return e.jsx(Le,{"data-slot":"dialog-title",className:A("text-lg leading-none font-semibold",s),...a})}function se({className:s,...a}){return e.jsx(Ue,{"data-slot":"dialog-description",className:A("text-muted-foreground text-sm",s),...a})}function Pt({isOpen:s,onClose:a,gameTitle:n,gameId:t,onJoinSuccess:g}){const{signUp:c,signInWithOAuth:d}=He(),[u,p]=j.useState("signup"),[r,i]=j.useState({name:"",email:"",phone:""}),[m,l]=j.useState(!1),[k,v]=j.useState("");if(!s)return null;const C=async N=>{N.preventDefault(),l(!0),v("");try{await c(r.email,"temp-password-"+Date.now(),{name:r.name,email:r.email,phone:r.phone,pendingGameId:t}),p("verify"),S.success("Account created! Check your email to verify and join the game.")}catch(y){v(y.message)}finally{l(!1)}},$=async N=>{try{l(!0),await d(N,{pendingGameId:t}),S.success(`Signing in with ${N}...`),a()}catch(y){S.error(y.message||"Social login failed")}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(I,{className:"w-full max-w-md",children:[e.jsxs(F,{className:"flex flex-row items-center justify-between",children:[e.jsx(G,{className:"text-lg",children:u==="signup"?`Join "${n}"`:"Check Your Email"}),e.jsx(f,{variant:"ghost",size:"icon",onClick:a,children:e.jsx(ye,{className:"w-4 h-4"})})]}),e.jsx(P,{children:u==="signup"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{variant:"outline",className:"w-full",onClick:()=>$("google"),disabled:m,children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),e.jsxs(f,{variant:"outline",className:"w-full",onClick:()=>$("apple"),disabled:m,children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"})}),"Continue with Apple"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with email"})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(R,{type:"text",placeholder:"Your name",value:r.name,onChange:N=>i(y=>({...y,name:N.target.value})),required:!0,className:"pl-10"}),e.jsx(qe,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{type:"email",placeholder:"Email address",value:r.email,onChange:N=>i(y=>({...y,email:N.target.value})),required:!0,className:"pl-10"}),e.jsx(Q,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{type:"tel",placeholder:"Phone (optional)",value:r.phone,onChange:N=>i(y=>({...y,phone:N.target.value})),className:"pl-10"}),e.jsx(bt,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),k&&e.jsx(ve,{variant:"destructive",children:e.jsx(we,{children:k})}),e.jsx(f,{type:"submit",className:"w-full",disabled:m,children:m?"Creating Account...":"Join Game"})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"By joining, you agree to our Terms of Service and Privacy Policy"})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Check your email"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["We sent a verification link to ",e.jsx("strong",{children:r.email})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:['Click the link to verify your account and automatically join "',n,'"']})]}),e.jsx(f,{variant:"outline",onClick:a,className:"w-full",children:"Got it"})]})})]})})}function Rt({game:s,isOpen:a,onClose:n}){const[t,g]=j.useState(!1);if(!a)return null;const c=`${window.location.origin}/public/game/${s.id}`,d=`Join me for ${s.sport} at ${s.location} on ${s.date}!`,u=async()=>{try{await navigator.clipboard.writeText(c),g(!0),S.success("Link copied to clipboard!"),setTimeout(()=>g(!1),2e3)}catch{S.error("Failed to copy link")}},p=async()=>{if(navigator.share)try{await navigator.share({title:`Join ${s.title}`,text:d,url:c})}catch{}else u()},r=()=>{const l=encodeURIComponent(`Join me for ${s.sport}!`),k=encodeURIComponent(`
Hi!

I'm organizing a ${s.sport} game and would love for you to join:

üìç ${s.location}
üìÖ ${s.date} at ${s.time}
üí∞ ${s.cost||"Free"}
üë• ${s.currentPlayers}/${s.maxPlayers} players

${s.description?s.description+`

`:""}RSVP here: ${c}

Hope to see you there!
    `.trim());window.open(`mailto:?subject=${l}&body=${k}`)},i=()=>{const l=encodeURIComponent(`${d} RSVP: ${c}`);window.open(`sms:?body=${l}`)},m=()=>{const l=encodeURIComponent(`${d} RSVP: ${c}`);window.open(`https://wa.me/?text=${l}`)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(I,{className:"w-full max-w-md",children:[e.jsx(F,{children:e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Share Game"]})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:s.title}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(O,{variant:"secondary",children:s.sport})}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(be,{className:"w-4 h-4"}),e.jsx("span",{children:s.date})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{children:s.time})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.currentPlayers,"/",s.maxPlayers," players"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Public RSVP Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:c,readOnly:!0,className:"flex-1"}),e.jsx(f,{variant:"outline",size:"sm",onClick:u,className:t?"bg-green-50 text-green-700":"",children:e.jsx(xe,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Anyone with this link can view game details and RSVP"})]}),e.jsx(je,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-3",children:"Share via"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(f,{variant:"outline",onClick:p,className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Share"]}),e.jsxs(f,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"Email"]}),e.jsxs(f,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"SMS"]}),e.jsxs(f,{variant:"outline",onClick:m,className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"WhatsApp"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"outline",onClick:n,className:"flex-1",children:"Close"}),e.jsxs(f,{onClick:u,className:"flex-1",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]})]})})}function Mt({isOpen:s,onClose:a,gameId:n,gameTitle:t,players:g}){const{checkForNewAchievements:c}=nt(),[d,u]=j.useState("game"),[p,r]=j.useState(!1),[i,m]=j.useState({overall:0,organization:0,skillLevel:0,fun:0,reviewText:"",wouldPlayAgain:!0,recommendToOthers:!0}),[l,k]=j.useState(g.map(x=>({playerId:x.id,skill:0,sportsmanship:0,communication:0,feedback:""}))),v=({rating:x,onRatingChange:h,label:b})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:b}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(D=>e.jsx("button",{type:"button",onClick:()=>h(D),className:"p-1 hover:scale-110 transition-transform",children:e.jsx(Z,{className:`w-6 h-6 ${D<=x?"fill-yellow-400 text-yellow-400":"text-gray-300 hover:text-yellow-400"}`})},D))})]}),C=async()=>{if(i.overall===0){S.error("Please provide an overall rating");return}try{r(!0),await _.submitGameReview({gameId:n,overallRating:i.overall,organizationRating:i.organization||void 0,skillLevelRating:i.skillLevel||void 0,funRating:i.fun||void 0,reviewText:i.reviewText||void 0,wouldPlayAgain:i.wouldPlayAgain,recommendToOthers:i.recommendToOthers}),u("players")}catch(x){console.error("Failed to submit game rating:",x),S.error("Failed to submit rating. Please try again.")}finally{r(!1)}},$=async()=>{const x=l.filter(h=>h.skill>0&&h.sportsmanship>0&&h.communication>0);if(x.length===0){u("complete");return}try{r(!0),await Promise.all(x.map(h=>_.submitPlayerRating({gameId:n,ratedPlayerId:h.playerId,skillRating:h.skill,sportsmanshipRating:h.sportsmanship,communicationRating:h.communication,feedbackText:h.feedback||void 0}))),u("complete")}catch(h){console.error("Failed to submit player ratings:",h),S.error("Failed to submit player ratings. Please try again.")}finally{r(!1)}},N=async()=>{await c(),a()},y=(x,h,b)=>{k(D=>D.map(M=>M.playerId===x?{...M,[h]:b}:M))};return e.jsx(X,{open:s,onOpenChange:a,children:e.jsxs(ee,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsxs(ae,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5 text-primary"}),"Rate Your Experience"]}),e.jsxs(se,{children:["Help improve the community by rating ",t]})]}),d==="game"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"How was the game?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your feedback helps other players"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(v,{rating:i.overall,onRatingChange:x=>m(h=>({...h,overall:x})),label:"Overall Rating *"}),e.jsx(v,{rating:i.organization,onRatingChange:x=>m(h=>({...h,organization:x})),label:"Organization"}),e.jsx(v,{rating:i.skillLevel,onRatingChange:x=>m(h=>({...h,skillLevel:x})),label:"Skill Level Match"}),e.jsx(v,{rating:i.fun,onRatingChange:x=>m(h=>({...h,fun:x})),label:"Fun Factor"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Additional Comments"}),e.jsx(Y,{placeholder:"Share your experience with other players...",value:i.reviewText,onChange:x=>m(h=>({...h,reviewText:x.target.value})),className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.wouldPlayAgain,onChange:x=>m(h=>({...h,wouldPlayAgain:x.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"I'd play again"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.recommendToOthers,onChange:x=>m(h=>({...h,recommendToOthers:x.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Recommend to others"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"outline",onClick:a,className:"flex-1",children:"Skip"}),e.jsx(f,{onClick:C,disabled:p||i.overall===0,className:"flex-1",children:p?"Submitting...":"Next: Rate Players"})]})]}),d==="players"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Rate Your Fellow Players"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Optional but helps build a better community"})]}),e.jsx("div",{className:"space-y-6",children:g.map(x=>{const h=l.find(b=>b.playerId===x.id);return h?e.jsxs(I,{children:[e.jsx(F,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Be,{children:[x.avatar&&e.jsx(Ye,{src:x.avatar,alt:x.name}),e.jsx(Ke,{children:x.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:x.name}),x.isHost&&e.jsx(O,{variant:"secondary",className:"text-xs",children:"Host"})]})]})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(v,{rating:h.skill,onRatingChange:b=>y(x.id,"skill",b),label:"Skill Level"}),e.jsx(v,{rating:h.sportsmanship,onRatingChange:b=>y(x.id,"sportsmanship",b),label:"Sportsmanship"}),e.jsx(v,{rating:h.communication,onRatingChange:b=>y(x.id,"communication",b),label:"Communication"})]}),e.jsx(Y,{placeholder:"Optional feedback for this player...",value:h.feedback,onChange:b=>y(x.id,"feedback",b.target.value),className:"min-h-[60px]"})]})]},x.id):null})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"outline",onClick:()=>u("complete"),className:"flex-1",children:"Skip Player Ratings"}),e.jsx(f,{onClick:$,disabled:p,className:"flex-1",children:p?"Submitting...":"Submit Ratings"})]})]}),d==="complete"&&e.jsxs("div",{className:"text-center space-y-6 py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(rt,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Thanks for your feedback!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your ratings help make TribeUp better for everyone"})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Check your profile for any new achievements!"})]})}),e.jsx(f,{onClick:N,className:"w-full",children:"Done"})]})]})})}class U{static API_KEY=E.get("openWeatherApiKey");static BASE_URL="https://api.openweathermap.org/data/2.5";static CONFIG={temperatureUnit:E.get("weatherTempUnit"),updateInterval:E.get("weatherUpdateInterval"),includeHourlyForecast:E.get("weatherIncludeHourly"),rainThreshold:E.get("weatherRainThreshold"),windThreshold:E.get("weatherWindThreshold")};static async getCurrentWeather(a,n){if(!this.API_KEY)return console.warn("Weather API key not configured, using mock data"),this.getMockWeatherData();try{const t=await fetch(`${this.BASE_URL}/weather?lat=${a}&lon=${n}&appid=${this.API_KEY}&units=imperial`);if(!t.ok)throw new Error(`Weather API error: ${t.status}`);const g=await t.json();return this.transformWeatherData(g)}catch(t){return console.error("Error fetching weather:",t),this.getMockWeatherData()}}static async getGameWeather(a,n,t){if(!this.API_KEY)return console.warn("Weather API key not configured, using mock data"),this.getMockWeatherData();try{const g=parseFloat(a.toFixed(6)),c=parseFloat(n.toFixed(6));console.log(`üå§Ô∏è Fetching weather for coordinates: ${g}, ${c}`),console.log(`üïê Game time: ${t.toISOString()}`);const d=await fetch(`${this.BASE_URL}/forecast?lat=${g}&lon=${c}&appid=${this.API_KEY}&units=imperial`);if(!d.ok)return console.error(`Weather API error: ${d.status} ${d.statusText}`),await this.getCurrentWeather(g,c);const u=await d.json();if(!u.list||u.list.length===0)return console.warn("No forecast data available, falling back to current weather"),await this.getCurrentWeather(g,c);console.log(`üìä Received ${u.list.length} forecast entries`);const p=t.getTime(),r=p-2*60*60*1e3,i=p+2*60*60*1e3;console.log(`üïê Weather window: ${new Date(r).toISOString()} to ${new Date(i).toISOString()}`);const m=u.list.filter(v=>{const C=v.dt*1e3;return C>=r&&C<=i});console.log(`üìà Found ${m.length} forecasts in 4-hour window`);let l;m.length>0?(l=m.reduce((v,C)=>{const $=Math.abs(C.dt*1e3-p),N=Math.abs(v.dt*1e3-p);return $<N?C:v}),console.log(`üéØ Selected forecast: ${new Date(l.dt*1e3).toISOString()}`)):(l=u.list.reduce((v,C)=>{const $=Math.abs(C.dt*1e3-p),N=Math.abs(v.dt*1e3-p);return $<N?C:v}),console.log(`‚ö†Ô∏è No forecasts in window, using closest: ${new Date(l.dt*1e3).toISOString()}`));const k=this.analyzeWeatherWindow(m,l);return this.transformWeatherData(l,k)}catch(g){return console.error("Error fetching game weather:",g),this.getMockWeatherData()}}static async getWeatherByZipcode(a,n){if(!this.API_KEY)return console.warn("Weather API key not configured, using mock data"),this.getMockWeatherData();try{console.log(`üå§Ô∏è Fetching weather for zipcode: ${a}`),console.log(`üïê Game time: ${n.toISOString()}`);const t=await fetch(`${this.BASE_URL}/forecast?zip=${a},US&appid=${this.API_KEY}&units=imperial`);if(!t.ok)throw new Error(`Weather API error: ${t.status}`);const g=await t.json();console.log(`üìä Received ${g.list.length} forecast entries for ${a}`);const c=n.getTime(),d=c-2*60*60*1e3,u=c+2*60*60*1e3;console.log(`üïê Weather window: ${new Date(d).toISOString()} to ${new Date(u).toISOString()}`);const p=g.list.filter(m=>{const l=m.dt*1e3;return l>=d&&l<=u});console.log(`üìà Found ${p.length} forecasts in 4-hour window`);let r;p.length>0?(r=p.reduce((m,l)=>{const k=Math.abs(l.dt*1e3-c),v=Math.abs(m.dt*1e3-c);return k<v?l:m}),console.log(`üéØ Selected forecast: ${new Date(r.dt*1e3).toISOString()}`)):(r=g.list.reduce((m,l)=>{const k=Math.abs(l.dt*1e3-c),v=Math.abs(m.dt*1e3-c);return k<v?l:m}),console.log(`‚ö†Ô∏è No forecasts in window, using closest: ${new Date(r.dt*1e3).toISOString()}`));const i=this.analyzeWeatherWindow(p,r);return this.transformWeatherData(r,i)}catch(t){return console.error("Error fetching weather by zipcode:",t),null}}static extractZipcode(a){const n=a.match(/\b(\d{5}(?:-\d{4})?)\b/);return n?n[1].split("-")[0]:null}static analyzeWeatherWindow(a,n){if(a.length===0)return{alerts:[],windowSummary:""};const t=a.map(l=>l.main.temp),g=a.map(l=>l.weather[0].main),c=a.map(l=>l.rain?.["3h"]||l.snow?.["3h"]||0),d=Math.min(...t),u=Math.max(...t);t.reduce((l,k)=>l+k,0)/t.length;const p=Math.max(...c),r=[];let i="";u-d>10&&r.push(`üå°Ô∏è Temperature will vary ${Math.round(d)}¬∞F to ${Math.round(u)}¬∞F during game time`),p>.1&&r.push("üåßÔ∏è Possible precipitation during game window");const m=[...new Set(g)];return m.length>1&&r.push(`üå§Ô∏è Weather conditions may change: ${m.join(", ")}`),a.length>1&&(i=`4-hour forecast: ${Math.round(d)}-${Math.round(u)}¬∞F, ${m.join("/")}`),{alerts:r,windowSummary:i}}static transformWeatherData(a,n){const t=Math.round(a.main.temp),g=a.weather[0].main,c=a.weather[0].description,d=a.rain?.["1h"]||a.snow?.["1h"]||0,u=this.generateWeatherAlerts(g,t,d,a.wind.speed),p=n?[...u,...n.alerts]:u,r=n?.windowSummary||this.capitalizeWords(c);return{temperature:t,condition:g,description:r,humidity:a.main.humidity,windSpeed:Math.round(a.wind.speed),precipitation:d,icon:this.getWeatherIcon(g),isOutdoorFriendly:this.isOutdoorFriendly(g,t,d,a.wind.speed),alerts:p}}static isOutdoorFriendly(a,n,t,g){return!(n<40||n>95||t>this.CONFIG.rainThreshold||g>this.CONFIG.windThreshold||["Thunderstorm","Tornado","Squall"].includes(a))}static generateWeatherAlerts(a,n,t,g){const c=[];return n<50?c.push("üß• Dress warmly - temperature below 50¬∞F"):n>85&&c.push("‚òÄÔ∏è Stay hydrated - high temperature expected"),t>this.CONFIG.rainThreshold&&c.push("üåßÔ∏è Rain expected - consider indoor backup plan"),g>12&&c.push("üí® Windy conditions - secure loose items"),a==="Thunderstorm"&&c.push("‚ö° Thunderstorm warning - move indoors immediately"),c}static getWeatherIcon(a){return{Clear:"‚òÄÔ∏è",Clouds:"‚òÅÔ∏è",Rain:"üåßÔ∏è",Drizzle:"üå¶Ô∏è",Thunderstorm:"‚õàÔ∏è",Snow:"‚ùÑÔ∏è",Mist:"üå´Ô∏è",Fog:"üå´Ô∏è",Haze:"üå´Ô∏è"}[a]||"üå§Ô∏è"}static capitalizeWords(a){return a.replace(/\b\w/g,n=>n.toUpperCase())}static getMockWeatherData(){return{temperature:72,condition:"Clear",description:"Clear Sky",humidity:65,windSpeed:8,precipitation:0,icon:"‚òÄÔ∏è",isOutdoorFriendly:!0,alerts:[]}}static isConfigured(){return!!this.API_KEY&&this.API_KEY.length>0}static getWeatherRecommendation(a){return a.isOutdoorFriendly?a.temperature<60?"Cool weather - dress in layers and bring warm clothing.":a.temperature>80?"Warm weather - bring water and sun protection.":"Great weather for outdoor activities!":"Weather conditions may not be ideal for outdoor activities. Consider rescheduling or moving indoors."}}function Ft({game:s}){const[a,n]=j.useState(null),[t,g]=j.useState(!0);return j.useEffect(()=>{(async()=>{console.log("üå§Ô∏è Getting weather data for game:",s.id),console.log("üìç Coordinates:",s.latitude,s.longitude),console.log("üìç Location:",s.location);try{let d=null;const u=new Date(`${s.date} ${s.time}`);if(s.latitude&&s.longitude)console.log("üéØ Using exact coordinates for weather"),d=await U.getGameWeather(s.latitude,s.longitude,u);else if(s.location){console.log("üó∫Ô∏è Using Google Maps geocoding for weather (same as map)");const p="AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ";try{const r=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(s.location)}&key=${p}`);if(r.ok){const i=await r.json();if(console.log("üó∫Ô∏è Google geocoding results:",i),i.status==="OK"&&i.results&&i.results.length>0){const{lat:m,lng:l}=i.results[0].geometry.location;console.log("üéØ Using Google Maps coordinates for weather:",m,l),d=await U.getGameWeather(m,l,u),console.log("‚úÖ Weather from Google Maps coordinates:",d)}else console.warn("üó∫Ô∏è Google geocoding failed:",i.status,i.error_message)}else console.error("üó∫Ô∏è Google geocoding HTTP error:",r.status,r.statusText)}catch(r){console.error("‚ùå Google Maps geocoding failed:",r)}if(!d){const r=U.extractZipcode(s.location);r&&(console.log("üìÆ Fallback: Using zipcode for weather:",r),d=await U.getWeatherByZipcode(r,u))}if(!d){console.log("üå§Ô∏è Final fallback: Simple weather search");const r=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(s.location)}&appid=3d49d90fb511ba08385a88435f10825c&units=imperial`);if(r.ok){const i=await r.json();d={temperature:Math.round(i.main.temp),condition:i.weather[0].main,description:i.weather[0].description,humidity:i.main.humidity,windSpeed:Math.round(i.wind.speed),precipitation:i.rain?.["1h"]||i.snow?.["1h"]||0,icon:i.weather[0].main==="Clear"?"‚òÄÔ∏è":i.weather[0].main==="Clouds"?"‚òÅÔ∏è":i.weather[0].main==="Rain"?"üåßÔ∏è":"üå§Ô∏è",isOutdoorFriendly:!0,alerts:[]}}}}if(d)console.log("‚úÖ Weather data received:",d),n(d);else throw new Error("No weather data available")}catch(d){console.error("‚ùå Weather error:",d);try{console.log("üîÑ Final attempt: Using current weather API");const u=await fetch("https://api.openweathermap.org/data/2.5/weather?zip=10001,US&appid=3d49d90fb511ba08385a88435f10825c&units=imperial");if(u.ok){const p=await u.json(),r=Math.round(p.main.temp),i=p.weather[0].main,m=p.weather[0].description;n({temperature:r,condition:i,description:`${m.charAt(0).toUpperCase()+m.slice(1)} (nearby area)`,humidity:p.main.humidity,windSpeed:Math.round(p.wind.speed),precipitation:p.rain?.["1h"]||p.snow?.["1h"]||0,icon:i==="Clear"?"‚òÄÔ∏è":i==="Clouds"?"‚òÅÔ∏è":i==="Rain"?"üåßÔ∏è":"üå§Ô∏è",isOutdoorFriendly:r>40&&r<95,alerts:[`üìç Showing weather for nearby area - actual conditions at ${s.location||"game location"} may vary`]})}else throw new Error("Fallback weather failed")}catch(u){console.error("‚ùå All weather sources failed:",u),n({temperature:72,condition:"Clear",description:"Weather data temporarily unavailable",humidity:65,windSpeed:8,precipitation:0,icon:"üå§Ô∏è",isOutdoorFriendly:!0,alerts:[`üîÑ Weather service temporarily unavailable for ${s.location||"this location"}`]})}}g(!1)})()},[s.latitude,s.longitude,s.location,s.date,s.time]),t?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading weather..."}):a?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[a.temperature,"¬∞F"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.description})]})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Humidity: ",a.humidity,"%"]}),e.jsxs("div",{children:["Wind: ",a.windSpeed," mph"]})]})]}),a.alerts&&a.alerts.length>0&&e.jsx("div",{className:"space-y-1",children:a.alerts.map((c,d)=>e.jsx("div",{className:"text-xs bg-yellow-50 text-yellow-800 p-2 rounded",children:c},d))}),e.jsx("div",{className:"text-xs text-muted-foreground",children:U.getWeatherRecommendation(a)})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"Weather unavailable"})}function oa(){const s=Qe(),{gameId:a}=Ve(),{user:n}=Ze(),{data:t,isLoading:g}=et(a||""),{data:c=[],isLoading:d}=tt(a||""),{toggleJoin:u,isLoading:p,getButtonText:r}=at(),{navigateToUser:i}=st(),[m,l]=j.useState(!1),[k,v]=j.useState(!1),[C,$]=j.useState(!1),[N,y]=j.useState(!1),[x,h]=j.useState(!1),[b,D]=j.useState(!1),[M,J]=j.useState(!1),[T,W]=j.useState({title:"",description:"",location:"",duration:60,maxPlayers:0,cost:""}),[ie,ke]=j.useState(""),H=j.useMemo(()=>!c||!t?[]:c.map(o=>({...o,isHost:o.id===t?.creator_id})),[c,t?.creator_id]),ne=j.useMemo(()=>t?ot(t.date,t.time):{label:"",aria:""},[t?.date,t?.time]),re=j.useMemo(()=>t?lt(t.date,t.time):{date:"",time:""},[t?.date,t?.time]),oe=t?t.currentPlayers>=t.maxPlayers:!1,le=t?t.tags:void 0,L=n&&t&&(t.creatorId===n.id||t.createdBy===n.id);console.log("üîç Dropdown Debug:",{user:n?.id,game:t?.id,creatorId:t?.creatorId,createdBy:t?.createdBy,isGameCreator:L,shouldShowDropdown:L});const ce=j.useMemo(()=>t?new Date(`${t.date} ${t.time}`)<new Date:!1,[t?.date,t?.time]),de=j.useMemo(()=>!n||!t?!1:t.isJoined||L,[n,t?.isJoined,L]);if(j.useEffect(()=>{ce&&de&&n&&!b&&a&&(async()=>{try{(await _.getGameReviews(a)).find(q=>q.reviewer_id===n.id)||D(!0)}catch{D(!0)}})()},[ce,de,n,a,b]),g)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(B,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading game details..."})]})});if(!t)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl mb-4",children:"Game not found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The game you're looking for doesn't exist or has been removed."}),e.jsx(f,{onClick:()=>s("/"),children:"Go Home"})]})});const Ce=async()=>{if(!p){if(!n){v(!0);return}u(t)}},Se=async()=>{v(!1),a&&t&&u(t)},$e=()=>{s(-1)},De=async()=>{$(!0)},Ie=()=>{const o=t.location||"Location not specified",w=encodeURIComponent(o),K=`https://maps.google.com/maps?q=${w}&t=m&z=16`;try{if(navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/)){const q=`maps://maps.google.com/maps?q=${w}`;window.location.href=q,setTimeout(()=>{window.open(K,"_blank")},1e3)}else window.open(K,"_blank");S.success("Opening directions...")}catch{S.error("Failed to open directions")}},Pe=()=>{W({title:t.title,description:t.description,location:t.location,duration:t.duration||60,maxPlayers:t.maxPlayers,cost:t.cost}),y(!0)},Re=async()=>{if(a){J(!0);try{await _.updateGame(a,T),S.success("Game updated successfully"),y(!1),window.location.reload()}catch(o){S.error("Failed to update game",{description:o.message||"Please try again later"})}finally{J(!1)}}},Me=async()=>{if(a){J(!0);try{await _.deleteGame(a,ie),S.success("Game cancelled successfully"),h(!1),s("/")}catch(o){S.error("Failed to cancel game",{description:o.message||"Please try again later"})}finally{J(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"sticky top-0 bg-background/95 backdrop-blur-sm border-b border-border z-10",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:$e,"aria-label":"Go back",children:e.jsx(ct,{className:"w-5 h-5"})}),e.jsxs("div",{role:"text","aria-label":`Event: ${t.title}. ${ne.aria}`,children:[e.jsx("h1",{className:"text-xl font-semibold line-clamp-2",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ne.label})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:De,"data-action":"share","aria-label":"Share game",title:"Share game (U)",children:e.jsx(dt,{className:"w-5 h-5"})}),e.jsxs(Ct,{onOpenChange:o=>console.log("Dropdown open state:",o),children:[e.jsx(St,{asChild:!0,children:e.jsx("div",{children:e.jsx(f,{variant:"ghost",size:"icon","aria-label":"Game options",onClick:o=>{console.log("Dropdown trigger clicked",o),o.stopPropagation()},style:{display:L?"flex":"none"},children:e.jsx(ft,{className:"w-5 h-5"})})})}),e.jsxs($t,{align:"end",className:"z-[9999]",children:[e.jsxs(ge,{onClick:o=>{console.log("Edit game clicked"),o.stopPropagation(),Pe()},children:[e.jsx(yt,{className:"w-4 h-4 mr-2"}),"Edit Game"]}),e.jsxs(ge,{onClick:o=>{console.log("Delete game clicked"),o.stopPropagation(),h(!0)},className:"text-destructive focus:text-destructive",children:[e.jsx(mt,{className:"w-4 h-4 mr-2"}),"Cancel Game"]})]})]}),e.jsx(f,{variant:"ghost",size:"icon","aria-label":"Report game",children:e.jsx(ht,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"px-4 py-6 space-y-6",id:"main-content",children:[e.jsxs(I,{children:[t.imageUrl&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-video overflow-hidden rounded-t-lg",children:e.jsx(Xe,{src:t.imageUrl,alt:`${t.sport} game`,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(O,{className:`${t.sportColor} text-white border-none`,children:t.sport})})]}),!t.imageUrl&&e.jsx("div",{className:"p-4 border-b",children:e.jsx(O,{className:`${t.sportColor} text-white border-none`,children:t.sport})}),e.jsxs(P,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:re.date}),e.jsx("div",{className:"text-sm text-muted-foreground",children:re.time})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:"2 hours"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Duration"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:t.cost}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cost"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:Array.isArray(le)&&le.map(o=>e.jsx(O,{variant:"secondary",children:o},o))}),e.jsx(f,{onClick:Ce,disabled:!t.isJoined&&oe||p,className:"w-full h-12",variant:t.isJoined?"outline":"default","data-action":"join-game",title:`${t.isJoined?"Leave":"Join"} game (J)`,children:p?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),t.isJoined?"Leaving...":"Joining..."]}):oe&&!t.isJoined?"Game is Full":n?r(t):"Join Game - Sign Up"})]})]}),e.jsxs(I,{children:[e.jsx(F,{children:e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"Location"]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("div",{children:t.location})}),e.jsx("div",{className:"aspect-video bg-muted rounded-lg flex items-center justify-center",children:t.latitude&&t.longitude||t.location?e.jsx("iframe",{src:`https://www.google.com/maps/embed/v1/place?key=AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ&q=${t.latitude&&t.longitude?`${t.latitude},${t.longitude}`:encodeURIComponent(t.location)}&zoom=15`,width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",className:"rounded-lg",title:"Game location map"}):e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(V,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:"Map not available"})]})}),e.jsxs(f,{variant:"outline",className:"w-full",onClick:Ie,"data-action":"directions",title:"Get directions (L)",children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Get Directions"]})]})})]}),(t.latitude&&t.longitude||t.location)&&e.jsxs(I,{children:[e.jsx(F,{children:e.jsx(G,{className:"flex items-center gap-2",children:"‚òÄÔ∏è Weather Forecast"})}),e.jsx(P,{children:e.jsx(Ft,{game:t})})]}),e.jsxs(I,{children:[e.jsx(F,{children:e.jsx(G,{children:"About This Game"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:`text-sm leading-relaxed ${m?"":"line-clamp-3"}`,children:t.description}),t.description.length>150&&e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>l(!m),className:"p-0 h-auto",children:m?"Show less":"Show more"}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Requirements"}),e.jsx("ul",{className:"space-y-1",children:["Athletic shoes required","Bring water bottle","No experience necessary"].map((o,w)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"w-1 h-1 bg-muted-foreground rounded-full mt-2 flex-shrink-0"}),o]},w))})]})]})})]}),e.jsxs(I,{children:[e.jsx(F,{children:e.jsx(G,{children:"Game Host"})}),e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{userId:t.creatorId||t.creatorData?.id,src:t.creatorData?.avatar,alt:t.creatorData?.name||t.createdBy||"Unknown",size:"md"}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>i(t.creatorId||t.creatorData?.id),className:"hover:text-primary transition-colors cursor-pointer font-medium","data-action":"view-profile",children:t.creatorData?.name||t.createdBy||"Unknown"}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Z,{className:"w-3 h-3 fill-current text-warning"}),"No rating yet"]})]})]})})})})]}),e.jsxs(I,{children:[e.jsx(F,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(G,{children:["Players (",H.length,"/",t.maxPlayers,")"]})})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:H.map((o,w)=>e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{userId:o.id,src:o.avatar,alt:o.name,size:"md"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{console.log("üîç Clicking on player:",o),i(o.id)},className:"hover:text-primary transition-colors cursor-pointer font-medium","data-action":"view-profile",children:o.name}),o.isHost&&e.jsx(O,{variant:"secondary",className:"text-xs px-2 py-0",children:"Host"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Z,{className:"w-3 h-3 fill-current text-warning"}),o.rating]})]})]})}),w<H.length-1&&e.jsx(je,{className:"mt-3"})]},o.id))})})]}),t.isJoined&&e.jsx(ve,{className:"border-success text-success-foreground",children:e.jsx(we,{children:"You're joined! See you on the field!"})})]}),e.jsx(Pt,{isOpen:k,onClose:()=>v(!1),gameTitle:t.title,gameId:t.id,onJoinSuccess:Se}),e.jsx(Rt,{isOpen:C,onClose:()=>$(!1),game:t}),e.jsx(X,{open:N,onOpenChange:y,children:e.jsxs(ee,{className:"sm:max-w-[425px]",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Edit Game"}),e.jsx(se,{children:"Make changes to your game. Participants will be notified of any updates."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-title",className:"text-sm font-medium",children:"Title"}),e.jsx(R,{id:"edit-title",value:T.title,onChange:o=>W(w=>({...w,title:o.target.value})),placeholder:"Game title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-description",className:"text-sm font-medium",children:"Description"}),e.jsx(Y,{id:"edit-description",value:T.description,onChange:o=>W(w=>({...w,description:o.target.value})),placeholder:"Game description",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-location",className:"text-sm font-medium",children:"Location"}),e.jsx(R,{id:"edit-location",value:T.location,onChange:o=>W(w=>({...w,location:o.target.value})),placeholder:"Game location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-duration",className:"text-sm font-medium",children:"Duration (minutes)"}),e.jsx(R,{id:"edit-duration",type:"number",min:"15",max:"480",value:T.duration,onChange:o=>W(w=>({...w,duration:parseInt(o.target.value)||60})),placeholder:"60"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-maxPlayers",className:"text-sm font-medium",children:"Max Players"}),e.jsx(R,{id:"edit-maxPlayers",type:"number",min:"2",max:"50",value:T.maxPlayers,onChange:o=>W(w=>({...w,maxPlayers:parseInt(o.target.value)||0}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-cost",className:"text-sm font-medium",children:"Cost"}),e.jsx(R,{id:"edit-cost",value:T.cost,onChange:o=>W(w=>({...w,cost:o.target.value})),placeholder:"FREE or $10"})]})]})]}),e.jsxs(fe,{children:[e.jsx(f,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(f,{onClick:Re,disabled:M,children:M?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})}),e.jsx(X,{open:x,onOpenChange:h,children:e.jsxs(ee,{className:"sm:max-w-[425px]",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Cancel Game"}),e.jsx(se,{children:"This action cannot be undone. All participants will be notified of the cancellation."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"delete-reason",className:"text-sm font-medium",children:"Reason for cancellation (optional)"}),e.jsx(Y,{id:"delete-reason",value:ie,onChange:o=>ke(o.target.value),placeholder:"Let participants know why the game is cancelled...",rows:3})]})}),e.jsxs(fe,{children:[e.jsx(f,{variant:"outline",onClick:()=>h(!1),children:"Keep Game"}),e.jsx(f,{variant:"destructive",onClick:Me,disabled:M,children:M?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),"Cancelling..."]}):"Cancel Game"})]})]})}),e.jsx(Mt,{isOpen:b,onClose:()=>D(!1),gameId:a,gameTitle:t?.title||"",players:H})]})}export{oa as default};
//# sourceMappingURL=GameDetails-tK15WhJH.js.map
