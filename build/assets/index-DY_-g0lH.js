const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeScreen-DadnCdyn.js","assets/ui-Bqrh-KgM.js","assets/vendor-CVaDA-xz.js","assets/utils-CfrcxnCJ.js","assets/useGames-DXf6rKqX.js","assets/data-D6RrWw63.js","assets/UnifiedGameCard-iUmRfKcf.js","assets/ImageWithFallback-B7gg3TPo.js","assets/useGameJoinToggle-3UeAyFpa.js","assets/dateUtils-DKSG3jUc.js","assets/skeleton-BoseYTwL.js","assets/SearchDiscovery-DZeNna6r.js","assets/input-DN8YmM7N.js","assets/CreateGame-CgIHuC4X.js","assets/progress-D2aZGeqv.js","assets/textarea-Dp7P__sn.js","assets/select-IIPyFkGi.js","assets/UserProfile-BUDBJUYv.js","assets/tabs-D1FYsXRI.js","assets/useUserProfile-BjKVQOaR.js","assets/useAchievements-DcCUYw23.js","assets/EditProfile-BUAuJ05D.js","assets/GameDetails-acsKCNDO.js","assets/separator-DF_n_RiV.js","assets/useDeepLinks-DH6hrT42.js","assets/OtherUserProfile-hDXSHppt.js","assets/NotificationCenter-cltkrfsR.js","assets/Settings-DUk3v9d8.js","assets/switch-C5o6dvlI.js","assets/AccessibilitySettings-D-9sVjrR.js","assets/NotificationSettings-B7584S6_.js","assets/DesignSystem-DHg6PPq6.js","assets/AdminDashboard-CSQSSIGF.js","assets/TermsOfService-DvnbAd_q.js","assets/PrivacyPolicy-CR1Mg_Li.js","assets/Onboarding-CvPMZSqB.js","assets/NavigationTest-CzbRtVUU.js","assets/Auth-DN2v9RKN.js"])))=>i.map(i=>d[i]);
import{j as e,S as t,c as r,P as a,u as s,a as i}from"./ui-Bqrh-KgM.js";import{a as n,r as o,u as c,N as l,e as d,R as u,O as m,f as p,B as f,h as g,i as h}from"./vendor-CVaDA-xz.js";import{c as _,_ as w,Q as y,a as b}from"./data-D6RrWw63.js";import{c as v,T as x,R as k,L as E,a as j,t as I,H as S,S as N,P as T,B as P,U as A,M as R,b as C,C as O,d as U}from"./utils-CfrcxnCJ.js";var z;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var D=n;z=D.createRoot,D.hydrateRoot;const L=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,G=v,M=(e,t)=>r=>{var a;if(null==(null==t?void 0:t.variants))return G(e,null==r?void 0:r.class,null==r?void 0:r.className);const{variants:s,defaultVariants:i}=t,n=Object.keys(s).map(e=>{const t=null==r?void 0:r[e],a=null==i?void 0:i[e];if(null===t)return null;const n=L(t)||L(a);return s[e][n]}),o=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{}),c=null==t||null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:r,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...o}[t]):{...i,...o}[t]===r})?[...e,r,a]:e},[]);return G(e,n,c,null==r?void 0:r.class,null==r?void 0:r.className)},F=e=>{const t=B(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:e=>{const r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),V(r,t)||W(e)},getConflictingClassGroupIds:(e,t)=>{const s=r[e]||[];return t&&a[e]?[...s,...a[e]]:s}}},V=(e,t)=>{if(0===e.length)return t.classGroupId;const r=e[0],a=t.nextPart.get(r),s=a?V(e.slice(1),a):void 0;if(s)return s;if(0===t.validators.length)return;const i=e.join("-");return t.validators.find(({validator:e})=>e(i))?.classGroupId},q=/^\[(.+)\]$/,W=e=>{if(q.test(e)){const t=q.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},B=e=>{const{theme:t,classGroups:r}=e,a={nextPart:new Map,validators:[]};for(const s in r)$(r[s],a,s,t);return a},$=(e,t,r,a)=>{e.forEach(e=>{if("string"==typeof e){return void((""===e?t:H(t,e)).classGroupId=r)}if("function"==typeof e)return J(e)?void $(e(a),t,r,a):void t.validators.push({validator:e,classGroupId:r});Object.entries(e).forEach(([e,s])=>{$(s,H(t,e),r,a)})})},H=(e,t)=>{let r=e;return t.split("-").forEach(e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)}),r},J=e=>e.isThemeGetter,K=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,a=new Map;const s=(s,i)=>{r.set(s,i),t++,t>e&&(t=0,a=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=a.get(e))?(s(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):s(e,t)}}},Y=e=>{const{prefix:t,experimentalParseClassName:r}=e;let a=e=>{const t=[];let r,a=0,s=0,i=0;for(let c=0;c<e.length;c++){let n=e[c];if(0===a&&0===s){if(":"===n){t.push(e.slice(i,c)),i=c+1;continue}if("/"===n){r=c;continue}}"["===n?a++:"]"===n?a--:"("===n?s++:")"===n&&s--}const n=0===t.length?e:e.substring(i),o=X(n);return{modifiers:t,hasImportantModifier:o!==n,baseClassName:o,maybePostfixModifierPosition:r&&r>i?r-i:void 0}};if(t){const e=t+":",r=a;a=t=>t.startsWith(e)?r(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(r){const e=a;a=t=>r({className:t,parseClassName:e})}return a},X=e=>e.endsWith("!")?e.substring(0,e.length-1):e.startsWith("!")?e.substring(1):e,Z=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(e=>[e,!0]));return e=>{if(e.length<=1)return e;const r=[];let a=[];return e.forEach(e=>{"["===e[0]||t[e]?(r.push(...a.sort(),e),a=[]):a.push(e)}),r.push(...a.sort()),r}},Q=/\s+/;function ee(){let e,t,r=0,a="";for(;r<arguments.length;)(e=arguments[r++])&&(t=te(e))&&(a&&(a+=" "),a+=t);return a}const te=e=>{if("string"==typeof e)return e;let t,r="";for(let a=0;a<e.length;a++)e[a]&&(t=te(e[a]))&&(r&&(r+=" "),r+=t);return r};function re(e,...t){let r,a,s,i=function(o){const c=t.reduce((e,t)=>t(e),e());return r=(e=>({cache:K(e.cacheSize),parseClassName:Y(e),sortModifiers:Z(e),...F(e)}))(c),a=r.cache.get,s=r.cache.set,i=n,n(o)};function n(e){const t=a(e);if(t)return t;const i=((e,t)=>{const{parseClassName:r,getClassGroupId:a,getConflictingClassGroupIds:s,sortModifiers:i}=t,n=[],o=e.trim().split(Q);let c="";for(let l=o.length-1;l>=0;l-=1){const e=o[l],{isExternal:t,modifiers:d,hasImportantModifier:u,baseClassName:m,maybePostfixModifierPosition:p}=r(e);if(t){c=e+(c.length>0?" "+c:c);continue}let f=!!p,g=a(f?m.substring(0,p):m);if(!g){if(!f){c=e+(c.length>0?" "+c:c);continue}if(g=a(m),!g){c=e+(c.length>0?" "+c:c);continue}f=!1}const h=i(d).join(":"),_=u?h+"!":h,w=_+g;if(n.includes(w))continue;n.push(w);const y=s(g,f);for(let r=0;r<y.length;++r){const e=y[r];n.push(_+e)}c=e+(c.length>0?" "+c:c)}return c})(e,r);return s(e,i),i}return function(){return i(ee.apply(null,arguments))}}const ae=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},se=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ie=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ne=/^\d+\/\d+$/,oe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ce=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,le=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,de=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ue=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,me=e=>ne.test(e),pe=e=>!!e&&!Number.isNaN(Number(e)),fe=e=>!!e&&Number.isInteger(Number(e)),ge=e=>e.endsWith("%")&&pe(e.slice(0,-1)),he=e=>oe.test(e),_e=()=>!0,we=e=>ce.test(e)&&!le.test(e),ye=()=>!1,be=e=>de.test(e),ve=e=>ue.test(e),xe=e=>!Ee(e)&&!Pe(e),ke=e=>De(e,Fe,ye),Ee=e=>se.test(e),je=e=>De(e,Ve,we),Ie=e=>De(e,qe,pe),Se=e=>De(e,Ge,ye),Ne=e=>De(e,Me,ve),Te=e=>De(e,Be,be),Pe=e=>ie.test(e),Ae=e=>Le(e,Ve),Re=e=>Le(e,We),Ce=e=>Le(e,Ge),Oe=e=>Le(e,Fe),Ue=e=>Le(e,Me),ze=e=>Le(e,Be,!0),De=(e,t,r)=>{const a=se.exec(e);return!!a&&(a[1]?t(a[1]):r(a[2]))},Le=(e,t,r=!1)=>{const a=ie.exec(e);return!!a&&(a[1]?t(a[1]):r)},Ge=e=>"position"===e||"percentage"===e,Me=e=>"image"===e||"url"===e,Fe=e=>"length"===e||"size"===e||"bg-size"===e,Ve=e=>"length"===e,qe=e=>"number"===e,We=e=>"family-name"===e,Be=e=>"shadow"===e,$e=re(()=>{const e=ae("color"),t=ae("font"),r=ae("text"),a=ae("font-weight"),s=ae("tracking"),i=ae("leading"),n=ae("breakpoint"),o=ae("container"),c=ae("spacing"),l=ae("radius"),d=ae("shadow"),u=ae("inset-shadow"),m=ae("text-shadow"),p=ae("drop-shadow"),f=ae("blur"),g=ae("perspective"),h=ae("aspect"),_=ae("ease"),w=ae("animate"),y=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",Pe,Ee],b=()=>[Pe,Ee,c],v=()=>[me,"full","auto",...b()],x=()=>[fe,"none","subgrid",Pe,Ee],k=()=>["auto",{span:["full",fe,Pe,Ee]},fe,Pe,Ee],E=()=>[fe,"auto",Pe,Ee],j=()=>["auto","min","max","fr",Pe,Ee],I=()=>["auto",...b()],S=()=>[me,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...b()],N=()=>[e,Pe,Ee],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",Ce,Se,{position:[Pe,Ee]}],P=()=>["auto","cover","contain",Oe,ke,{size:[Pe,Ee]}],A=()=>[ge,Ae,je],R=()=>["","none","full",l,Pe,Ee],C=()=>["",pe,Ae,je],O=()=>[pe,ge,Ce,Se],U=()=>["","none",f,Pe,Ee],z=()=>["none",pe,Pe,Ee],D=()=>["none",pe,Pe,Ee],L=()=>[pe,Pe,Ee],G=()=>[me,"full",...b()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[he],breakpoint:[he],color:[_e],container:[he],"drop-shadow":[he],ease:["in","out","in-out"],font:[xe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[he],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[he],shadow:[he],spacing:["px",pe],text:[he],"text-shadow":[he],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",me,Ee,Pe,h]}],container:["container"],columns:[{columns:[pe,Ee,Pe,o]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:y()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:v()}],"inset-x":[{"inset-x":v()}],"inset-y":[{"inset-y":v()}],start:[{start:v()}],end:[{end:v()}],top:[{top:v()}],right:[{right:v()}],bottom:[{bottom:v()}],left:[{left:v()}],visibility:["visible","invisible","collapse"],z:[{z:[fe,"auto",Pe,Ee]}],basis:[{basis:[me,"full","auto",o,...b()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[pe,me,"auto","initial","none",Ee]}],grow:[{grow:["",pe,Pe,Ee]}],shrink:[{shrink:["",pe,Pe,Ee]}],order:[{order:[fe,"first","last","none",Pe,Ee]}],"grid-cols":[{"grid-cols":x()}],"col-start-end":[{col:k()}],"col-start":[{"col-start":E()}],"col-end":[{"col-end":E()}],"grid-rows":[{"grid-rows":x()}],"row-start-end":[{row:k()}],"row-start":[{"row-start":E()}],"row-end":[{"row-end":E()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":j()}],"auto-rows":[{"auto-rows":j()}],gap:[{gap:b()}],"gap-x":[{"gap-x":b()}],"gap-y":[{"gap-y":b()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:b()}],px:[{px:b()}],py:[{py:b()}],ps:[{ps:b()}],pe:[{pe:b()}],pt:[{pt:b()}],pr:[{pr:b()}],pb:[{pb:b()}],pl:[{pl:b()}],m:[{m:I()}],mx:[{mx:I()}],my:[{my:I()}],ms:[{ms:I()}],me:[{me:I()}],mt:[{mt:I()}],mr:[{mr:I()}],mb:[{mb:I()}],ml:[{ml:I()}],"space-x":[{"space-x":b()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":b()}],"space-y-reverse":["space-y-reverse"],size:[{size:S()}],w:[{w:[o,"screen",...S()]}],"min-w":[{"min-w":[o,"screen","none",...S()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[n]},...S()]}],h:[{h:["screen","lh",...S()]}],"min-h":[{"min-h":["screen","lh","none",...S()]}],"max-h":[{"max-h":["screen","lh",...S()]}],"font-size":[{text:["base",r,Ae,je]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[a,Pe,Ie]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ge,Ee]}],"font-family":[{font:[Re,Ee,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,Pe,Ee]}],"line-clamp":[{"line-clamp":[pe,"none",Pe,Ie]}],leading:[{leading:[i,...b()]}],"list-image":[{"list-image":["none",Pe,Ee]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Pe,Ee]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:N()}],"text-color":[{text:N()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[pe,"from-font","auto",Pe,je]}],"text-decoration-color":[{decoration:N()}],"underline-offset":[{"underline-offset":[pe,"auto",Pe,Ee]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Pe,Ee]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Pe,Ee]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:T()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:P()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},fe,Pe,Ee],radial:["",Pe,Ee],conic:[fe,Pe,Ee]},Ue,Ne]}],"bg-color":[{bg:N()}],"gradient-from-pos":[{from:A()}],"gradient-via-pos":[{via:A()}],"gradient-to-pos":[{to:A()}],"gradient-from":[{from:N()}],"gradient-via":[{via:N()}],"gradient-to":[{to:N()}],rounded:[{rounded:R()}],"rounded-s":[{"rounded-s":R()}],"rounded-e":[{"rounded-e":R()}],"rounded-t":[{"rounded-t":R()}],"rounded-r":[{"rounded-r":R()}],"rounded-b":[{"rounded-b":R()}],"rounded-l":[{"rounded-l":R()}],"rounded-ss":[{"rounded-ss":R()}],"rounded-se":[{"rounded-se":R()}],"rounded-ee":[{"rounded-ee":R()}],"rounded-es":[{"rounded-es":R()}],"rounded-tl":[{"rounded-tl":R()}],"rounded-tr":[{"rounded-tr":R()}],"rounded-br":[{"rounded-br":R()}],"rounded-bl":[{"rounded-bl":R()}],"border-w":[{border:C()}],"border-w-x":[{"border-x":C()}],"border-w-y":[{"border-y":C()}],"border-w-s":[{"border-s":C()}],"border-w-e":[{"border-e":C()}],"border-w-t":[{"border-t":C()}],"border-w-r":[{"border-r":C()}],"border-w-b":[{"border-b":C()}],"border-w-l":[{"border-l":C()}],"divide-x":[{"divide-x":C()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":C()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:N()}],"border-color-x":[{"border-x":N()}],"border-color-y":[{"border-y":N()}],"border-color-s":[{"border-s":N()}],"border-color-e":[{"border-e":N()}],"border-color-t":[{"border-t":N()}],"border-color-r":[{"border-r":N()}],"border-color-b":[{"border-b":N()}],"border-color-l":[{"border-l":N()}],"divide-color":[{divide:N()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[pe,Pe,Ee]}],"outline-w":[{outline:["",pe,Ae,je]}],"outline-color":[{outline:N()}],shadow:[{shadow:["","none",d,ze,Te]}],"shadow-color":[{shadow:N()}],"inset-shadow":[{"inset-shadow":["none",u,ze,Te]}],"inset-shadow-color":[{"inset-shadow":N()}],"ring-w":[{ring:C()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:N()}],"ring-offset-w":[{"ring-offset":[pe,je]}],"ring-offset-color":[{"ring-offset":N()}],"inset-ring-w":[{"inset-ring":C()}],"inset-ring-color":[{"inset-ring":N()}],"text-shadow":[{"text-shadow":["none",m,ze,Te]}],"text-shadow-color":[{"text-shadow":N()}],opacity:[{opacity:[pe,Pe,Ee]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[pe]}],"mask-image-linear-from-pos":[{"mask-linear-from":O()}],"mask-image-linear-to-pos":[{"mask-linear-to":O()}],"mask-image-linear-from-color":[{"mask-linear-from":N()}],"mask-image-linear-to-color":[{"mask-linear-to":N()}],"mask-image-t-from-pos":[{"mask-t-from":O()}],"mask-image-t-to-pos":[{"mask-t-to":O()}],"mask-image-t-from-color":[{"mask-t-from":N()}],"mask-image-t-to-color":[{"mask-t-to":N()}],"mask-image-r-from-pos":[{"mask-r-from":O()}],"mask-image-r-to-pos":[{"mask-r-to":O()}],"mask-image-r-from-color":[{"mask-r-from":N()}],"mask-image-r-to-color":[{"mask-r-to":N()}],"mask-image-b-from-pos":[{"mask-b-from":O()}],"mask-image-b-to-pos":[{"mask-b-to":O()}],"mask-image-b-from-color":[{"mask-b-from":N()}],"mask-image-b-to-color":[{"mask-b-to":N()}],"mask-image-l-from-pos":[{"mask-l-from":O()}],"mask-image-l-to-pos":[{"mask-l-to":O()}],"mask-image-l-from-color":[{"mask-l-from":N()}],"mask-image-l-to-color":[{"mask-l-to":N()}],"mask-image-x-from-pos":[{"mask-x-from":O()}],"mask-image-x-to-pos":[{"mask-x-to":O()}],"mask-image-x-from-color":[{"mask-x-from":N()}],"mask-image-x-to-color":[{"mask-x-to":N()}],"mask-image-y-from-pos":[{"mask-y-from":O()}],"mask-image-y-to-pos":[{"mask-y-to":O()}],"mask-image-y-from-color":[{"mask-y-from":N()}],"mask-image-y-to-color":[{"mask-y-to":N()}],"mask-image-radial":[{"mask-radial":[Pe,Ee]}],"mask-image-radial-from-pos":[{"mask-radial-from":O()}],"mask-image-radial-to-pos":[{"mask-radial-to":O()}],"mask-image-radial-from-color":[{"mask-radial-from":N()}],"mask-image-radial-to-color":[{"mask-radial-to":N()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[pe]}],"mask-image-conic-from-pos":[{"mask-conic-from":O()}],"mask-image-conic-to-pos":[{"mask-conic-to":O()}],"mask-image-conic-from-color":[{"mask-conic-from":N()}],"mask-image-conic-to-color":[{"mask-conic-to":N()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:T()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:P()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Pe,Ee]}],filter:[{filter:["","none",Pe,Ee]}],blur:[{blur:U()}],brightness:[{brightness:[pe,Pe,Ee]}],contrast:[{contrast:[pe,Pe,Ee]}],"drop-shadow":[{"drop-shadow":["","none",p,ze,Te]}],"drop-shadow-color":[{"drop-shadow":N()}],grayscale:[{grayscale:["",pe,Pe,Ee]}],"hue-rotate":[{"hue-rotate":[pe,Pe,Ee]}],invert:[{invert:["",pe,Pe,Ee]}],saturate:[{saturate:[pe,Pe,Ee]}],sepia:[{sepia:["",pe,Pe,Ee]}],"backdrop-filter":[{"backdrop-filter":["","none",Pe,Ee]}],"backdrop-blur":[{"backdrop-blur":U()}],"backdrop-brightness":[{"backdrop-brightness":[pe,Pe,Ee]}],"backdrop-contrast":[{"backdrop-contrast":[pe,Pe,Ee]}],"backdrop-grayscale":[{"backdrop-grayscale":["",pe,Pe,Ee]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[pe,Pe,Ee]}],"backdrop-invert":[{"backdrop-invert":["",pe,Pe,Ee]}],"backdrop-opacity":[{"backdrop-opacity":[pe,Pe,Ee]}],"backdrop-saturate":[{"backdrop-saturate":[pe,Pe,Ee]}],"backdrop-sepia":[{"backdrop-sepia":["",pe,Pe,Ee]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":b()}],"border-spacing-x":[{"border-spacing-x":b()}],"border-spacing-y":[{"border-spacing-y":b()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Pe,Ee]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[pe,"initial",Pe,Ee]}],ease:[{ease:["linear","initial",_,Pe,Ee]}],delay:[{delay:[pe,Pe,Ee]}],animate:[{animate:["none",w,Pe,Ee]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,Pe,Ee]}],"perspective-origin":[{"perspective-origin":y()}],rotate:[{rotate:z()}],"rotate-x":[{"rotate-x":z()}],"rotate-y":[{"rotate-y":z()}],"rotate-z":[{"rotate-z":z()}],scale:[{scale:D()}],"scale-x":[{"scale-x":D()}],"scale-y":[{"scale-y":D()}],"scale-z":[{"scale-z":D()}],"scale-3d":["scale-3d"],skew:[{skew:L()}],"skew-x":[{"skew-x":L()}],"skew-y":[{"skew-y":L()}],transform:[{transform:[Pe,Ee,"","none","gpu","cpu"]}],"transform-origin":[{origin:y()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:G()}],"translate-x":[{"translate-x":G()}],"translate-y":[{"translate-y":G()}],"translate-z":[{"translate-z":G()}],"translate-none":["translate-none"],accent:[{accent:N()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:N()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Pe,Ee]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Pe,Ee]}],fill:[{fill:["none",...N()]}],"stroke-w":[{stroke:[pe,Ae,je,Ie]}],stroke:[{stroke:["none",...N()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function He(...e){return $e(v(e))}const Je=M("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive shadow-sm hover:shadow-md active:scale-[0.98] transform",{variants:{variant:{default:"bg-gradient-to-r from-primary to-primary/90 text-primary-foreground hover:from-primary/90 hover:to-primary/80 hover:shadow-primary/25",destructive:"bg-gradient-to-r from-destructive to-destructive/90 text-white hover:from-destructive/90 hover:to-destructive/80 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 hover:shadow-destructive/25",outline:"border-2 bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:border-primary/50",secondary:"bg-gradient-to-r from-secondary to-secondary/90 text-secondary-foreground hover:from-secondary/90 hover:to-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 hover:shadow-none",link:"text-primary underline-offset-4 hover:underline shadow-none hover:shadow-none",message:"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 hover:shadow-blue-500/25 font-semibold"},size:{default:"h-10 px-5 py-2.5 has-[>svg]:px-4",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-12 rounded-lg px-8 has-[>svg]:px-6 text-base",icon:"size-10 rounded-lg"}},defaultVariants:{variant:"default",size:"default"}});function Ke({className:r,variant:a,size:s,asChild:i=!1,...n}){const o=i?t:"button";return e.jsx(o,{"data-slot":"button",className:He(Je({variant:a,size:s,className:r})),...n})}function Ye({className:t,...r}){return e.jsx("div",{"data-slot":"card",className:He("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",t),...r})}function Xe({className:t,...r}){return e.jsx("div",{"data-slot":"card-header",className:He("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function Ze({className:t,...r}){return e.jsx("h4",{"data-slot":"card-title",className:He("leading-none",t),...r})}function Qe({className:t,...r}){return e.jsx("div",{"data-slot":"card-content",className:He("px-6 [&:last-child]:pb-6",t),...r})}class et extends o.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(Ye,{className:"w-full max-w-md",children:[e.jsxs(Xe,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-destructive/10",children:e.jsx(x,{className:"h-6 w-6 text-destructive"})}),e.jsx(Ze,{className:"text-xl",children:"Something went wrong"})]}),e.jsxs(Qe,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"We encountered an unexpected error. This has been logged and we'll look into it."}),!1,e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ke,{onClick:this.handleRetry,className:"flex-1",variant:"default",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsx(Ke,{onClick:()=>window.location.reload(),variant:"outline",className:"flex-1",children:"Reload Page"})]})]})]})}):this.props.children}}function tt({size:t="md",className:r="",text:a}){return e.jsxs("div",{className:`flex flex-col items-center justify-center gap-3 ${r}`,children:[e.jsx("div",{className:"animate-spin",children:e.jsx(E,{className:`${{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}[t]} text-primary`})}),a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]})}const rt=globalThis.__supabase__||_("https://alegufnopsminqcokelr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFsZWd1Zm5vcHNtaW5xY29rZWxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyMzUwMjIsImV4cCI6MjA3MTgxMTAyMn0.YgwFtX87MiSXA83DN2um0WP-1uYU6qsPXhwGmIWjadQ",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"tribeup-auth",flowType:"implicit"},db:{schema:"public"},global:{headers:{"x-client-info":"tribeup-web@1.0.0"}},realtime:{params:{eventsPerSecond:2},heartbeatIntervalMs:3e4,reconnectAfterMs:()=>5e3*Math.random()}});"undefined"!=typeof globalThis&&(globalThis.__supabase__=rt);const at=(e,t=!1)=>({id:e.id,title:e.title,sport:e.sport,date:e.date,time:e.time,duration:e.duration||60,location:e.location,latitude:e.latitude,longitude:e.longitude,cost:e.cost,maxPlayers:e.max_players,currentPlayers:e.current_players,description:e.description,imageUrl:e.image_url||"",sportColor:it(e.sport),isJoined:t,createdBy:e.creator?.full_name||e.creator?.username||`User ${e.creator_id?.slice(0,8)||"Unknown"}`,creatorId:e.creator_id,creatorData:e.creator?{id:e.creator.id,name:e.creator.full_name||e.creator.username||e.creator.email?.split("@")[0]||`User ${e.creator.id.slice(0,8)}`,avatar:e.creator.avatar_url||""}:{id:e.creator_id,name:`User ${e.creator_id?.slice(0,8)||"Unknown"}`,avatar:""},createdAt:e.created_at}),st=e=>({id:e.id,name:e.full_name||e.username||e.email?.split("@")[0]||`User ${e.id.slice(0,8)}`,username:e.username||e.email?.split("@")[0]||`user_${e.id.slice(0,8)}`,email:e.email,avatar:e.avatar_url||"",bio:e.bio||"",location:e.location||"",role:e.role||"user",preferences:{theme:"auto",highContrast:!1,largeText:!1,reducedMotion:!1,colorBlindFriendly:!1,notifications:{push:!0,email:!1,gameReminders:!0},privacy:{locationSharing:!0,profileVisibility:"public"},sports:e.preferred_sports||[]}}),it=e=>({basketball:"#FA4616",soccer:"#22C55E",tennis:"#3B82F6",pickleball:"#65A30D",volleyball:"#8B5CF6",football:"#F59E0B",baseball:"#EF4444",swimming:"#06B6D4",running:"#10B981",cycling:"#6366F1",yoga:"#EC4899"}[e.toLowerCase()]||"#6B7280"),nt={VITE_ENABLE_MOCK_DATA:"false",VITE_OPENWEATHER_API_KEY:"3d49d90fb511ba08385a88435f10825c",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFsZWd1Zm5vcHNtaW5xY29rZWxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyMzUwMjIsImV4cCI6MjA3MTgxMTAyMn0.YgwFtX87MiSXA83DN2um0WP-1uYU6qsPXhwGmIWjadQ",VITE_SUPABASE_URL:"https://alegufnopsminqcokelr.supabase.co",VITE_VAPID_PUBLIC_KEY:"BC4DMZTgsNweSUVDik1uoXwpXEnzk12jgZTVA0B19WYKxa4NeaFv4QRov_1e-w-V_SgN7RrBZ_yMX_2HopLoSus"};class ot{static instance;config;constructor(){this.config=this.loadConfig(),this.validateConfig()}static getInstance(){return ot.instance||(ot.instance=new ot),ot.instance}loadConfig(){const e=nt;return{supabaseUrl:e.VITE_SUPABASE_URL,supabaseAnonKey:e.VITE_SUPABASE_ANON_KEY,openWeatherApiKey:e.VITE_OPENWEATHER_API_KEY,weatherTempUnit:e.VITE_WEATHER_TEMP_UNIT||"fahrenheit",weatherUpdateInterval:parseInt(e.VITE_WEATHER_UPDATE_INTERVAL||"3600"),weatherIncludeHourly:"false"!==e.VITE_WEATHER_INCLUDE_HOURLY,weatherRainThreshold:parseFloat(e.VITE_WEATHER_RAIN_THRESHOLD||"0.1"),weatherWindThreshold:parseInt(e.VITE_WEATHER_WIND_THRESHOLD||"15"),vapidPublicKey:e.VITE_VAPID_PUBLIC_KEY,profileCheckTimeout:parseInt(e.VITE_PROFILE_CHECK_TIMEOUT||"5000"),profileForceTimeout:parseInt(e.VITE_PROFILE_FORCE_TIMEOUT||"15000"),presenceHeartbeatInterval:parseInt(e.VITE_PRESENCE_HEARTBEAT_INTERVAL||"30000"),locationMonitoringInterval:parseInt(e.VITE_LOCATION_MONITORING_INTERVAL||"1800000"),gameEditRestrictionHours:parseInt(e.VITE_GAME_EDIT_RESTRICTION_HOURS||"2"),gameDeletionRestrictionHours:parseInt(e.VITE_GAME_DELETION_RESTRICTION_HOURS||"4"),enableMockData:"true"===e.VITE_ENABLE_MOCK_DATA,logLevel:e.VITE_LOG_LEVEL||"info"}}validateConfig(){const e=[];if(this.config.supabaseUrl||e.push("VITE_SUPABASE_URL is required"),this.config.supabaseAnonKey||e.push("VITE_SUPABASE_ANON_KEY is required"),(isNaN(this.config.weatherUpdateInterval)||this.config.weatherUpdateInterval<60)&&e.push("VITE_WEATHER_UPDATE_INTERVAL must be a number >= 60"),(isNaN(this.config.weatherRainThreshold)||this.config.weatherRainThreshold<0)&&e.push("VITE_WEATHER_RAIN_THRESHOLD must be a number >= 0"),(isNaN(this.config.weatherWindThreshold)||this.config.weatherWindThreshold<0)&&e.push("VITE_WEATHER_WIND_THRESHOLD must be a number >= 0"),(isNaN(this.config.profileCheckTimeout)||this.config.profileCheckTimeout<1e3)&&e.push("VITE_PROFILE_CHECK_TIMEOUT must be a number >= 1000"),(isNaN(this.config.profileForceTimeout)||this.config.profileForceTimeout<5e3)&&e.push("VITE_PROFILE_FORCE_TIMEOUT must be a number >= 5000"),(isNaN(this.config.presenceHeartbeatInterval)||this.config.presenceHeartbeatInterval<1e4)&&e.push("VITE_PRESENCE_HEARTBEAT_INTERVAL must be a number >= 10000"),(isNaN(this.config.gameEditRestrictionHours)||this.config.gameEditRestrictionHours<0)&&e.push("VITE_GAME_EDIT_RESTRICTION_HOURS must be a number >= 0"),(isNaN(this.config.gameDeletionRestrictionHours)||this.config.gameDeletionRestrictionHours<0)&&e.push("VITE_GAME_DELETION_RESTRICTION_HOURS must be a number >= 0"),["fahrenheit","celsius"].includes(this.config.weatherTempUnit)||e.push('VITE_WEATHER_TEMP_UNIT must be "fahrenheit" or "celsius"'),["debug","info","warn","error"].includes(this.config.logLevel)||e.push("VITE_LOG_LEVEL must be one of: debug, info, warn, error"),e.length>0)throw new Error(`Environment configuration errors:\n${e.join("\n")}`);const t=[];this.config.openWeatherApiKey||t.push("VITE_OPENWEATHER_API_KEY not set - weather features will use mock data"),this.config.vapidPublicKey||t.push("VITE_VAPID_PUBLIC_KEY not set - push notifications will be disabled"),t.length}getConfig(){return{...this.config}}get(e){return this.config[e]}isFeatureEnabled(e){switch(e){case"weather":return!!this.config.openWeatherApiKey;case"pushNotifications":return!!this.config.vapidPublicKey;case"mockData":return this.config.enableMockData;default:return!1}}}const ct=ot.getInstance(),lt={maxRetries:3,baseDelay:1e3,maxDelay:1e4,timeout:15e3};class dt{static instance;connectionAttempts=new Map;lastConnectionTime=new Map;config;constructor(e=lt){this.config=e}static getInstance(e){return dt.instance||(dt.instance=new dt(e)),dt.instance}calculateDelay(e){const t=Math.min(this.config.baseDelay*Math.pow(2,e),this.config.maxDelay);return t+.1*Math.random()*t}shouldThrottle(e){const t=this.connectionAttempts.get(e)||0,r=this.lastConnectionTime.get(e)||0,a=Date.now();if(t>=this.config.maxRetries){if(a-r<this.calculateDelay(t))return!0;this.connectionAttempts.set(e,0)}return!1}recordAttempt(e){const t=this.connectionAttempts.get(e)||0;this.connectionAttempts.set(e,t+1),this.lastConnectionTime.set(e,Date.now())}resetAttempts(e){this.connectionAttempts.delete(e),this.lastConnectionTime.delete(e)}async executeWithRetry(e,t,r){const a={...this.config,...r};if(this.shouldThrottle(t))throw new Error(`Operation ${t} is being throttled due to repeated failures`);let s=null;for(let n=0;n<=a.maxRetries;n++)try{this.recordAttempt(t);const r=new Promise((e,t)=>{setTimeout(()=>t(new Error("Operation timeout")),a.timeout)}),s=await Promise.race([e(),r]);return this.resetAttempts(t),s}catch(i){if(s=i,this.isNonRetryableError(i))throw i;if(n<a.maxRetries){const e=this.calculateDelay(n);await new Promise(t=>setTimeout(t,e))}}throw s||new Error(`Operation ${t} failed after ${a.maxRetries} attempts`)}isNonRetryableError(e){const t=e.message?.toLowerCase()||"";return["Invalid API key","Unauthorized","Forbidden","Not found","Bad request","Invalid JWT","JWT expired"].some(e=>t.includes(e.toLowerCase()))}async checkConnectivity(){try{const{error:e}=await rt.from("users").select("id").limit(1);return!e}catch{return!1}}getConnectionStats(){const e={};for(const[t,r]of this.connectionAttempts.entries())e[t]={attempts:r,lastAttempt:this.lastConnectionTime.get(t)||0};return e}clearConnectionTracking(){this.connectionAttempts.clear(),this.lastConnectionTime.clear()}}const ut=dt.getInstance();class mt{static async signUp(e,t,r){const{data:a,error:s}=await rt.auth.signUp({email:e,password:t,options:{data:{full_name:r.name,username:r.name?.toLowerCase().replace(/\s+/g,"_")}}});if(s)throw s;return a.user&&await this.createUserProfile(a.user.id,r),a}static async signIn(e,t){const{data:r,error:a}=await rt.auth.signInWithPassword({email:e,password:t});if(a)throw a;return r}static async signOut(){const{error:e}=await rt.auth.signOut();if(e)throw e}static async getCurrentUser(){const{data:{user:e},error:t}=await rt.auth.getUser();if(t)throw t;return e}static async createUserProfile(e,t){try{const{data:r,error:a}=await rt.from("users").select("id").eq("id",e).maybeSingle();if(a&&"PGRST116"!==a.code)throw a;let s=t.email||null;if(!s){const{data:e}=await rt.auth.getUser();s=e.user?.email??null}if(!s)throw new Error("Unable to determine user email for profile creation");const i={id:e,email:s,full_name:`${t.firstName||""} ${t.lastName||""}`.trim()||t.name||"New User",username:t.username||`user_${Math.random().toString(36).substring(2,10)}`,bio:t.bio||"",location:t.location||"",role:t.role||"user",preferred_sports:Array.isArray(t.selectedSports)?t.selectedSports.filter(e=>"string"==typeof e&&e.trim().length>0):[]},{data:n,error:o}=await rt.from("users").upsert(i,{onConflict:"id"}).select().single();if(o)throw o;return n}catch(r){throw r}}static async getUserProfile(e){try{if(!e||""===e.trim())return null;const{data:{user:t}}=await rt.auth.getUser();if(!t)return null;const r=await ut.executeWithRetry(async()=>{const{data:t,error:r}=await rt.from("users").select("\n              id,\n              email,\n              username,\n              full_name,\n              avatar_url,\n              bio,\n              location,\n              preferred_sports,\n              role,\n              stats,\n              created_at\n            ").eq("id",e.trim()).maybeSingle();if(r){if("PGRST116"===r.code){const{data:t,error:r}=await rt.from("users").select("id, email, username, full_name, avatar_url, bio, location, role").eq("id",e.trim()).limit(1).single();if(r)throw r;return{...t,preferred_sports:[],stats:{},created_at:(new Date).toISOString()}}throw r}return t},`getUserProfile-${e}`,{maxRetries:1,timeout:3e3});if(!r){const{data:e,error:t}=await rt.from("users").select("id, full_name").limit(5);return null}return st(r)}catch(t){return t instanceof Error&&t.message,null}}static async isUsernameAvailable(e,t){const r=rt.from("users").select("id",{count:"exact",head:!0}).ilike("username",e),{count:a,error:s}=t?await r.neq("id",t):await r;if(s)throw s;return 0===(a??0)}static async uploadAvatar(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");const r=`${Date.now()}_${e.name}`.replace(/\s+/g,"_"),a=`${t.id}/${r}`,{error:s}=await rt.storage.from("avatars").upload(a,e,{upsert:!0,cacheControl:"3600"});if(s)throw s;const{data:i}=rt.storage.from("avatars").getPublicUrl(a);return i.publicUrl}static async updateUserProfile(e,t){const r={full_name:t.full_name,username:t.username,avatar_url:t.avatar_url,bio:t.bio,location:t.location,preferred_sports:t.preferred_sports||t.sports_preferences};t.role&&(r.role=t.role);const{data:a,error:s}=await rt.from("users").update(r).eq("id",e).select().single();if(s)throw s;return st(a)}static async isProfileComplete(e){try{const t=await this.getUserProfile(e);return!!(t&&t.name&&t.username)}catch(t){return!1}}static async hasAdminRole(e){try{const{data:t,error:r}=await rt.from("users").select("role").eq("id",e).single();return!r&&"admin"===t.role}catch(t){return!1}}static async hasModeratorRole(e){try{const{data:t,error:r}=await rt.from("users").select("role").eq("id",e).single();return!r&&("moderator"===t.role||"admin"===t.role)}catch(t){return!1}}static async updateUserRole(e,t){const r=await this.getCurrentUser();if(!r)throw new Error("Not authenticated");if(!(await this.hasAdminRole(r.id)))throw new Error("Only admins can update user roles");const{error:a}=await rt.from("users").update({role:t}).eq("id",e);if(a)throw a;await this.logAdminAction("update_user_role","user",e,{role:t})}static async deleteGame(e,t){const r=await this.getCurrentUser();if(!r)throw new Error("Not authenticated");const{data:a,error:s}=await rt.from("games").select("creator_id, date, time, title").eq("id",e).single();if(s)throw s;const i=a.creator_id===r.id,n=await this.hasModeratorRole(r.id);if(!i&&!n)throw new Error("Only game creators, moderators, or admins can delete games");if(i&&!n){const e=new Date(`${a.date}T${a.time}`),t=new Date,r=(e.getTime()-t.getTime())/36e5,s=ct.get("gameDeletionRestrictionHours");if(r<s)throw new Error(`Cannot delete game within ${s} hours of start time`)}await this.notifyGameParticipants(e,"game_cancelled",{title:"Game Cancelled",message:`The game "${a.title}" has been cancelled${t?`: ${t}`:"."}`}),await rt.from("game_participants").delete().eq("game_id",e),await rt.from("chat_messages").delete().eq("game_id",e);const{error:o}=await rt.from("games").delete().eq("id",e);if(o)throw o;n&&!i&&await this.logAdminAction("delete_game","game",e,{reason:t||"admin_deletion",game_title:a.title})}static async getAllUsers(){const e=await this.getCurrentUser();if(!e)throw new Error("Not authenticated");if(!(await this.hasAdminRole(e.id)))throw new Error("Only admins can view all users");const{data:t,error:r}=await rt.from("users").select("*").order("created_at",{ascending:!1});if(r)throw r;return t.map(st)}static async logAdminAction(e,t,r,a){if(!(await this.getCurrentUser()))return;const{error:s}=await rt.rpc("log_admin_action",{p_action:e,p_target_type:t,p_target_id:r,p_details:a})}static async getAdminAuditLog(e=50){const t=await this.getCurrentUser();if(!t)throw new Error("Not authenticated");if(!(await this.hasAdminRole(t.id)))throw new Error("Only admins can view audit logs");const{data:r,error:a}=await rt.from("admin_audit_log").select("\n        *,\n        admin:admin_id(full_name, username, email)\n      ").order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r}static getMockGames(){const e=new Date,t=new Date(e);return t.setDate(t.getDate()+1),[{id:"mock-1",title:"Basketball Pickup Game",sport:"basketball",date:e.toISOString().split("T")[0],time:"18:00",duration:90,location:"Local Community Center",cost:"Free",maxPlayers:10,currentPlayers:6,description:"Casual pickup basketball game. All skill levels welcome!",imageUrl:"",sportColor:"#FA4616",isJoined:!1,createdBy:"mock-user",createdAt:e.toISOString()},{id:"mock-2",title:"Soccer Match",sport:"soccer",date:t.toISOString().split("T")[0],time:"19:30",duration:120,location:"City Park Field",cost:"$5",maxPlayers:22,currentPlayers:18,description:"Friendly soccer match. Bring your own water!",imageUrl:"",sportColor:"#22C55E",isJoined:!1,createdBy:"mock-user",createdAt:e.toISOString()}]}static async getGames(){const e=performance.now();try{const{data:{user:e}}=await rt.auth.getUser(),t=e?.id,r=performance.now();if(t){const{data:e,error:r}=await rt.from("games").select("\n            *,\n            game_participants(user_id),\n            creator:users!games_creator_id_fkey(id, full_name, username, avatar_url)\n          ").gte("date",(new Date).toISOString().split("T")[0]).order("date",{ascending:!0}).limit(50);performance.now();if(r)throw r;const a=performance.now(),s=(e||[]).map(e=>{try{const r=e.game_participants?.some(e=>e.user_id===t)||!1;return at(e,r)}catch(r){return{id:e.id,title:e.title,sport:e.sport,date:e.date,time:e.time,location:e.location,latitude:e.latitude,longitude:e.longitude,cost:e.cost,maxPlayers:e.max_players,currentPlayers:e.current_players,description:e.description,imageUrl:e.image_url||"",sportColor:"#6B7280",isJoined:!1,createdBy:e.creator_id,createdAt:e.created_at}}});performance.now(),performance.now();return s}{const{data:e,error:t}=await rt.from("games").select("\n            *,\n            creator:users!games_creator_id_fkey(id, full_name, username, avatar_url)\n          ").gte("date",(new Date).toISOString().split("T")[0]).order("created_at",{ascending:!1}).limit(50);performance.now();if(t)throw t;const r=performance.now(),a=(e||[]).map(e=>{try{return at(e,!1)}catch(t){return{id:e.id,title:e.title,sport:e.sport,date:e.date,time:e.time,location:e.location,latitude:e.latitude,longitude:e.longitude,cost:e.cost,maxPlayers:e.max_players,currentPlayers:e.current_players,description:e.description,imageUrl:e.image_url||"",sportColor:"#6B7280",isJoined:!1,createdBy:e.creator_id,createdAt:e.created_at}}});performance.now(),performance.now();return a}}catch(t){return this.getMockGames()}}static async getMyGames(e){const{data:t,error:r}=await rt.from("games").select("\n        *,\n        creator:users!games_creator_id_fkey(full_name, username)\n      ").eq("creator_id",e).gte("date",(new Date).toISOString().split("T")[0]).order("date",{ascending:!0});if(r)throw r;return t.map(e=>at(e,!0))}static async getNearbyGames(e,t,r=25){try{const{data:{user:r}}=await rt.auth.getUser(),a=r?.id;let s=rt.from("games").select("id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id");if(e||t||(s=s.gte("date",(new Date).toISOString().split("T")[0])),e&&t&&(s=s.filter("latitude","gte",e-.1).filter("latitude","lte",e+.1).filter("longitude","gte",t-.1).filter("longitude","lte",t+.1)),!a){const{data:e,error:t}=await s.order("date",{ascending:!0}).limit(50);if(t)throw t;return(e||[]).map(e=>at(e,!1))}const{data:i,error:n}=await s.select("\n          *,\n          game_participants(user_id)\n        ").order("date",{ascending:!0}).limit(50);if(n)throw n;return(i||[]).map(e=>{const t=e.game_participants?.some(e=>e.user_id===a)||!1;return at(e,t)})}catch(a){return this.getGames()}}static async createGame(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");try{const{data:e,error:r}=await rt.from("users").select("id").eq("id",t.id).maybeSingle();if(e){if(r&&"PGRST116"!==r.code)throw r}else{const{data:e}=await rt.auth.getUser(),r=e.user?.email||"";if(!r)throw new Error("Cannot create user profile: missing email from auth");const a={id:t.id,email:r,full_name:e.user?.user_metadata?.full_name||e.user?.user_metadata?.name||"New User",username:e.user?.user_metadata?.username||`user_${Math.random().toString(36).slice(2,10)}`,bio:"",location:"",preferred_sports:[]},{error:s}=await rt.from("users").upsert(a,{onConflict:"id"});if(s)throw s}}catch(s){}const{data:r,error:a}=await rt.from("games").insert([{title:e.title,sport:e.sport,date:e.date,time:e.time,location:e.location,latitude:e.latitude,longitude:e.longitude,cost:e.cost,max_players:e.maxPlayers,current_players:1,description:e.description,image_url:e.imageUrl,creator_id:t.id}]).select().single();if(a)throw a;try{await rt.from("game_participants").insert({game_id:r.id,user_id:t.id})}catch(s){}return r.id}static async updateGame(e,t){const r=await this.getCurrentUser();if(!r)throw new Error("User not authenticated");const{data:a,error:s}=await rt.from("games").select("creator_id, date, time").eq("id",e).single();if(s)throw s;if(a.creator_id!==r.id)throw new Error("Only the game creator can edit this game");const i=new Date(`${a.date}T${a.time}`),n=new Date,o=(i.getTime()-n.getTime())/36e5,c=ct.get("gameEditRestrictionHours");if(o<c)throw new Error(`Cannot edit game within ${c} hours of start time`);let l;if(void 0!==t.cost)if("FREE"===t.cost)l=0;else{const e=t.cost.match(/\$(\d+)/);l=e?parseInt(e[1]):0}const d={};void 0!==t.title&&(d.title=t.title),void 0!==t.sport&&(d.sport=t.sport),void 0!==t.description&&(d.description=t.description),void 0!==t.date&&(d.date=t.date),void 0!==t.time&&(d.time=t.time),void 0!==t.duration&&(d.duration=t.duration),void 0!==t.location&&(d.location=t.location),void 0!==t.latitude&&(d.latitude=t.latitude),void 0!==t.longitude&&(d.longitude=t.longitude),void 0!==t.maxPlayers&&(d.max_players=t.maxPlayers),void 0!==l&&(d.cost=l),void 0!==t.imageUrl&&(d.image_url=t.imageUrl);const{data:u,error:m}=await rt.from("games").update(d).eq("id",e).select().single();if(m)throw m;return await this.notifyGameParticipants(e,"game_updated",{title:"Game Updated",message:`The game "${u.title}" has been updated by the organizer.`}),at(u,!1)}static async notifyGameParticipants(e,t,r){try{const{data:a,error:s}=await rt.from("game_participants").select("user_id").eq("game_id",e);if(s||!a)return;const i=a.map(a=>({user_id:a.user_id,type:t,title:r.title,message:r.message,data:{gameId:e},read:!1}));i.length>0&&await rt.from("notifications").insert(i)}catch(a){}}static async joinGame(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");const{error:r}=await rt.rpc("join_game",{game_uuid:e});if(r)throw r;try{await mt.recordGameParticipation(t.id,e,"joined")}catch(a){!a?.message?.includes("Could not find the 'status' column")&&a?.message?.includes('column "status" of relation "game_participants" does not exist')}}static async leaveGame(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");const{error:r}=await rt.rpc("leave_game",{game_uuid:e});if(r)throw r;try{await mt.recordGameParticipation(t.id,e,"left")}catch(a){!a?.message?.includes("Could not find the 'status' column")&&a?.message?.includes('column "status" of relation "game_participants" does not exist')}}static async getPublicRSVPs(e){const{data:t,error:r}=await rt.from("public_rsvps").select("*").eq("game_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}static async createPublicRSVP(e,t){const{data:r}=await rt.from("public_rsvps").select("id").eq("game_id",e).eq("email",t.email).single();if(r)throw new Error("This email has already RSVPed for this game");const{error:a}=await rt.from("public_rsvps").insert({game_id:e,name:t.name,email:t.email,phone:t.phone});if(a)throw a}static async getGameById(e){const{data:{user:t}}=await rt.auth.getUser(),r=t?.id;if(r){const{data:t,error:a}=await rt.from("games").select("\n          *,\n          game_participants(user_id),\n          creator:users!creator_id(id, full_name, username, avatar_url)\n        ").eq("id",e).single();if(a)throw a;const s=t.game_participants?.some(e=>e.user_id===r)||!1;return at(t,s)}{const{data:t,error:r}=await rt.from("games").select("\n          *,\n          creator:users!creator_id(id, full_name, username, avatar_url)\n        ").eq("id",e).single();if(r)throw r;return at(t,!1)}}static async getNotifications(){const e=await this.getCurrentUser();if(!e)throw new Error("User not authenticated");const{data:t,error:r}=await rt.from("notifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(r)throw r;return t.map(e=>({id:e.id,type:e.type,title:e.title,message:e.message,timestamp:new Date(e.created_at),read:e.read,actionUrl:e.data?.actionUrl,gameId:e.data?.gameId,userId:e.data?.userId,data:e.data}))}static async markNotificationAsRead(e){const{error:t}=await rt.from("notifications").update({read:!0}).eq("id",e);if(t)throw t}static async deleteNotification(e){const{error:t}=await rt.from("notifications").delete().eq("id",e);if(t)throw t}static async clearAllNotifications(){const e=await this.getCurrentUser();if(!e)throw new Error("User not authenticated");const{error:t}=await rt.from("notifications").delete().eq("user_id",e.id);if(t)throw t}static async getGameParticipants(e){try{const{data:t,error:r}=await rt.from("game_participants").select("user_id, joined_at").eq("game_id",e);if(r)throw r;if(!t||0===t.length)return[];const a=t.map(e=>e.user_id),{data:s,error:i}=await rt.from("users").select("id, full_name, username, avatar_url, email").in("id",a);return i?t.map(e=>({id:e.user_id,name:`User ${e.user_id.slice(0,8)}`,avatar:null,isHost:!1,rating:4.5})):t.map(e=>{const t=s?.find(t=>t.id===e.user_id);return{id:e.user_id,name:t?.full_name||t?.username||t?.email?.split("@")[0]||`User ${e.user_id.slice(0,8)}`,avatar:t?.avatar_url||null,isHost:!1,rating:4.5}})}catch(t){return[]}}static async createTestUser(e){try{const{data:t,error:r}=await rt.from("users").insert([{id:e.id||crypto.randomUUID(),full_name:e.full_name,username:e.username,email:e.email,bio:e.bio||"",location:e.location||"",role:"user",created_at:(new Date).toISOString()}]).select().single();if(r)throw r;return t}catch(t){throw t}}static subscribeToGameUpdates(e,t){return rt.channel(`game:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"games",filter:`id=eq.${e}`},t).on("postgres_changes",{event:"*",schema:"public",table:"game_participants",filter:`game_id=eq.${e}`},t).subscribe()}static subscribeToChatMessages(e,t){return rt.channel(`chat:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`game_id=eq.${e}`},t).subscribe()}static subscribeToNotifications(e){return{unsubscribe:()=>{}}}static subscribeToAllGames(e){return{unsubscribe:()=>{}}}static subscribeToPublicRSVPs(e,t){return{unsubscribe:()=>{}}}static async searchGames(e){try{const{data:{user:t}}=await rt.auth.getUser(),r=t?.id;let a=rt.from("games").select("id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id");if(e.dateRange?.start||(a=a.gte("date",(new Date).toISOString().split("T")[0])),e.sports&&e.sports.length>0&&(a=a.in("sport",e.sports)),e.dateRange?.start&&(a=a.gte("date",e.dateRange.start.toISOString().split("T")[0])),e.dateRange?.end&&(a=a.lte("date",e.dateRange.end.toISOString().split("T")[0])),!r){const{data:e,error:t}=await a.order("date",{ascending:!0}).limit(50);if(t)throw t;return(e||[]).map(e=>at(e,!1))}const{data:s,error:i}=await a.select("\n          *,\n          game_participants(user_id)\n        ").order("date",{ascending:!0}).limit(50);if(i)throw i;return(s||[]).map(e=>{const t=e.game_participants?.some(e=>e.user_id===r)||!1;return at(e,t)})}catch(t){return[]}}static async getRecommendedGames(e){Date.now(),Math.random().toString(36).slice(2,6);try{let t;if(Array.isArray(e)&&e.length>0)t=e.filter(e=>"string"==typeof e&&e.length>0);else{const{data:{user:e}}=await rt.auth.getUser(),r=e?.id;if(!r)return this.getGames();const{data:a}=await rt.from("users").select("preferred_sports").eq("id",r).single();t=(a?.preferred_sports??[]).filter(e=>"string"==typeof e&&e.length>0)}if(!t.length)return this.getGames();const{data:{user:r}}=await rt.auth.getUser(),a=r?.id;if(a){const{data:e,error:r}=await rt.from("games").select("\n            id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id,\n            game_participants(user_id)\n          ").in("sport",t).gte("date",(new Date).toISOString().split("T")[0]).order("date",{ascending:!0}).limit(50);if(r)throw r;return(e||[]).map(e=>{const t=e.game_participants?.some(e=>e.user_id===a)||!1;return at(e,t)})}{const{data:e,error:r}=await rt.from("games").select("id,title,sport,date,time,location,cost,max_players,current_players,description,image_url,creator_id").in("sport",t).gte("date",(new Date).toISOString().split("T")[0]).order("date",{ascending:!0}).limit(50);if(r)throw r;return(e||[]).map(e=>at(e,!1))}}catch(t){return this.getGames()}}static async getArchivedGames(e){try{let t=rt.from("games").select("*").lt("date",(new Date).toISOString().split("T")[0]).order("date",{ascending:!1}).limit(50);if(e){const{data:t,error:r}=await rt.from("games").select("\n            *,\n            game_participants(user_id)\n          ").lt("date",(new Date).toISOString().split("T")[0]).order("date",{ascending:!1}).limit(50);if(r)throw r;return(t||[]).filter(t=>t.creator_id===e||t.game_participants?.some(t=>t.user_id===e)).map(t=>{const r=t.game_participants?.some(t=>t.user_id===e)||!1;return at(t,r)})}{const{data:e,error:r}=await t;if(r)throw r;return(e||[]).map(e=>at(e,!1))}}catch(t){return[]}}static async archiveOldGames(){try{const e=new Date;e.setDate(e.getDate()-1);e.toISOString().split("T")[0]}catch(e){}}static async getUserStats(e){try{const{data:r,error:a}=await rt.from("user_stats").select("*").eq("user_id",e).maybeSingle();if(a&&"PGRST116"!==a.code)throw a;let s=null;if(!r){const{data:t,error:r}=await rt.from("games").select("id, sport").eq("creator_id",e),{data:a,error:i}=await rt.from("game_participants").select("\n            game_id,\n            play_time_minutes,\n            games!inner(sport, date)\n          ").eq("user_id",e),n=t?.length||0,o=a?.length||0,c=a?.reduce((e,t)=>e+(t.play_time_minutes||0),0)||0,l={};t?.forEach(e=>{l[e.sport]=(l[e.sport]||0)+1}),a?.forEach(e=>{const t=e.games?.sport;t&&(l[t]=(l[t]||0)+1)});s={user_id:e,games_played:o,games_hosted:n,total_play_time_minutes:c,favorite_sport:Object.keys(l).length>0?Object.entries(l).reduce((e,t)=>l[e[0]]>l[t[0]]?e:t)[0]:null,last_activity:(new Date).toISOString(),created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}}let i=[];try{const{data:t}=await rt.from("game_reviews").select("rating").eq("reviewee_id",e);i=t||[]}catch(t){i=[]}const n=i.length>0?i.reduce((e,t)=>e+t.rating,0)/i.length:0;return{...r||s||{user_id:e,games_played:0,games_hosted:0,total_play_time_minutes:0,favorite_sport:null,last_activity:(new Date).toISOString(),created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},average_rating:n}}catch(r){return{user_id:e,games_played:0,games_hosted:0,total_play_time_minutes:0,favorite_sport:null,average_rating:0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}}}static async getUserRecentGames(e,t=5){try{const{data:r,error:a}=await rt.from("game_participants").select("\n          *,\n          games (\n            id,\n            title,\n            sport,\n            date,\n            time,\n            location,\n            creator_id\n          )\n        ").eq("user_id",e).order("joined_at",{ascending:!1}).limit(t);return a?[]:r||[]}catch(r){return[]}}static async getUserAchievements(e){const{data:t,error:r}=await rt.from("user_achievements").select("\n        *,\n        achievements (\n          id,\n          name,\n          description,\n          icon,\n          category,\n          criteria,\n          points,\n          is_active\n        )\n      ").eq("user_id",e).order("earned_at",{ascending:!1});if(r)throw r;return t||[]}static async getAllAchievements(){const{data:e,error:t}=await rt.from("achievements").select("*").eq("is_active",!0).order("points",{ascending:!0});if(t)throw t;return e||[]}static async checkAndAwardAchievements(e){const t=await this.getUserStats(e),{data:r,error:a}=await rt.from("achievements").select("*").eq("is_active",!0);if(a)throw a;const{data:s,error:i}=await rt.from("user_achievements").select("achievement_id").eq("user_id",e);if(i)throw i;const n=new Set(s?.map(e=>e.achievement_id)||[]),o=[];for(const c of r||[]){if(n.has(c.id))continue;const e=c.criteria;let r=!1;e.games_played&&t.games_played>=e.games_played&&(r=!0),e.games_hosted&&t.games_hosted>=e.games_hosted&&(r=!0),r&&o.push(c)}if(o.length>0){const t=o.map(t=>({user_id:e,achievement_id:t.id,earned_at:(new Date).toISOString()})),{error:r}=await rt.from("user_achievements").insert(t);if(r)throw r}return o}static async recordGameParticipation(e,t,r="joined"){const{data:a,error:s}=await rt.from("information_schema.columns").select("column_name").eq("table_name","game_participants").eq("column_name","status");if(s){const{data:r,error:a}=await rt.from("game_participants").upsert({user_id:e,game_id:t},{onConflict:"user_id,game_id"});if(a)throw a;return r}if(a&&a.length>0){const{data:a,error:s}=await rt.from("game_participants").upsert({user_id:e,game_id:t,status:r,joined_at:"joined"===r?(new Date).toISOString():void 0,left_at:"left"===r||"completed"===r?(new Date).toISOString():void 0},{onConflict:"user_id,game_id"});if(s)throw s;return a}{const{data:r,error:a}=await rt.from("game_participants").upsert({user_id:e,game_id:t},{onConflict:"user_id,game_id"});if(a)throw a;return r}}static async markGameCompleted(e){const t=await this.getCurrentUser();if(!t)throw new Error("User not authenticated");const{data:r,error:a}=await rt.from("games").select("creator_id").eq("id",e).single();if(a)throw a;if(r.creator_id!==t.id)throw new Error("Only the game creator can mark a game as completed");const{error:s}=await rt.from("game_participants").update({status:"completed",left_at:(new Date).toISOString()}).eq("game_id",e).eq("status","joined");if(s)throw s;const{data:i,error:n}=await rt.from("game_participants").select("user_id").eq("game_id",e).eq("status","completed");if(n)throw n;for(const c of i||[])try{await this.checkAndAwardAchievements(c.user_id)}catch(o){}}static async joinWaitlist(e){const{data:t,error:r}=await rt.rpc("join_waitlist",{game_uuid:e});if(r)throw r;return t}static async leaveWaitlist(e){const{data:t,error:r}=await rt.rpc("leave_waitlist",{game_uuid:e});if(r)throw r;return t}static async joinFromWaitlist(e){const{data:t,error:r}=await rt.rpc("join_from_waitlist",{game_uuid:e});if(r)throw r;return t}static async getGameWaitlist(e){const{data:t,error:r}=await rt.from("game_waitlist").select("\n        *,\n        user:users!game_waitlist_user_id_fkey(id, full_name, username, avatar_url)\n      ").eq("game_id",e).order("position",{ascending:!0});if(r)throw r;return(t||[]).map(e=>({id:e.id,position:e.position,joinedAt:e.joined_at,status:e.status,expiresAt:e.expires_at,user:{id:e.user.id,name:e.user.full_name||e.user.username,username:e.user.username,avatarUrl:e.user.avatar_url}}))}static async getUserWaitlistStatus(e){const t=await this.getCurrentUser();if(!t)return{isOnWaitlist:!1};const{data:r,error:a}=await rt.from("game_waitlist").select("position, status").eq("game_id",e).eq("user_id",t.id).single();if(a&&"PGRST116"!==a.code)throw a;return r?{isOnWaitlist:!0,position:r.position,status:r.status}:{isOnWaitlist:!1}}static async createRecurringTemplate(e){const{data:t,error:r}=await rt.rpc("create_recurring_template",{p_title:e.title,p_sport:e.sport,p_location:e.location,p_latitude:e.latitude||null,p_longitude:e.longitude||null,p_cost:e.cost||"Free",p_max_players:e.maxPlayers,p_description:e.description||"",p_image_url:e.imageUrl||null,p_recurrence_type:e.recurrenceType,p_recurrence_interval:1,p_day_of_week:e.dayOfWeek||null,p_day_of_month:e.dayOfMonth||null,p_time_of_day:e.timeOfDay,p_start_date:e.startDate,p_end_date:e.endDate||null,p_max_occurrences:e.maxOccurrences||null});if(r)throw r;return t}static async getRecurringTemplates(e){let t=rt.from("recurring_game_templates").select("\n        *,\n        creator:users!recurring_game_templates_creator_id_fkey(id, full_name, username, avatar_url),\n        _count:recurring_game_instances(count)\n      ").eq("is_active",!0).order("created_at",{ascending:!1});e&&(t=t.eq("creator_id",e));const{data:r,error:a}=await t;if(a)throw a;return(r||[]).map(e=>({id:e.id,title:e.title,sport:e.sport,location:e.location,recurrenceType:e.recurrence_type,dayOfWeek:e.day_of_week,dayOfMonth:e.day_of_month,timeOfDay:e.time_of_day,startDate:e.start_date,endDate:e.end_date,maxOccurrences:e.max_occurrences,isActive:e.is_active,createdAt:e.created_at,creator:{id:e.creator.id,name:e.creator.full_name||e.creator.username,username:e.creator.username,avatarUrl:e.creator.avatar_url},instanceCount:e._count?.[0]?.count||0}))}static async updateRecurringTemplate(e,t){const{data:r,error:a}=await rt.rpc("update_recurring_template",{template_id:e,updates:t});if(a)throw a;return r}static async cancelRecurringTemplate(e,t=!0){const{data:r,error:a}=await rt.rpc("cancel_recurring_template",{template_id:e,cancel_future_games:t});if(a)throw a;return r}static async getRecurringGameInstances(e){const{data:t,error:r}=await rt.from("recurring_game_instances").select("\n        *,\n        game:games!recurring_game_instances_game_id_fkey(*)\n      ").eq("template_id",e).order("scheduled_date",{ascending:!0});if(r)throw r;return(t||[]).map(e=>({id:e.id,scheduledDate:e.scheduled_date,instanceNumber:e.instance_number,status:e.status,game:e.game?at(e.game,!1):null}))}static async submitGameReview(e){try{const{data:t,error:r}=await rt.rpc("submit_game_review",{p_game_id:e.gameId,p_overall_rating:e.overallRating,p_organization_rating:e.organizationRating||null,p_skill_level_rating:e.skillLevelRating||null,p_fun_rating:e.funRating||null,p_review_text:e.reviewText||null,p_would_play_again:e.wouldPlayAgain??!0,p_recommend_to_others:e.recommendToOthers??!0});if(r)throw r;return t}catch(t){throw new Error("Rating system is currently disabled")}}static async submitPlayerRating(e){try{const{data:t,error:r}=await rt.rpc("submit_player_rating",{p_game_id:e.gameId,p_rated_player_id:e.ratedPlayerId,p_skill_rating:e.skillRating,p_sportsmanship_rating:e.sportsmanshipRating,p_communication_rating:e.communicationRating,p_feedback_text:e.feedbackText||null});if(r)throw r;return t}catch(t){throw new Error("Rating system is currently disabled")}}static async getGameReviews(e){try{const{data:t,error:r}=await rt.from("game_reviews").select("\n          *,\n          reviewer:users!game_reviews_reviewer_id_fkey(id, full_name, username, avatar_url)\n        ").eq("game_id",e).order("created_at",{ascending:!1});return r?[]:t||[]}catch(t){return[]}}static async getGameRatingSummary(e){const{data:t,error:r}=await rt.from("game_rating_summary").select("*").eq("game_id",e).single();if(r&&"PGRST116"!==r.code)throw r;return t?{totalReviews:t.total_reviews,avgOverallRating:t.avg_overall_rating,avgOrganizationRating:t.avg_organization_rating,avgSkillLevelRating:t.avg_skill_level_rating,avgFunRating:t.avg_fun_rating,wouldPlayAgainCount:t.would_play_again_count,recommendCount:t.recommend_count,lastUpdated:t.last_updated}:null}static async getUserRatingSummary(e){const{data:t,error:r}=await rt.from("user_rating_summary").select("*").eq("user_id",e).single();if(r&&"PGRST116"!==r.code)throw r;return t?{totalRatingsReceived:t.total_ratings_received,avgSkillRating:t.avg_skill_rating,avgSportsmanshipRating:t.avg_sportsmanship_rating,avgCommunicationRating:t.avg_communication_rating,avgOverallPlayerRating:t.avg_overall_player_rating,gamesOrganized:t.games_organized,avgGameRating:t.avg_game_rating,lastUpdated:t.last_updated}:null}static async getReviewableGames(){const{data:e,error:t}=await rt.rpc("get_reviewable_games");if(t)throw t;return(e||[]).map(e=>({gameId:e.game_id,title:e.game_title,date:e.game_date,time:e.game_time,sport:e.sport,hasReviewed:e.has_reviewed}))}static async getPlayerRatings(e,t){let r=rt.from("player_ratings").select("\n        *,\n        rater:users!player_ratings_rater_id_fkey(id, full_name, username, avatar_url),\n        rated_player:users!player_ratings_rated_player_id_fkey(id, full_name, username, avatar_url)\n      ").eq("game_id",e);t&&(r=r.eq("rated_player_id",t));const{data:a,error:s}=await r.order("created_at",{ascending:!1});if(s)throw s;return(a||[]).map(e=>({id:e.id,skillRating:e.skill_rating,sportsmanshipRating:e.sportsmanship_rating,communicationRating:e.communication_rating,feedbackText:e.feedback_text,createdAt:e.created_at,rater:{id:e.rater.id,name:e.rater.full_name||e.rater.username,username:e.rater.username,avatarUrl:e.rater.avatar_url},ratedPlayer:{id:e.rated_player.id,name:e.rated_player.full_name||e.rated_player.username,username:e.rated_player.username,avatarUrl:e.rated_player.avatar_url}}))}static async submitUserTestingFeedback(e){try{const{error:t}=await rt.from("user_testing_feedback").insert([e]);if(t)throw t}catch(t){throw t}}}function pt(e,t){let r;try{r=e()}catch(a){return}return{getItem:e=>{var t;const a=e=>null===e?null:JSON.parse(e,void 0),s=null!=(t=r.getItem(e))?t:null;return s instanceof Promise?s.then(a):a(s)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}const ft=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then:e=>ft(e)(r),catch(e){return this}}}catch(r){return{then(e){return this},catch:e=>ft(e)(r)}}},gt=(e,t)=>(r,a,s)=>{let i={storage:pt(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const o=new Set,c=new Set;let l=i.storage;if(!l)return e((...e)=>{r(...e)},a,s);const d=()=>{const e=i.partialize({...a()});return l.setItem(i.name,{state:e,version:i.version})},u=s.setState;s.setState=(e,t)=>(u(e,t),d());const m=e((...e)=>(r(...e),d()),a,s);let p;s.getInitialState=()=>m;const f=()=>{var e,t;if(!l)return;n=!1,o.forEach(e=>{var t;return e(null!=(t=a())?t:m)});const s=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=a())?e:m))||void 0;return ft(l.getItem.bind(l))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate){const t=i.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}}return[!1,void 0]}).then(e=>{var t;const[s,n]=e;if(p=i.merge(n,null!=(t=a())?t:m),r(p,!0),s)return d()}).then(()=>{null==s||s(p,void 0),p=a(),n=!0,c.forEach(e=>e(p))}).catch(e=>{null==s||s(void 0,e)})};return s.persist={setOptions:e=>{i={...i,...e},e.storage&&(l=e.storage)},clearStorage:()=>{null==l||l.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>f(),hasHydrated:()=>n,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},i.skipHydration||f(),p||m};var ht=Symbol.for("immer-nothing"),_t=Symbol.for("immer-draftable"),wt=Symbol.for("immer-state");function yt(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var bt=Object.getPrototypeOf;function vt(e){return!!e&&!!e[wt]}function xt(e){return!!e&&(Et(e)||Array.isArray(e)||!!e[_t]||!!e.constructor?.[_t]||Tt(e)||Pt(e))}var kt=Object.prototype.constructor.toString();function Et(e){if(!e||"object"!=typeof e)return!1;const t=bt(e);if(null===t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===kt}function jt(e,t){0===It(e)?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function It(e){const t=e[wt];return t?t.type_:Array.isArray(e)?1:Tt(e)?2:Pt(e)?3:0}function St(e,t){return 2===It(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Nt(e,t,r){const a=It(e);2===a?e.set(t,r):3===a?e.add(r):e[t]=r}function Tt(e){return e instanceof Map}function Pt(e){return e instanceof Set}function At(e){return e.copy_||e.base_}function Rt(e,t){if(Tt(e))return new Map(e);if(Pt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Et(e);if(!0===t||"class_only"===t&&!r){const t=Object.getOwnPropertyDescriptors(e);delete t[wt];let r=Reflect.ownKeys(t);for(let a=0;a<r.length;a++){const s=r[a],i=t[s];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[s]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[s]})}return Object.create(bt(e),t)}{const t=bt(e);if(null!==t&&r)return{...e};const a=Object.create(t);return Object.assign(a,e)}}function Ct(e,t=!1){return Ut(e)||vt(e)||!xt(e)||(It(e)>1&&(e.set=e.add=e.clear=e.delete=Ot),Object.freeze(e),t&&Object.entries(e).forEach(([e,t])=>Ct(t,!0))),e}function Ot(){yt(2)}function Ut(e){return Object.isFrozen(e)}var zt,Dt={};function Lt(e){const t=Dt[e];return t||yt(0),t}function Gt(){return zt}function Mt(e,t){t&&(Lt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Ft(e){Vt(e),e.drafts_.forEach(Wt),e.drafts_=null}function Vt(e){e===zt&&(zt=e.parent_)}function qt(e){return zt={drafts_:[],parent_:zt,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Wt(e){const t=e[wt];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Bt(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return void 0!==e&&e!==r?(r[wt].modified_&&(Ft(t),yt(4)),xt(e)&&(e=$t(t,e),t.parent_||Jt(t,e)),t.patches_&&Lt("Patches").generateReplacementPatches_(r[wt].base_,e,t.patches_,t.inversePatches_)):e=$t(t,r,[]),Ft(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ht?e:void 0}function $t(e,t,r){if(Ut(t))return t;const a=t[wt];if(!a)return jt(t,(s,i)=>Ht(e,a,t,s,i,r)),t;if(a.scope_!==e)return t;if(!a.modified_)return Jt(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const t=a.copy_;let s=t,i=!1;3===a.type_&&(s=new Set(t),t.clear(),i=!0),jt(s,(s,n)=>Ht(e,a,t,s,n,r,i)),Jt(e,t,!1),r&&e.patches_&&Lt("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function Ht(e,t,r,a,s,i,n){if(vt(s)){const n=$t(e,s,i&&t&&3!==t.type_&&!St(t.assigned_,a)?i.concat(a):void 0);if(Nt(r,a,n),!vt(n))return;e.canAutoFreeze_=!1}else n&&r.add(s);if(xt(s)&&!Ut(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;$t(e,s),t&&t.scope_.parent_||"symbol"==typeof a||!Object.prototype.propertyIsEnumerable.call(r,a)||Jt(e,s)}}function Jt(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ct(t,r)}var Kt={get(e,t){if(t===wt)return e;const r=At(e);if(!St(r,t))return function(e,t,r){const a=Zt(t,r);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}(e,r,t);const a=r[t];return e.finalized_||!xt(a)?a:a===Xt(e.base_,t)?(er(e),e.copy_[t]=tr(a,e)):a},has:(e,t)=>t in At(e),ownKeys:e=>Reflect.ownKeys(At(e)),set(e,t,r){const a=Zt(At(e),t);if(a?.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const a=Xt(At(e),t),n=a?.[wt];if(n&&n.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(((s=r)===(i=a)?0!==s||1/s==1/i:s!=s&&i!=i)&&(void 0!==r||St(e.base_,t)))return!0;er(e),Qt(e)}var s,i;return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==Xt(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,er(e),Qt(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const r=At(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:a.enumerable,value:r[t]}:a},defineProperty(){yt(11)},getPrototypeOf:e=>bt(e.base_),setPrototypeOf(){yt(12)}},Yt={};function Xt(e,t){const r=e[wt];return(r?At(r):e)[t]}function Zt(e,t){if(!(t in e))return;let r=bt(e);for(;r;){const e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=bt(r)}}function Qt(e){e.modified_||(e.modified_=!0,e.parent_&&Qt(e.parent_))}function er(e){e.copy_||(e.copy_=Rt(e.base_,e.scope_.immer_.useStrictShallowCopy_))}jt(Kt,(e,t)=>{Yt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Yt.deleteProperty=function(e,t){return Yt.set.call(this,e,t,void 0)},Yt.set=function(e,t,r){return Kt.set.call(this,e[0],t,r,e[0])};function tr(e,t){const r=Tt(e)?Lt("MapSet").proxyMap_(e,t):Pt(e)?Lt("MapSet").proxySet_(e,t):function(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:Gt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=a,i=Kt;r&&(s=[a],i=Yt);const{revoke:n,proxy:o}=Proxy.revocable(s,i);return a.draft_=o,a.revoke_=n,o}(e,t);return(t?t.scope_:Gt()).drafts_.push(r),r}function rr(e){if(!xt(e)||Ut(e))return e;const t=e[wt];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Rt(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Rt(e,!0);return jt(r,(e,t)=>{Nt(r,e,rr(t))}),t&&(t.finalized_=!1),r}var ar=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"==typeof e&&"function"!=typeof t){const r=t;t=e;const a=this;return function(e=r,...s){return a.produce(e,e=>t.call(this,e,...s))}}let a;if("function"!=typeof t&&yt(6),void 0!==r&&"function"!=typeof r&&yt(7),xt(e)){const s=qt(this),i=tr(e,void 0);let n=!0;try{a=t(i),n=!1}finally{n?Ft(s):Vt(s)}return Mt(s,r),Bt(a,s)}if(!e||"object"!=typeof e){if(a=t(e),void 0===a&&(a=e),a===ht&&(a=void 0),this.autoFreeze_&&Ct(a,!0),r){const t=[],s=[];Lt("Patches").generateReplacementPatches_(e,a,t,s),r(t,s)}return a}yt(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,t=>e(t,...r));let r,a;return[this.produce(e,t,(e,t)=>{r=e,a=t}),r,a]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){xt(e)||yt(8),vt(e)&&(e=function(e){vt(e)||yt(10);return rr(e)}(e));const t=qt(this),r=tr(e,void 0);return r[wt].isManual_=!0,Vt(t),r}finishDraft(e,t){const r=e&&e[wt];r&&r.isManual_||yt(9);const{scope_:a}=r;return Mt(a,t),Bt(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}r>-1&&(t=t.slice(r+1));const a=Lt("Patches").applyPatches_;return vt(e)?a(e,t):this.produce(e,e=>a(e,t))}},sr=ar.produce;ar.produceWithPatches.bind(ar),ar.setAutoFreeze.bind(ar),ar.setUseStrictShallowCopy.bind(ar),ar.applyPatches.bind(ar),ar.createDraft.bind(ar),ar.finishDraft.bind(ar);const ir=e=>(t,r,a)=>(a.setState=(e,r,...a)=>{const s="function"==typeof e?sr(e):e;return t(s,r,...a)},e(a.setState,r,a)),nr={sports:[],dateRange:{start:null,end:null},distance:25,priceRange:{min:0,max:100}},or={user:null,isAuthenticated:!1,games:[],myGames:[],nearbyGames:[],isLoading:!1,error:null,chatContext:null,searchFilters:nr},cr=j()(gt(ir((e,t)=>({...or,setUser:t=>e(e=>{e.user=t,e.isAuthenticated=!!t}),updateUserPreferences:async r=>{const{setLoading:a,setError:s}=t();try{a(!0);const t=await mt.getCurrentUser();t&&(await mt.updateUserProfile(t.id,{preferences:r}),e(e=>{e.user&&(e.user.preferences={...e.user.preferences,...r})}))}catch(i){s(i instanceof Error?i.message:"Failed to update preferences")}finally{a(!1)}},signOut:async()=>{const{setLoading:r,setError:a}=t();try{r(!0),await mt.signOut(),e(e=>{e.user=null,e.isAuthenticated=!1,e.myGames=[],e.chatContext=null})}catch(s){a(s instanceof Error?s.message:"Failed to sign out")}finally{r(!1)}},signIn:async(r,a)=>{const{setLoading:s,setError:i}=t();try{s(!0);const{user:t}=await mt.signIn(r,a);if(t){const r=await mt.getUserProfile(t.id);e(e=>{e.user=r,e.isAuthenticated=!0})}}catch(n){i(n instanceof Error?n.message:"Failed to sign in")}finally{s(!1)}},signUp:async(r,a,s)=>{const{setLoading:i,setError:n}=t();try{i(!0);const{user:t}=await mt.signUp(r,a,s);if(t){const r=await mt.getUserProfile(t.id);e(e=>{e.user=r,e.isAuthenticated=!0})}}catch(o){n(o instanceof Error?o.message:"Failed to sign up")}finally{i(!1)}},initializeAuth:async()=>{const{setLoading:e,setError:r,setGames:a}=t(),s=t();if(!s.isLoading)try{if(e(!0),0===s.games.length){a(await mt.getGames())}}catch(i){r(i instanceof Error?i.message:"Failed to initialize auth")}finally{e(!1)}},setGames:t=>{e(e=>{e.games=t,e.isLoading=!1;const r=e.user?.id;e.myGames=t.filter(e=>e.createdBy===r||e.isJoined),e.nearbyGames=t.slice(0,10)})},addGame:async r=>{const{setLoading:a,setError:s}=t();try{a(!0);const t=await mt.createGame(r);e(e=>{e.games.unshift(t),t.createdBy===e.user?.id&&e.myGames.unshift(t)})}catch(i){s(i instanceof Error?i.message:"Failed to create game")}finally{a(!1)}},updateGame:async(r,a)=>{const{setLoading:s,setError:i}=t();try{s(!0),e(e=>{const t=e.games.findIndex(e=>e.id===r);-1!==t&&(e.games[t]={...e.games[t],...a});const s=e.myGames.findIndex(e=>e.id===r);-1!==s&&(e.myGames[s]={...e.myGames[s],...a})})}catch(n){i(n instanceof Error?n.message:"Failed to update game")}finally{s(!1)}},joinGame:async e=>{},leaveGame:async e=>{},setLoading:t=>e(e=>{e.isLoading=t}),setError:t=>e(e=>{e.error=t,e.isLoading=!1}),clearError:()=>e(e=>{e.error=null}),setChatContext:t=>e(e=>{e.chatContext=t}),updateSearchFilters:t=>e(e=>{e.searchFilters={...e.searchFilters,...t}}),clearSearchFilters:()=>e(e=>{e.searchFilters=nr}),reset:()=>e(()=>or)})),{name:"tribeup-store",storage:pt(()=>localStorage),partialize:e=>({user:e.user,searchFilters:e.searchFilters})})),lr=o.createContext(void 0);function dr({children:t}){const[r,a]=o.useState(null),[s,i]=o.useState(null),[n,c]=o.useState(!0),{setUser:l,initializeAuth:d}=cr();o.useEffect(()=>{"undefined"!=typeof window&&localStorage.getItem("DEBUG_AUTH");(async()=>{try{const{data:{session:e},error:t}=await rt.auth.getSession();if(t)return;i(e),a(e?.user??null),e?.user&&mt.getUserProfile(e.user.id).then(e=>{e&&l(e)}).catch(t=>{l({id:e.user.id,email:e.user.email||"",name:e.user.user_metadata?.full_name||e.user.email||"",username:e.user.user_metadata?.username||e.user.email?.split("@")[0]||"",avatar:e.user.user_metadata?.avatar_url||"",role:"user",preferences:{sports:[],notifications:{push:!0,email:!0,gameReminders:!0},theme:"light",highContrast:!1,largeText:!1,reducedMotion:!1,colorBlindFriendly:!1,privacy:{locationSharing:!0,profileVisibility:"public"}}})})}catch(e){}finally{c(!1)}})();const{data:{subscription:e}}=rt.auth.onAuthStateChange(async(e,t)=>{if(i(t),a(t?.user??null),"SIGNED_IN"===e&&t?.user)try{const e=await mt.getUserProfile(t.user.id);if(e){l(e);const t=localStorage.getItem("pendingGameJoin");if(t){localStorage.removeItem("pendingGameJoin");try{const{joinGame:e}=cr.getState();await e(t),I.success("Welcome! You've been automatically joined to the game.")}catch(r){I.error("Welcome! Please manually join the game you were interested in.")}}else"/onboarding"===window.location.pathname||I.success("Welcome back!")}}catch(s){}else"SIGNED_OUT"===e?(l(null),I.success("Signed out successfully")):"PASSWORD_RECOVERY"===e&&I.info("Check your email for password reset instructions");c(!1)});return()=>{e.unsubscribe()}},[l]);const u={user:r,session:s,loading:n,signIn:async(e,t)=>{try{const{error:r}=await rt.auth.signInWithPassword({email:e,password:t});if(r)throw r}catch(r){throw new Error(r.message||"Failed to sign in")}},signUp:async(e,t,r)=>{try{const{data:s,error:i}=await rt.auth.signUp({email:e,password:t,options:{data:{full_name:r.name,username:r.name?.toLowerCase().replace(/\s+/g,"_"),pending_game_id:r.pendingGameId,phone:r.phone}}});if(i)throw i;if(s.user)try{await mt.createUserProfile(s.user.id,{email:s.user.email,name:r.name,phone:r.phone}),r.pendingGameId&&localStorage.setItem("pendingGameJoin",r.pendingGameId)}catch(a){}}catch(s){throw new Error(s.message||"Failed to sign up")}},signInWithOAuth:async(e,t)=>{try{const r=`${window.location.origin}/auth/callback`;t?.pendingGameId&&localStorage.setItem("pendingGameJoin",t.pendingGameId);const{data:a,error:s}=await rt.auth.signInWithOAuth({provider:e,options:{redirectTo:r,queryParams:{access_type:"offline",prompt:"consent"}}});if(s)throw s}catch(r){throw new Error(r.message||`Failed to sign in with ${e}`)}},signOut:async()=>{try{const{error:e}=await rt.auth.signOut();if(e)throw e;a(null),l(null),localStorage.removeItem("pendingGameJoin")}catch(e){throw new Error(e.message||"Failed to sign out")}},resetPassword:async e=>{try{const{error:t}=await rt.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth?reset=true`});if(t)throw t}catch(t){throw new Error(t.message||"Failed to send reset email")}}};return e.jsx(lr.Provider,{value:u,children:t})}function ur(){const e=o.useContext(lr);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}function mr({children:t=null,requireAuth:r=!0,redirectTo:a="/auth"}){const{user:s,loading:i}=ur(),n=c();return i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(tt,{size:"lg",text:"Loading..."})}):r&&!s?e.jsx(l,{to:a,state:{from:n},replace:!0}):!r&&s?e.jsx(l,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:t||null})}function pr({children:t=null}){const r=d(),{user:a}=ur(),{user:s}=cr(),[i,n]=o.useState(!0),c=o.useRef(!1),l=o.useRef(null);return o.useEffect(()=>{const e=setTimeout(async()=>{if(c.current)return void n(!1);if(c.current=!0,"/onboarding"===window.location.pathname)return void n(!1);if((window.history.state?.usr||window.history.state||{}).fromOnboarding)n(!1);else if(a){try{const e=cr.getState().user;if(e){const t=e.name&&e.email;if(e.id&&e.email)return void n(!1);if(!t)return"/onboarding"!==window.location.pathname?(n(!1),void r("/onboarding",{replace:!0,state:{fromProfileCheck:!0}})):void n(!1)}else{const e=mt.getUserProfile(a.id),t=new Promise((e,t)=>{l.current=setTimeout(()=>{t(new Error("Profile check timeout"))},ct.get("profileCheckTimeout"))}),s=await Promise.race([e,t]);if(l.current&&(clearTimeout(l.current),l.current=null),!s)return n(!1),void r("/onboarding",{replace:!0});if(s?.id&&s?.email)return void n(!1);if(!s.name&&!s.username)return n(!1),void r("/onboarding",{replace:!0})}}catch(e){return void n(!1)}n(!1)}else n(!1)},100),t=setTimeout(()=>{c.current=!0,n(!1)},3e3);return()=>{clearTimeout(e),clearTimeout(t),l.current&&clearTimeout(l.current)}},[a?.id,r]),o.useEffect(()=>{const e=setTimeout(()=>{i&&(c.current=!0,n(!1))},ct.get("profileForceTimeout")),t=setTimeout(()=>{c.current=!0,n(!1)},2e4);return()=>{clearTimeout(e),clearTimeout(t)}},[i]),i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(tt,{size:"lg",text:"Getting ready..."})}):e.jsx(e.Fragment,{children:t||null})}const fr=M("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function gr({className:r,variant:a,asChild:s=!1,...i}){const n=s?t:"span";return e.jsx(n,{"data-slot":"badge",className:He(fr({variant:a}),r),...i})}var hr={exports:{}},_r={},wr=o;var yr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},br=wr.useState,vr=wr.useEffect,xr=wr.useLayoutEffect,kr=wr.useDebugValue;function Er(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!yr(e,r)}catch(a){return!0}}var jr="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=br({inst:{value:r,getSnapshot:t}}),s=a[0].inst,i=a[1];return xr(function(){s.value=r,s.getSnapshot=t,Er(s)&&i({inst:s})},[e,r,t]),vr(function(){return Er(s)&&i({inst:s}),e(function(){Er(s)&&i({inst:s})})},[e]),kr(r),r};_r.useSyncExternalStore=void 0!==wr.useSyncExternalStore?wr.useSyncExternalStore:jr,hr.exports=_r;var Ir=hr.exports;function Sr(){return()=>{}}var Nr="Avatar",[Tr,Pr]=r(Nr),[Ar,Rr]=Tr(Nr),Cr=o.forwardRef((t,r)=>{const{__scopeAvatar:s,...i}=t,[n,c]=o.useState("idle");return e.jsx(Ar,{scope:s,imageLoadingStatus:n,onImageLoadingStatusChange:c,children:e.jsx(a.span,{...i,ref:r})})});Cr.displayName=Nr;var Or="AvatarImage",Ur=o.forwardRef((t,r)=>{const{__scopeAvatar:n,src:c,onLoadingStatusChange:l=()=>{},...d}=t,u=Rr(Or,n),m=function(e,{referrerPolicy:t,crossOrigin:r}){const a=Ir.useSyncExternalStore(Sr,()=>!0,()=>!1),s=o.useRef(null),n=a?(s.current||(s.current=new window.Image),s.current):null,[c,l]=o.useState(()=>Lr(n,e));return i(()=>{l(Lr(n,e))},[n,e]),i(()=>{const e=e=>()=>{l(e)};if(!n)return;const a=e("loaded"),s=e("error");return n.addEventListener("load",a),n.addEventListener("error",s),t&&(n.referrerPolicy=t),"string"==typeof r&&(n.crossOrigin=r),()=>{n.removeEventListener("load",a),n.removeEventListener("error",s)}},[n,r,t]),c}(c,d),p=s(e=>{l(e),u.onImageLoadingStatusChange(e)});return i(()=>{"idle"!==m&&p(m)},[m,p]),"loaded"===m?e.jsx(a.img,{...d,ref:r,src:c}):null});Ur.displayName=Or;var zr="AvatarFallback",Dr=o.forwardRef((t,r)=>{const{__scopeAvatar:s,delayMs:i,...n}=t,c=Rr(zr,s),[l,d]=o.useState(void 0===i);return o.useEffect(()=>{if(void 0!==i){const e=window.setTimeout(()=>d(!0),i);return()=>window.clearTimeout(e)}},[i]),l&&"loaded"!==c.imageLoadingStatus?e.jsx(a.span,{...n,ref:r}):null});function Lr(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}Dr.displayName=zr;var Gr=Cr,Mr=Ur,Fr=Dr;function Vr({className:t,...r}){return e.jsx(Gr,{"data-slot":"avatar",className:He("relative flex size-10 shrink-0 overflow-hidden rounded-full",t),...r})}function qr({className:t,...r}){return e.jsx(Mr,{"data-slot":"avatar-image",className:He("aspect-square size-full",t),...r})}function Wr({className:t,...r}){return e.jsx(Fr,{"data-slot":"avatar-fallback",className:He("bg-muted flex size-full items-center justify-center rounded-full",t),...r})}const Br={sm:"size-6",md:"size-8",lg:"size-10",xl:"size-12"};function $r({userId:t,src:r,alt:a,fallback:s,size:i="md",className:n,onClick:o,disabled:c=!1}){const l=d();return e.jsxs(Vr,{className:He(Br[i],(t||o)&&!c&&"cursor-pointer hover:ring-2 hover:ring-primary/20 transition-all",c&&"opacity-50 cursor-not-allowed",n),onClick:e=>{e.stopPropagation(),o?o():t&&!c&&l(`/user/${t}`)},children:[r&&e.jsx(qr,{src:r,alt:a||"User avatar"}),e.jsx(Wr,{className:"bg-primary/10 text-primary font-medium",children:s||(u=a,u?u.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2):"?")})]});var u}function Hr(){const[e,t]=o.useState([]),[r,a]=o.useState({pushNotifications:!0,emailNotifications:!1,gameReminders:!0,messageNotifications:!0,soundEnabled:!0});o.useEffect(()=>{(async()=>{try{const e=await mt.getNotifications();t(e)}catch(e){}})()},[]),o.useEffect(()=>{let e=null;return(async()=>{e=await mt.subscribeToNotifications(e=>{t(t=>[e,...t]),r.pushNotifications&&s(e)})})(),()=>{e?.unsubscribe&&e.unsubscribe()}},[r.pushNotifications]);const s=o.useCallback(e=>{if(!r.pushNotifications)return;r.soundEnabled;["new_message","game_reminder","join_request"].includes(e.type)?"Notification"in window&&"granted"===Notification.permission&&["new_message","game_reminder"].includes(e.type)?new Notification(e.title,{body:e.message,icon:"/favicon.ico",badge:"/favicon.ico",timestamp:e.timestamp.getTime(),silent:!1}):I(e.title,{description:e.message,action:e.actionUrl?{label:"View",onClick:()=>{}}:void 0,duration:4e3}):I(e.title,{description:e.message,duration:3e3})},[r.pushNotifications,r.soundEnabled]),i=o.useCallback(async e=>{try{t(t=>t.map(t=>t.id===e?{...t,read:!0}:t)),await mt.markNotificationAsRead(e)}catch(r){t(t=>t.map(t=>t.id===e?{...t,read:!1}:t))}},[]),n=o.useCallback(async()=>{try{t(e=>{const t=e.filter(e=>!e.read);return Promise.all(t.map(e=>mt.markNotificationAsRead(e.id))).catch(e=>{}),e.map(e=>({...e,read:!0}))})}catch(e){}},[]),c=o.useCallback(async e=>{try{await mt.deleteNotification(e),t(t=>t.filter(t=>t.id!==e))}catch(r){}},[]),l=o.useCallback(async()=>{try{await mt.clearAllNotifications(),t([])}catch(e){}},[]),d=o.useCallback(async()=>{if(!("Notification"in window))return!1;if("granted"===Notification.permission)return!0;if("denied"===Notification.permission)return!1;return"granted"===await Notification.requestPermission()&&(I.success("Notifications enabled!"),!0)},[]),u=o.useCallback(e=>{a(t=>({...t,...e})),e.pushNotifications&&!r.pushNotifications&&d()},[r.pushNotifications,d]),m=e.filter(e=>!e.read).length;return{notifications:e.slice(0,10),unreadCount:m,settings:r,markAsRead:i,markAllAsRead:n,deleteNotification:c,clearAll:l,updateSettings:u,requestPermission:d}}const Jr=[{path:"/",icon:S,label:"Home"},{path:"/search",icon:N,label:"Search"},{path:"/create",icon:T,label:"Create"},{path:"/notifications",icon:P,label:"Notifications",showBadge:!0},{path:"/profile",icon:A,label:"Profile"}],Kr=o.forwardRef((t,r)=>{const a=d(),s=c(),{unreadCount:i}=Hr(),{user:n}=cr();return e.jsxs("div",{ref:r,className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t border-border",children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-2 max-w-lg mx-auto",children:Jr.map(t=>{const r=s.pathname===t.path,o=t.icon;return e.jsx("div",{className:"relative flex-1 flex justify-center",children:e.jsxs(Ke,{variant:"ghost",onClick:()=>a(t.path),className:"flex flex-col items-center gap-1 p-2 h-auto w-full transition-all duration-200 "+(r?"text-primary":"text-muted-foreground hover:text-foreground"),"aria-label":`Navigate to ${t.label}`,"aria-current":r?"page":void 0,children:[e.jsxs("div",{className:"relative",children:["/profile"===t.path&&n?e.jsx($r,{src:n.avatar,alt:n.name,size:"sm",onClick:()=>a("/profile"),className:"w-5 h-5"}):e.jsx(o,{className:"w-5 h-5"}),t.showBadge&&i>0&&e.jsx(gr,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 text-xs flex items-center justify-center min-w-[20px]",children:i>99?"99+":i})]}),e.jsx("span",{className:"text-xs font-medium",children:t.label}),r&&e.jsx("div",{className:"absolute -top-1 left-1/2 w-1 h-1 bg-primary rounded-full transition-all duration-200",style:{transform:"translateX(-50%)"}})]})},t.path)})}),e.jsx("div",{className:"pb-safe bg-background/95"})]})});Kr.displayName="BottomNavigation";const Yr=[{path:"/",icon:S,label:"Home",description:"Discover games"},{path:"/search",icon:N,label:"Search",description:"Find your game"},{path:"/notifications",icon:P,label:"Notifications",description:"Stay updated",showBadge:!0},{path:"/profile",icon:A,label:"Profile",description:"Your account"}];function Xr({children:t}){const r=d(),a=c(),{unreadCount:s}=Hr(),{user:i}=cr(),[n,l]=o.useState(!1);return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsxs("aside",{className:"bg-card border-r border-border transition-all duration-300 "+(n?"w-16":"w-64"),children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[!n&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl text-foreground",children:"TribeUp"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Find your tribe"})]}),e.jsx(Ke,{variant:"ghost",size:"icon",onClick:()=>l(!n),"aria-label":n?"Expand sidebar":"Collapse sidebar",children:e.jsx(R,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"p-4",children:e.jsxs(Ke,{onClick:()=>r("/create"),className:"w-full justify-start gap-3","aria-label":"Create new game",children:[e.jsx(T,{className:"w-5 h-5"}),!n&&"Create Game"]})}),e.jsx("nav",{className:"flex-1 px-4 space-y-2",role:"menubar",children:Yr.map(t=>{const i=a.pathname===t.path,o=t.icon;return e.jsx("div",{children:e.jsxs(Ke,{variant:i?"default":"ghost",onClick:()=>r(t.path),className:"w-full justify-start gap-3 h-12 relative "+(n?"px-2":"px-4"),role:"menuitem","aria-current":i?"page":void 0,title:n?t.label:void 0,children:[e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"w-5 h-5 flex-shrink-0"}),t.showBadge&&s>0&&e.jsx(gr,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 min-w-4 p-0 text-xs flex items-center justify-center",children:s>99?"99+":s})]}),!n&&e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[t.label,t.showBadge&&s>0&&e.jsx(gr,{variant:"destructive",className:"h-5 px-2 text-xs",children:s>99?"99+":s})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.description})]})]})},t.path)})}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Vr,{className:"cursor-pointer",onClick:()=>r("/profile"),children:[i?.avatar&&e.jsx(qr,{src:i.avatar,alt:i.name||"User"}),e.jsx(Wr,{children:i?.name?.charAt(0)||"U"})]}),!n&&e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:i?.name||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:i?.email||"user@example.com"})]})]})})]}),e.jsx("main",{className:"flex-1 overflow-hidden",children:t})]})}function Zr(){const{isMobile:t}=function(){const[e,t]=o.useState(!1);return o.useEffect(()=>{const e=()=>{t(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),{isMobile:e}}(),r=c(),{announceToScreenReader:a}=function(){const e=cr(e=>e.user),t=cr(e=>e.updateUserPreferences),r=o.useCallback((e,t="polite")=>{let r=document.getElementById("live-region");r?r.setAttribute("aria-live",t):(r=document.createElement("div"),r.id="live-region",r.setAttribute("aria-live",t),r.setAttribute("aria-atomic","true"),r.className="sr-only",document.body.appendChild(r)),r.textContent="",setTimeout(()=>{r&&(r.textContent=e)},100),setTimeout(()=>{r&&r.textContent===e&&(r.textContent="")},5e3)},[]),a=o.useCallback(e=>{const t=document.documentElement;if(t.classList.remove("light","dark"),"dark"===e.theme)t.classList.add("dark");else if("light"===e.theme)t.classList.add("light");else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;t.classList.toggle("dark",e),t.classList.toggle("light",!e)}t.classList.toggle("high-contrast",e.highContrast),t.classList.toggle("large-text",e.largeText),t.classList.toggle("colorblind-friendly",e.colorBlindFriendly),e.reducedMotion?(t.style.setProperty("--duration-fast","0ms"),t.style.setProperty("--duration-normal","0ms"),t.style.setProperty("--duration-slow","0ms")):(t.style.removeProperty("--duration-fast"),t.style.removeProperty("--duration-normal"),t.style.removeProperty("--duration-slow"))},[]);o.useEffect(()=>{if(e?.preferences)a({theme:e.preferences.theme,highContrast:e.preferences.highContrast,largeText:e.preferences.largeText,reducedMotion:e.preferences.reducedMotion,colorBlindFriendly:e.preferences.colorBlindFriendly});else{const e=document.documentElement;window.matchMedia("(prefers-color-scheme: dark)").matches&&e.classList.add("dark"),window.matchMedia("(prefers-contrast: high)").matches&&e.classList.add("high-contrast"),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(e.style.setProperty("--duration-fast","0ms"),e.style.setProperty("--duration-normal","0ms"),e.style.setProperty("--duration-slow","0ms"))}},[e?.preferences,a]);const s=o.useCallback(r=>{if(e){const s={...e.preferences,...r};t(s),a({theme:s.theme,highContrast:s.highContrast,largeText:s.largeText,reducedMotion:s.reducedMotion,colorBlindFriendly:s.colorBlindFriendly})}},[e,t,a]),i=o.useCallback(e=>{e&&(e.focus(),r(`Focused on ${e.getAttribute("aria-label")||e.textContent||"element"}`))},[r]),n=o.useCallback(e=>{const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=t[0],a=t[t.length-1],s=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),a.focus()):document.activeElement===a&&(e.preventDefault(),r.focus()))};return e.addEventListener("keydown",s),r?.focus(),()=>{e.removeEventListener("keydown",s)}},[]);return{preferences:e?.preferences,updatePreferences:s,applyPreferences:a,announceToScreenReader:r,focusElement:i,trapFocus:n}}(),[s,i]=u.useState(!1),n=o.useRef(null),[l,d]=o.useState(0);if(u.useEffect(()=>{(r.state||window.history.state?.usr||{}).fromOnboarding&&!s&&(i(!0),window.history.replaceState({...window.history.state,usr:{...window.history.state?.usr,fromOnboarding:!1}},""))},[r.state,s]),u.useEffect(()=>{const e="/"===(t=r.pathname)?"Home":"/search"===t?"Search":"/create"===t?"Create Game":"/profile"===t?"Profile":t.startsWith("/game/")?"Game Details":t.startsWith("/chat/")?"Chat":t.startsWith("/user/")?"User Profile":t.startsWith("/settings")?"Settings":"Page";var t;a(`Navigated to ${e}`),document.title=`${e} - TribeUp`},[r.pathname,a]),o.useEffect(()=>{const e=()=>{if(n.current){const e=n.current.offsetHeight;d(e)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),t){const t="/create"===r.pathname;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("main",{style:{paddingBottom:t?"0px":`${l+16}px`},children:e.jsx(m,{})}),!t&&e.jsx(Kr,{ref:n})]})})}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx(Xr,{children:e.jsx("main",{id:"main-content",className:"flex-1 overflow-hidden",children:e.jsx(m,{})})})}),e.jsx(C,{position:"bottom-right",theme:"system",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{className:"animate-slide-in-down"}})]})}const Qr=M("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function ea({className:t,variant:r,...a}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:He(Qr({variant:r}),t),...a})}function ta({className:t,...r}){return e.jsx("div",{"data-slot":"alert-title",className:He("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...r})}function ra({className:t,...r}){return e.jsx("div",{"data-slot":"alert-description",className:He("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...r})}function aa(){const t=d(),[r]=p(),[a,s]=o.useState("loading"),[i,n]=o.useState("Processing authentication..."),{setUser:c}=cr();return o.useEffect(()=>{(async()=>{try{const{data:e,error:r}=await rt.auth.getSession();if(r)return s("error"),void n(r.message||"Authentication failed");if(!e.session?.user)return s("error"),void n("No user session found");const a=e.session.user,i={id:a.id,email:a.email||"",name:a.user_metadata?.full_name||a.user_metadata?.name||a.email?.split("@")[0]||"User",username:a.user_metadata?.preferred_username||a.user_metadata?.user_name||a.email?.split("@")[0]||`user_${Math.random().toString(36).substring(2,10)}`,avatar:a.user_metadata?.avatar_url||a.user_metadata?.picture||"",bio:"",location:"",role:"user",preferences:{theme:"auto",highContrast:!1,largeText:!1,reducedMotion:!1,colorBlindFriendly:!1,notifications:{push:!0,email:!1,gameReminders:!0},privacy:{locationSharing:!0,profileVisibility:"public"},sports:[]}};c(i),s("success"),n("Authentication successful! Redirecting...");const o=localStorage.getItem("pendingGameJoin");if(o)localStorage.removeItem("pendingGameJoin"),setTimeout(()=>t(`/game/${o}`),1500);else if(i){i.name&&i.username?setTimeout(()=>t("/"),1500):setTimeout(()=>t("/onboarding"),1500)}else setTimeout(()=>t("/onboarding"),1500)}catch(e){s("error"),n("Authentication failed. Please try again."),setTimeout(()=>t("/auth"),3e3)}})()},[t,c,r]),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsx(Ye,{className:"w-full max-w-md",children:e.jsx(Qe,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-4",children:["loading"===a&&e.jsxs(e.Fragment,{children:[e.jsx(tt,{size:"lg"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Completing Sign In"}),e.jsx("p",{className:"text-muted-foreground",children:i})]}),"success"===a&&e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-12 h-12 text-green-500 mx-auto"}),e.jsx("h2",{className:"text-xl font-semibold text-green-700",children:"Success!"}),e.jsx("p",{className:"text-muted-foreground",children:i})]}),"error"===a&&e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-12 h-12 text-red-500 mx-auto"}),e.jsx("h2",{className:"text-xl font-semibold text-red-700",children:"Authentication Error"}),e.jsx(ea,{variant:"destructive",children:e.jsx(ra,{children:i})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Redirecting to sign in page..."})]})]})})})})}const sa=o.lazy(()=>w(()=>import("./HomeScreen-DadnCdyn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ia=o.lazy(()=>w(()=>import("./SearchDiscovery-DZeNna6r.js"),__vite__mapDeps([11,1,2,12,4,5,3,6,7,8,9]))),na=o.lazy(()=>w(()=>import("./CreateGame-CgIHuC4X.js"),__vite__mapDeps([13,1,2,14,12,15,16,3,5]))),oa=o.lazy(()=>w(()=>import("./UserProfile-BUDBJUYv.js"),__vite__mapDeps([17,1,2,18,19,5,3,20,14,9]))),ca=o.lazy(()=>w(()=>import("./EditProfile-BUAuJ05D.js"),__vite__mapDeps([21,1,2,12,15,3,19,5]))),la=o.lazy(()=>w(()=>import("./GameDetails-acsKCNDO.js"),__vite__mapDeps([22,1,2,23,3,12,15,7,4,5,8,24,20,9]))),da=o.lazy(()=>w(()=>import("./OtherUserProfile-hDXSHppt.js"),__vite__mapDeps([25,1,2,23,3,19,5]))),ua=o.lazy(()=>w(()=>import("./NotificationCenter-cltkrfsR.js"),__vite__mapDeps([26,1,2,3,24,5]))),ma=o.lazy(()=>w(()=>import("./Settings-DUk3v9d8.js"),__vite__mapDeps([27,1,2,28,16,3,23,5]))),pa=o.lazy(()=>w(()=>import("./AccessibilitySettings-D-9sVjrR.js"),__vite__mapDeps([29,1,2,28,16,3,23,5]))),fa=o.lazy(()=>w(()=>import("./NotificationSettings-B7584S6_.js"),__vite__mapDeps([30,1,2,28,3,5]))),ga=o.lazy(()=>w(()=>import("./DesignSystem-DHg6PPq6.js"),__vite__mapDeps([31,1,2,12,18,28,3,14,10,5]))),ha=o.lazy(()=>w(()=>import("./AdminDashboard-CSQSSIGF.js"),__vite__mapDeps([32,1,2,15,3,5,4]))),_a=o.lazy(()=>w(()=>import("./TermsOfService-DvnbAd_q.js"),__vite__mapDeps([33,1,2,3,5]))),wa=o.lazy(()=>w(()=>import("./PrivacyPolicy-CR1Mg_Li.js"),__vite__mapDeps([34,1,2,3,5]))),ya=o.lazy(()=>w(()=>import("./Onboarding-CvPMZSqB.js"),__vite__mapDeps([35,1,2,12,14,7,3,5]))),ba=o.lazy(()=>w(()=>import("./NavigationTest-CzbRtVUU.js"),__vite__mapDeps([36,1,2,3,5]))),va=o.lazy(()=>w(()=>import("./Auth-DN2v9RKN.js"),__vite__mapDeps([37,1,2,12,3,5]))),xa=({text:t="Loading..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(tt,{size:"lg",text:t})}),ka=({children:t})=>e.jsx("div",{className:"min-h-screen bg-background",children:t});function Ea(){return e.jsx(f,{children:e.jsx(et,{children:e.jsx(ka,{children:e.jsx(o.Suspense,{fallback:e.jsx(xa,{text:"Loading application..."}),children:e.jsxs(g,{children:[e.jsxs(h,{path:"/",element:e.jsx(mr,{children:e.jsx(pr,{children:e.jsx(Zr,{})})}),children:[e.jsx(h,{index:!0,element:e.jsx(sa,{})}),e.jsx(h,{path:"search",element:e.jsx(ia,{})}),e.jsx(h,{path:"create",element:e.jsx(na,{})}),e.jsx(h,{path:"profile",element:e.jsx(oa,{})}),e.jsx(h,{path:"profile/edit",element:e.jsx(ca,{})}),e.jsx(h,{path:"game/:gameId",element:e.jsx(la,{})}),e.jsx(h,{path:"user/:userId",element:e.jsx(da,{})}),e.jsx(h,{path:"notifications",element:e.jsx(ua,{})}),e.jsx(h,{path:"settings",element:e.jsx(ma,{})}),e.jsx(h,{path:"settings/accessibility",element:e.jsx(pa,{})}),e.jsx(h,{path:"settings/notifications",element:e.jsx(fa,{})}),e.jsx(h,{path:"admin",element:e.jsx(ha,{})}),e.jsx(h,{path:"design",element:e.jsx(ga,{onBack:()=>{}})}),e.jsx(h,{path:"navigation-test",element:e.jsx(ba,{})})]}),e.jsx(h,{path:"/auth",element:e.jsx(mr,{requireAuth:!1,children:e.jsx(o.Suspense,{fallback:e.jsx(xa,{text:"Loading authentication..."}),children:e.jsx(va,{})})})}),e.jsx(h,{path:"/auth/callback",element:e.jsx(aa,{})}),e.jsx(h,{path:"onboarding",element:e.jsx(o.Suspense,{fallback:e.jsx(xa,{text:"Loading onboarding..."}),children:e.jsx(ya,{onComplete:e=>{}})})}),e.jsx(h,{path:"legal/terms",element:e.jsx(o.Suspense,{fallback:e.jsx(xa,{text:"Loading terms..."}),children:e.jsx(_a,{})})}),e.jsx(h,{path:"legal/privacy",element:e.jsx(o.Suspense,{fallback:e.jsx(xa,{text:"Loading privacy policy..."}),children:e.jsx(wa,{})})}),e.jsx(h,{path:"*",element:e.jsx(l,{to:"/",replace:!0})})]})})})})})}const ja=new y({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:(e,t)=>!(t?.status>=400&&t?.status<500)&&e<3,retryDelay:e=>Math.min(1e3*2**e,3e4)},mutations:{retry:1}}});function Ia({children:t}){return e.jsxs(b,{client:ja,children:[t,!1]})}function Sa(){return e.jsx(et,{children:e.jsx(Ia,{children:e.jsx(dr,{children:e.jsx(Ea,{})})})})}if("serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/",updateViaCache:"none"});e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&confirm("New version available! Refresh to update?")&&window.location.reload()})})}catch(e){}}),"performance"in window){performance.now();window.addEventListener("load",()=>{performance.now()})}z(document.getElementById("root")).render(e.jsx(Sa,{}));export{ea as A,Ke as B,Ye as C,tt as L,mt as S,Qe as a,gr as b,$r as c,Xe as d,Ze as e,ra as f,He as g,Vr as h,qr as i,Wr as j,ur as k,ct as l,Hr as m,ta as n,rt as s,$e as t,cr as u};
//# sourceMappingURL=index-DY_-g0lH.js.map
