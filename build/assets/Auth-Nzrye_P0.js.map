{"version":3,"file":"Auth-Nzrye_P0.js","sources":["../../src/components/login-form.tsx","../../src/components/EnhancedAuth.tsx"],"sourcesContent":["import { cn } from '../lib/utils'\nimport { supabase } from '../lib/supabase'\nimport { Button } from './ui/button'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from './ui/card'\nimport { Input } from './ui/input'\nimport { Alert, AlertDescription } from './ui/alert'\nimport { useState } from 'react'\nimport { Chrome, Mail } from 'lucide-react'\n\ninterface LoginFormProps extends React.ComponentPropsWithoutRef<'div'> {\n  onEmailAuth?: (email: string, password: string, isSignUp: boolean) => Promise<void>\n  onForgotPassword?: () => void\n}\n\nexport function LoginForm({ className, onEmailAuth, onForgotPassword, ...props }: LoginFormProps) {\n  const [error, setError] = useState<string | null>(null)\n  const [success, setSuccess] = useState<string | null>(null)\n  const [isLoading, setIsLoading] = useState(false)\n  const [showEmailForm, setShowEmailForm] = useState(false)\n  const [isSignUp, setIsSignUp] = useState(false)\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [name, setName] = useState('')\n\n  const handleSocialLogin = async (provider: 'google') => {\n    setIsLoading(true)\n    setError(null)\n\n    try {\n      const { error } = await supabase.auth.signInWithOAuth({\n        provider,\n        options: {\n          redirectTo: `${window.location.origin}/auth/callback`,\n          queryParams: {\n            access_type: 'offline',\n            prompt: 'consent',\n          }\n        }\n      })\n\n      if (error) throw error\n      // OAuth will redirect automatically\n    } catch (error: unknown) {\n      setError(error instanceof Error ? error.message : 'An error occurred')\n      setIsLoading(false)\n    }\n  }\n\n  const handleEmailAuth = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!onEmailAuth) return\n    \n    setIsLoading(true)\n    setError(null)\n    setSuccess(null)\n\n    try {\n      await onEmailAuth(email, password, isSignUp)\n      if (isSignUp) {\n        setSuccess('Check your email for confirmation link!')\n      }\n    } catch (error: unknown) {\n      setError(error instanceof Error ? error.message : 'An error occurred')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className={cn('flex flex-col gap-6', className)} {...props}>\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-2xl\">Welcome to TribeUp!</CardTitle>\n          <CardDescription>Find your tribe and join the game</CardDescription>\n        </CardHeader>\n        <CardContent>\n          {!showEmailForm ? (\n            <div className=\"space-y-4\">\n              {/* Social Login Button */}\n              <Button\n                variant=\"outline\"\n                onClick={() => handleSocialLogin('google')}\n                disabled={isLoading}\n                className=\"w-full\"\n              >\n                <Chrome className=\"mr-2 h-4 w-4\" />\n                Continue with Google\n              </Button>\n\n              {/* Divider */}\n              <div className=\"relative my-6\">\n                <div className=\"absolute inset-0 flex items-center\">\n                  <span className=\"w-full border-t\" />\n                </div>\n                <div className=\"relative flex justify-center text-xs uppercase\">\n                  <span className=\"bg-background px-2 text-muted-foreground\">\n                    Or continue with email\n                  </span>\n                </div>\n              </div>\n\n              {/* Email Button */}\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowEmailForm(true)}\n                disabled={isLoading}\n                className=\"w-full\"\n              >\n                <Mail className=\"mr-2 h-4 w-4\" />\n                Continue with Email\n              </Button>\n\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n            </div>\n          ) : (\n            <form onSubmit={handleEmailAuth} className=\"space-y-4\">\n              {isSignUp && (\n                <div>\n                  <label htmlFor=\"name\" className=\"text-sm font-medium\">Name</label>\n                  <Input\n                    id=\"name\"\n                    type=\"text\"\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    required={isSignUp}\n                    placeholder=\"Enter your full name\"\n                  />\n                </div>\n              )}\n              \n              <div>\n                <label htmlFor=\"email\" className=\"text-sm font-medium\">Email</label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                  placeholder=\"Enter your email\"\n                />\n              </div>\n              \n              <div>\n                <label htmlFor=\"password\" className=\"text-sm font-medium\">Password</label>\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                  placeholder=\"Enter your password\"\n                />\n              </div>\n\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n\n              {success && (\n                <Alert>\n                  <AlertDescription>{success}</AlertDescription>\n                </Alert>\n              )}\n\n              <Button \n                type=\"submit\" \n                variant=\"default\" \n                className=\"w-full\" \n                disabled={isLoading}\n                style={{ backgroundColor: '#FA4616', color: 'white' }}\n              >\n                {isLoading ? 'Loading...' : (isSignUp ? 'Sign Up' : 'Sign In')}\n              </Button>\n\n              <div className=\"text-center space-y-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setIsSignUp(!isSignUp)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground\"\n                >\n                  {isSignUp ? 'Already have an account? Sign In' : 'Need an account? Sign Up'}\n                </button>\n                <br />\n                {!isSignUp && onForgotPassword && (\n                  <>\n                    <button\n                      type=\"button\"\n                      onClick={onForgotPassword}\n                      className=\"text-sm text-muted-foreground hover:text-foreground\"\n                    >\n                      Forgot your password?\n                    </button>\n                    <br />\n                  </>\n                )}\n                <button\n                  type=\"button\"\n                  onClick={() => setShowEmailForm(false)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground\"\n                >\n                  Back to social login\n                </button>\n              </div>\n            </form>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n","import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { LoginForm } from './login-form';\nimport { useSimpleAuth } from '../providers/SimpleAuthProvider';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { toast } from 'sonner';\n\nfunction EnhancedAuth() {\n  const navigate = useNavigate();\n  const { signIn, signUp } = useSimpleAuth();\n\n  const handleEmailAuth = async (email: string, password: string, isSignUp: boolean) => {\n    try {\n      if (isSignUp) {\n        // Use the existing signUp function which properly creates user profiles\n        await signUp(email, password, { \n          name: email.split('@')[0], // Default name from email\n          email \n        });\n        toast.success('Check your email for confirmation link!');\n      } else {\n        await signIn(email, password);\n        // Navigation will be handled by AuthProvider\n      }\n    } catch (error: any) {\n      console.error('Email auth error:', error);\n      throw error; // Re-throw so LoginForm can handle the error display\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <LoginForm \n          onEmailAuth={handleEmailAuth}\n          className=\"w-full\"\n        />\n        \n        <div className=\"mt-6 text-center\">\n          <p className=\"text-xs text-muted-foreground\">\n            By continuing, you agree to our Terms of Service and Privacy Policy\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default EnhancedAuth;\n"],"names":["LoginForm","className","onEmailAuth","onForgotPassword","props","error","setError","useState","success","setSuccess","isLoading","setIsLoading","showEmailForm","setShowEmailForm","isSignUp","setIsSignUp","email","setEmail","password","setPassword","name","setName","jsx","cn","children","jsxs","Card","CardHeader","CardTitle","CardDescription","CardContent","onSubmit","async","e","preventDefault","Error","message","htmlFor","Input","id","type","value","onChange","target","required","placeholder","Alert","variant","AlertDescription","Button","disabled","style","backgroundColor","color","onClick","Fragment","provider","supabase","auth","signInWithOAuth","options","redirectTo","window","location","origin","queryParams","access_type","prompt","handleSocialLogin","Chrome","Mail","EnhancedAuth","useNavigate","signIn","signUp","useSimpleAuth","split","toast"],"mappings":"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"}