import{j as e}from"./ui-CuzVkv4o.js";import{r as p}from"./vendor-Dit9F4CM.js";import{s as ke,u as Ee,b as le,B as M,C as z,a as W,f as Z,g as ee,L as ce,h as de}from"./index-RcbufgnR.js";import{P as Ie}from"./progress-B4lLJ9H6.js";import{I as Y}from"./input-CVPRRIiY.js";import{T as _e}from"./textarea-C7cl1V-L.js";import{A as me,a as ue}from"./alert-llQZMI73.js";import{S as Te,a as Ae,b as Le,c as $e,d as O}from"./select-CyoK6my-.js";import{A as te}from"./arrow-left-C_jR-xpn.js";import{M as ge}from"./map-pin-CHKzuRIh.js";import{C as xe}from"./circle-check-big-CjVW2u_d.js";import"./check-COIjBhBu.js";const De={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"1.0.0",VITE_ENABLE_MOCK_DATA:"false",VITE_ENVIRONMENT:"production",VITE_GOOGLE_MAPS_API_KEY:"AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ",VITE_GOOGLE_PLACES_API_KEY:"AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ",VITE_OPENWEATHER_API_KEY:"***REMOVED***",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFsZWd1Zm5vcHNtaW5xY29rZWxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyMzUwMjIsImV4cCI6MjA3MTgxMTAyMn0.YgwFtX87MiSXA83DN2um0WP-1uYU6qsPXhwGmIWjadQ",VITE_SUPABASE_URL:"https://alegufnopsminqcokelr.supabase.co",VITE_VAPID_PUBLIC_KEY:"BC4DMZTgsNweSUVDik1uoXwpXEnzk12jgZTVA0B19WYKxa4NeaFv4QRov_1e-w-V_SgN7RrBZ_yMX_2HopLoSus"};function Ge(){const[j,r]=p.useState([]),[N,f]=p.useState(!1),[I,d]=p.useState(!1),i="AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ";p.useEffect(()=>{console.log("üîë API Key status:",{hasKey:!0,keyLength:i?.length,keyPrefix:i?.substring(0,10)+"...",envVars:Object.keys(De||{}).filter(h=>h.includes("GOOGLE"))})},[i]),p.useEffect(()=>{console.log("üåê Using new Google Places API with OpenStreetMap fallback"),d(!1)},[]);const C=p.useCallback(async h=>{try{if(console.log("üåç Geocoding address with Google:",h),i&&i!=="demo_key"){const S=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(h)}&key=${i}`);if(S.ok){const m=await S.json();if(console.log("üåç Google Geocoding response:",m),m.results&&m.results.length>0){const c=m.results[0].geometry.location,b={lat:c.lat,lng:c.lng};return console.log("‚úÖ Google geocoded coordinates:",b),b}}else console.log("‚ö†Ô∏è Google Geocoding API error:",S.status)}console.log("üó∫Ô∏è Falling back to OpenStreetMap geocoding...");const y=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(h)}&limit=1`,{headers:{"User-Agent":"TribeUp Sports App"}});if(!y.ok)throw new Error("Geocoding failed");const w=await y.json();if(console.log("üåç OpenStreetMap geocoding response:",w),w.length>0){const S={lat:parseFloat(w[0].lat),lng:parseFloat(w[0].lon)};return console.log("‚úÖ OpenStreetMap geocoded coordinates:",S),S}return console.log("‚ö†Ô∏è No geocoding results found"),null}catch(y){return console.error("‚ùå Geocoding error:",y),null}},[i]),_=p.useCallback(async(h,y,w)=>{if(console.log("üîç searchLocations called with:",{query:h,userLat:y,userLng:w,queryLength:h?.length}),!h.trim()){console.log("‚ùå Empty query, clearing suggestions"),r([]);return}console.log("üîç Starting location search for:",h),f(!0);const S=async()=>{try{console.log("üó∫Ô∏è Trying OpenStreetMap for query:",h);let m=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(h)}&limit=5&addressdetails=1`;y&&w&&(m+=`&lat=${y}&lon=${w}&bounded=1&viewbox=${w-.1},${y+.1},${w+.1},${y-.1}`,console.log("üìç Added location bias to OpenStreetMap search")),console.log("üì° OpenStreetMap URL:",m);const c=await fetch(m,{headers:{"User-Agent":"TribeUp Sports App"}});if(console.log("üì• OpenStreetMap response status:",c.status,c.statusText),c.ok){const b=await c.json();if(console.log("‚úÖ OpenStreetMap response data:",b),b&&b.length>0){const L=b.map((v,D)=>({place_id:v.place_id||`osm-${D}`,description:v.display_name,structured_formatting:{main_text:v.name||v.display_name.split(",")[0],secondary_text:v.display_name.split(",").slice(1,3).join(",").trim()}}));console.log("üéØ OpenStreetMap suggestions processed:",L),r(L);return}else console.log("‚ö†Ô∏è OpenStreetMap returned empty results for query:",h)}else{console.log("‚ùå OpenStreetMap API error:",c.status,c.statusText);const b=await c.text();console.log("‚ùå Error details:",b)}}catch(m){console.error("‚ùå OpenStreetMap search error:",m)}console.log("‚ùå All location APIs failed, showing no suggestions"),r([])};try{if(i&&i!=="demo_key"&&i!=="your_anon_key_here"){console.log("üåê Trying new Google Places API (Text Search)...");const m={textQuery:h,maxResultCount:5,locationBias:y&&w?{circle:{center:{latitude:y,longitude:w},radius:5e4}}:void 0};console.log("üì§ Google Places API request:",m);const c=await fetch("https://places.googleapis.com/v1/places:searchText",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":i,"X-Goog-FieldMask":"places.id,places.displayName,places.formattedAddress,places.location"},body:JSON.stringify(m)});if(console.log("üì• Google Places API response status:",c.status),c.ok){const b=await c.json();if(console.log("‚úÖ Google Places API response:",b),b.places&&b.places.length>0){const L=b.places.map((v,D)=>{const G=v.displayName?.text||"",T=v.formattedAddress||"",F=G?T?`${G}, ${T}`:G:T||"Unknown location";return{place_id:v.id||`google-${D}`,description:F,structured_formatting:{main_text:G||T?.split(",")[0]||"Unknown",secondary_text:T||""}}});console.log("üéØ Google Places API suggestions:",L),r(L),f(!1);return}else console.log("‚ö†Ô∏è Google Places API returned no results")}else{const b=await c.text();console.log("‚ùå Google Places API error:",c.status,b)}}console.log("üó∫Ô∏è Falling back to OpenStreetMap..."),await S()}catch(m){console.error("‚ùå Location search error:",m),r([])}finally{f(!1)}},[]);return p.useEffect(()=>{typeof window<"u"&&(window.debugLocationSearch=async h=>{console.log("üß™ Debug location search for:",h),await _(h)})},[_]),{suggestions:j,loading:N,searchLocations:_,geocodeLocation:C}}function Me(j={}){const[r,N]=p.useState({latitude:null,longitude:null,error:null,loading:!0});return p.useEffect(()=>{if(console.log("useGeolocation hook initializing..."),!navigator.geolocation){console.log("Geolocation not supported"),N(i=>({...i,error:"Geolocation is not supported by this browser",loading:!1}));return}const f=i=>{console.log("GPS location obtained:",i.coords.latitude,i.coords.longitude),N({latitude:i.coords.latitude,longitude:i.coords.longitude,error:null,loading:!1})},I=i=>{let C="Unable to retrieve location";switch(i.code){case i.PERMISSION_DENIED:C="Location access denied by user";break;case i.POSITION_UNAVAILABLE:C="Location information unavailable";break;case i.TIMEOUT:C="Location request timed out";break}console.log("GPS error:",C,i),N(_=>({..._,error:C,loading:!1}))},d={enableHighAccuracy:j.enableHighAccuracy??!0,timeout:j.timeout??1e4,maximumAge:j.maximumAge??3e5};console.log("Requesting GPS permission with options:",d),navigator.geolocation.getCurrentPosition(f,I,d)},[j.enableHighAccuracy,j.timeout,j.maximumAge]),r}class U{static instance;cache={};CACHE_TTL=5*60*1e3;constructor(){}static getInstance(){return U.instance||(U.instance=new U),U.instance}async fetchConfigValue(r){try{const{data:N,error:f}=await ke.from("system_config").select("value").eq("key",r).single();if(f){if(f.code==="PGRST116")return console.warn(`Config key '${r}' not found in database`),null;throw f}return this.parseConfigValue(N.value)}catch{return console.log(`‚ö†Ô∏è system_config table not found or error fetching '${r}', using default`),null}}parseConfigValue(r){if(typeof r=="string")try{return JSON.parse(r)}catch{return r==="true"?!0:r==="false"?!1:!isNaN(Number(r))&&r!==""?Number(r):r}return r}async get(r,N){const f=this.cache[r];if(f&&Date.now()-f.timestamp<f.ttl)return f.value;const I=await this.fetchConfigValue(r);return this.cache[r]={value:I,timestamp:Date.now(),ttl:this.CACHE_TTL},I!==null?I:N}}const se=U.getInstance(),pe=[{value:"basketball",label:"Basketball",icon:"üèÄ"},{value:"soccer",label:"Soccer",icon:"‚öΩ"},{value:"tennis",label:"Tennis",icon:"üéæ"},{value:"pickleball",label:"Pickleball",icon:"ü•í"},{value:"volleyball",label:"Volleyball",icon:"üèê"},{value:"football",label:"Football",icon:"üèà"},{value:"baseball",label:"Baseball",icon:"‚öæ"}],E=[{id:1,title:"What & When",fields:["sport","date","time","duration"]},{id:2,title:"Where & Who",fields:["location","maxPlayers","cost"]},{id:3,title:"Review & Create",fields:[]}],q=["09:00","12:00","15:00","17:00","18:00","19:00","20:00","21:00"];function Xe(){const j=Ee(),[r,N]=p.useState(1),[f,I]=p.useState(!1),[d,i]=p.useState({}),[C,_]=p.useState(null),[h,y]=p.useState(!1),[w,S]=p.useState(q),{latitude:m,longitude:c,error:b}=Me(),{searchLocations:L,loading:v,suggestions:D,geocodeLocation:G}=Ge(),{user:T}=le(),F=p.useRef(null),[ae,he]=p.useState(0),fe=()=>{const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]},[a,A]=p.useState({title:"",sport:"",date:fe(),time:"",duration:"60",location:"",latitude:null,longitude:null,maxPlayers:"10",cost:"FREE",imageUrl:""});p.useEffect(()=>{(async()=>{try{const s=await se.get("quick_time_slots",["09:00","12:00","15:00","17:00","18:00","19:00","20:00","21:00"]);S(s||q);const o=await se.get("max_players_per_game",10);A(n=>({...n,maxPlayers:(o||10).toString()}))}catch(s){console.error("Error loading system config:",s),S(q),A(o=>({...o,maxPlayers:"10"}))}})()},[]),p.useEffect(()=>{(async()=>{if(a.sport)try{const s=await se.get(`sport_${a.sport}_duration`,60);A(o=>({...o,duration:s?s.toString():"60"}))}catch(s){console.error("Error loading sport defaults:",s)}})()},[a.sport]);const re={basketball:{maxPlayers:10},soccer:{maxPlayers:22},football:{maxPlayers:22},tennis:{maxPlayers:4},volleyball:{maxPlayers:12},baseball:{maxPlayers:18},hockey:{maxPlayers:12},badminton:{maxPlayers:4},pickleball:{maxPlayers:4},golf:{maxPlayers:4},running:{maxPlayers:20},cycling:{maxPlayers:15},swimming:{maxPlayers:8},yoga:{maxPlayers:15},crossfit:{maxPlayers:12}};(()=>{const t=new Date,s=t.getHours();return t.getDay()===0||t.getDay()===6?["09:00","10:00","11:00","14:00","15:00","16:00","17:00"]:s<17?["17:00","18:00","19:00","20:00","21:00"]:["18:00","19:00","20:00","21:00"]})();const[be,ye]=p.useState(()=>{try{return JSON.parse(localStorage.getItem("recentGameLocations")||"[]")}catch{return[]}});p.useEffect(()=>{T||j("/auth")},[T,j]),p.useEffect(()=>{const t=()=>{if(F.current){const s=F.current.offsetHeight;he(s)}};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[r,f]);const H=(t,s,o)=>{if(!t||!s||!o)return"";const n=parseInt(s.split(":")[0]);let l="Morning";n>=12&&n<17?l="Afternoon":n>=17&&(l="Evening");const x=(K=>{const V=K.split(",").map($=>$.trim()),B=V[0];if(!/^\d/.test(B))return B;const Ce=["park","center","centre","court","field","stadium","gym","club","recreation","community","sports","athletic","fitness","plaza","square","beach","lake","river","trail","complex","facility","ymca","school","university","college","library","museum"];for(const $ of V){const Q=$.toLowerCase();if(Ce.some(X=>Q.includes(X)))return $}const Pe=["starbucks","mcdonalds","walmart","target","costco","whole foods","restaurant","cafe","coffee","hotel","mall","store","shop"];for(const $ of V){const Q=$.toLowerCase();if(Pe.some(X=>Q.includes(X)))return $}return B.replace(/^\d+\s+/,"").replace(/\s+(st|street|ave|avenue|rd|road|blvd|boulevard|dr|drive|ln|lane|way|ct|court)$/i,"").trim()||B})(o),g=t.charAt(0).toUpperCase()+t.slice(1),k=[`${l} ${g} at ${x}`,`${g} Game - ${x}`,`${l} ${g} Session`,`${x} ${g} Meetup`,`${g} @ ${x}`];return k[Math.floor(Math.random()*k.length)]},je=async(t,s,o,n)=>{if(!t||!s||!o||!n)return null;try{return(await de.getGames()).filter(x=>{const g=x.date===s,k=Math.abs(new Date(`2000-01-01T${x.time}`).getTime()-new Date(`2000-01-01T${o}`).getTime())<36e5,K=x.sport.toLowerCase()===t.toLowerCase(),V=x.location.toLowerCase().includes(n.toLowerCase())||n.toLowerCase().includes(x.location.toLowerCase());return g&&k&&K&&V}).length>0?`Similar ${t} game already exists at ${n} on ${s} around ${o}`:null}catch(l){return console.error("Error checking duplicates:",l),null}},Ne=(t,s)=>{switch(t){case"date":if(!s)return null;const o=new Date;return new Date(s+"T00:00:00")<new Date(o.toDateString())?"Date cannot be in the past":null;case"time":if(!s)return null;const l=parseInt(s.split(":")[0]);return l<6||l>23?"Unusual time - games typically happen 6 AM - 11 PM":l>=2&&l<=5?"Did you mean PM instead of AM?":null;case"maxPlayers":if(!s)return null;const u=parseInt(s);if(u<2)return"Need at least 2 players";if(u>100)return"That seems like a lot of players - double check?";const x=a.sport?.toLowerCase();return x==="tennis"&&u>4?"Tennis usually has 2-4 players":x==="basketball"&&u>10?"Basketball usually has 6-10 players":x==="soccer"&&u>22?"Soccer usually has up to 22 players":null;case"location":return s?s.length<3?"Location too short":s.toLowerCase().includes("ocean")||s.toLowerCase().includes("sea")?"Are you sure this location is correct?":s.toLowerCase().includes("home")||s.toLowerCase().includes("house")?"Consider using a public venue for safety":null:null;case"cost":if(!s)return null;const g=parseFloat(s);return g<0?"Cost cannot be negative":g>500?"That seems expensive - double check?":null;case"duration":if(!s)return null;const k=parseInt(s);return k<15?"Duration should be at least 15 minutes":k>480?"Duration seems too long - max 8 hours":k>240?"That's a long game - are you sure?":null;default:return null}},P=(t,s)=>{A(n=>{const l={...n,[t]:s},u=H(n.sport,n.time,n.location),x=H(t==="sport"?s:n.sport,t==="time"?s:n.time,t==="location"?s:n.location);if((t==="sport"||t==="time"||t==="location")&&(!n.title||n.title===u)&&x&&(l.title=x),t==="sport"&&re[s.toLowerCase()]){const g=re[s.toLowerCase()];l.maxPlayers=(g?.maxPlayers||10).toString()}if(t==="location"&&s.trim()){const g=[s,...be.filter(k=>k!==s)].slice(0,5);ye(g),localStorage.setItem("recentGameLocations",JSON.stringify(g))}return l});const o=Ne(t,s);i(n=>{if(o)return{...n,[t]:o};{const{[t]:l,...u}=n;return u}}),t==="location"&&a.sport&&a.date&&a.time&&s&&je(a.sport,a.date,a.time,s).then(n=>{i(n?l=>({...l,duplicate:n}):l=>{const{duplicate:u,...x}=l;return x})})},J=t=>{const s=E[t-1]?.fields||[],o=s.every(n=>{const l=a[n];return l!=null&&l.toString().trim()!==""});return console.log("[CreateGame] isStepComplete - Step:",t,"Fields:",s,"Complete:",o,"FormData:",a),o},oe=()=>{const t={};if(r===1){if(a.sport||(t.sport="Please select a sport."),a.date||(t.date="Please choose a date."),a.time||(t.time="Please choose a time."),a.duration||(t.duration="Please set a duration."),a.date){const s=new Date;new Date(a.date+"T00:00:00")<new Date(s.toDateString())&&(t.date="Date cannot be in the past.")}if(a.duration){const s=parseInt(a.duration);s<15&&(t.duration="Duration should be at least 15 minutes."),s>480&&(t.duration="Duration seems too long - max 8 hours.")}}if(r===2){a.location.trim()||(t.location="Location is required.");const s=parseInt(a.maxPlayers,10);a.maxPlayers?(Number.isNaN(s)||s<=0)&&(t.maxPlayers="Enter a valid number greater than 0."):t.maxPlayers="Max players is required.",a.cost||(t.cost="Please select a cost option.")}return console.log("[CreateGame] Validation - Step:",r,"Errors:",t,"FormData:",a),i(t),Object.keys(t).length===0},we=()=>{oe()&&r<E.length&&N(r+1)},ne=()=>{r>1?N(r-1):j(-1)},ve=async()=>{if(oe()){I(!0),_(null);try{const{user:t}=le.getState();if(console.log("[CreateGame] submit clicked. user =",t?.id),!t)throw new Error("You must be logged in to create a game");const s={title:a.title,sport:a.sport,date:a.date,time:a.time,duration:parseInt(a.duration)||60,location:a.location,latitude:a.latitude,longitude:a.longitude,maxPlayers:parseInt(a.maxPlayers)||10,cost:a.cost||"Free",description:"",imageUrl:a.imageUrl};console.log("[CreateGame] creating game with data =",s),await de.createGame(s),j("/")}catch(t){console.error("Error creating game:",t),_(t instanceof Error?t.message:"Failed to create game")}finally{I(!1)}}},Se=r/E.length*100,R=pe.find(t=>t.value===a.sport),ie=(t,s,o="text",n)=>{const l=a[t],u=d[t],x=l&&!u;return o==="select"?e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:s}),e.jsxs("select",{value:l,onChange:g=>P(t,g.target.value),className:`w-full p-3 border rounded-lg transition-colors bg-background text-foreground ${u?"border-destructive bg-destructive/10":x?"border-green-500 bg-green-50 dark:bg-green-950/50 dark:border-green-400":"border-input hover:border-ring focus:border-ring focus:ring-2 focus:ring-ring/20"}`,children:[e.jsxs("option",{value:"",className:"bg-background text-foreground",children:["Select ",s.toLowerCase()]}),n?.map(g=>e.jsx("option",{value:g.value,className:"bg-background text-foreground",children:g.label},g.value))]}),u&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",u]}),x&&!u&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚úÖ"})," Looks good!"]})]}):o==="textarea"?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[s,E[r-1].fields.includes(t)&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(_e,{value:l,onChange:g=>P(t,g.target.value),placeholder:`Enter ${s.toLowerCase()}`,className:`resize-none ${u?"border-destructive":""}`,rows:3}),u&&e.jsx("p",{className:"text-sm text-destructive",children:u})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[s,E[r-1].fields.includes(t)&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(Y,{type:o,value:a[t],onChange:g=>P(t,g.target.value),placeholder:`Enter ${s.toLowerCase()}`,min:o==="date"?new Date().toISOString().split("T")[0]:void 0,className:`transition-colors ${u?"border-red-500 bg-red-50":x?"border-green-500 bg-green-50":"border-gray-300"}`}),u&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",u]}),x&&!u&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚úÖ"})," Looks good!"]})]})};return e.jsxs("div",{className:"min-h-screen bg-background",style:{paddingBottom:`${ae+16}px`},children:[e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6",children:[e.jsx("div",{className:"sticky top-0 bg-background/95 backdrop-blur-sm border-b border-border z-10",children:e.jsx("div",{className:"flex items-center justify-between px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(M,{variant:"ghost",size:"icon",onClick:ne,children:e.jsx(te,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Create Game"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:E[r-1].title})]})]})})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Ie,{value:Se,className:"h-2"})})]}),e.jsxs("div",{className:"px-4 pt-6",style:{paddingBottom:`${ae+16}px`},children:[R&&e.jsx("div",{className:"mb-6",children:e.jsx(z,{children:e.jsx(W,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-2xl",children:R.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.title||"New Game"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:R.label})]})]})})})}),r===1&&e.jsx("div",{className:"space-y-6",children:e.jsxs(z,{children:[e.jsx(Z,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"1"}),"What & When"]})}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Sport"}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:pe.map(t=>e.jsxs("button",{type:"button",onClick:()=>P("sport",t.value),className:`p-2 rounded-lg border-2 transition-all duration-200 ${a.sport===t.value?"border-primary bg-primary/10 text-primary":"border-input hover:border-ring text-foreground bg-background"}`,children:[e.jsx("div",{className:"text-lg mb-1",children:t.icon}),e.jsx("div",{className:"text-xs font-medium",children:t.label})]},t.value))}),d.sport&&e.jsx("p",{className:"text-sm text-destructive",children:d.sport})]}),ie("date","Date","date"),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Time"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:(w||q).map(t=>e.jsx("button",{type:"button",onClick:()=>P("time",t),className:`px-2 py-2 text-xs rounded-md border transition-colors ${a.time===t?"bg-primary text-primary-foreground border-primary":"bg-background text-foreground border-input hover:bg-muted hover:border-ring"}`,children:new Date(`2000-01-01T${t}:00`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},t))}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Or enter custom time:"}),e.jsx(Y,{type:"time",value:a.time,onChange:t=>P("time",t.target.value),className:d.time?"border-destructive":"",placeholder:"Select time"})]}),d.time&&e.jsx("p",{className:"text-sm text-destructive",children:d.time})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground",children:["Duration ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["30","60","90","120"].map(t=>e.jsxs("button",{type:"button",onClick:()=>P("duration",t),className:`px-2 py-2 text-xs rounded-md border transition-colors ${a.duration===t?"bg-primary text-primary-foreground border-primary":"bg-background text-foreground border-input hover:bg-muted hover:border-ring"}`,children:[t," min"]},t))}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Or enter custom duration (minutes):"}),e.jsx(Y,{type:"number",value:a.duration,onChange:t=>P("duration",t.target.value),className:d.duration?"border-destructive":"",placeholder:"Duration in minutes",min:"15",max:"480"})]}),d.duration&&e.jsx("p",{className:"text-sm text-destructive",children:d.duration})]})]})]})}),r===2&&e.jsx("div",{className:"space-y-6",children:e.jsxs(z,{children:[e.jsx(Z,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"2"}),"Where & Who"]})}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{value:a.location,onChange:t=>{P("location",t.target.value),console.log("Location input changed:",t.target.value),t.target.value.length>2?(console.log("Triggering location search for:",t.target.value),L(t.target.value,m||void 0,c||void 0),y(!0)):(console.log("Hiding location suggestions"),y(!1))},placeholder:"Enter location or address",className:d.location?"border-destructive":""}),e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex gap-2",children:[v&&e.jsx(ce,{className:"w-4 h-4 animate-spin text-muted-foreground"}),e.jsx(M,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:async()=>{if(m&&c)try{const o=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${m}&lon=${c}`)).json()).display_name||`${m.toFixed(4)}, ${c.toFixed(4)}`;A(n=>({...n,location:o,latitude:m,longitude:c}))}catch(t){console.error("Reverse geocoding failed:",t),A(s=>({...s,location:`${m.toFixed(4)}, ${c.toFixed(4)}`,latitude:m,longitude:c}))}},disabled:!m||!c,title:m&&c?"Use my current location":b||"Location not available",children:e.jsx(ge,{className:"w-4 h-4"})})]})]}),h&&e.jsx("div",{className:"border border-border rounded-md bg-background shadow-lg max-h-48 overflow-y-auto",children:D.length>0?D.map(t=>e.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-muted border-b border-border last:border-b-0 flex items-center gap-2",onClick:async()=>{A(o=>{const n=o.sport&&o.time?H(o.sport,o.time,t.description):o.title;return{...o,location:t.description,title:n||o.title}}),y(!1);const s=await G(t.description);s&&A(o=>({...o,latitude:s.lat,longitude:s.lng}))},children:[e.jsx(ge,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.structured_formatting.main_text}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.structured_formatting.secondary_text})]})]},t.place_id)):e.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:v?"Searching...":"No suggestions found. Try typing a more specific location."})}),d.location&&e.jsx("p",{className:"text-sm text-destructive",children:d.location})]}),ie("maxPlayers","Max Players","number"),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Cost ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Te,{value:a.cost,onValueChange:t=>P("cost",t),children:[e.jsx(Ae,{className:d.cost?"border-destructive":"",children:e.jsx(Le,{placeholder:"Select cost"})}),e.jsxs($e,{children:[e.jsx(O,{value:"FREE",children:"Free"}),e.jsx(O,{value:"$5",children:"$5 per person"}),e.jsx(O,{value:"$10",children:"$10 per person"}),e.jsx(O,{value:"$15",children:"$15 per person"}),e.jsx(O,{value:"$20",children:"$20 per person"}),e.jsx(O,{value:"custom",children:"Custom amount"})]})]}),d.cost&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",d.cost]}),a.cost&&!d.cost&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚úÖ"})," Looks good!"]})]})]})]})}),r===3&&e.jsx("div",{className:"space-y-6",children:e.jsxs(z,{children:[e.jsx(Z,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"3"}),"Review & Create"]})}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Game Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Sport:"}),e.jsxs("span",{className:"text-sm",children:[R?.icon," ",R?.label]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Date:"}),e.jsx("span",{className:"text-sm",children:a.date})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Time:"}),e.jsx("span",{className:"text-sm",children:a.time?new Date(`2000-01-01T${a.time}:00`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Duration:"}),e.jsxs("span",{className:"text-sm",children:[a.duration," minutes"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Location:"}),e.jsx("span",{className:"text-sm",children:a.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Max Players:"}),e.jsx("span",{className:"text-sm",children:a.maxPlayers})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Cost:"}),e.jsx("span",{className:"text-sm",children:a.cost})]})]})]})]}),e.jsxs(me,{children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsxs(ue,{children:['Ready to create "',a.title,'" for ',a.maxPlayers," players on ",a.date," at ",a.time?new Date(`2000-01-01T${a.time}:00`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"","?"]})]}),d.duplicate&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:d.duplicate}),e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"You can still create this game if it's intentional."})]})]})]})}),C&&e.jsx("div",{className:"mt-4",children:e.jsx(me,{variant:"destructive",children:e.jsx(ue,{children:C})})})]}),e.jsx("div",{ref:F,className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t border-border safe-area-inset-bottom z-50",children:e.jsxs("div",{className:"px-4 py-3 pb-safe",children:[e.jsx("div",{className:"flex justify-center mb-3 sm:hidden",children:e.jsx("div",{className:"flex items-center gap-2",children:E.map((t,s)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium transition-colors ${r===t.id?"bg-primary text-primary-foreground":r>t.id?"bg-green-500 text-white":"bg-muted text-muted-foreground"}`,children:r>t.id?"‚úì":t.id}),s<E.length-1&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${r>t.id?"bg-green-500":"bg-muted"}`})]},t.id))})}),e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[r>1?e.jsxs(M,{variant:"outline",onClick:ne,className:"min-h-[48px] px-4 sm:px-6 flex-1 max-w-[120px] touch-manipulation text-sm sm:text-base",size:"lg",children:[e.jsx(te,{className:"w-4 h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"Back"})]}):e.jsx(M,{variant:"ghost",onClick:()=>j(-1),className:"min-h-[48px] px-4 touch-manipulation text-sm sm:text-base",size:"lg",children:"Cancel"}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm text-muted-foreground",children:["Step ",r," of ",E.length]}),r<E.length?e.jsxs(M,{onClick:we,disabled:!J(r)||Object.keys(d).some(t=>t!=="duplicate"),className:"min-h-[48px] px-4 sm:px-6 flex-1 max-w-[120px] touch-manipulation text-sm sm:text-base",size:"lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Continue"}),e.jsx("span",{className:"sm:hidden",children:"Next"}),e.jsx(te,{className:"w-4 h-4 ml-1 sm:ml-2 rotate-180"})]}):e.jsx(M,{onClick:ve,disabled:!J(r)||Object.keys(d).some(t=>t!=="duplicate")||f,className:"min-h-[48px] px-4 sm:px-6 flex-1 max-w-[140px] touch-manipulation text-sm sm:text-base",size:"lg",children:f?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-1 sm:mr-2 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Creating..."}),e.jsx("span",{className:"sm:hidden",children:"Wait..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Create Game"}),e.jsx("span",{className:"sm:hidden",children:"Create"})]})})]}),!J(r)&&e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete required fields to continue"})}),!1]})})]})}export{Xe as default};
//# sourceMappingURL=CreateGame-idFs3NXv.js.map
