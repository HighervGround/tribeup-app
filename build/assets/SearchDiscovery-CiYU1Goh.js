import{j as e}from"./ui-Ca5AhCQM.js";import{r as n}from"./vendor-IUqyc6Bg.js";import{c as U,t as D,u as z,B as y,S as $,a as J}from"./index-B_FlWj16.js";import{I as O}from"./input-DgOvx0zD.js";import{B as F}from"./badge-BFuHp4QD.js";import{f as A}from"./dateUtils-But3d3jk.js";import{A as V}from"./arrow-left-BAdA-WRo.js";import{S as T}from"./search-Bkoabw6G.js";import{M as G}from"./map-pin-95o81VIX.js";import{C as q}from"./clock-DoDAqWI7.js";import{U as B}from"./users-C1Xlo5Ty.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],H=U("sliders-horizontal",_);function P(t,r,c,d){const p=w(c-t),o=w(d-r),u=Math.sin(p/2)*Math.sin(p/2)+Math.cos(w(t))*Math.cos(w(c))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}function w(t){return t*(Math.PI/180)}function M(t,r="km"){return r==="mi"&&(t=t*.621371),t<1?r==="km"?`${Math.round(t*1e3)}m`:`${Math.round(t*5280)}ft`:`${t.toFixed(1)}${r}`}function Q(t,r){const c=r/111,d=r/(111*Math.cos(w(t.latitude)));return{north:t.latitude+c,south:t.latitude-c,east:t.longitude+d,west:t.longitude-d}}function W(t={}){const{enableHighAccuracy:r=!0,timeout:c=1e4,maximumAge:d=6e4,watchPosition:x=!1,autoRequest:p=!0}=t,[o,u]=n.useState({currentLocation:null,isLoading:!1,error:null,permission:"unknown",lastUpdated:null}),f=n.useRef(null),v=n.useRef(!1),h="geolocation"in navigator,N=n.useCallback(async()=>{if(!h)return u(a=>({...a,permission:"denied",error:"Geolocation not supported"})),"denied";try{if("permissions"in navigator){const a=await navigator.permissions.query({name:"geolocation"});return u(s=>({...s,permission:a.state})),a.state}}catch{console.warn("Permission API not supported")}return"unknown"},[h]),k=n.useCallback(async()=>h?v.current?null:(v.current=!0,u(a=>({...a,isLoading:!0,error:null})),new Promise(a=>{const s={enableHighAccuracy:r,timeout:c,maximumAge:d},l=m=>{const g={latitude:m.coords.latitude,longitude:m.coords.longitude,accuracy:m.coords.accuracy,altitude:m.coords.altitude||void 0,heading:m.coords.heading||void 0,speed:m.coords.speed||void 0};u(S=>({...S,currentLocation:g,isLoading:!1,error:null,permission:"granted",lastUpdated:new Date})),v.current=!1,a(g)},i=m=>{let g="Failed to get location",S="unknown";switch(m.code){case m.PERMISSION_DENIED:g="Location access denied by user",S="denied",D.error("Please enable location access to find nearby games");break;case m.POSITION_UNAVAILABLE:g="Location information unavailable";break;case m.TIMEOUT:g="Location request timed out";break}u(E=>({...E,isLoading:!1,error:g,permission:S})),v.current=!1,a(null)};navigator.geolocation.getCurrentPosition(l,i,s)})):(D.error("Location services are not supported by your browser"),null),[h,r,c,d]),j=n.useCallback(()=>{if(!h||f.current!==null)return;const a={enableHighAccuracy:r,timeout:c,maximumAge:d},s=i=>{const m={latitude:i.coords.latitude,longitude:i.coords.longitude,accuracy:i.coords.accuracy,altitude:i.coords.altitude||void 0,heading:i.coords.heading||void 0,speed:i.coords.speed||void 0};u(g=>({...g,currentLocation:m,lastUpdated:new Date}))},l=i=>{console.error("Location watch error:",i)};f.current=navigator.geolocation.watchPosition(s,l,a)},[h,r,c,d]),C=n.useCallback(()=>{f.current!==null&&(navigator.geolocation.clearWatch(f.current),f.current=null)},[]),L=n.useCallback(()=>{u(a=>({...a,currentLocation:null,error:null,lastUpdated:null}))},[]),b=n.useCallback((a,s="km")=>{if(!o.currentLocation)return null;const l=P(o.currentLocation.latitude,o.currentLocation.longitude,a.latitude,a.longitude);return s==="mi"?l*.621371:l},[o.currentLocation]),I=n.useCallback((a,s="km")=>{const l=b(a,s);return l?M(l,s):null},[b]),R=n.useCallback((a,s=5)=>{const l=b(a,"km");return l!==null&&l<=s},[b]);return n.useEffect(()=>(N(),p&&k(),x&&j(),()=>{C()}),[N,k,j,C,p,x]),{...o,isSupported:h,requestLocation:k,clearLocation:L,startWatching:j,stopWatching:C,getDistanceTo:b,getFormattedDistanceTo:I,isNearby:R,calculateDistance:(a,s,l,i)=>P(a,s,l,i),formatDistance:M,getBoundsFromCenter:a=>o.currentLocation?Q(o.currentLocation,a):null}}const Y=[{name:"All Sports",value:"all"},{name:"Basketball",value:"basketball"},{name:"Soccer",value:"soccer"},{name:"Tennis",value:"tennis"},{name:"Pickleball",value:"pickleball"},{name:"Volleyball",value:"volleyball"},{name:"Flag Football",value:"flag football"},{name:"Baseball",value:"baseball"},{name:"Golf",value:"golf"},{name:"Hockey",value:"hockey"},{name:"Rugby",value:"rugby"}];function K({game:t,onSelect:r}){const{joinGame:c,leaveGame:d}=J(),x=o=>{o.stopPropagation(),t.isJoined?d(t.id):c(t.id)},p=()=>{r()};return e.jsxs("div",{className:"bg-card rounded-lg p-4 border border-border cursor-pointer hover:shadow-md transition-shadow",onClick:p,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.sport})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("div",{className:"text-sm font-medium",children:t.cost}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.currentPlayers,"/",t.maxPlayers," players"]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{children:[t.currentPlayers,"/",t.maxPlayers," players"]})]}),t.distance&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"ðŸ“"}),e.jsx("span",{children:t.distance})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{children:[t.date," at ",A(t.time)]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[t.isJoined?e.jsx("span",{className:"inline-block bg-success/20 text-success dark:bg-success/30 dark:text-success text-xs px-2 py-1 rounded",children:"Joined âœ“"}):e.jsx("div",{}),e.jsx("button",{onClick:x,className:`px-3 py-1 rounded text-sm font-medium transition-colors ${t.isJoined?"bg-destructive/20 text-destructive dark:bg-destructive/30 dark:text-destructive hover:bg-destructive/30 dark:hover:bg-destructive/40":"bg-primary text-primary-foreground hover:bg-primary/90"}`,children:t.isJoined?"Leave":"Join"})]})]})}function ce(){const t=z(),{currentLocation:r,isLoading:c,requestLocation:d}=W(),[x,p]=n.useState(""),[o,u]=n.useState("all"),[f,v]=n.useState(!1),[h,N]=n.useState("list"),[k,j]=n.useState([]),[C,L]=n.useState(!1);n.useEffect(()=>{(async()=>{L(!0);try{const l=await $.getGames();j(l)}catch(l){console.error("Error loading games:",l),j([])}finally{L(!1)}})()},[]);const b=s=>{t(`/game/${s}`)},I=()=>{t(-1)},R=s=>({Basketball:"bg-orange-500",Soccer:"bg-green-500",Tennis:"bg-yellow-500",Pickleball:"bg-purple-500",Volleyball:"bg-blue-500","Flag Football":"bg-red-500",Baseball:"bg-amber-600",Golf:"bg-emerald-600",Hockey:"bg-slate-600",Rugby:"bg-indigo-600"})[s]||"bg-gray-500",a=k.map(s=>{let l="Unknown distance";if(r&&s.latitude&&s.longitude){const i=P(r.latitude,r.longitude,s.latitude,s.longitude);l=M(i)}return{...s,distance:l,sportColor:R(s.sport),imageUrl:s.imageUrl||"",currentPlayers:s.currentPlayers||s.participants||0,maxPlayers:s.maxPlayers||s.maxParticipants||0}}).filter(s=>{const l=s.title.toLowerCase().includes(x.toLowerCase())||s.sport.toLowerCase().includes(x.toLowerCase())||s.location.toLowerCase().includes(x.toLowerCase()),i=o==="all"||s.sport.toLowerCase()===o.toLowerCase();return l&&i});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"sticky top-0 bg-background/95 backdrop-blur-sm border-b border-border z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 px-4 py-4",children:[e.jsx(y,{variant:"ghost",size:"icon",onClick:I,children:e.jsx(V,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(O,{id:"search-games",name:"search-games",value:x,onChange:s=>p(s.target.value),placeholder:"Search games, sports, locations...",className:"pl-10"})]}),e.jsx(y,{variant:"outline",size:"icon",onClick:()=>v(!f),children:e.jsx(H,{className:"w-4 h-4"})})]}),f&&e.jsx("div",{className:"px-4 pb-4 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Sort by"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"distance",children:"Distance"}),e.jsx("option",{value:"time",children:"Time"}),e.jsx("option",{value:"players",children:"Players Needed"}),e.jsx("option",{value:"cost",children:"Cost"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Date"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Any time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"tomorrow",children:"Tomorrow"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]})]})]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:Y.map(s=>e.jsx(F,{variant:o===s.value?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>u(s.value),children:s.name},s.value))})})]}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx(y,{variant:h==="list"?"default":"outline",size:"sm",onClick:()=>N("list"),children:"List View"}),e.jsx(y,{variant:h==="map"?"default":"outline",size:"sm",onClick:()=>N("map"),children:"Map View"})]}),h==="list"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold",children:[a.length," games found"]}),x&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:['Results for "',x,'"']})]})}),e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsx(K,{game:s,onSelect:()=>b(s.id)},s.id))}),a.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(T,{className:"w-6 h-6 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No games found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search or filters"}),e.jsx(y,{variant:"outline",onClick:()=>{p(""),u("all")},children:"Clear filters"})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-card rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Games Near You"}),r?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-video bg-muted rounded-lg flex items-center justify-center",children:a.length>0?e.jsx("iframe",{src:`https://www.google.com/maps/embed/v1/view?key=AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ&center=${r.latitude},${r.longitude}&zoom=12&maptype=roadmap`,width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",className:"rounded-lg",title:"Games map view"}):e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(G,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:"No games with locations found"})]})}),e.jsxs("div",{className:"absolute top-2 right-2 bg-background/90 backdrop-blur-sm rounded-md px-2 py-1 text-xs",children:["ðŸ“ You â€¢ ðŸŽ® ",a.length," Games"]})]}):e.jsxs("div",{className:"w-full h-64 md:h-80 bg-muted rounded-lg flex flex-col items-center justify-center border",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Allow location access to see games on map"}),e.jsx(y,{onClick:d,variant:"outline",size:"sm",className:"mt-2",disabled:c,children:c?"Requesting...":"Enable Location"})]}),r&&a.length>0&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Games on Map"}),a.filter(s=>s.latitude&&s.longitude).slice(0,10).map((s,l)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>b(s.id),children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:l+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium truncate",children:s.title}),e.jsx(F,{variant:"secondary",className:"text-xs",children:s.sport})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),A(s.time)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),s.currentPlayers||0,"/",s.maxPlayers]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3"}),r&&s.latitude&&s.longitude?M(P(r.latitude,r.longitude,s.latitude,s.longitude)):"Distance unknown"]})]})]})]},s.id))]})]})})]})]})}export{ce as SearchDiscovery};
//# sourceMappingURL=SearchDiscovery-CiYU1Goh.js.map
