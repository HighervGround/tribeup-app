import{j as e,n as Re,T as Me,o as Fe,p as Ae,I as Te,q as We,r as Ge,s as ze,t as Ee,v as Oe,w as Le,O as Ue}from"./ui-CuzVkv4o.js";import{r as v}from"./vendor-Dit9F4CM.js";import{c as z,i as F,l as _e,C as D,f as M,g as G,B as f,a as I,U as Je,t as S,d as O,A as He,j as qe,k as Be,h as q,m as E,u as Ye,n as Ke,b as Qe,L as H,e as ce}from"./index-BhmEvnf0.js";import{S as ge}from"./separator-BdFlBBur.js";import{A as fe,a as je}from"./alert-B6VdC8pc.js";import{X as ve}from"./x-Dd8Yl6oO.js";import{I as P}from"./input-D8Dn2a7Q.js";import{T as B}from"./textarea-nGYdWCEA.js";import{I as Ve}from"./ImageWithFallback-Ba8Vz0S_.js";import{a as Ze,b as Xe}from"./useGames-B21QXS2f.js";import{C as we,u as et}from"./useGameJoinToggle-QoOJ0--0.js";import{u as tt}from"./useDeepLinks-CaF1FTbe.js";import{M as Y}from"./mail-CiwEl83t.js";import{M as K}from"./map-pin-qWmmcoik.js";import{C as ye}from"./calendar-ByY_J1PI.js";import{U as at}from"./users-e7lhM7WU.js";import{M as de}from"./message-square-CLKudnb6.js";import{u as st}from"./useAchievements-BpV83pk7.js";import{T as me}from"./trophy-BMHJBr5_.js";import{C as it}from"./circle-check-big-BG9IQvOc.js";import{S as Q}from"./star-CQjFtHc5.js";import{a as nt,b as rt}from"./dateUtils-But3d3jk.js";import{A as ot}from"./arrow-left-BIeGM35v.js";import{S as lt}from"./share-A9dqrc7L.js";import{T as ct}from"./trash-2-CnKfgkDf.js";import{F as dt}from"./flag-BgDXP6_C.js";import"./useMutation-BqTsTPA3.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],he=z("copy",mt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ut=z("dollar-sign",ht);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],pt=z("ellipsis-vertical",xt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ft=z("navigation",gt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],vt=z("pen-line",jt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],yt=z("phone",wt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],ue=z("share-2",Nt);function bt({...s}){return e.jsx(Re,{"data-slot":"dropdown-menu",...s})}function kt({...s}){return e.jsx(Me,{"data-slot":"dropdown-menu-trigger",...s})}function Ct({className:s,sideOffset:a=4,...r}){return e.jsx(Fe,{children:e.jsx(Ae,{"data-slot":"dropdown-menu-content",sideOffset:a,className:F("z-[99999] min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...r})})}function xe({className:s,inset:a,variant:r="default",...t}){return e.jsx(Te,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":r,className:F("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function V({...s}){return e.jsx(We,{"data-slot":"dialog",...s})}function St({...s}){return e.jsx(Le,{"data-slot":"dialog-portal",...s})}function $t({className:s,...a}){return e.jsx(Ue,{"data-slot":"dialog-overlay",className:F("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function Z({className:s,children:a,...r}){return e.jsxs(St,{"data-slot":"dialog-portal",children:[e.jsx($t,{}),e.jsxs(Ge,{"data-slot":"dialog-content",className:F("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...r,children:[a,e.jsxs(ze,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(ve,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function X({className:s,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:F("flex flex-col gap-2 text-center sm:text-left",s),...a})}function pe({className:s,...a}){return e.jsx("div",{"data-slot":"dialog-footer",className:F("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...a})}function ee({className:s,...a}){return e.jsx(Ee,{"data-slot":"dialog-title",className:F("text-lg leading-none font-semibold",s),...a})}function te({className:s,...a}){return e.jsx(Oe,{"data-slot":"dialog-description",className:F("text-muted-foreground text-sm",s),...a})}function Dt({isOpen:s,onClose:a,gameTitle:r,gameId:t,onJoinSuccess:g}){const{signUp:c,signInWithOAuth:d}=_e(),[u,p]=v.useState("signup"),[n,i]=v.useState({name:"",email:"",phone:""}),[m,l]=v.useState(!1),[b,j]=v.useState("");if(!s)return null;const C=async N=>{N.preventDefault(),l(!0),j("");try{await c(n.email,"temp-password-"+Date.now(),{name:n.name,email:n.email,phone:n.phone,pendingGameId:t}),p("verify"),S.success("Account created! Check your email to verify and join the game.")}catch(w){j(w.message)}finally{l(!1)}},$=async N=>{try{l(!0),await d(N,{pendingGameId:t}),S.success(`Signing in with ${N}...`),a()}catch(w){S.error(w.message||"Social login failed")}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(D,{className:"w-full max-w-md",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between",children:[e.jsx(G,{className:"text-lg",children:u==="signup"?`Join "${r}"`:"Check Your Email"}),e.jsx(f,{variant:"ghost",size:"icon",onClick:a,children:e.jsx(ve,{className:"w-4 h-4"})})]}),e.jsx(I,{children:u==="signup"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{variant:"outline",className:"w-full",onClick:()=>$("google"),disabled:m,children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),e.jsxs(f,{variant:"outline",className:"w-full",onClick:()=>$("apple"),disabled:m,children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"})}),"Continue with Apple"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with email"})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(P,{type:"text",placeholder:"Your name",value:n.name,onChange:N=>i(w=>({...w,name:N.target.value})),required:!0,className:"pl-10"}),e.jsx(Je,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{type:"email",placeholder:"Email address",value:n.email,onChange:N=>i(w=>({...w,email:N.target.value})),required:!0,className:"pl-10"}),e.jsx(Y,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{type:"tel",placeholder:"Phone (optional)",value:n.phone,onChange:N=>i(w=>({...w,phone:N.target.value})),className:"pl-10"}),e.jsx(yt,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),b&&e.jsx(fe,{variant:"destructive",children:e.jsx(je,{children:b})}),e.jsx(f,{type:"submit",className:"w-full",disabled:m,children:m?"Creating Account...":"Join Game"})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"By joining, you agree to our Terms of Service and Privacy Policy"})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(Y,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Check your email"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["We sent a verification link to ",e.jsx("strong",{children:n.email})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:['Click the link to verify your account and automatically join "',r,'"']})]}),e.jsx(f,{variant:"outline",onClick:a,className:"w-full",children:"Got it"})]})})]})})}function It({game:s,isOpen:a,onClose:r}){const[t,g]=v.useState(!1);if(!a)return null;const c=`${window.location.origin}/public/game/${s.id}`,d=`Join me for ${s.sport} at ${s.location} on ${s.date}!`,u=async()=>{try{await navigator.clipboard.writeText(c),g(!0),S.success("Link copied to clipboard!"),setTimeout(()=>g(!1),2e3)}catch{S.error("Failed to copy link")}},p=async()=>{if(navigator.share)try{await navigator.share({title:`Join ${s.title}`,text:d,url:c})}catch{}else u()},n=()=>{const l=encodeURIComponent(`Join me for ${s.sport}!`),b=encodeURIComponent(`
Hi!

I'm organizing a ${s.sport} game and would love for you to join:

üìç ${s.location}
üìÖ ${s.date} at ${s.time}
üí∞ ${s.cost||"Free"}
üë• ${s.currentPlayers}/${s.maxPlayers} players

${s.description?s.description+`

`:""}RSVP here: ${c}

Hope to see you there!
    `.trim());window.open(`mailto:?subject=${l}&body=${b}`)},i=()=>{const l=encodeURIComponent(`${d} RSVP: ${c}`);window.open(`sms:?body=${l}`)},m=()=>{const l=encodeURIComponent(`${d} RSVP: ${c}`);window.open(`https://wa.me/?text=${l}`)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(D,{className:"w-full max-w-md",children:[e.jsx(M,{children:e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5"}),"Share Game"]})}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:s.title}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(O,{variant:"secondary",children:s.sport})}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{children:s.date})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{children:s.time})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(at,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.currentPlayers,"/",s.maxPlayers," players"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Public RSVP Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{value:c,readOnly:!0,className:"flex-1"}),e.jsx(f,{variant:"outline",size:"sm",onClick:u,className:t?"bg-green-50 text-green-700":"",children:e.jsx(he,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Anyone with this link can view game details and RSVP"})]}),e.jsx(ge,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-3",children:"Share via"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(f,{variant:"outline",onClick:p,className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Share"]}),e.jsxs(f,{variant:"outline",onClick:n,className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Email"]}),e.jsxs(f,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"SMS"]}),e.jsxs(f,{variant:"outline",onClick:m,className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"WhatsApp"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"outline",onClick:r,className:"flex-1",children:"Close"}),e.jsxs(f,{onClick:u,className:"flex-1",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]})]})})}function Pt({isOpen:s,onClose:a,gameId:r,gameTitle:t,players:g}){const{checkForNewAchievements:c}=st(),[d,u]=v.useState("game"),[p,n]=v.useState(!1),[i,m]=v.useState({overall:0,organization:0,skillLevel:0,fun:0,reviewText:"",wouldPlayAgain:!0,recommendToOthers:!0}),[l,b]=v.useState(g.map(x=>({playerId:x.id,skill:0,sportsmanship:0,communication:0,feedback:""}))),j=({rating:x,onRatingChange:h,label:k})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:k}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(A=>e.jsx("button",{type:"button",onClick:()=>h(A),className:"p-1 hover:scale-110 transition-transform",children:e.jsx(Q,{className:`w-6 h-6 ${A<=x?"fill-yellow-400 text-yellow-400":"text-gray-300 hover:text-yellow-400"}`})},A))})]}),C=async()=>{if(i.overall===0){S.error("Please provide an overall rating");return}try{n(!0),await q.submitGameReview({gameId:r,overallRating:i.overall,organizationRating:i.organization||void 0,skillLevelRating:i.skillLevel||void 0,funRating:i.fun||void 0,reviewText:i.reviewText||void 0,wouldPlayAgain:i.wouldPlayAgain,recommendToOthers:i.recommendToOthers}),u("players")}catch(x){console.error("Failed to submit game rating:",x),S.error("Failed to submit rating. Please try again.")}finally{n(!1)}},$=async()=>{const x=l.filter(h=>h.skill>0&&h.sportsmanship>0&&h.communication>0);if(x.length===0){u("complete");return}try{n(!0),await Promise.all(x.map(h=>q.submitPlayerRating({gameId:r,ratedPlayerId:h.playerId,skillRating:h.skill,sportsmanshipRating:h.sportsmanship,communicationRating:h.communication,feedbackText:h.feedback||void 0}))),u("complete")}catch(h){console.error("Failed to submit player ratings:",h),S.error("Failed to submit player ratings. Please try again.")}finally{n(!1)}},N=async()=>{await c(),a()},w=(x,h,k)=>{b(A=>A.map(R=>R.playerId===x?{...R,[h]:k}:R))};return e.jsx(V,{open:s,onOpenChange:a,children:e.jsxs(Z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(X,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-primary"}),"Rate Your Experience"]}),e.jsxs(te,{children:["Help improve the community by rating ",t]})]}),d==="game"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"How was the game?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your feedback helps other players"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(j,{rating:i.overall,onRatingChange:x=>m(h=>({...h,overall:x})),label:"Overall Rating *"}),e.jsx(j,{rating:i.organization,onRatingChange:x=>m(h=>({...h,organization:x})),label:"Organization"}),e.jsx(j,{rating:i.skillLevel,onRatingChange:x=>m(h=>({...h,skillLevel:x})),label:"Skill Level Match"}),e.jsx(j,{rating:i.fun,onRatingChange:x=>m(h=>({...h,fun:x})),label:"Fun Factor"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Additional Comments"}),e.jsx(B,{placeholder:"Share your experience with other players...",value:i.reviewText,onChange:x=>m(h=>({...h,reviewText:x.target.value})),className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.wouldPlayAgain,onChange:x=>m(h=>({...h,wouldPlayAgain:x.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"I'd play again"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.recommendToOthers,onChange:x=>m(h=>({...h,recommendToOthers:x.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Recommend to others"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"outline",onClick:a,className:"flex-1",children:"Skip"}),e.jsx(f,{onClick:C,disabled:p||i.overall===0,className:"flex-1",children:p?"Submitting...":"Next: Rate Players"})]})]}),d==="players"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Rate Your Fellow Players"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Optional but helps build a better community"})]}),e.jsx("div",{className:"space-y-6",children:g.map(x=>{const h=l.find(k=>k.playerId===x.id);return h?e.jsxs(D,{children:[e.jsx(M,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(He,{children:[x.avatar&&e.jsx(qe,{src:x.avatar,alt:x.name}),e.jsx(Be,{children:x.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:x.name}),x.isHost&&e.jsx(O,{variant:"secondary",className:"text-xs",children:"Host"})]})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(j,{rating:h.skill,onRatingChange:k=>w(x.id,"skill",k),label:"Skill Level"}),e.jsx(j,{rating:h.sportsmanship,onRatingChange:k=>w(x.id,"sportsmanship",k),label:"Sportsmanship"}),e.jsx(j,{rating:h.communication,onRatingChange:k=>w(x.id,"communication",k),label:"Communication"})]}),e.jsx(B,{placeholder:"Optional feedback for this player...",value:h.feedback,onChange:k=>w(x.id,"feedback",k.target.value),className:"min-h-[60px]"})]})]},x.id):null})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"outline",onClick:()=>u("complete"),className:"flex-1",children:"Skip Player Ratings"}),e.jsx(f,{onClick:$,disabled:p,className:"flex-1",children:p?"Submitting...":"Submit Ratings"})]})]}),d==="complete"&&e.jsxs("div",{className:"text-center space-y-6 py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(it,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Thanks for your feedback!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your ratings help make TribeUp better for everyone"})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(me,{className:"w-4 h-4"}),e.jsx("span",{children:"Check your profile for any new achievements!"})]})}),e.jsx(f,{onClick:N,className:"w-full",children:"Done"})]})]})})}class U{static API_KEY=E.get("openWeatherApiKey");static BASE_URL="https://api.openweathermap.org/data/2.5";static CONFIG={temperatureUnit:E.get("weatherTempUnit"),updateInterval:E.get("weatherUpdateInterval"),includeHourlyForecast:E.get("weatherIncludeHourly"),rainThreshold:E.get("weatherRainThreshold"),windThreshold:E.get("weatherWindThreshold")};static async getCurrentWeather(a,r){if(!this.API_KEY)return console.warn("Weather API key not configured, using mock data"),this.getMockWeatherData();try{const t=await fetch(`${this.BASE_URL}/weather?lat=${a}&lon=${r}&appid=${this.API_KEY}&units=imperial`);if(!t.ok)throw new Error(`Weather API error: ${t.status}`);const g=await t.json();return this.transformWeatherData(g)}catch(t){return console.error("Error fetching weather:",t),this.getMockWeatherData()}}static async getGameWeather(a,r,t){if(!this.API_KEY)return console.warn("Weather API key not configured, using mock data"),this.getMockWeatherData();try{const g=parseFloat(a.toFixed(6)),c=parseFloat(r.toFixed(6));console.log(`üå§Ô∏è Fetching weather for coordinates: ${g}, ${c}`),console.log(`üïê Game time: ${t.toISOString()}`);const d=await fetch(`${this.BASE_URL}/forecast?lat=${g}&lon=${c}&appid=${this.API_KEY}&units=imperial`);if(!d.ok)return console.error(`Weather API error: ${d.status} ${d.statusText}`),await this.getCurrentWeather(g,c);const u=await d.json();if(!u.list||u.list.length===0)return console.warn("No forecast data available, falling back to current weather"),await this.getCurrentWeather(g,c);console.log(`üìä Received ${u.list.length} forecast entries`);const p=t.getTime(),n=p-2*60*60*1e3,i=p+2*60*60*1e3;console.log(`üïê Weather window: ${new Date(n).toISOString()} to ${new Date(i).toISOString()}`);const m=u.list.filter(j=>{const C=j.dt*1e3;return C>=n&&C<=i});console.log(`üìà Found ${m.length} forecasts in 4-hour window`);let l;m.length>0?(l=m.reduce((j,C)=>{const $=Math.abs(C.dt*1e3-p),N=Math.abs(j.dt*1e3-p);return $<N?C:j}),console.log(`üéØ Selected forecast: ${new Date(l.dt*1e3).toISOString()}`)):(l=u.list.reduce((j,C)=>{const $=Math.abs(C.dt*1e3-p),N=Math.abs(j.dt*1e3-p);return $<N?C:j}),console.log(`‚ö†Ô∏è No forecasts in window, using closest: ${new Date(l.dt*1e3).toISOString()}`));const b=this.analyzeWeatherWindow(m,l);return this.transformWeatherData(l,b)}catch(g){return console.error("Error fetching game weather:",g),this.getMockWeatherData()}}static async getWeatherByZipcode(a,r){if(!this.API_KEY)return console.warn("Weather API key not configured, using mock data"),this.getMockWeatherData();try{console.log(`üå§Ô∏è Fetching weather for zipcode: ${a}`),console.log(`üïê Game time: ${r.toISOString()}`);const t=await fetch(`${this.BASE_URL}/forecast?zip=${a},US&appid=${this.API_KEY}&units=imperial`);if(!t.ok)throw new Error(`Weather API error: ${t.status}`);const g=await t.json();console.log(`üìä Received ${g.list.length} forecast entries for ${a}`);const c=r.getTime(),d=c-2*60*60*1e3,u=c+2*60*60*1e3;console.log(`üïê Weather window: ${new Date(d).toISOString()} to ${new Date(u).toISOString()}`);const p=g.list.filter(m=>{const l=m.dt*1e3;return l>=d&&l<=u});console.log(`üìà Found ${p.length} forecasts in 4-hour window`);let n;p.length>0?(n=p.reduce((m,l)=>{const b=Math.abs(l.dt*1e3-c),j=Math.abs(m.dt*1e3-c);return b<j?l:m}),console.log(`üéØ Selected forecast: ${new Date(n.dt*1e3).toISOString()}`)):(n=g.list.reduce((m,l)=>{const b=Math.abs(l.dt*1e3-c),j=Math.abs(m.dt*1e3-c);return b<j?l:m}),console.log(`‚ö†Ô∏è No forecasts in window, using closest: ${new Date(n.dt*1e3).toISOString()}`));const i=this.analyzeWeatherWindow(p,n);return this.transformWeatherData(n,i)}catch(t){return console.error("Error fetching weather by zipcode:",t),null}}static extractZipcode(a){const r=a.match(/\b(\d{5}(?:-\d{4})?)\b/);return r?r[1].split("-")[0]:null}static analyzeWeatherWindow(a,r){if(a.length===0)return{alerts:[],windowSummary:""};const t=a.map(l=>l.main.temp),g=a.map(l=>l.weather[0].main),c=a.map(l=>l.rain?.["3h"]||l.snow?.["3h"]||0),d=Math.min(...t),u=Math.max(...t);t.reduce((l,b)=>l+b,0)/t.length;const p=Math.max(...c),n=[];let i="";u-d>10&&n.push(`üå°Ô∏è Temperature will vary ${Math.round(d)}¬∞F to ${Math.round(u)}¬∞F during game time`),p>.1&&n.push("üåßÔ∏è Possible precipitation during game window");const m=[...new Set(g)];return m.length>1&&n.push(`üå§Ô∏è Weather conditions may change: ${m.join(", ")}`),a.length>1&&(i=`4-hour forecast: ${Math.round(d)}-${Math.round(u)}¬∞F, ${m.join("/")}`),{alerts:n,windowSummary:i}}static transformWeatherData(a,r){const t=Math.round(a.main.temp),g=a.weather[0].main,c=a.weather[0].description,d=a.rain?.["1h"]||a.snow?.["1h"]||0,u=this.generateWeatherAlerts(g,t,d,a.wind.speed),p=r?[...u,...r.alerts]:u,n=r?.windowSummary||this.capitalizeWords(c);return{temperature:t,condition:g,description:n,humidity:a.main.humidity,windSpeed:Math.round(a.wind.speed),precipitation:d,icon:this.getWeatherIcon(g),isOutdoorFriendly:this.isOutdoorFriendly(g,t,d,a.wind.speed),alerts:p}}static isOutdoorFriendly(a,r,t,g){return!(r<40||r>95||t>this.CONFIG.rainThreshold||g>this.CONFIG.windThreshold||["Thunderstorm","Tornado","Squall"].includes(a))}static generateWeatherAlerts(a,r,t,g){const c=[];return r<50?c.push("üß• Dress warmly - temperature below 50¬∞F"):r>85&&c.push("‚òÄÔ∏è Stay hydrated - high temperature expected"),t>this.CONFIG.rainThreshold&&c.push("üåßÔ∏è Rain expected - consider indoor backup plan"),g>12&&c.push("üí® Windy conditions - secure loose items"),a==="Thunderstorm"&&c.push("‚ö° Thunderstorm warning - move indoors immediately"),c}static getWeatherIcon(a){return{Clear:"‚òÄÔ∏è",Clouds:"‚òÅÔ∏è",Rain:"üåßÔ∏è",Drizzle:"üå¶Ô∏è",Thunderstorm:"‚õàÔ∏è",Snow:"‚ùÑÔ∏è",Mist:"üå´Ô∏è",Fog:"üå´Ô∏è",Haze:"üå´Ô∏è"}[a]||"üå§Ô∏è"}static capitalizeWords(a){return a.replace(/\b\w/g,r=>r.toUpperCase())}static getMockWeatherData(){return{temperature:72,condition:"Clear",description:"Clear Sky",humidity:65,windSpeed:8,precipitation:0,icon:"‚òÄÔ∏è",isOutdoorFriendly:!0,alerts:[]}}static isConfigured(){return!!this.API_KEY&&this.API_KEY.length>0}static getWeatherRecommendation(a){return a.isOutdoorFriendly?a.temperature<60?"Cool weather - dress in layers and bring warm clothing.":a.temperature>80?"Warm weather - bring water and sun protection.":"Great weather for outdoor activities!":"Weather conditions may not be ideal for outdoor activities. Consider rescheduling or moving indoors."}}function Rt({game:s}){const[a,r]=v.useState(null),[t,g]=v.useState(!0);return v.useEffect(()=>{(async()=>{console.log("üå§Ô∏è Getting weather data for game:",s.id),console.log("üìç Coordinates:",s.latitude,s.longitude),console.log("üìç Location:",s.location);try{let d=null;const u=new Date(`${s.date} ${s.time}`);if(s.latitude&&s.longitude)console.log("üéØ Using exact coordinates for weather"),d=await U.getGameWeather(s.latitude,s.longitude,u);else if(s.location){console.log("üó∫Ô∏è Using Google Maps geocoding for weather (same as map)");const p="AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ";try{const n=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(s.location)}&key=${p}`);if(n.ok){const i=await n.json();if(console.log("üó∫Ô∏è Google geocoding results:",i),i.status==="OK"&&i.results&&i.results.length>0){const{lat:m,lng:l}=i.results[0].geometry.location;console.log("üéØ Using Google Maps coordinates for weather:",m,l),d=await U.getGameWeather(m,l,u),console.log("‚úÖ Weather from Google Maps coordinates:",d)}else console.warn("üó∫Ô∏è Google geocoding failed:",i.status,i.error_message)}else console.error("üó∫Ô∏è Google geocoding HTTP error:",n.status,n.statusText)}catch(n){console.error("‚ùå Google Maps geocoding failed:",n)}if(!d){const n=U.extractZipcode(s.location);n&&(console.log("üìÆ Fallback: Using zipcode for weather:",n),d=await U.getWeatherByZipcode(n,u))}if(!d){console.log("üå§Ô∏è Final fallback: Simple weather search");const n=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(s.location)}&appid=***REMOVED***&units=imperial`);if(n.ok){const i=await n.json();d={temperature:Math.round(i.main.temp),condition:i.weather[0].main,description:i.weather[0].description,humidity:i.main.humidity,windSpeed:Math.round(i.wind.speed),precipitation:i.rain?.["1h"]||i.snow?.["1h"]||0,icon:i.weather[0].main==="Clear"?"‚òÄÔ∏è":i.weather[0].main==="Clouds"?"‚òÅÔ∏è":i.weather[0].main==="Rain"?"üåßÔ∏è":"üå§Ô∏è",isOutdoorFriendly:!0,alerts:[]}}}}if(d)console.log("‚úÖ Weather data received:",d),r(d);else throw new Error("No weather data available")}catch(d){console.error("‚ùå Weather error:",d);try{console.log("üîÑ Final attempt: Using current weather API");const u=await fetch("https://api.openweathermap.org/data/2.5/weather?zip=10001,US&appid=***REMOVED***&units=imperial");if(u.ok){const p=await u.json(),n=Math.round(p.main.temp),i=p.weather[0].main,m=p.weather[0].description;r({temperature:n,condition:i,description:`${m.charAt(0).toUpperCase()+m.slice(1)} (nearby area)`,humidity:p.main.humidity,windSpeed:Math.round(p.wind.speed),precipitation:p.rain?.["1h"]||p.snow?.["1h"]||0,icon:i==="Clear"?"‚òÄÔ∏è":i==="Clouds"?"‚òÅÔ∏è":i==="Rain"?"üåßÔ∏è":"üå§Ô∏è",isOutdoorFriendly:n>40&&n<95,alerts:[`üìç Showing weather for nearby area - actual conditions at ${s.location||"game location"} may vary`]})}else throw new Error("Fallback weather failed")}catch(u){console.error("‚ùå All weather sources failed:",u),r({temperature:72,condition:"Clear",description:"Weather data temporarily unavailable",humidity:65,windSpeed:8,precipitation:0,icon:"üå§Ô∏è",isOutdoorFriendly:!0,alerts:[`üîÑ Weather service temporarily unavailable for ${s.location||"this location"}`]})}}g(!1)})()},[s.latitude,s.longitude,s.location,s.date,s.time]),t?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading weather..."}):a?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[a.temperature,"¬∞F"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.description})]})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Humidity: ",a.humidity,"%"]}),e.jsxs("div",{children:["Wind: ",a.windSpeed," mph"]})]})]}),a.alerts&&a.alerts.length>0&&e.jsx("div",{className:"space-y-1",children:a.alerts.map((c,d)=>e.jsx("div",{className:"text-xs bg-yellow-50 text-yellow-800 p-2 rounded",children:c},d))}),e.jsx("div",{className:"text-xs text-muted-foreground",children:U.getWeatherRecommendation(a)})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"Weather unavailable"})}function na(){const s=Ye(),{gameId:a}=Ke(),{user:r}=Qe(),{data:t,isLoading:g}=Ze(a||""),{data:c=[],isLoading:d}=Xe(a||""),{toggleJoin:u,isLoading:p,getButtonText:n}=et(),{navigateToUser:i}=tt(),[m,l]=v.useState(!1),[b,j]=v.useState(!1),[C,$]=v.useState(!1),[N,w]=v.useState(!1),[x,h]=v.useState(!1),[k,A]=v.useState(!1),[R,_]=v.useState(!1),[T,W]=v.useState({title:"",description:"",location:"",duration:60,maxPlayers:0,cost:""}),[ae,Ne]=v.useState(""),J=v.useMemo(()=>!c||!t?[]:c.map(o=>({...o,isHost:o.id===t?.creator_id})),[c,t?.creator_id]),se=v.useMemo(()=>t?nt(t.date,t.time):{label:"",aria:""},[t?.date,t?.time]),ie=v.useMemo(()=>t?rt(t.date,t.time):{date:"",time:""},[t?.date,t?.time]),ne=t?t.currentPlayers>=t.maxPlayers:!1,re=t?t.tags:void 0,L=r&&t&&(t.creatorId===r.id||t.createdBy===r.id);if(console.log("üîç Dropdown Debug:",{user:r?.id,game:t?.id,creatorId:t?.creatorId,createdBy:t?.createdBy,isGameCreator:L,shouldShowDropdown:L}),v.useMemo(()=>t?new Date(`${t.date} ${t.time}`)<new Date:!1,[t?.date,t?.time]),v.useMemo(()=>!r||!t?!1:t.isJoined||L,[r,t?.isJoined,L]),g)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(H,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading game details..."})]})});if(!t)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl mb-4",children:"Game not found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The game you're looking for doesn't exist or has been removed."}),e.jsx(f,{onClick:()=>s("/"),children:"Go Home"})]})});const be=async()=>{if(!p){if(!r){j(!0);return}u(t)}},ke=async()=>{j(!1),a&&t&&u(t)},Ce=()=>{s(-1)},Se=async()=>{$(!0)},$e=()=>{const o=t.location||"Location not specified",y=encodeURIComponent(o),oe=`https://maps.google.com/maps?q=${y}&t=m&z=16`;try{if(navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/)){const le=`maps://maps.google.com/maps?q=${y}`;window.location.href=le,setTimeout(()=>{window.open(oe,"_blank")},1e3)}else window.open(oe,"_blank");S.success("Opening directions...")}catch{S.error("Failed to open directions")}},De=()=>{W({title:t.title,description:t.description,location:t.location,duration:t.duration||60,maxPlayers:t.maxPlayers,cost:t.cost}),w(!0)},Ie=async()=>{if(a){_(!0);try{await q.updateGame(a,T),S.success("Game updated successfully"),w(!1),window.location.reload()}catch(o){S.error("Failed to update game",{description:o.message||"Please try again later"})}finally{_(!1)}}},Pe=async()=>{if(a){_(!0);try{await q.deleteGame(a,ae),S.success("Game cancelled successfully"),h(!1),s("/")}catch(o){S.error("Failed to cancel game",{description:o.message||"Please try again later"})}finally{_(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"sticky top-0 bg-background/95 backdrop-blur-sm border-b border-border z-10",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:Ce,"aria-label":"Go back",children:e.jsx(ot,{className:"w-5 h-5"})}),e.jsxs("div",{role:"text","aria-label":`Event: ${t.title}. ${se.aria}`,children:[e.jsx("h1",{className:"text-xl font-semibold line-clamp-2",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:se.label})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:Se,"data-action":"share","aria-label":"Share game",title:"Share game (U)",children:e.jsx(lt,{className:"w-5 h-5"})}),e.jsxs(bt,{onOpenChange:o=>console.log("Dropdown open state:",o),children:[e.jsx(kt,{asChild:!0,children:e.jsx("div",{children:e.jsx(f,{variant:"ghost",size:"icon","aria-label":"Game options",onClick:o=>{console.log("Dropdown trigger clicked",o),o.stopPropagation()},style:{display:L?"flex":"none"},children:e.jsx(pt,{className:"w-5 h-5"})})})}),e.jsxs(Ct,{align:"end",className:"z-[99999] relative",children:[e.jsxs(xe,{onClick:o=>{console.log("Edit game clicked"),o.stopPropagation(),De()},children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Edit Game"]}),e.jsxs(xe,{onClick:o=>{console.log("Delete game clicked"),o.stopPropagation(),h(!0)},className:"text-destructive focus:text-destructive",children:[e.jsx(ct,{className:"w-4 h-4 mr-2"}),"Cancel Game"]})]})]}),e.jsx(f,{variant:"ghost",size:"icon","aria-label":"Report game",children:e.jsx(dt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"px-4 py-6 space-y-6",id:"main-content",children:[e.jsxs(D,{children:[t.imageUrl&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-video overflow-hidden rounded-t-lg",children:e.jsx(Ve,{src:t.imageUrl,alt:`${t.sport} game`,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(O,{className:`${t.sportColor} text-white border-none`,children:t.sport})})]}),!t.imageUrl&&e.jsx("div",{className:"p-4 border-b",children:e.jsx(O,{className:`${t.sportColor} text-white border-none`,children:t.sport})}),e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:ie.date}),e.jsx("div",{className:"text-sm text-muted-foreground",children:ie.time})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(we,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:"2 hours"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Duration"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:t.cost}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cost"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:Array.isArray(re)&&re.map(o=>e.jsx(O,{variant:"secondary",children:o},o))}),e.jsx(f,{onClick:be,disabled:!t.isJoined&&ne||p,className:"w-full h-12",variant:t.isJoined?"outline":"default","data-action":"join-game",title:`${t.isJoined?"Leave":"Join"} game (J)`,children:p?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2 animate-spin"}),t.isJoined?"Leaving...":"Joining..."]}):ne&&!t.isJoined?"Game is Full":r?n(t):"Join Game - Sign Up"})]})]}),e.jsxs(D,{children:[e.jsx(M,{children:e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),"Location"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("div",{children:t.location})}),e.jsx("div",{className:"aspect-video bg-muted rounded-lg flex items-center justify-center",children:t.latitude&&t.longitude||t.location?e.jsx("iframe",{src:`https://www.google.com/maps/embed/v1/place?key=AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ&q=${t.latitude&&t.longitude?`${t.latitude},${t.longitude}`:encodeURIComponent(t.location)}&zoom=15`,width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",className:"rounded-lg",title:"Game location map"}):e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(K,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:"Map not available"})]})}),e.jsxs(f,{variant:"outline",className:"w-full",onClick:$e,"data-action":"directions",title:"Get directions (L)",children:[e.jsx(ft,{className:"w-4 h-4 mr-2"}),"Get Directions"]})]})})]}),(t.latitude&&t.longitude||t.location)&&e.jsxs(D,{children:[e.jsx(M,{children:e.jsx(G,{className:"flex items-center gap-2",children:"‚òÄÔ∏è Weather Forecast"})}),e.jsx(I,{children:e.jsx(Rt,{game:t})})]}),e.jsxs(D,{children:[e.jsx(M,{children:e.jsx(G,{children:"About This Game"})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:`text-sm leading-relaxed ${m?"":"line-clamp-3"}`,children:t.description}),t.description.length>150&&e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>l(!m),className:"p-0 h-auto",children:m?"Show less":"Show more"}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Requirements"}),e.jsx("ul",{className:"space-y-1",children:["Athletic shoes required","Bring water bottle","No experience necessary"].map((o,y)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"w-1 h-1 bg-muted-foreground rounded-full mt-2 flex-shrink-0"}),o]},y))})]})]})})]}),e.jsxs(D,{children:[e.jsx(M,{children:e.jsx(G,{children:"Game Host"})}),e.jsx(I,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{userId:t.creatorId||t.creatorData?.id,src:t.creatorData?.avatar,alt:t.creatorData?.name||t.createdBy||"Unknown",size:"md"}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>i(t.creatorId||t.creatorData?.id),className:"hover:text-primary transition-colors cursor-pointer font-medium","data-action":"view-profile",children:t.creatorData?.name||t.createdBy||"Unknown"}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Q,{className:"w-3 h-3 fill-current text-warning"}),t.creatorData?.rating||"4.5"]})]})]})})})})]}),e.jsxs(D,{children:[e.jsx(M,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(G,{children:["Players (",J.length,"/",t.maxPlayers,")"]})})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-3",children:J.map((o,y)=>e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{userId:o.id,src:o.avatar,alt:o.name,size:"md"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{console.log("üîç Clicking on player:",o),i(o.id)},className:"hover:text-primary transition-colors cursor-pointer font-medium","data-action":"view-profile",children:o.name}),o.isHost&&e.jsx(O,{variant:"secondary",className:"text-xs px-2 py-0",children:"Host"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Q,{className:"w-3 h-3 fill-current text-warning"}),o.rating]})]})]})}),y<J.length-1&&e.jsx(ge,{className:"mt-3"})]},o.id))})})]}),t.isJoined&&e.jsx(fe,{className:"border-success text-success-foreground",children:e.jsx(je,{children:"You're joined! See you on the field!"})})]}),e.jsx(Dt,{isOpen:b,onClose:()=>j(!1),gameTitle:t.title,gameId:t.id,onJoinSuccess:ke}),e.jsx(It,{isOpen:C,onClose:()=>$(!1),game:t}),e.jsx(V,{open:N,onOpenChange:w,children:e.jsxs(Z,{className:"sm:max-w-[425px]",children:[e.jsxs(X,{children:[e.jsx(ee,{children:"Edit Game"}),e.jsx(te,{children:"Make changes to your game. Participants will be notified of any updates."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-title",className:"text-sm font-medium",children:"Title"}),e.jsx(P,{id:"edit-title",value:T.title,onChange:o=>W(y=>({...y,title:o.target.value})),placeholder:"Game title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-description",className:"text-sm font-medium",children:"Description"}),e.jsx(B,{id:"edit-description",value:T.description,onChange:o=>W(y=>({...y,description:o.target.value})),placeholder:"Game description",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-location",className:"text-sm font-medium",children:"Location"}),e.jsx(P,{id:"edit-location",value:T.location,onChange:o=>W(y=>({...y,location:o.target.value})),placeholder:"Game location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-duration",className:"text-sm font-medium",children:"Duration (minutes)"}),e.jsx(P,{id:"edit-duration",type:"number",min:"15",max:"480",value:T.duration,onChange:o=>W(y=>({...y,duration:parseInt(o.target.value)||60})),placeholder:"60"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-maxPlayers",className:"text-sm font-medium",children:"Max Players"}),e.jsx(P,{id:"edit-maxPlayers",type:"number",min:"2",max:"50",value:T.maxPlayers,onChange:o=>W(y=>({...y,maxPlayers:parseInt(o.target.value)||0}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-cost",className:"text-sm font-medium",children:"Cost"}),e.jsx(P,{id:"edit-cost",value:T.cost,onChange:o=>W(y=>({...y,cost:o.target.value})),placeholder:"FREE or $10"})]})]})]}),e.jsxs(pe,{children:[e.jsx(f,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(f,{onClick:Ie,disabled:R,children:R?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})}),e.jsx(V,{open:x,onOpenChange:h,children:e.jsxs(Z,{className:"sm:max-w-[425px]",children:[e.jsxs(X,{children:[e.jsx(ee,{children:"Cancel Game"}),e.jsx(te,{children:"This action cannot be undone. All participants will be notified of the cancellation."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"delete-reason",className:"text-sm font-medium",children:"Reason for cancellation (optional)"}),e.jsx(B,{id:"delete-reason",value:ae,onChange:o=>Ne(o.target.value),placeholder:"Let participants know why the game is cancelled...",rows:3})]})}),e.jsxs(pe,{children:[e.jsx(f,{variant:"outline",onClick:()=>h(!1),children:"Keep Game"}),e.jsx(f,{variant:"destructive",onClick:Pe,disabled:R,children:R?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2 animate-spin"}),"Cancelling..."]}):"Cancel Game"})]})]})}),e.jsx(Pt,{isOpen:k,onClose:()=>A(!1),gameId:a,gameTitle:t?.title||"",players:J})]})}export{na as default};
//# sourceMappingURL=GameDetails-fsG2bgrt.js.map
