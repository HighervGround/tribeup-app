{"version":3,"file":"AuthCallback-CTTmS7rq.js","sources":["../../src/pages/AuthCallback.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '../lib/supabase';\nimport { toast } from 'sonner';\nimport { Loader2 } from 'lucide-react';\n\nexport function AuthCallback() {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const handleAuthCallback = async () => {\n      try {\n        console.log('[AuthCallback] Processing OAuth callback...');\n        \n        // First, handle the OAuth callback with Supabase\n        const { data, error } = await supabase.auth.getSession();\n        \n        if (error) {\n          console.error('[AuthCallback] Session error:', error);\n          toast.error('Authentication failed');\n          navigate('/auth', { replace: true });\n          return;\n        }\n\n        if (data.session) {\n          console.log('[AuthCallback] Session found, user authenticated');\n          \n          // Add a small delay to ensure auth state is fully processed\n          setTimeout(() => {\n            // Check for pending game join\n            const pendingGameId = localStorage.getItem('pendingGameJoin');\n            if (pendingGameId) {\n              console.log('[AuthCallback] Redirecting to pending game:', pendingGameId);\n              localStorage.removeItem('pendingGameJoin');\n              navigate(`/game/${pendingGameId}`, { replace: true });\n            } else {\n              console.log('[AuthCallback] Redirecting to home');\n              navigate('/', { replace: true });\n            }\n          }, 1000);\n        } else {\n          console.log('[AuthCallback] No session found');\n          navigate('/auth', { replace: true });\n        }\n      } catch (error) {\n        console.error('[AuthCallback] Unexpected error:', error);\n        toast.error('Authentication failed');\n        navigate('/auth', { replace: true });\n      }\n    };\n\n    // Add timeout to prevent infinite loading\n    const timeoutId = setTimeout(() => {\n      console.error('[AuthCallback] Timeout - redirecting to auth');\n      toast.error('Authentication timed out');\n      navigate('/auth', { replace: true });\n    }, 10000); // 10 second timeout\n\n    handleAuthCallback().finally(() => {\n      clearTimeout(timeoutId);\n    });\n\n    return () => clearTimeout(timeoutId);\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center\">\n      <div className=\"text-center space-y-4\">\n        <Loader2 className=\"w-8 h-8 animate-spin mx-auto\" />\n        <h2 className=\"text-xl font-semibold\">Completing sign in...</h2>\n        <p className=\"text-muted-foreground\">Please wait while we set up your account</p>\n      </div>\n    </div>\n  );\n}\n"],"names":["AuthCallback","navigate","useNavigate","useEffect","handleAuthCallback","data","error","supabase","toast","pendingGameId","timeoutId","jsxs","jsx","Loader2"],"mappings":"2IAMO,SAASA,GAAe,CAC7B,MAAMC,EAAWC,EAAA,EAEjBC,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAqB,SAAY,CACrC,GAAI,CACF,QAAQ,IAAI,6CAA6C,EAGzD,KAAM,CAAE,KAAAC,EAAM,MAAAC,CAAA,EAAU,MAAMC,EAAS,KAAK,WAAA,EAE5C,GAAID,EAAO,CACT,QAAQ,MAAM,gCAAiCA,CAAK,EACpDE,EAAM,MAAM,uBAAuB,EACnCP,EAAS,QAAS,CAAE,QAAS,EAAA,CAAM,EACnC,MACF,CAEII,EAAK,SACP,QAAQ,IAAI,kDAAkD,EAG9D,WAAW,IAAM,CAEf,MAAMI,EAAgB,aAAa,QAAQ,iBAAiB,EACxDA,GACF,QAAQ,IAAI,8CAA+CA,CAAa,EACxE,aAAa,WAAW,iBAAiB,EACzCR,EAAS,SAASQ,CAAa,GAAI,CAAE,QAAS,GAAM,IAEpD,QAAQ,IAAI,oCAAoC,EAChDR,EAAS,IAAK,CAAE,QAAS,EAAA,CAAM,EAEnC,EAAG,GAAI,IAEP,QAAQ,IAAI,iCAAiC,EAC7CA,EAAS,QAAS,CAAE,QAAS,EAAA,CAAM,EAEvC,OAASK,EAAO,CACd,QAAQ,MAAM,mCAAoCA,CAAK,EACvDE,EAAM,MAAM,uBAAuB,EACnCP,EAAS,QAAS,CAAE,QAAS,EAAA,CAAM,CACrC,CACF,EAGMS,EAAY,WAAW,IAAM,CACjC,QAAQ,MAAM,8CAA8C,EAC5DF,EAAM,MAAM,0BAA0B,EACtCP,EAAS,QAAS,CAAE,QAAS,EAAA,CAAM,CACrC,EAAG,GAAK,EAER,OAAAG,EAAA,EAAqB,QAAQ,IAAM,CACjC,aAAaM,CAAS,CACxB,CAAC,EAEM,IAAM,aAAaA,CAAS,CACrC,EAAG,CAACT,CAAQ,CAAC,QAGV,MAAA,CAAI,UAAU,8DACb,SAAAU,EAAAA,KAAC,MAAA,CAAI,UAAU,wBACb,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAQ,UAAU,8BAAA,CAA+B,EAClDD,EAAAA,IAAC,KAAA,CAAG,UAAU,wBAAwB,SAAA,wBAAqB,EAC3DA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,0CAAA,CAAwC,CAAA,CAAA,CAC/E,CAAA,CACF,CAEJ"}