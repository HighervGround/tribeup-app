{"version":3,"file":"Auth-CfIbqBVa.js","sources":["../../src/components/Auth.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Alert, AlertDescription } from './ui/alert';\nimport { useAuth } from '../providers/AuthProvider';\nimport { toast } from 'sonner';\nimport { Apple, Chrome } from 'lucide-react';\n\nfunction Auth() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { signIn, signUp, resetPassword, signInWithOAuth } = useAuth();\n  \n  const [isSignUp, setIsSignUp] = useState(false);\n  const [isResetPassword, setIsResetPassword] = useState(false);\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [name, setName] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n\n  // Check if we're coming from a password reset\n  useEffect(() => {\n    const params = new URLSearchParams(location.search);\n    if (params.get('reset') === 'true') {\n      setIsResetPassword(true);\n    }\n  }, [location]);\n\n  const handleAuth = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    setSuccess('');\n\n    try {\n      if (isResetPassword) {\n        await resetPassword(email);\n        setSuccess('Password reset email sent! Check your inbox.');\n        setIsResetPassword(false);\n      } else if (isSignUp) {\n        await signUp(email, password, { name, email });\n        setSuccess('Check your email for confirmation link!');\n      } else {\n        await signIn(email, password);\n        // Navigation will be handled by AuthProvider\n      }\n    } catch (error: any) {\n      setError(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleOAuthSignIn = async (provider: 'google' | 'apple') => {\n    setLoading(true);\n    setError('');\n    \n    // Set a timeout to reset loading state if OAuth doesn't complete\n    const timeoutId = setTimeout(() => {\n      setLoading(false);\n      setError('OAuth sign-in timed out. Please try again or use email sign-in.');\n    }, 30000); // 30 second timeout\n    \n    try {\n      await signInWithOAuth(provider);\n      // OAuth should redirect to callback, but if it doesn't work, the timeout will handle it\n    } catch (error: any) {\n      clearTimeout(timeoutId);\n      console.error(`OAuth sign-in error for ${provider}:`, error);\n      \n      // Provide more user-friendly error messages\n      if (error.message?.includes('popup')) {\n        setError('Authentication popup was blocked. Please allow popups and try again.');\n      } else if (error.message?.includes('network') || error.message?.includes('fetch')) {\n        setError('Network error during authentication. Please check your connection and try again.');\n      } else if (error.message?.includes('redirect')) {\n        setError('OAuth redirect failed. Please try again or use email sign-in.');\n      } else {\n        setError(`Authentication failed: ${error.message || 'Unknown error'}. Please try again or use email sign-in.`);\n      }\n      setLoading(false);\n    }\n    \n    // Clear timeout on component unmount\n    return () => clearTimeout(timeoutId);\n  };\n\n  const handleBackToSignIn = () => {\n    setIsSignUp(false);\n    setIsResetPassword(false);\n    setError('');\n    setSuccess('');\n  };\n\n  const getTitle = () => {\n    if (isResetPassword) return 'Reset Password';\n    return isSignUp ? 'Create Account' : 'Sign In';\n  };\n\n  const getButtonText = () => {\n    if (loading) return 'Loading...';\n    if (isResetPassword) return 'Send Reset Email';\n    return isSignUp ? 'Sign Up' : 'Sign In';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader>\n          <CardTitle className=\"text-center\">{getTitle()}</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {!isResetPassword && (\n            <>\n              <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => handleOAuthSignIn('google')}\n                  disabled={loading}\n                  className=\"w-full\"\n                >\n                  <Chrome className=\"mr-2 h-4 w-4\" />\n                  Google\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => handleOAuthSignIn('apple')}\n                  disabled={loading}\n                  className=\"w-full\"\n                >\n                  <Apple className=\"mr-2 h-4 w-4\" />\n                  Apple\n                </Button>\n              </div>\n              \n              <div className=\"text-xs text-muted-foreground text-center mb-4\">\n                Note: You may see browser warnings during OAuth sign-in. These are from external services and don't affect your account security.\n              </div>\n\n              <div className=\"relative my-6\">\n                <div className=\"absolute inset-0 flex items-center\">\n                  <span className=\"w-full border-t\" />\n                </div>\n                <div className=\"relative flex justify-center text-xs uppercase\">\n                  <span className=\"bg-background px-2 text-muted-foreground\">\n                    Or continue with email\n                  </span>\n                </div>\n              </div>\n            </>\n          )}\n\n          <form onSubmit={handleAuth} className=\"space-y-4\">\n            {isSignUp && !isResetPassword && (\n              <div>\n                <label htmlFor=\"name\" className=\"text-sm font-medium\">Name</label>\n                <Input\n                  id=\"name\"\n                  name=\"name\"\n                  type=\"text\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  required={isSignUp}\n                  placeholder=\"Enter your full name\"\n                />\n              </div>\n            )}\n            \n            <div>\n              <label htmlFor=\"email\" className=\"text-sm font-medium\">Email</label>\n              <Input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                placeholder=\"Enter your email\"\n              />\n            </div>\n            \n            {!isResetPassword && (\n              <div>\n                <label htmlFor=\"password\" className=\"text-sm font-medium\">Password</label>\n                <Input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required={!isResetPassword}\n                  placeholder=\"Enter your password\"\n                />\n              </div>\n            )}\n\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n\n            {success && (\n              <Alert>\n                <AlertDescription>{success}</AlertDescription>\n              </Alert>\n            )}\n\n            <Button \n              type=\"submit\" \n              className=\"w-full\" \n              disabled={loading}\n            >\n              {getButtonText()}\n            </Button>\n          </form>\n\n\n          <div className=\"mt-4 space-y-2 text-center\">\n            {!isResetPassword ? (\n              <>\n                <button\n                  onClick={() => setIsSignUp(!isSignUp)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground block\"\n                >\n                  {isSignUp ? 'Already have an account? Sign In' : 'Need an account? Sign Up'}\n                </button>\n                <button\n                  onClick={() => setIsResetPassword(true)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground block\"\n                >\n                  Forgot your password?\n                </button>\n              </>\n            ) : (\n              <button\n                onClick={handleBackToSignIn}\n                className=\"text-sm text-muted-foreground hover:text-foreground\"\n              >\n                Back to Sign In\n              </button>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nexport default Auth;\n"],"names":["Auth","useNavigate","location","useLocation","signIn","signUp","resetPassword","signInWithOAuth","useAuth","isSignUp","setIsSignUp","useState","isResetPassword","setIsResetPassword","email","setEmail","password","setPassword","name","setName","loading","setLoading","error","setError","success","setSuccess","useEffect","URLSearchParams","search","get","handleOAuthSignIn","async","provider","timeoutId","setTimeout","clearTimeout","message","includes","className","children","jsxs","Card","jsx","CardHeader","CardTitle","CardContent","Fragment","Button","variant","onClick","disabled","Chrome","Apple","onSubmit","e","preventDefault","htmlFor","Input","id","type","value","onChange","target","required","placeholder","Alert","AlertDescription"],"mappings":"0UAUA,SAASA,IACUC,IACjB,MAAMC,EAAWC,KACXC,OAAEA,EAAAC,OAAQA,EAAAC,cAAQA,EAAAC,gBAAeA,GAAoBC,KAEpDC,EAAUC,GAAeC,EAAAA,UAAS,IAClCC,EAAiBC,GAAsBF,EAAAA,UAAS,IAChDG,EAAOC,GAAYJ,EAAAA,SAAS,KAC5BK,EAAUC,GAAeN,EAAAA,SAAS,KAClCO,EAAMC,GAAWR,EAAAA,SAAS,KAC1BS,EAASC,GAAcV,EAAAA,UAAS,IAChCW,EAAOC,GAAYZ,EAAAA,SAAS,KAC5Ba,EAASC,GAAcd,EAAAA,SAAS,IAGvCe,EAAAA,UAAU,KAEoB,SADb,IAAIC,gBAAgBzB,EAAS0B,QACjCC,IAAI,UACbhB,GAAmB,IAEpB,CAACX,IAEJ,MAyBM4B,EAAoBC,MAAOC,IAC/BX,GAAW,GACXE,EAAS,IAGT,MAAMU,EAAYC,WAAW,KAC3Bb,GAAW,GACXE,EAAS,oEACR,KAEH,UACQhB,EAAgByB,EAExB,OAASV,GACPa,aAAaF,GAITX,EAAMc,SAASC,SAAS,SAC1Bd,EAAS,wEACAD,EAAMc,SAASC,SAAS,YAAcf,EAAMc,SAASC,SAAS,SACvEd,EAAS,oFACAD,EAAMc,SAASC,SAAS,YACjCd,EAAS,iEAETA,EAAS,0BAA0BD,EAAMc,SAAW,2DAEtDf,GAAW,EACb,CAGA,MAAO,IAAMc,aAAaF,IAqB5B,aACG,MAAA,CAAIK,UAAU,kEACbC,SAAAC,EAAAA,KAACC,EAAA,CAAKH,UAAU,kBACdC,SAAA,CAAAG,EAAAA,IAACC,GACCJ,SAAAG,EAAAA,IAACE,EAAA,CAAUN,UAAU,cAAeC,SAdtC3B,EAAwB,iBACrBH,EAAW,iBAAmB,qBAehCoC,EAAA,CACEN,SAAA,EAAC3B,GACA4B,EAAAA,KAAAM,EAAAA,SAAA,CACEP,SAAA,CAAAC,EAAAA,KAAC,MAAA,CAAIF,UAAU,8BACbC,SAAA,CAAAC,EAAAA,KAACO,EAAA,CACCC,QAAQ,UACRC,QAAS,IAAMnB,EAAkB,UACjCoB,SAAU9B,EACVkB,UAAU,SAEVC,SAAA,CAAAG,EAAAA,IAACS,EAAA,CAAOb,UAAU,iBAAiB,YAGrCE,EAAAA,KAACO,EAAA,CACCC,QAAQ,UACRC,QAAS,IAAMnB,EAAkB,SACjCoB,SAAU9B,EACVkB,UAAU,SAEVC,SAAA,CAAAG,EAAAA,IAACU,EAAA,CAAMd,UAAU,iBAAiB,cAKtCI,EAAAA,IAAC,MAAA,CAAIJ,UAAU,iDAAiDC,SAAA,sIAIhEC,EAAAA,KAAC,MAAA,CAAIF,UAAU,gBACbC,SAAA,CAAAG,EAAAA,IAAC,OAAIJ,UAAU,qCACbC,eAAC,OAAA,CAAKD,UAAU,sBAElBI,EAAAA,IAAC,OAAIJ,UAAU,iDACbC,eAAC,OAAA,CAAKD,UAAU,2CAA2CC,SAAA,mCAQnEC,EAAAA,KAAC,OAAA,CAAKa,SA5HKtB,MAAOuB,IACxBA,EAAEC,iBACFlC,GAAW,GACXE,EAAS,IACTE,EAAW,IAEX,IACMb,SACIN,EAAcQ,GACpBW,EAAW,gDACXZ,GAAmB,IACVJ,SACHJ,EAAOS,EAAOE,EAAU,CAAEE,OAAMJ,UACtCW,EAAW,kDAELrB,EAAOU,EAAOE,EAGxB,OAASM,GACPC,EAASD,EAAMc,QACjB,CAAA,QACEf,GAAW,EACb,GAsGkCiB,UAAU,YACnCC,SAAA,CAAA9B,IAAaG,GACZ4B,EAAAA,KAAC,MAAA,CACCD,SAAA,CAAAG,MAAC,QAAA,CAAMc,QAAQ,OAAOlB,UAAU,sBAAsBC,SAAA,SACtDG,EAAAA,IAACe,EAAA,CACCC,GAAG,OACHxC,KAAK,OACLyC,KAAK,OACLC,MAAO1C,EACP2C,SAAWP,GAAMnC,EAAQmC,EAAEQ,OAAOF,OAClCG,SAAUtD,EACVuD,YAAY,mCAKjB,MAAA,CACCzB,SAAA,CAAAG,MAAC,QAAA,CAAMc,QAAQ,QAAQlB,UAAU,sBAAsBC,SAAA,UACvDG,EAAAA,IAACe,EAAA,CACCC,GAAG,QACHxC,KAAK,QACLyC,KAAK,QACLC,MAAO9C,EACP+C,SAAWP,GAAMvC,EAASuC,EAAEQ,OAAOF,OACnCG,UAAQ,EACRC,YAAY,yBAIdpD,GACA4B,EAAAA,KAAC,MAAA,CACCD,SAAA,CAAAG,MAAC,QAAA,CAAMc,QAAQ,WAAWlB,UAAU,sBAAsBC,SAAA,aAC1DG,EAAAA,IAACe,EAAA,CACCC,GAAG,WACHxC,KAAK,WACLyC,KAAK,WACLC,MAAO5C,EACP6C,SAAWP,GAAMrC,EAAYqC,EAAEQ,OAAOF,OACtCG,UAAWnD,EACXoD,YAAY,2BAKjB1C,SACE2C,EAAA,CAAMjB,QAAQ,cACbT,SAAAG,EAAAA,IAACwB,EAAA,CAAkB3B,eAItBf,GACCkB,EAAAA,IAACuB,EAAA,CACC1B,SAAAG,EAAAA,IAACwB,EAAA,CAAkB3B,eAIvBG,EAAAA,IAACK,EAAA,CACCY,KAAK,SACLrB,UAAU,SACVY,SAAU9B,EAETmB,SAjHPnB,EAAgB,aAChBR,EAAwB,mBACrBH,EAAW,UAAY,qBAoHvB,MAAA,CAAI6B,UAAU,6BACZC,SAAC3B,EAgBA8B,EAAAA,IAAC,SAAA,CACCO,QArJa,KACzBvC,GAAY,GACZG,GAAmB,GACnBU,EAAS,IACTE,EAAW,KAkJCa,UAAU,sDACXC,SAAA,oBAlBDC,EAAAA,KAAAM,WAAA,CACEP,SAAA,CAAAG,EAAAA,IAAC,SAAA,CACCO,QAAS,IAAMvC,GAAaD,GAC5B6B,UAAU,4DAETC,WAAW,mCAAqC,6BAEnDG,EAAAA,IAAC,SAAA,CACCO,QAAS,IAAMpC,GAAmB,GAClCyB,UAAU,4DACXC,SAAA,sCAiBjB"}