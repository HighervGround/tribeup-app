{"version":3,"file":"useUserProfile-BP1eR5NT.js","sources":["../../src/hooks/useUserProfile.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { SupabaseService } from '../lib/supabaseService';\nimport { toast } from 'sonner';\n\n// Query keys\nexport const userKeys = {\n  all: ['users'] as const,\n  profile: (id: string) => [...userKeys.all, 'profile', id] as const,\n  stats: (id: string) => [...userKeys.all, 'stats', id] as const,\n  recentGames: (id: string) => [...userKeys.all, 'recentGames', id] as const,\n  achievements: (id: string) => [...userKeys.all, 'achievements', id] as const,\n};\n\n/**\n * Hook for fetching user profile data\n */\nexport function useUserProfile(userId: string) {\n  return useQuery({\n    queryKey: userKeys.profile(userId),\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      return await SupabaseService.getUserProfile(userId);\n    },\n    enabled: !!userId,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n  });\n}\n\n/**\n * Hook for fetching user stats\n */\nexport function useUserStats(userId: string) {\n  return useQuery({\n    queryKey: userKeys.stats(userId),\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      try {\n        const rawStats = await SupabaseService.getUserStats(userId);\n        // Map database fields to expected format\n        return {\n          totalGamesPlayed: rawStats.games_played || 0,\n          totalGamesHosted: rawStats.games_hosted || 0,\n          averageRating: rawStats.average_rating || 0,\n          totalPlayTime: rawStats.total_play_time_minutes || 0,\n          favoritesSports: rawStats.favorite_sport ? [rawStats.favorite_sport] : [],\n          completionRate: rawStats.completion_rate || 0,\n          totalDistance: rawStats.total_distance || 0,\n        };\n      } catch (error) {\n        // Return default stats if none exist\n        return {\n          totalGamesPlayed: 0,\n          totalGamesHosted: 0,\n          averageRating: 0,\n          totalPlayTime: 0,\n          favoritesSports: [],\n          completionRate: 0,\n          totalDistance: 0,\n        };\n      }\n    },\n    enabled: !!userId,\n    staleTime: 2 * 60 * 1000, // 2 minutes\n    gcTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n/**\n * Hook for fetching user's recent games\n */\nexport function useUserRecentGames(userId: string, limit = 5) {\n  return useQuery({\n    queryKey: [...userKeys.recentGames(userId), limit],\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      try {\n        return await SupabaseService.getUserRecentGames(userId, limit);\n      } catch (error) {\n        return [];\n      }\n    },\n    enabled: !!userId,\n    staleTime: 1 * 60 * 1000, // 1 minute\n    gcTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n/**\n * Hook for fetching user achievements\n */\nexport function useUserAchievements(userId: string) {\n  return useQuery({\n    queryKey: userKeys.achievements(userId),\n    queryFn: async () => {\n      if (!userId) throw new Error('User ID is required');\n      try {\n        return await SupabaseService.getUserAchievements(userId);\n      } catch (error) {\n        return [];\n      }\n    },\n    enabled: !!userId,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n  });\n}\n\n/**\n * Hook for updating user profile\n */\nexport function useUpdateUserProfile() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ userId, profileData }: { userId: string; profileData: any }) => {\n      return await SupabaseService.updateUserProfile(userId, profileData);\n    },\n    onSuccess: (_, { userId }) => {\n      // Invalidate user profile queries\n      queryClient.invalidateQueries({ queryKey: userKeys.profile(userId) });\n      queryClient.invalidateQueries({ queryKey: userKeys.stats(userId) });\n      \n      toast.success('Profile updated successfully!', {\n        description: 'Your changes have been saved',\n      });\n    },\n    onError: (error) => {\n      console.error('Update profile error:', error);\n      toast.error('Failed to update profile', {\n        description: 'Please try again later',\n      });\n    },\n  });\n}\n"],"names":["userKeys","id","useUserProfile","userId","useQuery","SupabaseService","useUserStats","rawStats","useUserRecentGames","limit","useUserAchievements","useUpdateUserProfile","queryClient","useQueryClient","useMutation","profileData","_","toast","error"],"mappings":"2GAKO,MAAMA,EAAW,CACtB,IAAK,CAAC,OAAO,EACb,QAAUC,GAAe,CAAC,GAAGD,EAAS,IAAK,UAAWC,CAAE,EACxD,MAAQA,GAAe,CAAC,GAAGD,EAAS,IAAK,QAASC,CAAE,EACpD,YAAcA,GAAe,CAAC,GAAGD,EAAS,IAAK,cAAeC,CAAE,EAChE,aAAeA,GAAe,CAAC,GAAGD,EAAS,IAAK,eAAgBC,CAAE,CACpE,EAKO,SAASC,EAAeC,EAAgB,CAC7C,OAAOC,EAAS,CACd,SAAUJ,EAAS,QAAQG,CAAM,EACjC,QAAS,SAAY,CACnB,GAAI,CAACA,EAAQ,MAAM,IAAI,MAAM,qBAAqB,EAClD,OAAO,MAAME,EAAgB,eAAeF,CAAM,CACpD,EACA,QAAS,CAAC,CAACA,EACX,UAAW,EAAI,GAAK,IACpB,OAAQ,GAAK,GAAK,GAAA,CACnB,CACH,CAKO,SAASG,EAAaH,EAAgB,CAC3C,OAAOC,EAAS,CACd,SAAUJ,EAAS,MAAMG,CAAM,EAC/B,QAAS,SAAY,CACnB,GAAI,CAACA,EAAQ,MAAM,IAAI,MAAM,qBAAqB,EAClD,GAAI,CACF,MAAMI,EAAW,MAAMF,EAAgB,aAAaF,CAAM,EAE1D,MAAO,CACL,iBAAkBI,EAAS,cAAgB,EAC3C,iBAAkBA,EAAS,cAAgB,EAC3C,cAAeA,EAAS,gBAAkB,EAC1C,cAAeA,EAAS,yBAA2B,EACnD,gBAAiBA,EAAS,eAAiB,CAACA,EAAS,cAAc,EAAI,CAAA,EACvE,eAAgBA,EAAS,iBAAmB,EAC5C,cAAeA,EAAS,gBAAkB,CAAA,CAE9C,MAAgB,CAEd,MAAO,CACL,iBAAkB,EAClB,iBAAkB,EAClB,cAAe,EACf,cAAe,EACf,gBAAiB,CAAA,EACjB,eAAgB,EAChB,cAAe,CAAA,CAEnB,CACF,EACA,QAAS,CAAC,CAACJ,EACX,UAAW,EAAI,GAAK,IACpB,OAAQ,EAAI,GAAK,GAAA,CAClB,CACH,CAKO,SAASK,EAAmBL,EAAgBM,EAAQ,EAAG,CAC5D,OAAOL,EAAS,CACd,SAAU,CAAC,GAAGJ,EAAS,YAAYG,CAAM,EAAGM,CAAK,EACjD,QAAS,SAAY,CACnB,GAAI,CAACN,EAAQ,MAAM,IAAI,MAAM,qBAAqB,EAClD,GAAI,CACF,OAAO,MAAME,EAAgB,mBAAmBF,EAAQM,CAAK,CAC/D,MAAgB,CACd,MAAO,CAAA,CACT,CACF,EACA,QAAS,CAAC,CAACN,EACX,UAAW,EAAI,GAAK,IACpB,OAAQ,EAAI,GAAK,GAAA,CAClB,CACH,CAKO,SAASO,EAAoBP,EAAgB,CAClD,OAAOC,EAAS,CACd,SAAUJ,EAAS,aAAaG,CAAM,EACtC,QAAS,SAAY,CACnB,GAAI,CAACA,EAAQ,MAAM,IAAI,MAAM,qBAAqB,EAClD,GAAI,CACF,OAAO,MAAME,EAAgB,oBAAoBF,CAAM,CACzD,MAAgB,CACd,MAAO,CAAA,CACT,CACF,EACA,QAAS,CAAC,CAACA,EACX,UAAW,EAAI,GAAK,IACpB,OAAQ,GAAK,GAAK,GAAA,CACnB,CACH,CAKO,SAASQ,GAAuB,CACrC,MAAMC,EAAcC,EAAA,EAEpB,OAAOC,EAAY,CACjB,WAAY,MAAO,CAAE,OAAAX,EAAQ,YAAAY,KACpB,MAAMV,EAAgB,kBAAkBF,EAAQY,CAAW,EAEpE,UAAW,CAACC,EAAG,CAAE,OAAAb,KAAa,CAE5BS,EAAY,kBAAkB,CAAE,SAAUZ,EAAS,QAAQG,CAAM,EAAG,EACpES,EAAY,kBAAkB,CAAE,SAAUZ,EAAS,MAAMG,CAAM,EAAG,EAElEc,EAAM,QAAQ,gCAAiC,CAC7C,YAAa,8BAAA,CACd,CACH,EACA,QAAUC,GAAU,CAClB,QAAQ,MAAM,wBAAyBA,CAAK,EAC5CD,EAAM,MAAM,2BAA4B,CACtC,YAAa,wBAAA,CACd,CACH,CAAA,CACD,CACH"}