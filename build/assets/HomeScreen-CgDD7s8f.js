import{u as R,a as k,r as i,S as y,j as e,B as l,R as g}from"./index-DB6wa_yx.js";import{P as w}from"./plus-B4EuX6th.js";import{M as A}from"./map-pin-CYLnUi8K.js";import{U as J}from"./users-BdIY6C-s.js";import{C as T}from"./clock-DJH1VLy5.js";function h({game:t,onSelect:a}){const{joinGame:c,leaveGame:n}=k(),d=j=>{j.stopPropagation(),t.isJoined?n(t.id):c(t.id)},o=()=>{a()};return e.jsxs("div",{className:"bg-card rounded-lg p-4 border border-border cursor-pointer hover:shadow-md transition-shadow",onClick:o,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.sport})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("div",{className:"text-sm font-medium",children:t.cost}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.currentPlayers,"/",t.maxPlayers," players"]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{children:[t.currentPlayers,"/",t.maxPlayers," players"]})]}),t.distance&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"ðŸ“"}),e.jsx("span",{children:t.distance})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{children:[t.date," at ",t.time]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[t.isJoined?e.jsx("span",{className:"inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded",children:"Joined"}):e.jsx("div",{}),e.jsx("button",{onClick:d,className:`px-3 py-1 rounded text-sm font-medium transition-colors ${t.isJoined?"bg-red-100 text-red-700 hover:bg-red-200":"bg-primary text-primary-foreground hover:bg-primary/90"}`,children:t.isJoined?"Leave":"Join"})]})]})}function L(){const t=R(),{games:a,setGames:c,isLoading:n,setLoading:d,user:o}=k(),[j,N]=i.useState(!1),[C,u]=i.useState(!1),S=i.useMemo(()=>o?.preferences?.sports??[],[o]),[r,b]=i.useState("all");i.useEffect(()=>{a.length===0&&!n&&f()},[]),i.useEffect(()=>{a.length>0&&f()},[r]),i.useEffect(()=>()=>{d(!1)},[d]);const f=async()=>{if(n){console.log("Already loading games, skipping duplicate call");return}u(!1),d(!0);try{const s=r==="recommended"?await y.getRecommendedGames(S):await y.getGames();c(s)}catch(s){console.error("Error loading games:",s),u(!0),c([])}finally{d(!1)}},p=async()=>{if(!j){u(!1),N(!0);try{await f()}finally{N(!1)}}},m=s=>{t(`/game/${s}`)},v=()=>{t("/create-game")},x=a.filter(s=>{const G=new Date(s.date),P=new Date;return G.toDateString()===P.toDateString()});return n&&a.length===0?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading games..."})]})}):C&&a.length===0?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Connection issues detected. Showing sample games."}),e.jsxs(l,{onClick:p,variant:"outline",children:[e.jsx(g,{className:"w-4 h-4 mr-2"})," Try Again"]})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"px-4 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"TribeUp"}),e.jsx("p",{className:"text-muted-foreground",children:"Find your next game"})]}),e.jsx(l,{onClick:v,size:"icon","aria-label":"Create new game",children:e.jsx(w,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-card rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:a.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Games"})]}),e.jsxs("div",{className:"bg-card rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:"0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Players Online"})]}),e.jsxs("div",{className:"bg-card rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:"0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"This Week"})]})]})]}),x.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsx("h2",{className:"text-lg mb-4",children:"Happening Soon"}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:x.map(s=>e.jsx("div",{className:"flex-shrink-0 w-72",children:e.jsx(h,{game:s,onSelect:()=>m(s.id)})},s.id))})]}),e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"All Games"}),e.jsx(l,{variant:"ghost",size:"sm",onClick:p,disabled:n,"aria-label":"Refresh games",children:e.jsx(g,{className:`w-4 h-4 ${n?"animate-spin":""}`})})]}),e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsx("div",{children:e.jsx(h,{game:s,onSelect:()=>m(s.id)})},s.id))})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"TribeUp"}),e.jsx("p",{className:"text-muted-foreground",children:"Find your next game"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-muted rounded-md p-1 flex",children:[e.jsx("button",{className:`px-3 py-1 text-sm rounded ${r==="recommended"?"bg-background shadow font-medium":"text-muted-foreground"}`,onClick:()=>b("recommended"),children:"Recommended"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded ${r==="all"?"bg-background shadow font-medium":"text-muted-foreground"}`,onClick:()=>b("all"),children:"All"})]}),e.jsxs(l,{onClick:v,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Create Game"]})]})]}),x.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Happening Today"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(s=>e.jsx(h,{game:s,onSelect:()=>m(s.id)},s.id))})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:r==="recommended"?"Recommended For You":"All Games"}),e.jsxs(l,{variant:"outline",onClick:p,disabled:n,children:[e.jsx(g,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(s=>e.jsx("div",{children:e.jsx(h,{game:s,onSelect:()=>m(s.id)})},s.id))})]}),e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"bg-card rounded-lg p-6 sticky top-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Active Games"}),e.jsx("span",{className:"font-semibold",children:a.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Players Online"}),e.jsx("span",{className:"font-semibold",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"This Week"}),e.jsx("span",{className:"font-semibold",children:"0"})]})]})]})})]})})})]})}export{L as HomeScreen};
//# sourceMappingURL=HomeScreen-CgDD7s8f.js.map
