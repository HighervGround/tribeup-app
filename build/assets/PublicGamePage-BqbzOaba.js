import{c as D,k as F,u as G,r,j as e,C as d,b as o,B as x,d as p,e as j,A,f as B,S as h,t as n}from"./index-BQ6ii6ap.js";import{I as f}from"./input-BgaEYafv.js";import{B as M}from"./badge-Ct05bC3n.js";import{S as U}from"./separator-CcS8R7Ig.js";import{S as q,C as I}from"./share-2-BjMcuRJL.js";import{M as L}from"./map-pin-dIIxx45t.js";import{C as T}from"./calendar-DfB3bsKk.js";import{U as Y}from"./users-gHhITmMd.js";import{M as z}from"./mail-7qH5tu7O.js";import{C as H}from"./circle-check-big-CT_HhTbB.js";import"./index-DneN3sKk.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],_=D("external-link",J);function ne(){const{gameId:l}=F(),g=G(),[t,S]=r.useState(null),[w,N]=r.useState(!0),[c,v]=r.useState([]),[i,m]=r.useState({name:"",email:"",phone:""}),[b,y]=r.useState(!1),[$,O]=r.useState(!1),[C,P]=r.useState(!1),[u,W]=r.useState(null);r.useEffect(()=>{(async()=>{if(l)try{N(!0);const[a,E]=await Promise.all([h.getGameById(l),h.getPublicRSVPs(l)]);S(a),v(E)}catch(a){console.error("Error loading game data:",a),n.error("Failed to load game details")}finally{N(!1)}})()},[l]);const R=async s=>{if(s.preventDefault(),!i.name.trim()||!i.email.trim()){n.error("Name and email are required");return}try{if(y(!0),await h.createPublicRSVP(l,{name:i.name.trim(),email:i.email.trim(),phone:i.phone.trim()||void 0}),P(!0),m({name:"",email:"",phone:""}),n.success("RSVP confirmed! You'll receive updates via email."),l){const a=await h.getPublicRSVPs(l);v(a)}}catch(a){console.error("Error submitting RSVP:",a),n.error("Failed to submit RSVP. Please try again.")}finally{y(!1)}},k=async()=>{const s=window.location.href;if(navigator.share)try{await navigator.share({title:`Join ${t.title}`,text:`${t.sport} game at ${t.location}`,url:s})}catch{}else try{await navigator.clipboard.writeText(s),n.success("Game link copied to clipboard!")}catch{n.error("Failed to copy link")}},V=()=>{g("/auth?redirect="+encodeURIComponent(window.location.pathname))};return w?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading game details..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"bg-card border-b",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold",children:"T"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg",children:"TribeUp"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Social Sports"})]})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:V,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Join App"]})]})})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsxs(d,{className:"mb-8",children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(j,{className:"text-2xl mb-2",children:t.title}),e.jsx(M,{className:"mb-4",children:t.sport})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:k,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Share"]})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.location}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Location"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.date}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.time}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Time"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Y,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[c.length+(t.currentPlayers||0),"/",t.maxPlayers," players"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Capacity"})]})]})]}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"About this game"}),e.jsx("p",{className:"text-muted-foreground",children:t.description})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Cost:"})," ",t.cost||"Free"]})})]})]}),C?e.jsxs(A,{className:"mb-8",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsxs(B,{children:[e.jsx("strong",{children:"You're all set!"})," Your RSVP has been confirmed. You'll receive email updates about this game.",u&&e.jsxs("div",{className:"mt-2 text-sm",children:["Registered as: ",e.jsx("strong",{children:u.name})," (",u.email,")"]})]})]}):e.jsxs(d,{className:"mb-8",children:[e.jsx(p,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"RSVP for this Game"]})}),e.jsxs(o,{children:[e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Full Name *"}),e.jsx(f,{type:"text",placeholder:"Enter your name",value:i.name,onChange:s=>m(a=>({...a,name:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Email Address *"}),e.jsx(f,{type:"email",placeholder:"Enter your email",value:i.email,onChange:s=>m(a=>({...a,email:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Phone Number (Optional)"}),e.jsx(f,{type:"tel",placeholder:"Enter your phone number",value:i.phone,onChange:s=>m(a=>({...a,phone:s.target.value}))})]}),e.jsx(x,{type:"submit",className:"w-full",disabled:b,children:b?"Confirming...":"Confirm RSVP"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-4",children:"By RSVPing, you'll receive email updates about this game. Your information is only shared with the game organizer."})]})]}),c.length>0&&e.jsxs(d,{children:[e.jsx(p,{children:e.jsxs(j,{children:["Who's Coming (",c.length,")"]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-3",children:c.map(s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-primary",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["RSVPed ",new Date(s.created_at).toLocaleDateString()]})]})]},s.id))})})]})]})]}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(d,{className:"w-full max-w-md",children:e.jsxs(o,{className:"pt-6 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Game Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"This game may have been cancelled or the link is invalid."}),e.jsx(x,{onClick:()=>g("/"),children:"Browse Other Games"})]})})})}export{ne as default};
//# sourceMappingURL=PublicGamePage-BqbzOaba.js.map
