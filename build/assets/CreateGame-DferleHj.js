import{j as e}from"./ui-CuzVkv4o.js";import{r as x}from"./vendor-Dit9F4CM.js";import{s as ye,u as ve,b as se,B as T,C as A,a as G,g as O,h as U,L as ae,i as re}from"./index-Mzv7St__.js";import{P as Ne}from"./progress-Br14-YiG.js";import{I as D}from"./input-CMStqkNd.js";import{T as we}from"./textarea-Dzmojl_a.js";import{A as z,a as H}from"./alert-CUeGNN31.js";import{S as ke,a as Se,b as Ce,c as Ee,d as _}from"./select-0FuCrqZO.js";import{A as B}from"./arrow-left-BwnB17kP.js";import{M as ne}from"./map-pin-DThEIEnm.js";import{C as Le}from"./circle-alert-CBmJDmqw.js";import{C as ie}from"./circle-check-big-CGHnT8vq.js";import"./check-Cc1EEBk7.js";function $e(){const[N,r]=x.useState([]),[y,p]=x.useState(!1),f="AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ",d=x.useCallback(async j=>{try{if(f&&f!=="demo_key"){const k=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(j)}&key=${f}`);if(k.ok){const E=await k.json();if(E.results&&E.results.length>0){const S=E.results[0].geometry.location;return{lat:S.lat,lng:S.lng}}}}const b=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(j)}&limit=1`);if(!b.ok)throw new Error("Geocoding failed");const w=await b.json();return w.length>0?{lat:parseFloat(w[0].lat),lng:parseFloat(w[0].lon)}:null}catch(b){return console.error("Geocoding error:",b),null}},[f]),h=x.useCallback(async(j,b,w)=>{if(!j.trim()){r([]);return}console.log("üîç Starting location search for:",j),p(!0);try{if(f&&f!=="demo_key"&&f!=="your_anon_key_here"){console.log("üåê Trying Google Places API...");let S=`https://maps.googleapis.com/maps/api/place/autocomplete/json?input=${encodeURIComponent(j)}&key=${f}`;b&&w&&(S+=`&location=${b},${w}&radius=50000`),console.log("üì° Google Places URL:",S);const m=await fetch(S);if(m.ok){const c=await m.json();if(console.log("‚úÖ Google Places response:",c),c.predictions&&c.predictions.length>0){const $=c.predictions.map(P=>({place_id:P.place_id,description:P.description,structured_formatting:{main_text:P.structured_formatting?.main_text||P.description.split(",")[0],secondary_text:P.structured_formatting?.secondary_text||P.description.split(",").slice(1).join(",").trim()}}));console.log("üéØ Google Places suggestions:",$),r($),p(!1);return}else console.log("‚ö†Ô∏è Google Places returned no predictions")}else console.log("‚ùå Google Places API error:",m.status,m.statusText)}console.log("üó∫Ô∏è Trying OpenStreetMap...");let k=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(j)}&limit=5&addressdetails=1`;b&&w&&(k+=`&lat=${b}&lon=${w}&bounded=1&viewbox=${w-.1},${b+.1},${w+.1},${b-.1}`),console.log("üì° OpenStreetMap URL:",k);const E=await fetch(k);if(E.ok){const S=await E.json();console.log("‚úÖ OpenStreetMap response:",S);const m=S.map((c,$)=>({place_id:c.place_id||`osm-${$}`,description:c.display_name,structured_formatting:{main_text:c.name||c.display_name.split(",")[0],secondary_text:c.display_name.split(",").slice(1,3).join(",").trim()}}));console.log("üéØ OpenStreetMap suggestions:",m),r(m),p(!1);return}else console.log("‚ùå OpenStreetMap API error:",E.status,E.statusText);console.log("‚ùå All location APIs failed, showing no suggestions"),r([])}catch(k){console.error("‚ùå Location search error:",k),r([])}finally{p(!1)}},[f]);return{suggestions:N,loading:y,searchLocations:h,geocodeLocation:d}}function Pe(N={}){const[r,y]=x.useState({latitude:null,longitude:null,error:null,loading:!0});return x.useEffect(()=>{if(console.log("useGeolocation hook initializing..."),!navigator.geolocation){console.log("Geolocation not supported"),y(h=>({...h,error:"Geolocation is not supported by this browser",loading:!1}));return}const p=h=>{console.log("GPS location obtained:",h.coords.latitude,h.coords.longitude),y({latitude:h.coords.latitude,longitude:h.coords.longitude,error:null,loading:!1})},f=h=>{let j="Unable to retrieve location";switch(h.code){case h.PERMISSION_DENIED:j="Location access denied by user";break;case h.POSITION_UNAVAILABLE:j="Location information unavailable";break;case h.TIMEOUT:j="Location request timed out";break}console.log("GPS error:",j,h),y(b=>({...b,error:j,loading:!1}))},d={enableHighAccuracy:N.enableHighAccuracy??!0,timeout:N.timeout??1e4,maximumAge:N.maximumAge??3e5};console.log("Requesting GPS permission with options:",d),navigator.geolocation.getCurrentPosition(p,f,d)},[N.enableHighAccuracy,N.timeout,N.maximumAge]),r}class I{static instance;cache={};CACHE_TTL=5*60*1e3;constructor(){}static getInstance(){return I.instance||(I.instance=new I),I.instance}async fetchConfigValue(r){try{const{data:y,error:p}=await ye.from("system_config").select("value").eq("key",r).single();if(p){if(p.code==="PGRST116")return console.warn(`Config key '${r}' not found in database`),null;throw p}return this.parseConfigValue(y.value)}catch{return console.log(`‚ö†Ô∏è system_config table not found or error fetching '${r}', using default`),null}}parseConfigValue(r){if(typeof r=="string")try{return JSON.parse(r)}catch{return r==="true"?!0:r==="false"?!1:!isNaN(Number(r))&&r!==""?Number(r):r}return r}async get(r,y){const p=this.cache[r];if(p&&Date.now()-p.timestamp<p.ttl)return p.value;const f=await this.fetchConfigValue(r);return this.cache[r]={value:f,timestamp:Date.now(),ttl:this.CACHE_TTL},f!==null?f:y}}const W=I.getInstance(),oe=[{value:"basketball",label:"Basketball",icon:"üèÄ"},{value:"soccer",label:"Soccer",icon:"‚öΩ"},{value:"tennis",label:"Tennis",icon:"üéæ"},{value:"pickleball",label:"Pickleball",icon:"ü•í"},{value:"volleyball",label:"Volleyball",icon:"üèê"},{value:"football",label:"Football",icon:"üèà"},{value:"baseball",label:"Baseball",icon:"‚öæ"}],C=[{id:1,title:"What & When",fields:["sport","date","time","duration"]},{id:2,title:"Where & Who",fields:["location","maxPlayers","cost"]},{id:3,title:"Skill & Requirements",fields:["skillLevel"]},{id:4,title:"Review & Create",fields:[]}],Re=["09:00","12:00","15:00","17:00","18:00","19:00","20:00","21:00"];function We(){const N=ve(),[r,y]=x.useState(1),[p,f]=x.useState(!1),[d,h]=x.useState({}),[j,b]=x.useState(null),[w,k]=x.useState(!1),[E,S]=x.useState(Re),{latitude:m,longitude:c,error:$}=Pe(),{searchLocations:P,loading:V,suggestions:Q,geocodeLocation:le}=$e(),{user:J}=se(),q=x.useRef(null),[Y,ce]=x.useState(0),de=()=>{const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]},[s,L]=x.useState({title:"",sport:"",date:de(),time:"",duration:"60",location:"",latitude:null,longitude:null,maxPlayers:"10",cost:"FREE",imageUrl:"",skillLevel:"mixed",minEloRating:"",maxEloRating:"",minReputation:"70",competitiveMode:!1});x.useEffect(()=>{(async()=>{try{const a=await W.get("quick_time_slots",["09:00","12:00","15:00","17:00","18:00","19:00","20:00","21:00"]);S(a);const i=await W.get("max_players_per_game",10);L(n=>({...n,maxPlayers:i.toString()}))}catch(a){console.error("Error loading system config:",a)}})()},[]),x.useEffect(()=>{(async()=>{if(s.sport)try{const a=await W.get(`sport_${s.sport}_duration`,60);L(i=>({...i,duration:a?a.toString():"60"}))}catch(a){console.error("Error loading sport defaults:",a)}})()},[s.sport]);const K={basketball:{maxPlayers:10},soccer:{maxPlayers:22},football:{maxPlayers:22},tennis:{maxPlayers:4},volleyball:{maxPlayers:12},baseball:{maxPlayers:18},hockey:{maxPlayers:12},badminton:{maxPlayers:4},pickleball:{maxPlayers:4},golf:{maxPlayers:4},running:{maxPlayers:20},cycling:{maxPlayers:15},swimming:{maxPlayers:8},yoga:{maxPlayers:15},crossfit:{maxPlayers:12}};(()=>{const t=new Date,a=t.getHours();return t.getDay()===0||t.getDay()===6?["09:00","10:00","11:00","14:00","15:00","16:00","17:00"]:a<17?["17:00","18:00","19:00","20:00","21:00"]:["18:00","19:00","20:00","21:00"]})();const[me,ue]=x.useState(()=>{try{return JSON.parse(localStorage.getItem("recentGameLocations")||"[]")}catch{return[]}});x.useEffect(()=>{console.log("Location effect triggered:",{userLat:m,userLng:c,location:s.location,latitude:s.latitude,geoError:$}),m&&c&&!s.location.trim()&&(console.log("Auto-filling location with GPS coordinates"),(async()=>{try{console.log("Fetching reverse geocoding for:",m,c);const a="AIzaSyCs_MsE3qt74h6eIR04QJqmf2FYgSys4UQ";let i;if(a&&(i=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${m},${c}&key=${a}`)),!i.ok)throw new Error(`HTTP ${i.status}`);const n=await i.json();console.log("Reverse geocoding response:",n);let l="";if(a&&n.results&&n.results.length>0)l=n.results[0].formatted_address;else if(n.address){const o=[];n.address.house_number&&n.address.road?o.push(`${n.address.house_number} ${n.address.road}`):n.address.road&&o.push(n.address.road),(n.address.city||n.address.town||n.address.village)&&o.push(n.address.city||n.address.town||n.address.village),n.address.state&&o.push(n.address.state),l=o.join(", ")}l||(l=n.display_name||`${m.toFixed(4)}, ${c.toFixed(4)}`),console.log("Setting location to:",l),L(o=>({...o,location:l,latitude:m,longitude:c}))}catch(a){console.error("Reverse geocoding failed:",a);const i=`${m.toFixed(4)}, ${c.toFixed(4)}`;console.log("Using fallback location:",i),L(n=>({...n,location:i,latitude:m,longitude:c}))}})())},[m,c,$]),x.useEffect(()=>{J||N("/auth")},[J,N]),x.useEffect(()=>{const t=()=>{if(q.current){const a=q.current.offsetHeight;ce(a)}};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[r,p]);const X=(t,a,i)=>{if(!t||!a||!i)return"";const n=parseInt(a.split(":")[0]);let l="Morning";n>=12&&n<17?l="Afternoon":n>=17&&(l="Evening");const o=i.split(",")[0].trim(),u=t.charAt(0).toUpperCase()+t.slice(1),g=[`${l} ${u} at ${o}`,`${u} Game - ${o}`,`${l} ${u} Session`,`${o} ${u} Meetup`,`${u} @ ${o}`];return g[Math.floor(Math.random()*g.length)]},xe=async(t,a,i,n)=>{if(!t||!a||!i||!n)return null;try{return(await re.getGames()).filter(u=>{const g=u.date===a,R=Math.abs(new Date(`2000-01-01T${u.time}`).getTime()-new Date(`2000-01-01T${i}`).getTime())<36e5,je=u.sport.toLowerCase()===t.toLowerCase(),be=u.location.toLowerCase().includes(n.toLowerCase())||n.toLowerCase().includes(u.location.toLowerCase());return g&&R&&je&&be}).length>0?`Similar ${t} game already exists at ${n} on ${a} around ${i}`:null}catch(l){return console.error("Error checking duplicates:",l),null}},ge=(t,a)=>{switch(t){case"date":if(!a)return null;const i=new Date;return new Date(a+"T00:00:00")<new Date(i.toDateString())?"Date cannot be in the past":null;case"time":if(!a)return null;const l=parseInt(a.split(":")[0]);return l<6||l>23?"Unusual time - games typically happen 6 AM - 11 PM":l>=2&&l<=5?"Did you mean PM instead of AM?":null;case"maxPlayers":if(!a)return null;const o=parseInt(a);if(o<2)return"Need at least 2 players";if(o>100)return"That seems like a lot of players - double check?";const u=s.sport?.toLowerCase();return u==="tennis"&&o>4?"Tennis usually has 2-4 players":u==="basketball"&&o>10?"Basketball usually has 6-10 players":u==="soccer"&&o>22?"Soccer usually has up to 22 players":null;case"location":return a?a.length<3?"Location too short":a.toLowerCase().includes("ocean")||a.toLowerCase().includes("sea")?"Are you sure this location is correct?":a.toLowerCase().includes("home")||a.toLowerCase().includes("house")?"Consider using a public venue for safety":null:null;case"cost":if(!a)return null;const g=parseFloat(a);return g<0?"Cost cannot be negative":g>500?"That seems expensive - double check?":null;case"duration":if(!a)return null;const R=parseInt(a);return R<15?"Duration should be at least 15 minutes":R>480?"Duration seems too long - max 8 hours":R>240?"That's a long game - are you sure?":null;default:return null}},v=(t,a)=>{L(n=>{const l={...n,[t]:a},o=X(n.sport,n.time,n.location),u=X(t==="sport"?a:n.sport,t==="time"?a:n.time,t==="location"?a:n.location);if((t==="sport"||t==="time"||t==="location")&&(!n.title||n.title===o)&&u&&(l.title=u),t==="sport"&&K[a.toLowerCase()]&&(l.maxPlayers=K[a.toLowerCase()].maxPlayers.toString()),t==="location"&&a.trim()){const g=[a,...me.filter(R=>R!==a)].slice(0,5);ue(g),localStorage.setItem("recentGameLocations",JSON.stringify(g))}return l});const i=ge(t,a);h(n=>{if(i)return{...n,[t]:i};{const{[t]:l,...o}=n;return o}}),t==="location"&&s.sport&&s.date&&s.time&&a&&xe(s.sport,s.date,s.time,a).then(n=>{h(n?l=>({...l,duplicate:n}):l=>{const{duplicate:o,...u}=l;return u})}),setTimeout(()=>{F(r)&&!Object.keys(d).length&&r<C.length&&y(r+1)},500)},F=t=>{const a=C[t-1]?.fields||[],i=a.every(n=>{const l=s[n];return l&&l.toString().trim()!==""});return console.log("[CreateGame] isStepComplete - Step:",t,"Fields:",a,"Complete:",i,"FormData:",s),i},Z=()=>{const t={};if(r===1){if(s.sport||(t.sport="Please select a sport."),s.date||(t.date="Please choose a date."),s.time||(t.time="Please choose a time."),s.duration||(t.duration="Please set a duration."),s.date){const a=new Date;new Date(s.date+"T00:00:00")<new Date(a.toDateString())&&(t.date="Date cannot be in the past.")}if(s.duration){const a=parseInt(s.duration);a<15&&(t.duration="Duration should be at least 15 minutes."),a>480&&(t.duration="Duration seems too long - max 8 hours.")}}if(r===2){s.location.trim()||(t.location="Location is required.");const a=parseInt(s.maxPlayers,10);s.maxPlayers?(Number.isNaN(a)||a<=0)&&(t.maxPlayers="Enter a valid number greater than 0."):t.maxPlayers="Max players is required.",s.cost||(t.cost="Please select a cost option.")}return r===3&&(s.skillLevel||(t.skillLevel="Please select a skill level.")),console.log("[CreateGame] Validation - Step:",r,"Errors:",t,"FormData:",s),h(t),Object.keys(t).length===0},pe=()=>{Z()&&r<C.length&&y(r+1)},ee=()=>{r>1?y(r-1):N(-1)},he=async()=>{if(Z()){f(!0),b(null);try{const{user:t}=se.getState();if(console.log("[CreateGame] submit clicked. user =",t?.id),!t)throw new Error("You must be logged in to create a game");const a={title:s.title,sport:s.sport,date:s.date,time:s.time,duration:parseInt(s.duration)||60,location:s.location,latitude:s.latitude,longitude:s.longitude,maxPlayers:parseInt(s.maxPlayers)||10,cost:s.cost||"Free",description:"",imageUrl:s.imageUrl,skillLevel:s.skillLevel,minEloRating:s.minEloRating?parseInt(s.minEloRating):null,maxEloRating:s.maxEloRating?parseInt(s.maxEloRating):null,minReputation:s.minReputation?parseInt(s.minReputation):70,competitiveMode:s.competitiveMode};console.log("[CreateGame] creating game with data =",a),await re.createGame(a),N("/")}catch(t){console.error("Error creating game:",t),b(t instanceof Error?t.message:"Failed to create game")}finally{f(!1)}}},fe=r/C.length*100,M=oe.find(t=>t.value===s.sport),te=(t,a,i="text",n)=>{const l=s[t],o=d[t],u=l&&!o;return i==="select"?e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:a}),e.jsxs("select",{value:l,onChange:g=>v(t,g.target.value),className:`w-full p-3 border rounded-lg transition-colors bg-background text-foreground ${o?"border-destructive bg-destructive/10":u?"border-green-500 bg-green-50 dark:bg-green-950/50 dark:border-green-400":"border-input hover:border-ring focus:border-ring focus:ring-2 focus:ring-ring/20"}`,children:[e.jsxs("option",{value:"",className:"bg-background text-foreground",children:["Select ",a.toLowerCase()]}),n?.map(g=>e.jsx("option",{value:g.value,className:"bg-background text-foreground",children:g.label},g.value))]}),o&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",o]}),u&&!o&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚úÖ"})," Looks good!"]})]}):i==="textarea"?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[a,C[r-1].fields.includes(t)&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(we,{value:l,onChange:g=>v(t,g.target.value),placeholder:`Enter ${a.toLowerCase()}`,className:`resize-none ${o?"border-destructive":""}`,rows:3}),o&&e.jsx("p",{className:"text-sm text-destructive",children:o})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[a,C[r-1].fields.includes(t)&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(D,{type:i,value:s[t],onChange:g=>v(t,g.target.value),placeholder:`Enter ${a.toLowerCase()}`,min:i==="date"?new Date().toISOString().split("T")[0]:void 0,className:`transition-colors ${o?"border-red-500 bg-red-50":u?"border-green-500 bg-green-50":"border-gray-300"}`}),o&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",o]}),u&&!o&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚úÖ"})," Looks good!"]})]})};return e.jsxs("div",{className:"min-h-screen bg-background",style:{paddingBottom:`${Y+16}px`},children:[e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6",children:[e.jsx("div",{className:"sticky top-0 bg-background/95 backdrop-blur-sm border-b border-border z-10",children:e.jsx("div",{className:"flex items-center justify-between px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(T,{variant:"ghost",size:"icon",onClick:ee,children:e.jsx(B,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Create Game"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C[r-1].title})]})]})})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Ne,{value:fe,className:"h-2"})})]}),e.jsxs("div",{className:"px-4 pt-6",style:{paddingBottom:`${Y+16}px`},children:[M&&e.jsx("div",{className:"mb-6",children:e.jsx(A,{children:e.jsx(G,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-2xl",children:M.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.title||"New Game"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:M.label})]})]})})})}),r===1&&e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"1"}),"What & When"]})}),e.jsxs(G,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Sport"}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:oe.map(t=>e.jsxs("button",{type:"button",onClick:()=>v("sport",t.value),className:`p-2 rounded-lg border-2 transition-all duration-200 ${s.sport===t.value?"border-primary bg-primary/10 text-primary":"border-input hover:border-ring text-foreground bg-background"}`,children:[e.jsx("div",{className:"text-lg mb-1",children:t.icon}),e.jsx("div",{className:"text-xs font-medium",children:t.label})]},t.value))}),d.sport&&e.jsx("p",{className:"text-sm text-destructive",children:d.sport})]}),te("date","Date","date"),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Time"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:E.map(t=>e.jsx("button",{type:"button",onClick:()=>v("time",t),className:`px-2 py-2 text-xs rounded-md border transition-colors ${s.time===t?"bg-primary text-primary-foreground border-primary":"bg-background text-foreground border-input hover:bg-muted hover:border-ring"}`,children:new Date(`2000-01-01T${t}:00`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},t))}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Or enter custom time:"}),e.jsx(D,{type:"time",value:s.time,onChange:t=>v("time",t.target.value),className:d.time?"border-destructive":"",placeholder:"Select time"})]}),d.time&&e.jsx("p",{className:"text-sm text-destructive",children:d.time})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground",children:["Duration ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["30","60","90","120"].map(t=>e.jsxs("button",{type:"button",onClick:()=>v("duration",t),className:`px-2 py-2 text-xs rounded-md border transition-colors ${s.duration===t?"bg-primary text-primary-foreground border-primary":"bg-background text-foreground border-input hover:bg-muted hover:border-ring"}`,children:[t," min"]},t))}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Or enter custom duration (minutes):"}),e.jsx(D,{type:"number",value:s.duration,onChange:t=>v("duration",t.target.value),className:d.duration?"border-destructive":"",placeholder:"Duration in minutes",min:"15",max:"480"})]}),d.duration&&e.jsx("p",{className:"text-sm text-destructive",children:d.duration})]})]})]})}),r===2&&e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"2"}),"Where & Who"]})}),e.jsxs(G,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{value:s.location,onChange:t=>{v("location",t.target.value),console.log("Location input changed:",t.target.value),t.target.value.length>2?(console.log("Triggering location search for:",t.target.value),P(t.target.value,m||void 0,c||void 0),k(!0)):(console.log("Hiding location suggestions"),k(!1))},placeholder:"Enter location or address",className:d.location?"border-destructive":""}),e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex gap-2",children:[V&&e.jsx(ae,{className:"w-4 h-4 animate-spin text-muted-foreground"}),e.jsx(T,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:async()=>{if(m&&c)try{const i=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${m}&lon=${c}`)).json()).display_name||`${m.toFixed(4)}, ${c.toFixed(4)}`;L(n=>({...n,location:i,latitude:m,longitude:c}))}catch(t){console.error("Reverse geocoding failed:",t),L(a=>({...a,location:`${m.toFixed(4)}, ${c.toFixed(4)}`,latitude:m,longitude:c}))}},disabled:!m||!c,title:m&&c?"Use my current location":$||"Location not available",children:e.jsx(ne,{className:"w-4 h-4"})})]})]}),w&&e.jsx("div",{className:"border border-border rounded-md bg-background shadow-lg max-h-48 overflow-y-auto",children:Q.length>0?Q.map(t=>e.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-muted border-b border-border last:border-b-0 flex items-center gap-2",onClick:async()=>{L(i=>({...i,location:t.description})),k(!1);const a=await le(t.description);a&&L(i=>({...i,latitude:a.lat,longitude:a.lng}))},children:[e.jsx(ne,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.structured_formatting.main_text}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.structured_formatting.secondary_text})]})]},t.place_id)):e.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:V?"Searching...":"No suggestions found. Try typing a more specific location."})}),d.location&&e.jsx("p",{className:"text-sm text-destructive",children:d.location})]}),te("maxPlayers","Max Players","number"),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Cost ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(ke,{value:s.cost,onValueChange:t=>v("cost",t),children:[e.jsx(Se,{className:d.cost?"border-destructive":"",children:e.jsx(Ce,{placeholder:"Select cost"})}),e.jsxs(Ee,{children:[e.jsx(_,{value:"FREE",children:"Free"}),e.jsx(_,{value:"$5",children:"$5 per person"}),e.jsx(_,{value:"$10",children:"$10 per person"}),e.jsx(_,{value:"$15",children:"$15 per person"}),e.jsx(_,{value:"$20",children:"$20 per person"}),e.jsx(_,{value:"custom",children:"Custom amount"})]})]}),d.cost&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",d.cost]}),s.cost&&!d.cost&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:"‚úÖ"})," Looks good!"]})]})]})]})}),r===3&&e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"3"}),"Skill & Requirements"]})}),e.jsxs(G,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Skill Level"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"beginner",label:"Beginner",description:"New to the sport"},{value:"intermediate",label:"Intermediate",description:"Some experience"},{value:"advanced",label:"Advanced",description:"Experienced player"},{value:"competitive",label:"Competitive",description:"High skill level"},{value:"mixed",label:"Mixed",description:"All skill levels welcome"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>v("skillLevel",t.value),className:`p-3 rounded-lg border-2 text-left transition-all duration-200 ${s.skillLevel===t.value?"border-primary bg-primary/10 text-primary":"border-input hover:border-ring text-foreground bg-background"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:t.label}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:t.description})]},t.value))})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Competitive Mode"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Stricter skill matching and ELO tracking"})]}),e.jsx("button",{type:"button",onClick:()=>v("competitiveMode",(!s.competitiveMode).toString()),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.competitiveMode?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.competitiveMode?"translate-x-6":"translate-x-1"}`})})]})}),s.competitiveMode&&e.jsxs("div",{className:"space-y-4 p-4 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"ELO Rating Requirements"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.minEloRating&&s.maxEloRating?`Players must have ELO between ${s.minEloRating} and ${s.maxEloRating}`:s.minEloRating?`Players must have ELO of at least ${s.minEloRating}`:s.maxEloRating?`Players must have ELO no higher than ${s.maxEloRating}`:null}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Minimum ELO"}),e.jsx(D,{type:"number",value:s.minEloRating,onChange:t=>v("minEloRating",t.target.value),placeholder:"e.g. 1200",min:"100",max:"3000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty for no minimum"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Maximum ELO"}),e.jsx(D,{type:"number",value:s.maxEloRating,onChange:t=>v("maxEloRating",t.target.value),placeholder:"e.g. 1800",min:"100",max:"3000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty for no maximum"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Minimum Reputation"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{type:"number",value:s.minReputation,onChange:t=>v("minReputation",t.target.value),placeholder:"70",min:"0",max:"100"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Players need at least this reputation score to join (0-100). Lower values allow players with poor attendance history."})]})]}),e.jsxs(z,{children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsxs(H,{children:[s.skillLevel==="mixed"&&"Mixed skill level games welcome players of all abilities. Great for casual, fun games!",s.skillLevel==="beginner"&&"Beginner games are perfect for new players learning the sport. Experienced players may find it too easy.",s.skillLevel==="competitive"&&"Competitive games are for skilled players who want serious competition. ELO ratings will be tracked.",(s.skillLevel==="intermediate"||s.skillLevel==="advanced")&&`${s.skillLevel.charAt(0).toUpperCase()+s.skillLevel.slice(1)} level games are for players with some experience in the sport.`]})]})]})]})}),r===4&&e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-primary font-semibold text-sm",children:"4"}),"Review & Create"]})}),e.jsxs(G,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Game Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Sport:"}),e.jsxs("span",{className:"text-sm",children:[M?.icon," ",M?.label]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Date:"}),e.jsx("span",{className:"text-sm",children:s.date})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Time:"}),e.jsx("span",{className:"text-sm",children:s.time?new Date(`2000-01-01T${s.time}:00`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Duration:"}),e.jsxs("span",{className:"text-sm",children:[s.duration," minutes"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Skill Level:"}),e.jsx("span",{className:"text-sm capitalize",children:s.skillLevel}),s.competitiveMode&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:"Competitive"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Location:"}),e.jsx("span",{className:"text-sm",children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Max Players:"}),e.jsx("span",{className:"text-sm",children:s.maxPlayers})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Cost:"}),e.jsx("span",{className:"text-sm",children:s.cost})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Min Reputation:"}),e.jsxs("span",{className:"text-sm",children:[s.minReputation,"%"]})]})]})]}),s.competitiveMode&&(s.minEloRating||s.maxEloRating)&&e.jsxs("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"ELO Requirements"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.minEloRating&&s.maxEloRating?`Players must have ELO between ${s.minEloRating} and ${s.maxEloRating}`:s.minEloRating?`Players must have ELO of at least ${s.minEloRating}`:s.maxEloRating?`Players must have ELO no higher than ${s.maxEloRating}`:null})]})]}),e.jsxs(z,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsxs(H,{children:['Ready to create "',s.title,'" for ',s.maxPlayers," players on ",s.date," at ",s.time?new Date(`2000-01-01T${s.time}:00`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"","?"]})]}),d.duplicate&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:d.duplicate}),e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"You can still create this game if it's intentional."})]})]})]})}),j&&e.jsx("div",{className:"mt-4",children:e.jsx(z,{variant:"destructive",children:e.jsx(H,{children:j})})})]}),e.jsx("div",{ref:q,className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t border-border safe-area-inset-bottom z-50",children:e.jsxs("div",{className:"px-4 py-3 pb-safe",children:[e.jsx("div",{className:"flex justify-center mb-3 sm:hidden",children:e.jsx("div",{className:"flex items-center gap-2",children:C.map((t,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium transition-colors ${r===t.id?"bg-primary text-primary-foreground":r>t.id?"bg-green-500 text-white":"bg-muted text-muted-foreground"}`,children:r>t.id?"‚úì":t.id}),a<C.length-1&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${r>t.id?"bg-green-500":"bg-muted"}`})]},t.id))})}),e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[r>1?e.jsxs(T,{variant:"outline",onClick:ee,className:"min-h-[48px] px-4 sm:px-6 flex-1 max-w-[120px] touch-manipulation text-sm sm:text-base",size:"lg",children:[e.jsx(B,{className:"w-4 h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"Back"})]}):e.jsx(T,{variant:"ghost",onClick:()=>N(-1),className:"min-h-[48px] px-4 touch-manipulation text-sm sm:text-base",size:"lg",children:"Cancel"}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm text-muted-foreground",children:["Step ",r," of ",C.length]}),r<C.length?e.jsxs(T,{onClick:pe,disabled:!F(r)||Object.keys(d).some(t=>t!=="duplicate"),className:"min-h-[48px] px-4 sm:px-6 flex-1 max-w-[120px] touch-manipulation text-sm sm:text-base",size:"lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Continue"}),e.jsx("span",{className:"sm:hidden",children:"Next"}),e.jsx(B,{className:"w-4 h-4 ml-1 sm:ml-2 rotate-180"})]}):e.jsx(T,{onClick:he,disabled:!F(r)||Object.keys(d).some(t=>t!=="duplicate")||p,className:"min-h-[48px] px-4 sm:px-6 flex-1 max-w-[140px] touch-manipulation text-sm sm:text-base",size:"lg",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4 mr-1 sm:mr-2 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Creating..."}),e.jsx("span",{className:"sm:hidden",children:"Wait..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Create Game"}),e.jsx("span",{className:"sm:hidden",children:"Create"})]})})]}),!F(r)&&e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete required fields to continue"})}),!1]})})]})}export{We as default};
//# sourceMappingURL=CreateGame-DferleHj.js.map
