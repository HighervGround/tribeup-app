import{r as o,S as r,t as n}from"./index-Cc4LGJhl.js";function y(){const[c,a]=o.useState([]),[e,f]=o.useState({pushNotifications:!0,emailNotifications:!1,gameReminders:!0,messageNotifications:!0,soundEnabled:!0});o.useEffect(()=>{(async()=>{try{const t=await r.getNotifications();a(t)}catch(t){console.error("Error loading notifications:",t)}})()},[]),o.useEffect(()=>{const i=r.subscribeToNotifications(t=>{a(s=>[t,...s]),e.pushNotifications&&u(t)});return()=>{i?.unsubscribe()}},[e.pushNotifications]);const u=o.useCallback(i=>{e.pushNotifications&&(e.soundEnabled&&console.log("ðŸ”Š Notification sound played"),n(i.title,{description:i.message,action:i.actionUrl?{label:"View",onClick:()=>{console.log("Navigate to:",i.actionUrl)}}:void 0,duration:5e3}),"Notification"in window&&Notification.permission==="granted"&&new Notification(i.title,{body:i.message,icon:"/favicon.ico",badge:"/favicon.ico",vibrate:[200,100,200],timestamp:i.timestamp.getTime()}))},[e.pushNotifications,e.soundEnabled]),d=o.useCallback(async i=>{try{await r.markNotificationAsRead(i),a(t=>t.map(s=>s.id===i?{...s,read:!0}:s))}catch(t){console.error("Error marking notification as read:",t)}},[]),N=o.useCallback(async()=>{try{const i=c.filter(t=>!t.read);await Promise.all(i.map(t=>r.markNotificationAsRead(t.id))),a(t=>t.map(s=>({...s,read:!0})))}catch(i){console.error("Error marking all notifications as read:",i)}},[c]),m=o.useCallback(async i=>{try{await r.deleteNotification(i),a(t=>t.filter(s=>s.id!==i))}catch(t){console.error("Error deleting notification:",t)}},[]),p=o.useCallback(async()=>{try{await r.clearAllNotifications(),a([])}catch(i){console.error("Error clearing all notifications:",i)}},[]),l=o.useCallback(async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?(n.error("Notifications are blocked. Please enable them in your browser settings."),!1):await Notification.requestPermission()==="granted"?(n.success("Notifications enabled!"),!0):(n.error("Notification permission denied"),!1):(n.error("Browser notifications not supported"),!1),[]),b=o.useCallback(i=>{f(t=>({...t,...i})),i.pushNotifications&&!e.pushNotifications&&l()},[e.pushNotifications,l]),g=c.filter(i=>!i.read).length;return{notifications:c.slice(0,10),unreadCount:g,settings:e,markAsRead:d,markAllAsRead:N,deleteNotification:m,clearAll:p,updateSettings:b,requestPermission:l}}export{y as u};
//# sourceMappingURL=useNotifications-DiLhkJRH.js.map
