import{j as e}from"./ui-B4gQYcc6.js";import{e as s,u as a,r as t}from"./vendor-CTE-63Sz.js";import{i as r,C as n,d as i,e as l,a as o,B as c}from"./index-DjD2F37Y.js";import{I as d}from"./input-BX0zMGzL.js";import{A as m,a as u}from"./alert-BhCkKA91.js";import{ak as x,al as h}from"./utils-B5KmqWpW.js";import"./data-pHbUkPVm.js";function g(){s();const g=a(),{signIn:p,signUp:j,resetPassword:f,signInWithOAuth:y}=r(),[v,w]=t.useState(!1),[b,N]=t.useState(!1),[k,S]=t.useState(""),[C,A]=t.useState(""),[P,I]=t.useState(""),[E,F]=t.useState(!1),[U,O]=t.useState(""),[T,q]=t.useState("");t.useEffect(()=>{"true"===new URLSearchParams(g.search).get("reset")&&N(!0)},[g]);const R=async e=>{F(!0),O("");const s=setTimeout(()=>{F(!1),O("OAuth sign-in timed out. Please try again or use email sign-in.")},3e4);try{await y(e)}catch(a){clearTimeout(s),a.message?.includes("popup")?O("Authentication popup was blocked. Please allow popups and try again."):a.message?.includes("network")||a.message?.includes("fetch")?O("Network error during authentication. Please check your connection and try again."):a.message?.includes("redirect")?O("OAuth redirect failed. Please try again or use email sign-in."):O(`Authentication failed: ${a.message||"Unknown error"}. Please try again or use email sign-in.`),F(!1)}return()=>clearTimeout(s)},B=()=>E?"Loading...":b?"Send Reset Email":v?"Sign Up":"Sign In";return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(n,{className:"w-full max-w-md",children:[e.jsx(i,{children:e.jsx(l,{className:"text-center",children:b?"Reset Password":v?"Create Account":"Sign In"})}),e.jsxs(o,{children:[!b&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs(c,{variant:"outline",onClick:()=>R("google"),disabled:E,className:"w-full",children:[e.jsx(x,{className:"mr-2 h-4 w-4"}),"Google"]}),e.jsxs(c,{variant:"outline",onClick:()=>R("apple"),disabled:E,className:"w-full",children:[e.jsx(h,{className:"mr-2 h-4 w-4"}),"Apple"]})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center mb-4",children:"Note: You may see browser warnings during OAuth sign-in. These are from external services and don't affect your account security."}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with email"})})]})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),F(!0),O(""),q("");try{b?(await f(k),q("Password reset email sent! Check your inbox."),N(!1)):v?(await j(k,C,{name:P,email:k}),q("Check your email for confirmation link!")):await p(k,C)}catch(s){O(s.message)}finally{F(!1)}},className:"space-y-4",children:[v&&!b&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"text-sm font-medium",children:"Name"}),e.jsx(d,{id:"name",name:"name",type:"text",value:P,onChange:e=>I(e.target.value),required:v,placeholder:"Enter your full name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),e.jsx(d,{id:"email",name:"email",type:"email",value:k,onChange:e=>S(e.target.value),required:!0,placeholder:"Enter your email"})]}),!b&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),e.jsx(d,{id:"password",name:"password",type:"password",value:C,onChange:e=>A(e.target.value),required:!b,placeholder:"Enter your password"})]}),U&&e.jsx(m,{variant:"destructive",children:e.jsx(u,{children:U})}),T&&e.jsx(m,{children:e.jsx(u,{children:T})}),e.jsx(c,{type:"submit",className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",disabled:E,style:{minHeight:"40px",display:"block"},children:B()}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Debug: isSignUp=",v.toString(),", loading=",E.toString(),', buttonText="',B(),'"']})]}),e.jsx("div",{className:"mt-4 space-y-2 text-center",children:b?e.jsx("button",{onClick:()=>{w(!1),N(!1),O(""),q("")},className:"text-sm text-muted-foreground hover:text-foreground",children:"Back to Sign In"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(!v),className:"text-sm text-muted-foreground hover:text-foreground block",children:v?"Already have an account? Sign In":"Need an account? Sign Up"}),e.jsx("button",{onClick:()=>N(!0),className:"text-sm text-muted-foreground hover:text-foreground block",children:"Forgot your password?"})]})})]})]})})}export{g as default};
//# sourceMappingURL=Auth-BtY3oSs2.js.map
