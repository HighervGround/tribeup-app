{"version":3,"file":"useDeepLinks-a41SsUrc.js","sources":["../../src/hooks/useDeepLinks.ts"],"sourcesContent":["import { useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation, useParams } from 'react-router-dom';\nimport { toast } from 'sonner';\n\ninterface DeepLink {\n  path: string;\n  params?: Record<string, string>;\n  query?: Record<string, string>;\n  state?: any;\n}\n\ninterface ShareableLink {\n  title: string;\n  description: string;\n  url: string;\n  image?: string;\n}\n\nexport function useDeepLinks() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const params = useParams();\n\n  // Generate app URLs for sharing\n  const generateGameUrl = useCallback((gameId: string, options?: { \n    utm_source?: string; \n    utm_medium?: string; \n    utm_campaign?: string;\n  }) => {\n    const baseUrl = window.location.origin;\n    const url = new URL(`${baseUrl}/game/${gameId}`);\n    \n    if (options) {\n      Object.entries(options).forEach(([key, value]) => {\n        if (value) url.searchParams.set(key, value);\n      });\n    }\n    \n    return url.toString();\n  }, []);\n\n  const generateChatUrl = useCallback((type: 'game' | 'direct', id: string, options?: {\n    message?: string;\n    utm_source?: string;\n  }) => {\n    const baseUrl = window.location.origin;\n    const url = new URL(`${baseUrl}/chat/${type}/${id}`);\n    \n    if (options) {\n      Object.entries(options).forEach(([key, value]) => {\n        if (value) url.searchParams.set(key, value);\n      });\n    }\n    \n    return url.toString();\n  }, []);\n\n  const generateUserUrl = useCallback((userId: string) => {\n    const baseUrl = window.location.origin;\n    return `${baseUrl}/user/${userId}`;\n  }, []);\n\n  // Share game with native sharing or clipboard\n  const shareGame = useCallback(async (gameData: {\n    id: string;\n    title: string;\n    sport: string;\n    location: string;\n    date: string;\n    time: string;\n  }) => {\n    const gameUrl = generateGameUrl(gameData.id, {\n      utm_source: 'app_share',\n      utm_medium: 'native_share',\n      utm_campaign: 'game_invitation'\n    });\n\n    const shareData: ShareableLink = {\n      title: `Join me for ${gameData.title}!`,\n      description: `${gameData.sport} game at ${gameData.location} on ${gameData.date} at ${gameData.time}. Tap to join!`,\n      url: gameUrl\n    };\n\n    try {\n      if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {\n        await navigator.share(shareData);\n        toast.success('Game shared successfully!');\n        return true;\n      } else {\n        // Fallback to clipboard\n        await navigator.clipboard.writeText(gameUrl);\n        toast.success('Game link copied to clipboard!', {\n          description: 'Share with your friends',\n          action: {\n            label: 'Share again',\n            onClick: () => shareGame(gameData)\n          }\n        });\n        return true;\n      }\n    } catch (error) {\n      console.error('Error sharing game:', error);\n      toast.error('Failed to share game');\n      return false;\n    }\n  }, [generateGameUrl]);\n\n  // Share user profile\n  const shareProfile = useCallback(async (userData: {\n    id: string;\n    name: string;\n    rating?: number;\n  }) => {\n    const profileUrl = generateUserUrl(userData.id);\n    const shareData: ShareableLink = {\n      title: `Check out ${userData.name}'s TribeUp profile`,\n      description: `${userData.name}${userData.rating ? ` (${userData.rating}â­)` : ''} is on TribeUp! Connect and play sports together.`,\n      url: profileUrl\n    };\n\n    try {\n      if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {\n        await navigator.share(shareData);\n        toast.success('Profile shared successfully!');\n        return true;\n      } else {\n        await navigator.clipboard.writeText(profileUrl);\n        toast.success('Profile link copied to clipboard!');\n        return true;\n      }\n    } catch (error) {\n      console.error('Error sharing profile:', error);\n      toast.error('Failed to share profile');\n      return false;\n    }\n  }, [generateUserUrl]);\n\n  // Navigate with deep link support\n  const navigateToGame = useCallback((gameId: string, state?: any) => {\n    navigate(`/game/${gameId}`, { state });\n  }, [navigate]);\n\n  const navigateToChat = useCallback((type: 'game' | 'direct', id: string, state?: any) => {\n    navigate(`/chat/${type}/${id}`, { state });\n  }, [navigate]);\n\n  const navigateToUser = useCallback((userId: string, state?: any) => {\n    navigate(`/user/${userId}`, { state });\n  }, [navigate]);\n\n  // Handle incoming deep links (when app is opened via URL)\n  const handleIncomingDeepLink = useCallback(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const utmSource = searchParams.get('utm_source');\n    const utmMedium = searchParams.get('utm_medium');\n    const utmCampaign = searchParams.get('utm_campaign');\n\n    // Track analytics for deep link usage\n    if (utmSource || utmMedium || utmCampaign) {\n      console.log('Deep link opened with UTM parameters:', {\n        source: utmSource,\n        medium: utmMedium,\n        campaign: utmCampaign,\n        path: location.pathname\n      });\n\n      // In a real app, you'd send this to your analytics service\n      // analytics.track('deep_link_opened', { utmSource, utmMedium, utmCampaign, path: location.pathname });\n    }\n\n    // Handle specific deep link actions\n    if (location.pathname.startsWith('/game/')) {\n      const gameId = params.gameId;\n      if (gameId && utmCampaign === 'game_invitation') {\n        toast.success('Welcome to the game!', {\n          description: 'You were invited to join this game'\n        });\n      }\n    }\n\n    if (location.pathname.startsWith('/chat/')) {\n      const message = searchParams.get('message');\n      if (message) {\n        // Pre-fill message input if provided\n        setTimeout(() => {\n          const messageInput = document.querySelector('input[placeholder*=\"message\" i]') as HTMLInputElement;\n          if (messageInput) {\n            messageInput.value = decodeURIComponent(message);\n            messageInput.focus();\n          }\n        }, 500);\n      }\n    }\n  }, [location, params]);\n\n  // Generate meta tags for social sharing (for SSR or when sharing externally)\n  const generateMetaTags = useCallback((data: ShareableLink) => {\n    return {\n      'og:title': data.title,\n      'og:description': data.description,\n      'og:url': data.url,\n      'og:image': data.image || `${window.location.origin}/og-image.png`,\n      'og:type': 'website',\n      'twitter:card': 'summary_large_image',\n      'twitter:title': data.title,\n      'twitter:description': data.description,\n      'twitter:image': data.image || `${window.location.origin}/og-image.png`\n    };\n  }, []);\n\n  // Copy current URL to clipboard\n  const copyCurrentUrl = useCallback(async () => {\n    try {\n      await navigator.clipboard.writeText(window.location.href);\n      toast.success('Link copied to clipboard!');\n      return true;\n    } catch (error) {\n      console.error('Error copying URL:', error);\n      toast.error('Failed to copy link');\n      return false;\n    }\n  }, []);\n\n  // Get current route context for analytics\n  const getCurrentContext = useCallback(() => {\n    const path = location.pathname;\n    \n    if (path === '/') return 'home';\n    if (path === '/search') return 'search';\n    if (path === '/create') return 'create';\n    if (path === '/profile') return 'profile';\n    if (path.startsWith('/game/')) return 'game';\n    if (path.startsWith('/chat/')) return 'chat';\n    if (path.startsWith('/user/')) return 'user_profile';\n    if (path.startsWith('/settings')) return 'settings';\n    \n    return 'unknown';\n  }, [location.pathname]);\n\n  // Handle deep link on app load/route change\n  useEffect(() => {\n    handleIncomingDeepLink();\n  }, [handleIncomingDeepLink]);\n\n  // Return all utilities\n  return {\n    // URL generators\n    generateGameUrl,\n    generateChatUrl,\n    generateUserUrl,\n    \n    // Sharing functions\n    shareGame,\n    shareProfile,\n    copyCurrentUrl,\n    \n    // Navigation functions\n    navigateToGame,\n    navigateToChat,\n    navigateToUser,\n    \n    // Utilities\n    generateMetaTags,\n    getCurrentContext,\n    \n    // Current route info\n    currentPath: location.pathname,\n    currentSearch: location.search,\n    currentParams: params,\n    currentState: location.state\n  };\n}\n\n// Hook for handling URL state and query parameters\nexport function useUrlState<T = any>(key: string, defaultValue?: T) {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const getValue = useCallback(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const value = searchParams.get(key);\n    \n    if (value === null) return defaultValue;\n    \n    try {\n      return JSON.parse(value);\n    } catch {\n      return value;\n    }\n  }, [location.search, key, defaultValue]);\n\n  const setValue = useCallback((value: T) => {\n    const searchParams = new URLSearchParams(location.search);\n    \n    if (value === undefined || value === null) {\n      searchParams.delete(key);\n    } else {\n      const stringValue = typeof value === 'string' ? value : JSON.stringify(value);\n      searchParams.set(key, stringValue);\n    }\n    \n    const newSearch = searchParams.toString();\n    const newUrl = newSearch ? `${location.pathname}?${newSearch}` : location.pathname;\n    \n    navigate(newUrl, { replace: true, state: location.state });\n  }, [location, navigate, key]);\n\n  return [getValue(), setValue] as const;\n}"],"names":["useDeepLinks","navigate","useNavigate","location","useLocation","params","useParams","generateGameUrl","useCallback","gameId","options","baseUrl","window","origin","url","URL","Object","entries","forEach","key","value","searchParams","set","toString","generateChatUrl","type","id","generateUserUrl","userId","shareGame","async","gameData","gameUrl","utm_source","utm_medium","utm_campaign","shareData","title","description","sport","date","time","navigator","share","canShare","toast","success","clipboard","writeText","action","label","onClick","error","shareProfile","userData","profileUrl","name","rating","navigateToGame","state","navigateToChat","navigateToUser","handleIncomingDeepLink","URLSearchParams","search","utmCampaign","get","pathname","startsWith","message","setTimeout","messageInput","document","querySelector","decodeURIComponent","focus","generateMetaTags","data","image","copyCurrentUrl","href","getCurrentContext","path","useEffect","currentPath","currentSearch","currentParams","currentState"],"mappings":"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"}